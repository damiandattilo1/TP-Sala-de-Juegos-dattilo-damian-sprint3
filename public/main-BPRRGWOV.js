import{$ as Ne,A as Qb,B as Yb,C as fn,D as ti,E as qd,F as Ou,G as Xm,H as Zb,I as Xb,J as B,K as Qt,L as it,M as Jm,N as Jb,O as Fu,P as ee,Q as Lt,R as Gd,S as ey,T as pn,U as ni,V as Sr,W as Ao,X as Ro,Y as ty,Z as ri,_ as zd,a as M,aa as st,b as ge,ba as ny,c as Qm,d as _,e as $b,f as Ud,g as Hb,h as qb,i as D,j as bo,k as jd,l as Gb,m as zb,n as Pu,o as dt,p as So,q as ku,r as Ym,s as Wb,t as Qn,u as Zm,v as Bd,w as $d,x as Kb,y as Hd,z as Xe}from"./chunk-4OSARYCZ.js";var e0=null;var ry=1,iy=Symbol("SIGNAL");function me(t){let e=e0;return e0=t,e}var t0={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function pL(t){if(!(ay(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===ry)){if(!t.producerMustRecompute(t)&&!sy(t)){t.dirty=!1,t.lastCleanEpoch=ry;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=ry}}function n0(t){return t&&(t.nextProducerIndex=0),me(t)}function r0(t,e){if(me(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(ay(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)oy(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function sy(t){Wd(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(pL(n),r!==n.version))return!0}return!1}function i0(t){if(Wd(t),ay(t))for(let e=0;e<t.producerNode.length;e++)oy(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function oy(t,e){if(gL(t),Wd(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)oy(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Wd(i),i.producerIndexOfThis[r]=e}}function ay(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Wd(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function gL(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function mL(){throw new Error}var yL=mL;function s0(t){yL=t}function G(t){return typeof t=="function"}function xo(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Kd=xo(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function Ji(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var We=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(G(r))try{r()}catch(s){e=s instanceof Kd?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{o0(s)}catch(o){e=e??[],o instanceof Kd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Kd(e)}}add(e){var n;if(e&&e!==this)if(this.closed)o0(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Ji(n,e)}remove(e){let{_finalizers:n}=this;n&&Ji(n,e),e instanceof t&&e._removeParent(this)}};We.EMPTY=(()=>{let t=new We;return t.closed=!0,t})();var uy=We.EMPTY;function Qd(t){return t instanceof We||t&&"closed"in t&&G(t.remove)&&G(t.add)&&G(t.unsubscribe)}function o0(t){G(t)?t():t.unsubscribe()}var kn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Mo={setTimeout(t,e,...n){let{delegate:r}=Mo;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=Mo;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Yd(t){Mo.setTimeout(()=>{let{onUnhandledError:e}=kn;if(e)e(t);else throw t})}function es(){}var a0=cy("C",void 0,void 0);function u0(t){return cy("E",void 0,t)}function c0(t){return cy("N",t,void 0)}function cy(t,e,n){return{kind:t,value:e,error:n}}var ts=null;function No(t){if(kn.useDeprecatedSynchronousErrorHandling){let e=!ts;if(e&&(ts={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=ts;if(ts=null,n)throw r}}else t()}function l0(t){kn.useDeprecatedSynchronousErrorHandling&&ts&&(ts.errorThrown=!0,ts.error=t)}var ns=class extends We{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Qd(e)&&e.add(this)):this.destination=wL}static create(e,n,r){return new Ar(e,n,r)}next(e){this.isStopped?dy(c0(e),this):this._next(e)}error(e){this.isStopped?dy(u0(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?dy(a0,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},_L=Function.prototype.bind;function ly(t,e){return _L.call(t,e)}var hy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Zd(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Zd(r)}else Zd(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Zd(n)}}},Ar=class extends ns{constructor(e,n,r){super();let i;if(G(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&kn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&ly(e.next,s),error:e.error&&ly(e.error,s),complete:e.complete&&ly(e.complete,s)}):i=e}this.destination=new hy(i)}};function Zd(t){kn.useDeprecatedSynchronousErrorHandling?l0(t):Yd(t)}function vL(t){throw t}function dy(t,e){let{onStoppedNotification:n}=kn;n&&Mo.setTimeout(()=>n(t,e))}var wL={closed:!0,next:es,error:vL,complete:es};var Po=typeof Symbol=="function"&&Symbol.observable||"@@observable";function wt(t){return t}function fy(...t){return py(t)}function py(t){return t.length===0?wt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var X=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=IL(n)?n:new Ar(n,r,i);return No(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=d0(r),new r((i,s)=>{let o=new Ar({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Po](){return this}pipe(...n){return py(n)(this)}toPromise(n){return n=d0(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function d0(t){var e;return(e=t??kn.Promise)!==null&&e!==void 0?e:Promise}function EL(t){return t&&G(t.next)&&G(t.error)&&G(t.complete)}function IL(t){return t&&t instanceof ns||EL(t)&&Qd(t)}function gy(t){return G(t?.lift)}function K(t){return e=>{if(gy(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function z(t,e,n,r,i){return new my(t,e,n,r,i)}var my=class extends ns{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function ko(){return K((t,e)=>{let n=null;t._refCount++;let r=z(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Oo=class extends X{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,gy(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new We;let n=this.getSubject();e.add(this.source.subscribe(z(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=We.EMPTY)}return e}refCount(){return ko()(this)}};var h0=xo(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Be=(()=>{class t extends X{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Xd(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new h0}next(n){No(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){No(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){No(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?uy:(this.currentObservers=null,s.push(n),new We(()=>{this.currentObservers=null,Ji(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new X;return n.source=this,n}}return t.create=(e,n)=>new Xd(e,n),t})(),Xd=class extends Be{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:uy}};var Et=class extends Be{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Lu={now(){return(Lu.delegate||Date).now()},delegate:void 0};var Jd=class extends Be{constructor(e=1/0,n=1/0,r=Lu){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}};var eh=class extends We{constructor(e,n){super()}schedule(e,n=0){return this}};var Vu={setInterval(t,e,...n){let{delegate:r}=Vu;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=Vu;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Fo=class extends eh{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return Vu.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&Vu.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,Ji(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Lo=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};Lo.now=Lu.now;var Vo=class extends Lo{constructor(e,n=Lo.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var rs=new Vo(Fo);var th=class extends Fo{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var nh=class extends Vo{};var yy=new nh(th);var Vt=new X(t=>t.complete());function f0(t){return t&&G(t.schedule)}function _y(t){return t[t.length-1]}function Uo(t){return G(_y(t))?t.pop():void 0}function Yn(t){return f0(_y(t))?t.pop():void 0}function p0(t,e){return typeof _y(t)=="number"?t.pop():e}var rh=t=>t&&typeof t.length=="number"&&typeof t!="function";function ih(t){return G(t?.then)}function sh(t){return G(t[Po])}function oh(t){return Symbol.asyncIterator&&G(t?.[Symbol.asyncIterator])}function ah(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function CL(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var uh=CL();function ch(t){return G(t?.[uh])}function lh(t){return Hb(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield Ud(n.read());if(i)return yield Ud(void 0);yield yield Ud(r)}}finally{n.releaseLock()}})}function dh(t){return G(t?.getReader)}function Ie(t){if(t instanceof X)return t;if(t!=null){if(sh(t))return DL(t);if(rh(t))return TL(t);if(ih(t))return bL(t);if(oh(t))return g0(t);if(ch(t))return SL(t);if(dh(t))return AL(t)}throw ah(t)}function DL(t){return new X(e=>{let n=t[Po]();if(G(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function TL(t){return new X(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function bL(t){return new X(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Yd)})}function SL(t){return new X(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function g0(t){return new X(e=>{RL(t,e).catch(n=>e.error(n))})}function AL(t){return g0(lh(t))}function RL(t,e){var n,r,i,s;return $b(this,void 0,void 0,function*(){try{for(n=qb(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function Yt(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function tn(t,e=0){return K((n,r)=>{n.subscribe(z(r,i=>Yt(r,t,()=>r.next(i),e),()=>Yt(r,t,()=>r.complete(),e),i=>Yt(r,t,()=>r.error(i),e)))})}function gn(t,e=0){return K((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function m0(t,e){return Ie(t).pipe(gn(e),tn(e))}function y0(t,e){return Ie(t).pipe(gn(e),tn(e))}function _0(t,e){return new X(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function v0(t,e){return new X(n=>{let r;return Yt(n,e,()=>{r=t[uh](),Yt(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>G(r?.return)&&r.return()})}function hh(t,e){if(!t)throw new Error("Iterable cannot be null");return new X(n=>{Yt(n,e,()=>{let r=t[Symbol.asyncIterator]();Yt(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function w0(t,e){return hh(lh(t),e)}function E0(t,e){if(t!=null){if(sh(t))return m0(t,e);if(rh(t))return _0(t,e);if(ih(t))return y0(t,e);if(oh(t))return hh(t,e);if(ch(t))return v0(t,e);if(dh(t))return w0(t,e)}throw ah(t)}function ye(t,e){return e?E0(t,e):Ie(t)}function V(...t){let e=Yn(t);return ye(t,e)}function jo(t,e){let n=G(t)?t:()=>t,r=i=>i.error(n());return new X(e?i=>e.schedule(r,0,i):r)}function vy(t){return!!t&&(t instanceof X||G(t.lift)&&G(t.subscribe))}var Rr=xo(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function F(t,e){return K((n,r)=>{let i=0;n.subscribe(z(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:xL}=Array;function ML(t,e){return xL(e)?t(...e):t(e)}function fh(t){return F(e=>ML(t,e))}var{isArray:NL}=Array,{getPrototypeOf:PL,prototype:kL,keys:OL}=Object;function ph(t){if(t.length===1){let e=t[0];if(NL(e))return{args:e,keys:null};if(FL(e)){let n=OL(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function FL(t){return t&&typeof t=="object"&&PL(t)===kL}function gh(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function mh(...t){let e=Yn(t),n=Uo(t),{args:r,keys:i}=ph(t);if(r.length===0)return ye([],e);let s=new X(LL(r,e,i?o=>gh(i,o):wt));return n?s.pipe(fh(n)):s}function LL(t,e,n=wt){return r=>{I0(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)I0(e,()=>{let c=ye(t[u],e),l=!1;c.subscribe(z(r,d=>{s[u]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function I0(t,e,n){t?Yt(n,t,e):e()}function C0(t,e,n,r,i,s,o,a){let u=[],c=0,l=0,d=!1,h=()=>{d&&!u.length&&!c&&e.complete()},f=g=>c<r?p(g):u.push(g),p=g=>{s&&e.next(g),c++;let m=!1;Ie(n(g,l++)).subscribe(z(e,I=>{i?.(I),s?f(I):e.next(I)},()=>{m=!0},void 0,()=>{if(m)try{for(c--;u.length&&c<r;){let I=u.shift();o?Yt(e,o,()=>p(I)):p(I)}h()}catch(I){e.error(I)}}))};return t.subscribe(z(e,f,()=>{d=!0,h()})),()=>{a?.()}}function ot(t,e,n=1/0){return G(e)?ot((r,i)=>F((s,o)=>e(r,s,i,o))(Ie(t(r,i))),n):(typeof e=="number"&&(n=e),K((r,i)=>C0(r,i,t,n)))}function Uu(t=1/0){return ot(wt,t)}function D0(){return Uu(1)}function Bo(...t){return D0()(ye(t,Yn(t)))}function yh(t){return new X(e=>{Ie(t()).subscribe(e)})}function wy(...t){let e=Uo(t),{args:n,keys:r}=ph(t),i=new X(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),u=o,c=o;for(let l=0;l<o;l++){let d=!1;Ie(n[l]).subscribe(z(s,h=>{d||(d=!0,c--),a[l]=h},()=>u--,void 0,()=>{(!u||!d)&&(c||s.next(r?gh(r,a):a),s.complete())}))}});return e?i.pipe(fh(e)):i}function $o(...t){let e=Yn(t),n=p0(t,1/0),r=t;return r.length?r.length===1?Ie(r[0]):Uu(n)(ye(r,e)):Vt}function bt(t,e){return K((n,r)=>{let i=0;n.subscribe(z(r,s=>t.call(e,s,i++)&&r.next(s)))})}function ii(t){return K((e,n)=>{let r=null,i=!1,s;r=e.subscribe(z(n,void 0,void 0,o=>{s=Ie(t(o,ii(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function T0(t,e,n,r,i){return(s,o)=>{let a=n,u=e,c=0;s.subscribe(z(o,l=>{let d=c++;u=a?t(u,l,d):(a=!0,l),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function Ho(t,e){return G(e)?ot(t,e,1):ot(t,1)}function si(t){return K((e,n)=>{let r=!1;e.subscribe(z(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function xr(t){return t<=0?()=>Vt:K((e,n)=>{let r=0;e.subscribe(z(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Ey(t){return F(()=>t)}function ju(t,e=wt){return t=t??VL,K((n,r)=>{let i,s=!0;n.subscribe(z(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function VL(t,e){return t===e}function _h(t=UL){return K((e,n)=>{let r=!1;e.subscribe(z(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function UL(){return new Rr}function Bu(t){return K((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function mn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?bt((i,s)=>t(i,s,r)):wt,xr(1),n?si(e):_h(()=>new Rr))}function qo(t){return t<=0?()=>Vt:K((e,n)=>{let r=[];e.subscribe(z(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function Iy(t,e){let n=arguments.length>=2;return r=>r.pipe(t?bt((i,s)=>t(i,s,r)):wt,qo(1),n?si(e):_h(()=>new Rr))}function $u(){return K((t,e)=>{let n,r=!1;t.subscribe(z(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function Zn(t,e){return K(T0(t,e,arguments.length>=2,!0))}function Hu(t={}){let{connector:e=()=>new Be,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,c=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=u=void 0,l=d=!1},p=()=>{let g=o;f(),g?.unsubscribe()};return K((g,m)=>{c++,!d&&!l&&h();let I=u=u??e();m.add(()=>{c--,c===0&&!d&&!l&&(a=Cy(p,i))}),I.subscribe(m),!o&&c>0&&(o=new Ar({next:R=>I.next(R),error:R=>{d=!0,h(),a=Cy(f,n,R),I.error(R)},complete:()=>{l=!0,h(),a=Cy(f,r),I.complete()}}),Ie(g).subscribe(o))})(s)}}function Cy(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new Ar({next:()=>{r.unsubscribe(),t()}});return Ie(e(...n)).subscribe(r)}function vh(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,Hu({connector:()=>new Jd(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Dy(t){return K((e,n)=>{let r=!1,i=0;e.subscribe(z(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function is(...t){let e=Yn(t);return K((n,r)=>{(e?Bo(t,n,e):Bo(t,n)).subscribe(r)})}function Oe(t,e){return K((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(z(r,u=>{i?.unsubscribe();let c=0,l=s++;Ie(t(u,l)).subscribe(i=z(r,d=>r.next(e?e(u,d,l,c++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function wh(t,e){return G(e)?Oe(()=>t,e):Oe(()=>t)}function Ty(t){return K((e,n)=>{Ie(t).subscribe(z(n,()=>n.complete(),es)),!n.closed&&e.subscribe(n)})}function at(t,e,n){let r=G(t)||e||n?{next:t,error:e,complete:n}:t;return r?K((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(z(s,u=>{var c;(c=r.next)===null||c===void 0||c.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,u),s.error(u)},()=>{var u,c;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):wt}function by(...t){let e=Uo(t);return K((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let u=0;u<i;u++)Ie(t[u]).subscribe(z(r,c=>{s[u]=c,!a&&!o[u]&&(o[u]=!0,(a=o.every(wt))&&(o=null))},es));n.subscribe(z(r,u=>{if(a){let c=[u,...s];r.next(e?e(...c):c)}}))})}var uS="https://g.co/ng/security#xss",$=class extends Error{constructor(e,n){super(D_(e,n)),this.code=e}};function D_(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function nc(t){return{toString:t}.toString()}var Eh="__parameters__";function jL(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function BL(t,e,n){return nc(()=>{let r=jL(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,c,l){let d=u.hasOwnProperty(Eh)?u[Eh]:Object.defineProperty(u,Eh,{value:[]})[Eh];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var ss=globalThis;function Ce(t){for(let e in t)if(t[e]===Ce)return e;throw Error("Could not find renamed property on target object.")}function $L(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function jt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(jt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function b0(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var HL=Ce({__forward_ref__:Ce});function ms(t){return t.__forward_ref__=ms,t.toString=function(){return jt(this())},t}function Ut(t){return cS(t)?t():t}function cS(t){return typeof t=="function"&&t.hasOwnProperty(HL)&&t.__forward_ref__===ms}function U(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Le(t){return{providers:t.providers||[],imports:t.imports||[]}}function Qh(t){return S0(t,dS)||S0(t,hS)}function lS(t){return Qh(t)!==null}function S0(t,e){return t.hasOwnProperty(e)?t[e]:null}function qL(t){let e=t&&(t[dS]||t[hS]);return e||null}function A0(t){return t&&(t.hasOwnProperty(R0)||t.hasOwnProperty(GL))?t[R0]:null}var dS=Ce({\u0275prov:Ce}),R0=Ce({\u0275inj:Ce}),hS=Ce({ngInjectableDef:Ce}),GL=Ce({ngInjectorDef:Ce}),N=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=U({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function fS(t){return t&&!!t.\u0275providers}var zL=Ce({\u0275cmp:Ce}),WL=Ce({\u0275dir:Ce}),KL=Ce({\u0275pipe:Ce}),QL=Ce({\u0275mod:Ce}),xh=Ce({\u0275fac:Ce}),qu=Ce({__NG_ELEMENT_ID__:Ce}),x0=Ce({__NG_ENV_ID__:Ce});function T_(t){return typeof t=="string"?t:t==null?"":String(t)}function YL(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():T_(t)}function ZL(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new $(-200,t)}function b_(t,e){throw new $(-201,!1)}var ie=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ie||{}),$y;function pS(){return $y}function yn(t){let e=$y;return $y=t,e}function gS(t,e,n){let r=Qh(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ie.Optional)return null;if(e!==void 0)return e;b_(t,"Injector")}var XL={},Gu=XL,Hy="__NG_DI_FLAG__",Mh="ngTempTokenPath",JL="ngTokenPath",eV=/\n/gm,tV="\u0275",M0="__source",Ko;function nV(){return Ko}function oi(t){let e=Ko;return Ko=t,e}function rV(t,e=ie.Default){if(Ko===void 0)throw new $(-203,!1);return Ko===null?gS(t,void 0,e):Ko.get(t,e&ie.Optional?null:void 0,e)}function T(t,e=ie.Default){return(pS()||rV)(Ut(t),e)}function k(t,e=ie.Default){return T(t,Yh(e))}function Yh(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function qy(t){let e=[];for(let n=0;n<t.length;n++){let r=Ut(t[n]);if(Array.isArray(r)){if(r.length===0)throw new $(900,!1);let i,s=ie.Default;for(let o=0;o<r.length;o++){let a=r[o],u=sV(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(T(i,s))}else e.push(T(r))}return e}function iV(t,e){return t[Hy]=e,t.prototype[Hy]=e,t}function sV(t){return t[Hy]}function oV(t,e,n,r){let i=t[Mh];throw e[M0]&&i.unshift(e[M0]),t.message=aV(`
`+t.message,i,n,r),t[JL]=i,t[Mh]=null,t}function aV(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==tV?t.slice(2):t;let i=jt(e);if(Array.isArray(e))i=e.map(jt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):jt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(eV,`
  `)}`}var Ke=iV(BL("Optional"),8);function Yo(t,e){let n=t.hasOwnProperty(xh);return n?t[xh]:null}function S_(t,e){t.forEach(n=>Array.isArray(n)?S_(n,e):e(n))}function mS(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Nh(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function uV(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function cV(t,e,n){let r=rc(t,e);return r>=0?t[r|1]=n:(r=~r,uV(t,r,e,n)),r}function Sy(t,e){let n=rc(t,e);if(n>=0)return t[n|1]}function rc(t,e){return lV(t,e,1)}function lV(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var Zo={},_n=[],Xo=new N(""),yS=new N("",-1),_S=new N(""),Ph=class{get(e,n=Gu){if(n===Gu){let r=new Error(`NullInjectorError: No provider for ${jt(e)}!`);throw r.name="NullInjectorError",r}return n}},vS=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(vS||{}),er=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(er||{}),At=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(At||{});function dV(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function Gy(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];hV(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function wS(t){return t===3||t===4||t===6}function hV(t){return t.charCodeAt(0)===64}function zu(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?N0(t,n,i,null,e[++r]):N0(t,n,i,null,null))}}return t}function N0(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var ES="ng-template";function fV(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&dV(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(A_(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function A_(t){return t.type===4&&t.value!==ES}function pV(t,e,n){let r=t.type===4&&!n?ES:t.value;return e===r}function gV(t,e,n){let r=4,i=t.attrs,s=i!==null?_V(i):0,o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!On(r)&&!On(u))return!1;if(o&&On(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!pV(t,u,n)||u===""&&e.length===1){if(On(r))return!1;o=!0}}else if(r&8){if(i===null||!fV(t,i,u,n)){if(On(r))return!1;o=!0}}else{let c=e[++a],l=mV(u,i,A_(t),n);if(l===-1){if(On(r))return!1;o=!0;continue}if(c!==""){let d;if(l>s?d="":d=i[l+1].toLowerCase(),r&2&&c!==d){if(On(r))return!1;o=!0}}}}return On(r)||o}function On(t){return(t&1)===0}function mV(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return vV(e,t)}function yV(t,e,n=!1){for(let r=0;r<e.length;r++)if(gV(t,e[r],n))return!0;return!1}function _V(t){for(let e=0;e<t.length;e++){let n=t[e];if(wS(n))return e}return t.length}function vV(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function P0(t,e){return t?":not("+e.trim()+")":e}function wV(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!On(o)&&(e+=P0(s,i),i=""),r=o,s=s||!On(r);n++}return i!==""&&(e+=P0(s,i)),e}function EV(t){return t.map(wV).join(",")}function IV(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!On(i))break;i=s}r++}return{attrs:e,classes:n}}function En(t){return nc(()=>{let e=bS(t),n=ge(M({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===vS.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||er.Emulated,styles:t.styles||_n,_:null,schemas:t.schemas||null,tView:null,id:""});SS(n);let r=t.dependencies;return n.directiveDefs=O0(r,!1),n.pipeDefs=O0(r,!0),n.id=TV(n),n})}function CV(t){return us(t)||IS(t)}function DV(t){return t!==null}function Ve(t){return nc(()=>({type:t.type,bootstrap:t.bootstrap||_n,declarations:t.declarations||_n,imports:t.imports||_n,exports:t.exports||_n,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function k0(t,e){if(t==null)return Zo;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=At.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==At.None?[r,a]:r,e[s]=o):n[s]=r}return n}function xt(t){return nc(()=>{let e=bS(t);return SS(e),e})}function us(t){return t[zL]||null}function IS(t){return t[WL]||null}function CS(t){return t[KL]||null}function DS(t){let e=us(t)||IS(t)||CS(t);return e!==null?e.standalone:!1}function TS(t,e){let n=t[QL]||null;if(!n&&e===!0)throw new Error(`Type ${jt(t)} does not have '\u0275mod' property.`);return n}function bS(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Zo,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||_n,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:k0(t.inputs,e),outputs:k0(t.outputs),debugInfo:null}}function SS(t){t.features?.forEach(e=>e(t))}function O0(t,e){if(!t)return null;let n=e?CS:CV;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(DV)}function TV(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Zh(t){return{\u0275providers:t}}function ys(...t){return{\u0275providers:AS(!0,t),\u0275fromNgModule:!0}}function AS(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return S_(e,o=>{let a=o;zy(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&RS(i,s),n}function RS(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];R_(i,s=>{e(s,r)})}}function zy(t,e,n,r){if(t=Ut(t),!t)return!1;let i=null,s=A0(t),o=!s&&us(t);if(!s&&!o){let u=t.ngModule;if(s=A0(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of u)zy(c,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let c;try{S_(s.imports,l=>{zy(l,e,n,r)&&(c||=[],c.push(l))})}finally{}c!==void 0&&RS(c,e)}if(!a){let c=Yo(i)||(()=>new i);e({provide:i,useFactory:c,deps:_n},i),e({provide:_S,useValue:i,multi:!0},i),e({provide:Xo,useValue:()=>T(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let c=t;R_(u,l=>{e(l,c)})}}else return!1;return i!==t&&t.providers!==void 0}function R_(t,e){for(let n of t)fS(n)&&(n=n.\u0275providers),Array.isArray(n)?R_(n,e):e(n)}var bV=Ce({provide:String,useValue:Ce});function xS(t){return t!==null&&typeof t=="object"&&bV in t}function SV(t){return!!(t&&t.useExisting)}function AV(t){return!!(t&&t.useFactory)}function Jo(t){return typeof t=="function"}function RV(t){return!!t.useClass}var Xh=new N(""),Th={},xV={},Ay;function x_(){return Ay===void 0&&(Ay=new Ph),Ay}var wn=class{},Wu=class extends wn{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ky(e,o=>this.processProvider(o)),this.records.set(yS,Go(void 0,this)),i.has("environment")&&this.records.set(wn,Go(void 0,this));let s=this.records.get(Xh);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(_S,_n,ie.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=me(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),me(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=oi(this),r=yn(void 0),i;try{return e()}finally{oi(n),yn(r)}}get(e,n=Gu,r=ie.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(x0))return e[x0](this);r=Yh(r);let i,s=oi(this),o=yn(void 0);try{if(!(r&ie.SkipSelf)){let u=this.records.get(e);if(u===void 0){let c=OV(e)&&Qh(e);c&&this.injectableDefInScope(c)?u=Go(Wy(e),Th):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&ie.Self?x_():this.parent;return n=r&ie.Optional&&n===Gu?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Mh]=a[Mh]||[]).unshift(jt(e)),s)throw a;return oV(a,e,"R3InjectorError",this.source)}else throw a}finally{yn(o),oi(s)}}resolveInjectorInitializers(){let e=me(null),n=oi(this),r=yn(void 0),i;try{let s=this.get(Xo,_n,ie.Self);for(let o of s)o()}finally{oi(n),yn(r),me(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(jt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new $(205,!1)}processProvider(e){e=Ut(e);let n=Jo(e)?e:Ut(e&&e.provide),r=NV(e);if(!Jo(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Go(void 0,Th,!0),i.factory=()=>qy(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=me(null);try{return n.value===Th&&(n.value=xV,n.value=n.factory()),typeof n.value=="object"&&n.value&&kV(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{me(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Ut(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function Wy(t){let e=Qh(t),n=e!==null?e.factory:Yo(t);if(n!==null)return n;if(t instanceof N)throw new $(204,!1);if(t instanceof Function)return MV(t);throw new $(204,!1)}function MV(t){if(t.length>0)throw new $(204,!1);let n=qL(t);return n!==null?()=>n.factory(t):()=>new t}function NV(t){if(xS(t))return Go(void 0,t.useValue);{let e=MS(t);return Go(e,Th)}}function MS(t,e,n){let r;if(Jo(t)){let i=Ut(t);return Yo(i)||Wy(i)}else if(xS(t))r=()=>Ut(t.useValue);else if(AV(t))r=()=>t.useFactory(...qy(t.deps||[]));else if(SV(t))r=()=>T(Ut(t.useExisting));else{let i=Ut(t&&(t.useClass||t.provide));if(PV(t))r=()=>new i(...qy(t.deps));else return Yo(i)||Wy(i)}return r}function Go(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function PV(t){return!!t.deps}function kV(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function OV(t){return typeof t=="function"||typeof t=="object"&&t instanceof N}function Ky(t,e){for(let n of t)Array.isArray(n)?Ky(n,e):n&&fS(n)?Ky(n.\u0275providers,e):e(n)}function _s(t,e){t instanceof Wu&&t.assertNotDestroyed();let n,r=oi(t),i=yn(void 0);try{return e()}finally{oi(r),yn(i)}}function FV(){return pS()!==void 0||nV()!=null}function LV(t){return typeof t=="function"}var Or=0,ue=1,q=2,Rt=3,Fn=4,Vn=5,kh=6,Ku=7,Mr=8,ea=9,Ln=10,ht=11,Qu=12,F0=13,ic=14,tr=15,Jh=16,zo=17,ta=18,ef=19,NS=20,ai=21,Ry=22,cs=23,ui=25,PS=1;var ls=7,Oh=8,Fh=9,vn=10,M_=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(M_||{});function os(t){return Array.isArray(t)&&typeof t[PS]=="object"}function Fr(t){return Array.isArray(t)&&t[PS]===!0}function kS(t){return(t.flags&4)!==0}function tf(t){return t.componentOffset>-1}function N_(t){return(t.flags&1)===1}function ci(t){return!!t.template}function VV(t){return(t[q]&512)!==0}var Qy=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function OS(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function di(){return FS}function FS(t){return t.type.prototype.ngOnChanges&&(t.setInput=jV),UV}di.ngInherit=!0;function UV(){let t=VS(this),e=t?.current;if(e){let n=t.previous;if(n===Zo)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function jV(t,e,n,r,i){let s=this.declaredInputs[r],o=VS(t)||BV(t,{previous:Zo,current:null}),a=o.current||(o.current={}),u=o.previous,c=u[s];a[s]=new Qy(c&&c.currentValue,n,u===Zo),OS(t,e,i,n)}var LS="__ngSimpleChanges__";function VS(t){return t[LS]||null}function BV(t,e){return t[LS]=e}var L0=null;var Xn=function(t,e,n){L0?.(t,e,n)},$V="svg",HV="math",qV=!1;function GV(){return qV}function nr(t){for(;Array.isArray(t);)t=t[Or];return t}function zV(t,e){return nr(e[t])}function In(t,e){return nr(e[t.index])}function US(t,e){return t.data[e]}function hi(t,e){let n=e[t];return os(n)?n:n[Or]}function P_(t){return(t[q]&128)===128}function WV(t){return Fr(t[Rt])}function Lh(t,e){return e==null?null:t[e]}function jS(t){t[zo]=0}function KV(t){t[q]&1024||(t[q]|=1024,P_(t)&&Yu(t))}function k_(t){return!!(t[q]&9216||t[cs]?.dirty)}function Yy(t){t[Ln].changeDetectionScheduler?.notify(1),k_(t)?Yu(t):t[q]&64&&(GV()?(t[q]|=1024,Yu(t)):t[Ln].changeDetectionScheduler?.notify())}function Yu(t){t[Ln].changeDetectionScheduler?.notify();let e=Zu(t);for(;e!==null&&!(e[q]&8192||(e[q]|=8192,!P_(e)));)e=Zu(e)}function BS(t,e){if((t[q]&256)===256)throw new $(911,!1);t[ai]===null&&(t[ai]=[]),t[ai].push(e)}function QV(t,e){if(t[ai]===null)return;let n=t[ai].indexOf(e);n!==-1&&t[ai].splice(n,1)}function Zu(t){let e=t[Rt];return Fr(e)?e[Rt]:e}var he={lFrame:KS(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function YV(){return he.lFrame.elementDepthCount}function ZV(){he.lFrame.elementDepthCount++}function XV(){he.lFrame.elementDepthCount--}function $S(){return he.bindingsEnabled}function JV(){return he.skipHydrationRootTNode!==null}function eU(t){return he.skipHydrationRootTNode===t}function tU(){he.skipHydrationRootTNode=null}function Fe(){return he.lFrame.lView}function nn(){return he.lFrame.tView}function Zt(){let t=HS();for(;t!==null&&t.type===64;)t=t.parent;return t}function HS(){return he.lFrame.currentTNode}function nU(){let t=he.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function sc(t,e){let n=he.lFrame;n.currentTNode=t,n.isParent=e}function qS(){return he.lFrame.isParent}function rU(){he.lFrame.isParent=!1}function iU(t){return he.lFrame.bindingIndex=t}function O_(){return he.lFrame.bindingIndex++}function sU(t){let e=he.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function oU(){return he.lFrame.inI18n}function aU(t,e){let n=he.lFrame;n.bindingIndex=n.bindingRootIndex=t,Zy(e)}function uU(){return he.lFrame.currentDirectiveIndex}function Zy(t){he.lFrame.currentDirectiveIndex=t}function cU(t){let e=he.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function GS(t){he.lFrame.currentQueryIndex=t}function lU(t){let e=t[ue];return e.type===2?e.declTNode:e.type===1?t[Vn]:null}function zS(t,e,n){if(n&ie.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&ie.Host);)if(i=lU(s),i===null||(s=s[ic],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=he.lFrame=WS();return r.currentTNode=e,r.lView=t,!0}function F_(t){let e=WS(),n=t[ue];he.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function WS(){let t=he.lFrame,e=t===null?null:t.child;return e===null?KS(t):e}function KS(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function QS(){let t=he.lFrame;return he.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var YS=QS;function L_(){let t=QS();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function oc(){return he.lFrame.selectedIndex}function ds(t){he.lFrame.selectedIndex=t}function V_(){let t=he.lFrame;return US(t.tView,t.selectedIndex)}function dU(){return he.lFrame.currentNamespace}var ZS=!0;function U_(){return ZS}function j_(t){ZS=t}function hU(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=FS(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function B_(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function bh(t,e,n){XS(t,e,3,n)}function Sh(t,e,n,r){(t[q]&3)===n&&XS(t,e,n,r)}function xy(t,e){let n=t[q];(n&3)===e&&(n&=16383,n+=1,t[q]=n)}function XS(t,e,n,r){let i=r!==void 0?t[zo]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(t[zo]+=65536),(a<s||s==-1)&&(fU(t,n,e,u),t[zo]=(t[zo]&4294901760)+u+2),u++}function V0(t,e){Xn(4,t,e);let n=me(null);try{e.call(t)}finally{me(n),Xn(5,t,e)}}function fU(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[q]>>14<t[zo]>>16&&(t[q]&3)===e&&(t[q]+=16384,V0(a,s)):V0(a,s)}var Qo=-1,hs=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function pU(t){return t instanceof hs}function gU(t){return(t.flags&8)!==0}function mU(t){return(t.flags&16)!==0}function JS(t){return t!==Qo}function Vh(t){return t&32767}function yU(t){return t>>16}function Uh(t,e){let n=yU(t),r=e;for(;n>0;)r=r[ic],n--;return r}var Xy=!0;function U0(t){let e=Xy;return Xy=t,e}var _U=256,eA=_U-1,tA=5,vU=0,Jn={};function wU(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(qu)&&(r=n[qu]),r==null&&(r=n[qu]=vU++);let i=r&eA,s=1<<i;e.data[t+(i>>tA)]|=s}function jh(t,e){let n=nA(t,e);if(n!==-1)return n;let r=e[ue];r.firstCreatePass&&(t.injectorIndex=e.length,My(r.data,t),My(e,null),My(r.blueprint,null));let i=$_(t,e),s=t.injectorIndex;if(JS(i)){let o=Vh(i),a=Uh(i,e),u=a[ue].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|u[o+c]}return e[s+8]=i,s}function My(t,e){t.push(0,0,0,0,0,0,0,0,e)}function nA(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function $_(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=aA(i),r===null)return Qo;if(n++,i=i[ic],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Qo}function Jy(t,e,n){wU(t,e,n)}function EU(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(wS(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function rA(t,e,n){if(n&ie.Optional||t!==void 0)return t;b_(e,"NodeInjector")}function iA(t,e,n,r){if(n&ie.Optional&&r===void 0&&(r=null),!(n&(ie.Self|ie.Host))){let i=t[ea],s=yn(void 0);try{return i?i.get(e,r,n&ie.Optional):gS(e,r,n&ie.Optional)}finally{yn(s)}}return rA(r,e,n)}function sA(t,e,n,r=ie.Default,i){if(t!==null){if(e[q]&2048&&!(r&ie.Self)){let o=bU(t,e,n,r,Jn);if(o!==Jn)return o}let s=oA(t,e,n,r,Jn);if(s!==Jn)return s}return iA(e,n,r,i)}function oA(t,e,n,r,i){let s=DU(n);if(typeof s=="function"){if(!zS(e,t,r))return r&ie.Host?rA(i,n,r):iA(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&ie.Optional))b_(n);else return o}finally{YS()}}else if(typeof s=="number"){let o=null,a=nA(t,e),u=Qo,c=r&ie.Host?e[tr][Vn]:null;for((a===-1||r&ie.SkipSelf)&&(u=a===-1?$_(t,e):e[a+8],u===Qo||!B0(r,!1)?a=-1:(o=e[ue],a=Vh(u),e=Uh(u,e)));a!==-1;){let l=e[ue];if(j0(s,a,l.data)){let d=IU(a,e,n,o,r,c);if(d!==Jn)return d}u=e[a+8],u!==Qo&&B0(r,e[ue].data[a+8]===c)&&j0(s,a,e)?(o=l,a=Vh(u),e=Uh(u,e)):a=-1}}return i}function IU(t,e,n,r,i,s){let o=e[ue],a=o.data[t+8],u=r==null?tf(a)&&Xy:r!=o&&(a.type&3)!==0,c=i&ie.Host&&s===a,l=CU(a,o,n,u,c);return l!==null?na(e,o,l,a):Jn}function CU(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,u=t.directiveStart,c=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:c;for(let f=d;f<h;f++){let p=o[f];if(f<u&&n===p||f>=u&&p.type===n)return f}if(i){let f=o[u];if(f&&ci(f)&&f.type===n)return u}return null}function na(t,e,n,r){let i=t[n],s=e.data;if(pU(i)){let o=i;o.resolving&&ZL(YL(s[n]));let a=U0(o.canSeeViewProviders);o.resolving=!0;let u,c=o.injectImpl?yn(o.injectImpl):null,l=zS(t,r,ie.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&hU(n,s[n],e)}finally{c!==null&&yn(c),U0(a),o.resolving=!1,YS()}}return i}function DU(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(qu)?t[qu]:void 0;return typeof e=="number"?e>=0?e&eA:TU:e}function j0(t,e,n){let r=1<<t;return!!(n[e+(t>>tA)]&r)}function B0(t,e){return!(t&ie.Self)&&!(t&ie.Host&&e)}var as=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return sA(this._tNode,this._lView,e,Yh(r),n)}};function TU(){return new as(Zt(),Fe())}function ia(t){return nc(()=>{let e=t.prototype.constructor,n=e[xh]||e_(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[xh]||e_(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function e_(t){return cS(t)?()=>{let e=e_(Ut(t));return e&&e()}:Yo(t)}function bU(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[q]&2048&&!(o[q]&512);){let a=oA(s,o,n,r|ie.Self,Jn);if(a!==Jn)return a;let u=s.parent;if(!u){let c=o[NS];if(c){let l=c.get(n,Jn,r);if(l!==Jn)return l}u=aA(o),o=o[ic]}s=u}return i}function aA(t){let e=t[ue],n=e.type;return n===2?e.declTNode:n===1?t[Vn]:null}function H_(t){return EU(Zt(),t)}function $0(t,e=null,n=null,r){let i=uA(t,e,n,r);return i.resolveInjectorInitializers(),i}function uA(t,e=null,n=null,r,i=new Set){let s=[n||_n,ys(t)];return r=r||(typeof t=="object"?void 0:jt(t)),new Wu(s,e||x_(),r||null,i)}var Xt=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return $0({name:""},i,r,"");{let s=r.name??"";return $0({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Gu,e.NULL=new Ph,e.\u0275prov=U({token:e,providedIn:"any",factory:()=>T(yS)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var SU="ngOriginalError";function Ny(t){return t[SU]}var Nr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Ny(e);for(;n&&Ny(n);)n=Ny(n);return n||null}},cA=new N("",{providedIn:"root",factory:()=>k(Nr).handleError.bind(void 0)}),lA=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=AU,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),t_=class extends lA{constructor(e){super(),this._lView=e}onDestroy(e){return BS(this._lView,e),()=>QV(this._lView,e)}};function AU(){return new t_(Fe())}function RU(){return nf(Zt(),Fe())}function nf(t,e){return new fi(In(t,e))}var fi=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=RU;let t=e;return t})();var n_=class extends Be{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,FV()&&(this.destroyRef=k(lA,{optional:!0})??void 0)}emit(e){let n=me(null);try{super.next(e)}finally{me(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=Py(s),i&&(i=Py(i)),o&&(o=Py(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof We&&e.add(a),a}};function Py(t){return e=>{setTimeout(t,void 0,e)}}var St=n_;function dA(t){return(t.flags&128)===128}var hA=new Map,xU=0;function MU(){return xU++}function NU(t){hA.set(t[ef],t)}function PU(t){hA.delete(t[ef])}var H0="__ngContext__";function fs(t,e){os(e)?(t[H0]=e[ef],NU(e)):t[H0]=e}function fA(t){return gA(t[Qu])}function pA(t){return gA(t[Fn])}function gA(t){for(;t!==null&&!Fr(t);)t=t[Fn];return t}var r_;function mA(t){r_=t}function kU(){if(r_!==void 0)return r_;if(typeof document<"u")return document;throw new $(210,!1)}var q_=new N("",{providedIn:"root",factory:()=>OU}),OU="ng",G_=new N(""),Mt=new N("",{providedIn:"platform",factory:()=>"unknown"});var z_=new N("",{providedIn:"root",factory:()=>kU().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var FU="h",LU="b";var VU=()=>null;function W_(t,e,n=!1){return VU(t,e,n)}var yA=!1,UU=new N("",{providedIn:"root",factory:()=>yA});var Ih;function jU(){if(Ih===void 0&&(Ih=null,ss.trustedTypes))try{Ih=ss.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Ih}function q0(t){return jU()?.createScriptURL(t)||t}var Bh=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${uS})`}};function ac(t){return t instanceof Bh?t.changingThisBreaksApplicationSecurity:t}function K_(t,e){let n=BU(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${uS})`)}return n===e}function BU(t){return t instanceof Bh&&t.getTypeName()||null}var $U=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function _A(t){return t=String(t),t.match($U)?t:"unsafe:"+t}var rf=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(rf||{});function HU(t){let e=wA();return e?e.sanitize(rf.URL,t)||"":K_(t,"URL")?ac(t):_A(T_(t))}function qU(t){let e=wA();if(e)return q0(e.sanitize(rf.RESOURCE_URL,t)||"");if(K_(t,"ResourceURL"))return q0(ac(t));throw new $(904,!1)}function GU(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?qU:HU}function vA(t,e,n){return GU(e,n)(t)}function wA(){let t=Fe();return t&&t[Ln].sanitizer}function EA(t){return t instanceof Function?t():t}var Pr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Pr||{}),zU;function Q_(t,e){return zU(t,e)}function Wo(t,e,n,r,i){if(r!=null){let s,o=!1;Fr(r)?s=r:os(r)&&(o=!0,r=r[Or]);let a=nr(r);t===0&&n!==null?i==null?bA(e,n,a):$h(e,n,a,i||null,!0):t===1&&n!==null?$h(e,n,a,i||null,!0):t===2?uj(e,a,o):t===3&&e.destroyNode(a),s!=null&&lj(e,t,s,n,i)}}function WU(t,e){return t.createText(e)}function IA(t,e,n){return t.createElement(e,n)}function KU(t,e){CA(t,e),e[Or]=null,e[Vn]=null}function QU(t,e,n,r,i,s){r[Or]=i,r[Vn]=e,sf(t,r,n,1,i,s)}function CA(t,e){e[Ln].changeDetectionScheduler?.notify(1),sf(t,e,e[ht],2,null,null)}function YU(t){let e=t[Qu];if(!e)return ky(t[ue],t);for(;e;){let n=null;if(os(e))n=e[Qu];else{let r=e[vn];r&&(n=r)}if(!n){for(;e&&!e[Fn]&&e!==t;)os(e)&&ky(e[ue],e),e=e[Rt];e===null&&(e=t),os(e)&&ky(e[ue],e),n=e&&e[Fn]}e=n}}function ZU(t,e,n,r){let i=vn+r,s=n.length;r>0&&(n[i-1][Fn]=e),r<s-vn?(e[Fn]=n[i],mS(n,vn+r,e)):(n.push(e),e[Fn]=null),e[Rt]=n;let o=e[Jh];o!==null&&n!==o&&XU(o,e);let a=e[ta];a!==null&&a.insertView(t),Yy(e),e[q]|=128}function XU(t,e){let n=t[Fh],i=e[Rt][Rt][tr];e[tr]!==i&&(t[q]|=M_.HasTransplantedViews),n===null?t[Fh]=[e]:n.push(e)}function DA(t,e){let n=t[Fh],r=n.indexOf(e);n.splice(r,1)}function i_(t,e){if(t.length<=vn)return;let n=vn+e,r=t[n];if(r){let i=r[Jh];i!==null&&i!==t&&DA(i,r),e>0&&(t[n-1][Fn]=r[Fn]);let s=Nh(t,vn+e);KU(r[ue],r);let o=s[ta];o!==null&&o.detachView(s[ue]),r[Rt]=null,r[Fn]=null,r[q]&=-129}return r}function TA(t,e){if(!(e[q]&256)){let n=e[ht];n.destroyNode&&sf(t,e,n,3,null,null),YU(e)}}function ky(t,e){if(e[q]&256)return;let n=me(null);try{e[q]&=-129,e[q]|=256,e[cs]&&i0(e[cs]),ej(t,e),JU(t,e),e[ue].type===1&&e[ht].destroy();let r=e[Jh];if(r!==null&&Fr(e[Rt])){r!==e[Rt]&&DA(r,e);let i=e[ta];i!==null&&i.detachView(t)}PU(e)}finally{me(n)}}function JU(t,e){let n=t.cleanup,r=e[Ku];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Ku]=null);let i=e[ai];if(i!==null){e[ai]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function ej(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof hs)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];Xn(4,a,u);try{u.call(a)}finally{Xn(5,a,u)}}else{Xn(4,i,s);try{s.call(i)}finally{Xn(5,i,s)}}}}}function tj(t,e,n){return nj(t,e.parent,n)}function nj(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[Or];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===er.None||s===er.Emulated)return null}return In(r,n)}}function $h(t,e,n,r,i){t.insertBefore(e,n,r,i)}function bA(t,e,n){t.appendChild(e,n)}function G0(t,e,n,r,i){r!==null?$h(t,e,n,r,i):bA(t,e,n)}function rj(t,e,n,r){t.removeChild(e,n,r)}function Y_(t,e){return t.parentNode(e)}function ij(t,e){return t.nextSibling(e)}function sj(t,e,n){return aj(t,e,n)}function oj(t,e,n){return t.type&40?In(t,n):null}var aj=oj,z0;function Z_(t,e,n,r){let i=tj(t,r,e),s=e[ht],o=r.parent||e[Vn],a=sj(o,r,e);if(i!=null)if(Array.isArray(n))for(let u=0;u<n.length;u++)G0(s,i,n[u],a,!1);else G0(s,i,n,a,!1);z0!==void 0&&z0(s,r,e,n,i)}function Ah(t,e){if(e!==null){let n=e.type;if(n&3)return In(e,t);if(n&4)return s_(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return Ah(t,r);{let i=t[e.index];return Fr(i)?s_(-1,i):nr(i)}}else{if(n&32)return Q_(e,t)()||nr(t[e.index]);{let r=SA(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Zu(t[tr]);return Ah(i,r)}else return Ah(t,e.next)}}}return null}function SA(t,e){if(e!==null){let r=t[tr][Vn],i=e.projection;return r.projection[i]}return null}function s_(t,e){let n=vn+t+1;if(n<e.length){let r=e[n],i=r[ue].firstChild;if(i!==null)return Ah(r,i)}return e[ls]}function uj(t,e,n){let r=Y_(t,e);r&&rj(t,r,e,n)}function X_(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],u=n.type;if(o&&e===0&&(a&&fs(nr(a),r),n.flags|=2),(n.flags&32)!==32)if(u&8)X_(t,e,n.child,r,i,s,!1),Wo(e,t,i,a,s);else if(u&32){let c=Q_(n,r),l;for(;l=c();)Wo(e,t,i,l,s);Wo(e,t,i,a,s)}else u&16?cj(t,e,r,n,i,s):Wo(e,t,i,a,s);n=o?n.projectionNext:n.next}}function sf(t,e,n,r,i,s){X_(n,r,t.firstChild,e,i,s,!1)}function cj(t,e,n,r,i,s){let o=n[tr],u=o[Vn].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++){let l=u[c];Wo(e,t,i,l,s)}else{let c=u,l=o[Rt];dA(r)&&(c.flags|=128),X_(t,e,c,l,i,s,!0)}}function lj(t,e,n,r,i){let s=n[ls],o=nr(n);s!==o&&Wo(e,t,r,s,i);for(let a=vn;a<n.length;a++){let u=n[a];sf(u[ue],u,t,e,r,s)}}function dj(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Pr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Pr.Important),t.setStyle(n,r,i,s))}}function hj(t,e,n){t.setAttribute(e,"style",n)}function AA(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function RA(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&Gy(t,e,r),i!==null&&AA(t,e,i),s!==null&&hj(t,e,s)}var of={};function pi(t=1){xA(nn(),Fe(),oc()+t,!1)}function xA(t,e,n,r){if(!r)if((e[q]&3)===3){let s=t.preOrderCheckHooks;s!==null&&bh(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Sh(e,s,0,n)}ds(n)}function te(t,e=ie.Default){let n=Fe();if(n===null)return T(t,e);let r=Zt();return sA(r,n,Ut(t),e)}function MA(t,e,n,r,i,s){let o=me(null);try{let a=null;i&At.SignalBased&&(a=e[r][iy]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&At.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):OS(e,a,r,s)}finally{me(o)}}function fj(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)ds(~i);else{let s=i,o=n[++r],a=n[++r];aU(o,s);let u=e[s];a(2,u)}}}finally{ds(-1)}}function af(t,e,n,r,i,s,o,a,u,c,l){let d=e.blueprint.slice();return d[Or]=i,d[q]=r|4|128|8|64,(c!==null||t&&t[q]&2048)&&(d[q]|=2048),jS(d),d[Rt]=d[ic]=t,d[Mr]=n,d[Ln]=o||t&&t[Ln],d[ht]=a||t&&t[ht],d[ea]=u||t&&t[ea]||null,d[Vn]=s,d[ef]=MU(),d[kh]=l,d[NS]=c,d[tr]=e.type==2?t[tr]:d,d}function uf(t,e,n,r,i){let s=t.data[e];if(s===null)s=pj(t,e,n,r,i),oU()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=nU();s.injectorIndex=o===null?-1:o.injectorIndex}return sc(s,!0),s}function pj(t,e,n,r,i){let s=HS(),o=qS(),a=o?s:s&&s.parent,u=t.data[e]=vj(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function NA(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function PA(t,e,n,r,i){let s=oc(),o=r&2;try{ds(-1),o&&e.length>ui&&xA(t,e,ui,!1),Xn(o?2:0,i),n(r,i)}finally{ds(s),Xn(o?3:1,i)}}function kA(t,e,n){if(kS(e)){let r=me(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let u=n[o];a.contentQueries(1,u,o)}}}finally{me(r)}}}function OA(t,e,n){$S()&&(Tj(t,e,n,In(n,e)),(n.flags&64)===64&&BA(t,e,n))}function FA(t,e,n=In){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function LA(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=J_(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function J_(t,e,n,r,i,s,o,a,u,c,l){let d=ui+r,h=d+i,f=gj(d,h),p=typeof c=="function"?c():c;return f[ue]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:p,incompleteFirstPass:!1,ssrId:l}}function gj(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:of);return n}function mj(t,e,n,r){let s=r.get(UU,yA)||n===er.ShadowDom,o=t.selectRootElement(e,s);return yj(o),o}function yj(t){_j(t)}var _j=()=>null;function vj(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return JV()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function W0(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,u=At.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let c=s;if(i!==null){if(!i.hasOwnProperty(s))continue;c=i[s]}t===0?K0(r,n,c,a,u):K0(r,n,c,a)}return r}function K0(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function wj(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],u=null,c=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;u=W0(0,d.inputs,l,u,f),c=W0(1,d.outputs,l,c,p);let g=u!==null&&o!==null&&!A_(e)?Fj(u,l,o):null;a.push(g)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=c}function Ej(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function VA(t,e,n,r,i,s,o,a){let u=In(e,n),c=e.inputs,l;!a&&c!=null&&(l=c[r])?(ev(t,n,l,r,i),tf(e)&&Ij(n,e.index)):e.type&3?(r=Ej(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(u,r,i)):e.type&12}function Ij(t,e){let n=hi(e,t);n[q]&16||(n[q]|=64)}function UA(t,e,n,r){if($S()){let i=r===null?null:{"":-1},s=Sj(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&jA(t,e,n,o,i,a),i&&Aj(n,r,i)}n.mergedAttrs=zu(n.mergedAttrs,n.attrs)}function jA(t,e,n,r,i,s){for(let c=0;c<r.length;c++)Jy(jh(n,e),t,r[c].type);xj(n,t.data.length,r.length);for(let c=0;c<r.length;c++){let l=r[c];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,u=NA(t,e,r.length,null);for(let c=0;c<r.length;c++){let l=r[c];n.mergedAttrs=zu(n.mergedAttrs,l.hostAttrs),Mj(t,n,e,u,l),Rj(u,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}wj(t,n,s)}function Cj(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;Dj(o)!=a&&o.push(a),o.push(n,r,s)}}function Dj(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function Tj(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;tf(n)&&Nj(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||jh(n,e),fs(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let u=t.data[a],c=na(e,t,a,n);if(fs(c,e),o!==null&&Oj(e,a-i,c,u,n,o),ci(u)){let l=hi(n.index,e);l[Mr]=na(e,t,a,n)}}}function BA(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=uU();try{ds(s);for(let a=r;a<i;a++){let u=t.data[a],c=e[a];Zy(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&bj(u,c)}}finally{ds(-1),Zy(o)}}function bj(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function Sj(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(yV(e,o.selectors,!1))if(r||(r=[]),ci(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;o_(t,e,u)}else r.unshift(o),o_(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function o_(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function Aj(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new $(-301,!1);r.push(e[i],s)}}}function Rj(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;ci(e)&&(n[""]=t)}}function xj(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Mj(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Yo(i.type,!0)),o=new hs(s,ci(i),te);t.blueprint[r]=o,n[r]=o,Cj(t,e,r,NA(t,n,i.hostVars,of),i)}function Nj(t,e,n){let r=In(e,t),i=LA(n),s=t[Ln].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=cf(t,af(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function Pj(t,e,n,r,i,s){let o=In(t,e);kj(e[ht],o,s,t.value,n,r,i)}function kj(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?T_(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function Oj(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],c=o[a++],l=o[a++],d=o[a++];MA(r,n,u,c,l,d)}}function Fj(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function $A(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function HA(t,e){let n=t.contentQueries;if(n!==null){let r=me(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];GS(s),a.contentQueries(2,e[o],o)}}}finally{me(r)}}}function cf(t,e){return t[Qu]?t[F0][Fn]=e:t[Qu]=e,t[F0]=e,e}function a_(t,e,n){GS(0);let r=me(null);try{e(t,n)}finally{me(r)}}function Lj(t){return t[Ku]||(t[Ku]=[])}function Vj(t){return t.cleanup||(t.cleanup=[])}function qA(t,e){let n=t[ea],r=n?n.get(Nr,null):null;r&&r.handleError(e)}function ev(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],u=n[s++],c=e[o],l=t.data[o];MA(l,c,r,a,u,i)}}function Uj(t,e){let n=hi(e,t),r=n[ue];jj(r,n);let i=n[Or];i!==null&&n[kh]===null&&(n[kh]=W_(i,n[ea])),tv(r,n,n[Mr])}function jj(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function tv(t,e,n){F_(e);try{let r=t.viewQuery;r!==null&&a_(1,r,n);let i=t.template;i!==null&&PA(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[ta]?.finishViewCreation(t),t.staticContentQueries&&HA(t,e),t.staticViewQueries&&a_(2,t.viewQuery,n);let s=t.components;s!==null&&Bj(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[q]&=-5,L_()}}function Bj(t,e){for(let n=0;n<e.length;n++)Uj(t,e[n])}function $j(t,e,n,r){let i=me(null);try{let s=e.tView,a=t[q]&4096?4096:16,u=af(t,s,n,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),c=t[e.index];u[Jh]=c;let l=t[ta];return l!==null&&(u[ta]=l.createEmbeddedView(s)),tv(s,u,n),u}finally{me(i)}}function Q0(t,e){return!e||e.firstChild===null||dA(t)}function Hj(t,e,n,r=!0){let i=e[ue];if(ZU(i,e,t,n),r){let o=s_(n,t),a=e[ht],u=Y_(a,t[ls]);u!==null&&QU(i,t[Vn],a,e,u,o)}let s=e[kh];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Hh(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(nr(s)),Fr(s)&&qj(s,r);let o=n.type;if(o&8)Hh(t,e,n.child,r);else if(o&32){let a=Q_(n,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=SA(e,n);if(Array.isArray(a))r.push(...a);else{let u=Zu(e[tr]);Hh(u[ue],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function qj(t,e){for(let n=vn;n<t.length;n++){let r=t[n],i=r[ue].firstChild;i!==null&&Hh(r[ue],r,i,e)}t[ls]!==t[Or]&&e.push(t[ls])}var GA=[];function Gj(t){return t[cs]??zj(t)}function zj(t){let e=GA.pop()??Object.create(Kj);return e.lView=t,e}function Wj(t){t.lView[cs]!==t&&(t.lView=null,GA.push(t))}var Kj=ge(M({},t0),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Yu(t.lView)},consumerOnSignalRead(){this.lView[cs]=this}}),zA=100;function WA(t,e=!0,n=0){let r=t[Ln],i=r.rendererFactory,s=!1;s||i.begin?.();try{Qj(t,n)}catch(o){throw e&&qA(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function Qj(t,e){u_(t,e);let n=0;for(;k_(t);){if(n===zA)throw new $(103,!1);n++,u_(t,1)}}function Yj(t,e,n,r){let i=e[q];if((i&256)===256)return;let s=!1;!s&&e[Ln].inlineEffectRunner?.flush(),F_(e);let o=null,a=null;!s&&Zj(t)&&(a=Gj(e),o=n0(a));try{jS(e),iU(t.bindingStartIndex),n!==null&&PA(t,e,n,2,r);let u=(i&3)===3;if(!s)if(u){let d=t.preOrderCheckHooks;d!==null&&bh(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Sh(e,d,0,null),xy(e,0)}if(Xj(e),KA(e,0),t.contentQueries!==null&&HA(t,e),!s)if(u){let d=t.contentCheckHooks;d!==null&&bh(e,d)}else{let d=t.contentHooks;d!==null&&Sh(e,d,1),xy(e,1)}fj(t,e);let c=t.components;c!==null&&YA(e,c,0);let l=t.viewQuery;if(l!==null&&a_(2,l,r),!s)if(u){let d=t.viewCheckHooks;d!==null&&bh(e,d)}else{let d=t.viewHooks;d!==null&&Sh(e,d,2),xy(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[Ry]){for(let d of e[Ry])d();e[Ry]=null}s||(e[q]&=-73)}catch(u){throw Yu(e),u}finally{a!==null&&(r0(a,o),Wj(a)),L_()}}function Zj(t){return t.type!==2}function KA(t,e){for(let n=fA(t);n!==null;n=pA(n))for(let r=vn;r<n.length;r++){let i=n[r];QA(i,e)}}function Xj(t){for(let e=fA(t);e!==null;e=pA(e)){if(!(e[q]&M_.HasTransplantedViews))continue;let n=e[Fh];for(let r=0;r<n.length;r++){let i=n[r],s=i[Rt];KV(i)}}}function Jj(t,e,n){let r=hi(e,t);QA(r,n)}function QA(t,e){P_(t)&&u_(t,e)}function u_(t,e){let r=t[ue],i=t[q],s=t[cs],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&sy(s)),s&&(s.dirty=!1),t[q]&=-9217,o)Yj(r,t,r.template,t[Mr]);else if(i&8192){KA(t,1);let a=r.components;a!==null&&YA(t,a,1)}}function YA(t,e,n){for(let r=0;r<e.length;r++)Jj(t,e[r],n)}function nv(t){for(t[Ln].changeDetectionScheduler?.notify();t;){t[q]|=64;let e=Zu(t);if(VV(t)&&!e)return t;t=e}return null}var ps=class{get rootNodes(){let e=this._lView,n=e[ue];return Hh(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Mr]}set context(e){this._lView[Mr]=e}get destroyed(){return(this._lView[q]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Rt];if(Fr(e)){let n=e[Oh],r=n?n.indexOf(this):-1;r>-1&&(i_(e,r),Nh(n,r))}this._attachedToViewContainer=!1}TA(this._lView[ue],this._lView)}onDestroy(e){BS(this._lView,e)}markForCheck(){nv(this._cdRefInjectingView||this._lView)}detach(){this._lView[q]&=-129}reattach(){Yy(this._lView),this._lView[q]|=128}detectChanges(){this._lView[q]|=1024,WA(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new $(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,CA(this._lView[ue],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new $(902,!1);this._appRef=e,Yy(this._lView)}},rv=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=n2;let t=e;return t})(),e2=rv,t2=class extends e2{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=$j(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:n,dehydratedView:r});return new ps(i)}};function n2(){return r2(Zt(),Fe())}function r2(t,e){return t.type&4?new t2(e,t,nf(t,e)):null}var wJ=new RegExp(`^(\\d+)*(${LU}|${FU})*(.*)`);var i2=()=>null;function Y0(t,e){return i2(t,e)}var c_=class{},l_=class{},qh=class{};function s2(t){let e=Error(`No component factory found for ${jt(t)}.`);return e[o2]=t,e}var o2="ngComponent";var d_=class{resolveComponentFactory(e){throw s2(e)}},lf=(()=>{let e=class e{};e.NULL=new d_;let t=e;return t})(),Xu=class{},vs=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>a2();let t=e;return t})();function a2(){let t=Fe(),e=Zt(),n=hi(e.index,t);return(os(n)?n:t)[ht]}var u2=(()=>{let e=class e{};e.\u0275prov=U({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),Oy={};var Z0=new Set;function ZA(t){Z0.has(t)||(Z0.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function X0(...t){}function c2(){let t=typeof ss.requestAnimationFrame=="function",e=ss[t?"requestAnimationFrame":"setTimeout"],n=ss[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var se=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new St(!1),this.onMicrotaskEmpty=new St(!1),this.onStable=new St(!1),this.onError=new St(!1),typeof Zone>"u")throw new $(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=c2().nativeRequestAnimationFrame,h2(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new $(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new $(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,l2,X0,X0);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},l2={};function iv(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function d2(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(ss,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,h_(t),t.isCheckStableRunning=!0,iv(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),h_(t))}function h2(t){let e=()=>{d2(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(f2(a))return n.invokeTask(i,s,o,a);try{return J0(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),eS(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return J0(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),eS(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,h_(t),iv(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function h_(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function J0(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function eS(t){t._nesting--,iv(t)}function f2(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}var XA=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=U({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function f_(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=b0(i,a);else if(s==2){let u=a,c=e[++o];r=b0(r,u+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Gh=class extends lf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=us(e);return new Ju(n,this.ngModule)}};function tS(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function p2(t){let e=t.toLowerCase();return e==="svg"?$V:e==="math"?HV:null}var p_=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Yh(r);let i=this.injector.get(e,Oy,r);return i!==Oy||n===Oy?i:this.parentInjector.get(e,n,r)}},Ju=class extends qh{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=tS(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return tS(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=EV(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=me(null);try{i=i||this.ngModule;let o=i instanceof wn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new p_(e,o):e,u=a.get(Xu,null);if(u===null)throw new $(407,!1);let c=a.get(u2,null),l=a.get(XA,null),d=a.get(c_,null),h={rendererFactory:u,sanitizer:c,inlineEffectRunner:null,afterRenderEventManager:l,changeDetectionScheduler:d},f=u.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",g=r?mj(f,r,this.componentDef.encapsulation,a):IA(f,p,p2(p)),m=512;this.componentDef.signals?m|=4096:this.componentDef.onPush||(m|=16);let I=null;g!==null&&(I=W_(g,a,!0));let R=J_(0,null,null,1,0,null,null,null,null,null,null),C=af(null,R,null,m,null,null,h,f,a,null,I);F_(C);let P,j;try{let H=this.componentDef,ve,lt=null;H.findHostDirectiveDefs?(ve=[],lt=new Map,H.findHostDirectiveDefs(H,ve,lt),ve.push(H)):ve=[H];let Km=g2(C,g),Vd=m2(Km,g,H,ve,C,h,f);j=US(R,ui),g&&v2(f,H,g,r),n!==void 0&&w2(j,this.ngContentSelectors,n),P=_2(Vd,H,ve,lt,C,[E2]),tv(R,C,null)}finally{L_()}return new g_(this.componentType,P,nf(j,C),C,j)}finally{me(s)}}},g_=class extends l_{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new ps(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;ev(s[ue],s,i,e,n),this.previousInputValues.set(e,n);let o=hi(this._tNode.index,s);nv(o)}}get injector(){return new as(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function g2(t,e){let n=t[ue],r=ui;return t[r]=e,uf(n,r,2,"#host",null)}function m2(t,e,n,r,i,s,o){let a=i[ue];y2(r,t,e,o);let u=null;e!==null&&(u=W_(e,i[ea]));let c=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=af(i,LA(n),null,l,i[t.index],t,s,c,null,null,u);return a.firstCreatePass&&o_(a,t,r.length-1),cf(i,d),i[t.index]=d}function y2(t,e,n,r){for(let i of t)e.mergedAttrs=zu(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(f_(e,e.mergedAttrs,!0),n!==null&&RA(r,n,e))}function _2(t,e,n,r,i,s){let o=Zt(),a=i[ue],u=In(o,i);jA(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=na(i,a,d,o);fs(h,i)}BA(a,i,o),u&&fs(u,i);let c=na(i,a,o.directiveStart+o.componentOffset,o);if(t[Mr]=i[Mr]=c,s!==null)for(let l of s)l(c,e);return kA(a,o,i),c}function v2(t,e,n,r){if(r)Gy(t,n,["ng-version","17.3.5"]);else{let{attrs:i,classes:s}=IV(e.selectors[0]);i&&Gy(t,n,i),s&&s.length>0&&AA(t,n,s.join(" "))}}function w2(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function E2(){let t=Zt();B_(Fe()[ue],t)}var uc=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=I2;let t=e;return t})();function I2(){let t=Zt();return D2(t,Fe())}var C2=uc,JA=class extends C2{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return nf(this._hostTNode,this._hostLView)}get injector(){return new as(this._hostTNode,this._hostLView)}get parentInjector(){let e=$_(this._hostTNode,this._hostLView);if(JS(e)){let n=Uh(e,this._hostLView),r=Vh(e),i=n[ue].data[r+8];return new as(i,n)}else return new as(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=nS(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-vn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Y0(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,Q0(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!LV(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let u=o?e:new Ju(us(e)),c=r||this.parentInjector;if(!s&&u.ngModule==null){let g=(o?c:this.parentInjector).get(wn,null);g&&(s=g)}let l=us(u.componentType??{}),d=Y0(this._lContainer,l?.id??null),h=d?.firstChild??null,f=u.create(c,i,h,s);return this.insertImpl(f.hostView,a,Q0(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(WV(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[Rt],c=new JA(u,u[Vn],u[Rt]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return Hj(o,i,s,r),e.attachToViewContainerRef(),mS(Fy(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=nS(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=i_(this._lContainer,n);r&&(Nh(Fy(this._lContainer),n),TA(r[ue],r))}detach(e){let n=this._adjustIndex(e,-1),r=i_(this._lContainer,n);return r&&Nh(Fy(this._lContainer),n)!=null?new ps(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function nS(t){return t[Oh]}function Fy(t){return t[Oh]||(t[Oh]=[])}function D2(t,e){let n,r=e[t.index];return Fr(r)?n=r:(n=$A(r,e,null,t),e[t.index]=n,cf(e,n)),b2(n,e,t,r),new JA(n,t,e)}function T2(t,e){let n=t[ht],r=n.createComment(""),i=In(e,t),s=Y_(n,i);return $h(n,s,r,ij(n,i),!1),r}var b2=R2,S2=()=>!1;function A2(t,e,n){return S2(t,e,n)}function R2(t,e,n,r){if(t[ls])return;let i;n.type&8?i=nr(r):i=T2(e,n),t[ls]=i}function x2(t){return typeof t=="function"&&t[iy]!==void 0}function eR(t){return x2(t)&&typeof t.set=="function"}function M2(t){return Object.getPrototypeOf(t.prototype).constructor}function Lr(t){let e=M2(t.type),n=!0,r=[t];for(;e;){let i;if(ci(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new $(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Ch(t.inputs),o.inputTransforms=Ch(t.inputTransforms),o.declaredInputs=Ch(t.declaredInputs),o.outputs=Ch(t.outputs);let a=i.hostBindings;a&&F2(t,a);let u=i.viewQuery,c=i.contentQueries;if(u&&k2(t,u),c&&O2(t,c),N2(t,i),$L(t.outputs,i.outputs),ci(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===Lr&&(n=!1)}}e=Object.getPrototypeOf(e)}P2(r)}function N2(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function P2(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=zu(i.hostAttrs,n=zu(n,i.hostAttrs))}}function Ch(t){return t===Zo?{}:t===_n?[]:t}function k2(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function O2(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function F2(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function sv(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var li=class{},ec=class{};var m_=class extends li{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Gh(this);let i=TS(e);this._bootstrapComponents=EA(i.bootstrap),this._r3Injector=uA(e,n,[{provide:li,useValue:this},{provide:lf,useValue:this.componentFactoryResolver},...r],jt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},y_=class extends ec{constructor(e){super(),this.moduleType=e}create(e){return new m_(this.moduleType,e,[])}};var zh=class extends li{constructor(e){super(),this.componentFactoryResolver=new Gh(this),this.instance=null;let n=new Wu([...e.providers,{provide:li,useValue:this},{provide:lf,useValue:this.componentFactoryResolver}],e.parent||x_(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function ov(t,e,n=null){return new zh({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var df=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Et(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function hf(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function L2(t){return(t.flags&32)===32}function V2(t,e,n,r,i,s,o,a,u){let c=e.consts,l=uf(e,t,4,o||null,Lh(c,a));UA(e,n,l,Lh(c,u)),B_(e,l);let d=l.tView=J_(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function av(t,e,n,r,i,s,o,a){let u=Fe(),c=nn(),l=t+ui,d=c.firstCreatePass?V2(l,c,u,e,n,r,i,s,o):c.data[l];sc(d,!1);let h=U2(c,u,d,t);U_()&&Z_(c,u,h,d),fs(h,u);let f=$A(h,u,h,d);return u[l]=f,cf(u,f),A2(f,d,u),N_(d)&&OA(c,u,d),o!=null&&FA(u,d,a),av}var U2=j2;function j2(t,e,n,r){return j_(!0),e[ht].createComment("")}function cc(t,e,n,r){let i=Fe(),s=O_();if(hf(i,s,e)){let o=nn(),a=V_();Pj(a,i,t,e,n,r)}return cc}function Dh(t,e){return t<<17|e<<2}function gs(t){return t>>17&32767}function B2(t){return(t&2)==2}function $2(t,e){return t&131071|e<<17}function __(t){return t|2}function ra(t){return(t&131068)>>2}function Ly(t,e){return t&-131069|e<<2}function H2(t){return(t&1)===1}function v_(t){return t|1}function q2(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=gs(o),u=ra(o);t[r]=n;let c=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||rc(d,l)>0)&&(c=!0)}else l=n;if(i)if(u!==0){let h=gs(t[a+1]);t[r+1]=Dh(h,a),h!==0&&(t[h+1]=Ly(t[h+1],r)),t[a+1]=$2(t[a+1],r)}else t[r+1]=Dh(a,0),a!==0&&(t[a+1]=Ly(t[a+1],r)),a=r;else t[r+1]=Dh(u,0),a===0?a=r:t[u+1]=Ly(t[u+1],r),u=r;c&&(t[r+1]=__(t[r+1])),rS(t,l,r,!0),rS(t,l,r,!1),G2(e,l,t,r,s),o=Dh(a,u),s?e.classBindings=o:e.styleBindings=o}function G2(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&rc(s,e)>=0&&(n[r+1]=v_(n[r+1]))}function rS(t,e,n,r){let i=t[n+1],s=e===null,o=r?gs(i):ra(i),a=!1;for(;o!==0&&(a===!1||s);){let u=t[o],c=t[o+1];z2(u,e)&&(a=!0,t[o+1]=r?v_(c):__(c)),o=r?gs(c):ra(c)}a&&(t[n+1]=r?__(i):v_(i))}function z2(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?rc(t,e)>=0:!1}function uv(t,e,n){let r=Fe(),i=O_();if(hf(r,i,e)){let s=nn(),o=V_();VA(s,o,r,t,e,r[ht],n,!1)}return uv}function iS(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";ev(t,n,s[o],o,r)}function ff(t,e){return W2(t,e,null,!0),ff}function W2(t,e,n,r){let i=Fe(),s=nn(),o=sU(2);if(s.firstUpdatePass&&Q2(s,t,o,r),e!==of&&hf(i,o,e)){let a=s.data[oc()];eB(s,a,i,i[ht],t,i[o+1]=tB(e,n),r,o)}}function K2(t,e){return e>=t.expandoStartIndex}function Q2(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[oc()],o=K2(t,n);nB(s,r)&&e===null&&!o&&(e=!1),e=Y2(i,s,e,r),q2(i,s,e,n,o,r)}}function Y2(t,e,n,r){let i=cU(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=Vy(null,t,e,n,r),n=tc(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=Vy(i,t,e,n,r),s===null){let u=Z2(t,e,r);u!==void 0&&Array.isArray(u)&&(u=Vy(null,t,e,u[1],r),u=tc(u,e.attrs,r),X2(t,e,r,u))}else s=J2(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function Z2(t,e,n){let r=n?e.classBindings:e.styleBindings;if(ra(r)!==0)return t[gs(r)]}function X2(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[gs(i)]=r}function J2(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=tc(r,o,n)}return tc(r,e.attrs,n)}function Vy(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=tc(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function tc(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),cV(t,o,n?!0:e[++s]))}return t===void 0?null:t}function eB(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let u=t.data,c=u[a+1],l=H2(c)?sS(u,e,n,i,ra(c),o):void 0;if(!Wh(l)){Wh(s)||B2(c)&&(s=sS(u,null,n,i,a,o));let d=zV(oc(),n);dj(r,o,d,i,s)}}function sS(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let u=t[i],c=Array.isArray(u),l=c?u[1]:u,d=l===null,h=n[i+1];h===of&&(h=d?_n:void 0);let f=d?Sy(h,r):l===r?h:void 0;if(c&&!Wh(f)&&(f=Sy(u,r)),Wh(f)&&(a=f,o))return a;let p=t[i+1];i=o?gs(p):ra(p)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(a=Sy(u,r))}return a}function Wh(t){return t!==void 0}function tB(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=jt(ac(t)))),t}function nB(t,e){return(t.flags&(e?8:16))!==0}function rB(t,e,n,r,i,s){let o=e.consts,a=Lh(o,i),u=uf(e,t,2,r,a);return UA(e,n,u,Lh(o,s)),u.attrs!==null&&f_(u,u.attrs,!1),u.mergedAttrs!==null&&f_(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function De(t,e,n,r){let i=Fe(),s=nn(),o=ui+t,a=i[ht],u=s.firstCreatePass?rB(o,s,i,e,n,r):s.data[o],c=iB(s,i,u,a,e,t);i[o]=c;let l=N_(u);return sc(u,!0),RA(a,c,u),!L2(u)&&U_()&&Z_(s,i,c,u),YV()===0&&fs(c,i),ZV(),l&&(OA(s,i,u),kA(s,u,i)),r!==null&&FA(i,u),De}function Se(){let t=Zt();qS()?rU():(t=t.parent,sc(t,!1));let e=t;eU(e)&&tU(),XV();let n=nn();return n.firstCreatePass&&(B_(n,t),kS(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&gU(e)&&iS(n,e,Fe(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&mU(e)&&iS(n,e,Fe(),e.stylesWithoutHost,!1),Se}function Vr(t,e,n,r){return De(t,e,n,r),Se(),Vr}var iB=(t,e,n,r,i,s)=>(j_(!0),IA(r,i,dU()));var Kh="en-US";var sB=Kh;function oB(t){typeof t=="string"&&(sB=t.toLowerCase().replace(/_/g,"-"))}function rr(t,e,n,r){let i=Fe(),s=nn(),o=Zt();return tR(s,i,i[ht],o,t,e,r),rr}function aB(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Ku],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function tR(t,e,n,r,i,s,o){let a=N_(r),c=t.firstCreatePass&&Vj(t),l=e[Mr],d=Lj(e),h=!0;if(r.type&3||o){let g=In(r,e),m=o?o(g):g,I=d.length,R=o?P=>o(nr(P[r.index])):r.index,C=null;if(!o&&a&&(C=aB(t,e,i,r.index)),C!==null){let P=C.__ngLastListenerFn__||C;P.__ngNextListenerFn__=s,C.__ngLastListenerFn__=s,h=!1}else{s=aS(r,e,l,s,!1);let P=n.listen(m,i,s);d.push(s,P),c&&c.push(i,R,I,I+1)}}else s=aS(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let m=0;m<g;m+=2){let I=p[m],R=p[m+1],j=e[I][R].subscribe(s),H=d.length;d.push(s,j),c&&c.push(i,r.index,H,-(H+1))}}}function oS(t,e,n,r){let i=me(null);try{return Xn(6,e,n),n(r)!==!1}catch(s){return qA(t,s),!1}finally{Xn(7,e,n),me(i)}}function aS(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?hi(t.index,e):e;nv(a);let u=oS(e,n,r,o),c=s.__ngNextListenerFn__;for(;c;)u=oS(e,n,c,o)&&u,c=c.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}function $e(t,e=""){let n=Fe(),r=nn(),i=t+ui,s=r.firstCreatePass?uf(r,i,1,e,null):r.data[i],o=uB(r,n,s,e,t);n[i]=o,U_()&&Z_(r,n,o,s),sc(s,!1)}var uB=(t,e,n,r,i)=>(j_(!0),WU(e[ht],r));function ws(t,e,n){eR(e)&&(e=e());let r=Fe(),i=O_();if(hf(r,i,e)){let s=nn(),o=V_();VA(s,o,r,t,e,r[ht],n,!1)}return ws}function sa(t,e){let n=eR(t);return n&&t.set(e),n}function Es(t,e){let n=Fe(),r=nn(),i=Zt();return tR(r,n,n[ht],i,t,e),Es}function cB(t,e,n){let r=nn();if(r.firstCreatePass){let i=ci(t);w_(n,r.data,r.blueprint,i,!0),w_(e,r.data,r.blueprint,i,!1)}}function w_(t,e,n,r,i){if(t=Ut(t),Array.isArray(t))for(let s=0;s<t.length;s++)w_(t[s],e,n,r,i);else{let s=nn(),o=Fe(),a=Zt(),u=Jo(t)?t:Ut(t.provide),c=MS(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Jo(t)||!t.multi){let f=new hs(c,i,te),p=jy(u,e,i?l:l+h,d);p===-1?(Jy(jh(a,o),s,u),Uy(s,t,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=jy(u,e,l+h,d),p=jy(u,e,l,l+h),g=f>=0&&n[f],m=p>=0&&n[p];if(i&&!m||!i&&!g){Jy(jh(a,o),s,u);let I=hB(i?dB:lB,n.length,i,r,c);!i&&m&&(n[p].providerFactory=I),Uy(s,t,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(I),o.push(I)}else{let I=nR(n[i?p:f],c,!i&&r);Uy(s,t,f>-1?f:p,I)}!i&&r&&m&&n[p].componentProviders++}}}function Uy(t,e,n,r){let i=Jo(e),s=RV(e);if(i||s){let u=(s?Ut(e.useClass):e).prototype.ngOnDestroy;if(u){let c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=c.indexOf(n);l===-1?c.push(n,[r,u]):c[l+1].push(r,u)}else c.push(n,u)}}}function nR(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function jy(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function lB(t,e,n,r){return E_(this.multi,[])}function dB(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=na(n,n[ue],this.providerFactory.index,r);s=a.slice(0,o),E_(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],E_(i,s);return s}function E_(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function hB(t,e,n,r,i){let s=new hs(t,n,te);return s.multi=[],s.index=e,s.componentProviders=0,nR(s,i,r&&!n),s}function Is(t,e=[]){return n=>{n.providersResolver=(r,i)=>cB(r,i?i(t):t,e)}}var fB=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=AS(!1,r.type),s=i.length>0?ov([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=U({token:e,providedIn:"environment",factory:()=>new e(T(wn))});let t=e;return t})();function Cn(t){ZA("NgStandalone"),t.getStandaloneInjector=e=>e.get(fB).getOrCreateStandaloneInjector(t)}var kr=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},pf=new kr("17.3.5"),gf=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var rR=new N("");function Cs(t){return!!t&&typeof t.then=="function"}function iR(t){return!!t&&typeof t.subscribe=="function"}var sR=new N(""),oR=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=k(sR,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Cs(o))r.push(o);else if(iR(o)){let a=new Promise((u,c)=>{o.subscribe({complete:u,error:c})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),cv=new N("");function pB(){s0(()=>{throw new $(600,!1)})}function gB(t){return t.isBoundToModule}function mB(t,e,n){try{let r=n();return Cs(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}var lc=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=k(cA),this.afterRenderEffectManager=k(XA),this.externalTestViews=new Set,this.beforeRender=new Be,this.afterTick=new Be,this.componentTypes=[],this.components=[],this.isStable=k(df).hasPendingTasks.pipe(F(r=>!r)),this._injector=k(wn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof qh;if(!this._injector.get(oR).done){let f=!s&&DS(r),p=!1;throw new $(405,p)}let a;s?a=r:a=this._injector.get(lf).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let u=gB(a)?void 0:this._injector.get(li),c=i||a.selector,l=a.create(Xt.NULL,[],c,u),d=l.location.nativeElement,h=l.injector.get(rR,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),By(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new $(101,!1);let i=me(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,me(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===zA)throw new $(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:u}of this._views)yB(a,o,u)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>I_(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>I_(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;By(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(cv,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>By(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new $(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function By(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function yB(t,e,n){!e&&!I_(t)||_B(t,n,e)}function I_(t){return k_(t)}function _B(t,e,n){let r;n?(r=0,t[q]|=1024):t[q]&64?r=0:r=1,WA(t,e,r)}var C_=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},lv=(()=>{let e=class e{compileModuleSync(r){return new y_(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=TS(r),o=EA(s.declarations).reduce((a,u)=>{let c=us(u);return c&&a.push(new Ju(c)),a},[]);return new C_(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var vB=(()=>{let e=class e{constructor(){this.zone=k(se),this.applicationRef=k(lc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function wB(t){return[{provide:se,useFactory:t},{provide:Xo,multi:!0,useFactory:()=>{let e=k(vB,{optional:!0});return()=>e.initialize()}},{provide:Xo,multi:!0,useFactory:()=>{let e=k(DB);return()=>{e.initialize()}}},{provide:cA,useFactory:EB}]}function EB(){let t=k(se),e=k(Nr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function IB(t){let e=wB(()=>new se(CB(t)));return Zh([[],e])}function CB(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var DB=(()=>{let e=class e{constructor(){this.subscription=new We,this.initialized=!1,this.zone=k(se),this.pendingTasks=k(df)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{se.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{se.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function TB(){return typeof $localize<"u"&&$localize.locale||Kh}var dv=new N("",{providedIn:"root",factory:()=>k(dv,ie.Optional|ie.SkipSelf)||TB()});var aR=new N("");var Rh=null;function bB(t=[],e){return Xt.create({name:e,providers:[{provide:Xh,useValue:"platform"},{provide:aR,useValue:new Set([()=>Rh=null])},...t]})}function SB(t=[]){if(Rh)return Rh;let e=bB(t);return Rh=e,pB(),AB(e),e}function AB(t){t.get(G_,null)?.forEach(n=>n())}function hv(){return!1}var Ds=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=RB;let t=e;return t})();function RB(t){return xB(Zt(),Fe(),(t&16)===16)}function xB(t,e,n){if(tf(t)&&!n){let r=hi(t.index,e);return new ps(r,r)}else if(t.type&47){let r=e[tr];return new ps(r,e)}return null}function uR(t){try{let{rootComponent:e,appProviders:n,platformProviders:r}=t,i=SB(r),s=[IB(),...n||[]],a=new zh({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,u=a.get(se);return u.run(()=>{a.resolveInjectorInitializers();let c=a.get(Nr,null),l;u.runOutsideAngular(()=>{l=u.onError.subscribe({next:f=>{c.handleError(f)}})});let d=()=>a.destroy(),h=i.get(aR);return h.add(d),a.onDestroy(()=>{l.unsubscribe(),h.delete(d)}),mB(c,u,()=>{let f=a.get(oR);return f.runInitializers(),f.donePromise.then(()=>{let p=a.get(dv,Kh);oB(p||Kh);let g=a.get(lc);return e!==void 0&&g.bootstrap(e),g})})})}catch(e){return Promise.reject(e)}}function gi(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}var hR=null;function Ur(){return hR}function fR(t){hR??=t}var mf=class{};var Dn=new N(""),pR=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:()=>k(MB),providedIn:"platform"});let t=e;return t})();var MB=(()=>{let e=class e extends pR{constructor(){super(),this._doc=k(Dn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ur().getBaseHref(this._doc)}onPopState(r){let i=Ur().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=Ur().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function gR(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function cR(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Ts(t){return t&&t[0]!=="?"?"?"+t:t}var oa=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:()=>k(mR),providedIn:"root"});let t=e;return t})(),NB=new N(""),mR=(()=>{let e=class e extends oa{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??k(Dn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return gR(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Ts(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Ts(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Ts(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(T(pR),T(NB,8))},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var dc=(()=>{let e=class e{constructor(r){this._subject=new St,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=OB(cR(lR(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Ts(i))}normalize(r){return e.stripTrailingSlash(kB(this._basePath,lR(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Ts(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Ts(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Ts,e.joinWithSlash=gR,e.stripTrailingSlash=cR,e.\u0275fac=function(i){return new(i||e)(T(oa))},e.\u0275prov=U({token:e,factory:()=>PB(),providedIn:"root"});let t=e;return t})();function PB(){return new dc(T(oa))}function kB(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function lR(t){return t.replace(/\/index.html$/,"")}function OB(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function yR(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var _R=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new fv,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){dR("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){dR("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(te(uc),te(rv))},e.\u0275dir=xt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),fv=class{constructor(){this.$implicit=null,this.ngIf=null}};function dR(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${jt(e)}'.`)}var bs=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ve({type:e}),e.\u0275inj=Le({});let t=e;return t})(),vR="browser",FB="server";function Ss(t){return t===FB}var yf=class{};var mv=class extends mf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},yv=class t extends mv{static makeCurrent(){fR(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=LB();return n==null?null:VB(n)}resetBaseElement(){hc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return yR(document.cookie,e)}},hc=null;function LB(){return hc=hc||document.querySelector("base"),hc?hc.getAttribute("href"):null}function VB(t){return new URL(t,document.baseURI).pathname}var UB=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac});let t=e;return t})(),_v=new N(""),DR=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new $(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(T(_v),T(se))},e.\u0275prov=U({token:e,factory:e.\u0275fac});let t=e;return t})(),_f=class{constructor(e){this._doc=e}},pv="ng-app-id",TR=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Ss(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${pv}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(pv),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(pv,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(T(Dn),T(q_),T(z_,8),T(Mt))},e.\u0275prov=U({token:e,factory:e.\u0275fac});let t=e;return t})(),gv={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},wv=/%COMP%/g,bR="%COMP%",jB=`_nghost-${bR}`,BB=`_ngcontent-${bR}`,$B=!0,HB=new N("",{providedIn:"root",factory:()=>$B});function qB(t){return BB.replace(wv,t)}function GB(t){return jB.replace(wv,t)}function SR(t,e){return e.map(n=>n.replace(wv,t))}var ER=(()=>{let e=class e{constructor(r,i,s,o,a,u,c,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=Ss(u),this.defaultRenderer=new fc(r,a,c,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===er.ShadowDom&&(i=ge(M({},i),{encapsulation:er.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof vf?s.applyToHost(r):s instanceof pc&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,u=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case er.Emulated:o=new vf(c,l,i,this.appId,d,a,u,h);break;case er.ShadowDom:return new vv(c,l,r,i,a,u,this.nonce,h);default:o=new pc(c,l,i,d,a,u,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(T(DR),T(TR),T(q_),T(HB),T(Dn),T(Mt),T(se),T(z_))},e.\u0275prov=U({token:e,factory:e.\u0275fac});let t=e;return t})(),fc=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(gv[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(IR(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(IR(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new $(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=gv[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=gv[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Pr.DashCase|Pr.Important)?e.style.setProperty(n,r,i&Pr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Pr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=Ur().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function IR(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var vv=class extends fc{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=SR(i.id,i.styles);for(let l of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},pc=class extends fc{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?SR(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},vf=class extends pc{constructor(e,n,r,i,s,o,a,u){let c=i+"-"+r.id;super(e,n,r,s,o,a,u,c),this.contentAttr=qB(c),this.hostAttr=GB(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},zB=(()=>{let e=class e extends _f{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(T(Dn))},e.\u0275prov=U({token:e,factory:e.\u0275fac});let t=e;return t})(),CR=["alt","control","meta","shift"],WB={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},KB={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},QB=(()=>{let e=class e extends _f{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ur().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),a="code."),CR.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=s,c.fullKey=a,c}static matchEventFullKeyCode(r,i){let s=WB[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),CR.forEach(a=>{if(a!==s){let u=KB[a];u(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(T(Dn))},e.\u0275prov=U({token:e,factory:e.\u0275fac});let t=e;return t})();function AR(t,e){return uR(M({rootComponent:t},YB(e)))}function YB(t){return{appProviders:[...t$,...t?.providers??[]],platformProviders:e$}}function ZB(){yv.makeCurrent()}function XB(){return new Nr}function JB(){return mA(document),document}var e$=[{provide:Mt,useValue:vR},{provide:G_,useValue:ZB,multi:!0},{provide:Dn,useFactory:JB,deps:[]}];var t$=[{provide:Xh,useValue:"root"},{provide:Nr,useFactory:XB,deps:[]},{provide:_v,useClass:zB,multi:!0,deps:[Dn,se,Mt]},{provide:_v,useClass:QB,multi:!0,deps:[Dn]},ER,TR,DR,{provide:Xu,useExisting:ER},{provide:yf,useClass:UB,deps:[]},[]];var RR=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(T(Dn))},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var J="primary",Rc=Symbol("RouteTitle"),Tv=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function da(t){return new Tv(t)}function r$(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function i$(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!ir(t[n],e[n]))return!1;return!0}function ir(t,e){let n=t?bv(t):void 0,r=e?bv(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!OR(t[i],e[i]))return!1;return!0}function bv(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function OR(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function FR(t){return t.length>0?t[t.length-1]:null}function vi(t){return vy(t)?t:Cs(t)?ye(Promise.resolve(t)):V(t)}var s$={exact:VR,subset:UR},LR={exact:o$,subset:a$,ignored:()=>!0};function xR(t,e,n){return s$[n.paths](t.root,e.root,n.matrixParams)&&LR[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function o$(t,e){return ir(t,e)}function VR(t,e,n){if(!Rs(t.segments,e.segments)||!If(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!VR(t.children[r],e.children[r],n))return!1;return!0}function a$(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>OR(t[n],e[n]))}function UR(t,e,n){return jR(t,e,e.segments,n)}function jR(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Rs(i,n)||e.hasChildren()||!If(i,n,r))}else if(t.segments.length===n.length){if(!Rs(t.segments,n)||!If(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!UR(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Rs(t.segments,i)||!If(t.segments,i,r)||!t.children[J]?!1:jR(t.children[J],e,s,r)}}function If(t,e,n){return e.every((r,i)=>LR[n](t[i].parameters,r.parameters))}var mi=class{constructor(e=new _e([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=da(this.queryParams),this._queryParamMap}toString(){return l$.serialize(this)}},_e=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Cf(this)}},As=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=da(this.parameters),this._parameterMap}toString(){return $R(this)}};function u$(t,e){return Rs(t,e)&&t.every((n,r)=>ir(n.parameters,e[r].parameters))}function Rs(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function c$(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===J&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==J&&(n=n.concat(e(i,r)))}),n}var Xv=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:()=>new Tf,providedIn:"root"});let t=e;return t})(),Tf=class{parse(e){let n=new Av(e);return new mi(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${gc(e.root,!0)}`,r=f$(e.queryParams),i=typeof e.fragment=="string"?`#${d$(e.fragment)}`:"";return`${n}${r}${i}`}},l$=new Tf;function Cf(t){return t.segments.map(e=>$R(e)).join("/")}function gc(t,e){if(!t.hasChildren())return Cf(t);if(e){let n=t.children[J]?gc(t.children[J],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==J&&r.push(`${i}:${gc(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=c$(t,(r,i)=>i===J?[gc(t.children[J],!1)]:[`${i}:${gc(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[J]!=null?`${Cf(t)}/${n[0]}`:`${Cf(t)}/(${n.join("//")})`}}function BR(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function wf(t){return BR(t).replace(/%3B/gi,";")}function d$(t){return encodeURI(t)}function Sv(t){return BR(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Df(t){return decodeURIComponent(t)}function MR(t){return Df(t.replace(/\+/g,"%20"))}function $R(t){return`${Sv(t.path)}${h$(t.parameters)}`}function h$(t){return Object.entries(t).map(([e,n])=>`;${Sv(e)}=${Sv(n)}`).join("")}function f$(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${wf(n)}=${wf(i)}`).join("&"):`${wf(n)}=${wf(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var p$=/^[^\/()?;#]+/;function Ev(t){let e=t.match(p$);return e?e[0]:""}var g$=/^[^\/()?;=#]+/;function m$(t){let e=t.match(g$);return e?e[0]:""}var y$=/^[^=?&#]+/;function _$(t){let e=t.match(y$);return e?e[0]:""}var v$=/^[^&#]+/;function w$(t){let e=t.match(v$);return e?e[0]:""}var Av=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new _e([],{}):new _e([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[J]=new _e(e,n)),r}parseSegment(){let e=Ev(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new $(4009,!1);return this.capture(e),new As(Df(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=m$(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=Ev(this.remaining);i&&(r=i,this.capture(r))}e[Df(n)]=Df(r)}parseQueryParam(e){let n=_$(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=w$(this.remaining);o&&(r=o,this.capture(r))}let i=MR(n),s=MR(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Ev(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new $(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=J);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[J]:new _e([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new $(4011,!1)}};function HR(t){return t.segments.length>0?new _e([],{[J]:t}):t}function qR(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=qR(i);if(r===J&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new _e(t.segments,e);return E$(n)}function E$(t){if(t.numberOfChildren===1&&t.children[J]){let e=t.children[J];return new _e(t.segments.concat(e.segments),e.children)}return t}function ha(t){return t instanceof mi}function I$(t,e,n=null,r=null){let i=GR(t);return zR(i,e,n,r)}function GR(t){let e;function n(s){let o={};for(let u of s.children){let c=n(u);o[u.outlet]=c}let a=new _e(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=HR(r);return e??i}function zR(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return Iv(i,i,i,n,r);let s=C$(e);if(s.toRoot())return Iv(i,i,new _e([],{}),n,r);let o=D$(s,i,t),a=o.processChildren?_c(o.segmentGroup,o.index,s.commands):KR(o.segmentGroup,o.index,s.commands);return Iv(i,o.segmentGroup,a,n,r)}function bf(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Ec(t){return typeof t=="object"&&t!=null&&t.outlets}function Iv(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([u,c])=>{s[u]=Array.isArray(c)?c.map(l=>`${l}`):`${c}`});let o;t===e?o=n:o=WR(t,e,n);let a=HR(qR(o));return new mi(a,s,i)}function WR(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=WR(s,e,n)}),new _e(t.segments,r)}var Sf=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&bf(r[0]))throw new $(4003,!1);let i=r.find(Ec);if(i&&i!==FR(r))throw new $(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function C$(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Sf(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,c])=>{a[u]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Sf(n,e,r)}var ca=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function D$(t,e,n){if(t.isAbsolute)return new ca(e,!0,0);if(!n)return new ca(e,!1,NaN);if(n.parent===null)return new ca(n,!0,0);let r=bf(t.commands[0])?0:1,i=n.segments.length-1+r;return T$(n,i,t.numberOfDoubleDots)}function T$(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new $(4005,!1);i=r.segments.length}return new ca(r,!1,i-s)}function b$(t){return Ec(t[0])?t[0].outlets:{[J]:t}}function KR(t,e,n){if(t??=new _e([],{}),t.segments.length===0&&t.hasChildren())return _c(t,e,n);let r=S$(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new _e(t.segments.slice(0,r.pathIndex),{});return s.children[J]=new _e(t.segments.slice(r.pathIndex),t.children),_c(s,0,i)}else return r.match&&i.length===0?new _e(t.segments,{}):r.match&&!t.hasChildren()?Rv(t,e,n):r.match?_c(t,0,i):Rv(t,e,n)}function _c(t,e,n){if(n.length===0)return new _e(t.segments,{});{let r=b$(n),i={};if(Object.keys(r).some(s=>s!==J)&&t.children[J]&&t.numberOfChildren===1&&t.children[J].segments.length===0){let s=_c(t.children[J],e,n);return new _e(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=KR(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new _e(t.segments,i)}}function S$(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(Ec(a))break;let u=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&u===void 0)break;if(u&&c&&typeof c=="object"&&c.outlets===void 0){if(!PR(u,c,o))return s;r+=2}else{if(!PR(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Rv(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(Ec(s)){let u=A$(s.outlets);return new _e(r,u)}if(i===0&&bf(n[0])){let u=t.segments[e];r.push(new As(u.path,NR(n[0]))),i++;continue}let o=Ec(s)?s.outlets[J]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&bf(a)?(r.push(new As(o,NR(a))),i+=2):(r.push(new As(o,{})),i++)}return new _e(r,{})}function A$(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=Rv(new _e([],{}),0,r))}),e}function NR(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function PR(t,e,n){return t==n.path&&ir(e,n.parameters)}var vc="imperative",It=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(It||{}),Tn=class{constructor(e,n){this.id=e,this.url=n}},Ic=class extends Tn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=It.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},yi=class extends Tn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=It.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},sn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(sn||{}),xv=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(xv||{}),_i=class extends Tn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=It.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},xs=class extends Tn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=It.NavigationSkipped}},Cc=class extends Tn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=It.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Af=class extends Tn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=It.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Mv=class extends Tn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=It.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nv=class extends Tn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=It.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Pv=class extends Tn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=It.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},kv=class extends Tn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=It.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ov=class{constructor(e){this.route=e,this.type=It.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Fv=class{constructor(e){this.route=e,this.type=It.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Lv=class{constructor(e){this.snapshot=e,this.type=It.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Vv=class{constructor(e){this.snapshot=e,this.type=It.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Uv=class{constructor(e){this.snapshot=e,this.type=It.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},jv=class{constructor(e){this.snapshot=e,this.type=It.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Dc=class{},Tc=class{constructor(e){this.url=e}};var Bv=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new kf,this.attachRef=null}},kf=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new Bv,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Rf=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=$v(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=$v(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=Hv(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Hv(e,this._root).map(n=>n.value)}};function $v(t,e){if(t===e.value)return e;for(let n of e.children){let r=$v(t,n);if(r)return r}return null}function Hv(t,e){if(t===e.value)return[e];for(let n of e.children){let r=Hv(t,n);if(r.length)return r.unshift(e),r}return[]}var rn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function ua(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var xf=class extends Rf{constructor(e,n){super(e),this.snapshot=n,ew(this,e)}toString(){return this.snapshot.toString()}};function QR(t){let e=R$(t),n=new Et([new As("",{})]),r=new Et({}),i=new Et({}),s=new Et({}),o=new Et(""),a=new Ms(n,r,s,o,i,J,t,e.root);return a.snapshot=e.root,new xf(new rn(a,[]),e)}function R$(t){let e={},n={},r={},i="",s=new bc([],e,r,i,n,J,t,null,{});return new Mf("",new rn(s,[]))}var Ms=class{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(F(c=>c[Rc]))??V(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(F(e=>da(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(F(e=>da(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Jv(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:M(M({},e.params),t.params),data:M(M({},e.data),t.data),resolve:M(M(M(M({},t.data),e.data),i?.data),t._resolvedData)}:r={params:M({},t.params),data:M({},t.data),resolve:M(M({},t.data),t._resolvedData??{})},i&&ZR(i)&&(r.resolve[Rc]=i.title),r}var bc=class{get title(){return this.data?.[Rc]}constructor(e,n,r,i,s,o,a,u,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=da(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=da(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Mf=class extends Rf{constructor(e,n){super(n),this.url=e,ew(this,n)}toString(){return YR(this._root)}};function ew(t,e){e.value._routerState=t,e.children.forEach(n=>ew(t,n))}function YR(t){let e=t.children.length>0?` { ${t.children.map(YR).join(", ")} } `:"";return`${t.value}${e}`}function Cv(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,ir(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),ir(e.params,n.params)||t.paramsSubject.next(n.params),i$(e.url,n.url)||t.urlSubject.next(n.url),ir(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function qv(t,e){let n=ir(t.params,e.params)&&u$(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||qv(t.parent,e.parent))}function ZR(t){return typeof t.title=="string"||t.title===null}var tw=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=J,this.activateEvents=new St,this.deactivateEvents=new St,this.attachEvents=new St,this.detachEvents=new St,this.parentContexts=k(kf),this.location=k(uc),this.changeDetector=k(Ds),this.environmentInjector=k(wn),this.inputBinder=k(nw,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new $(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new $(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new $(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new $(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new Gv(r,u,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=xt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[di]});let t=e;return t})(),Gv=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r,this.__ngOutletInjector=!0}get(e,n){return e===Ms?this.route:e===kf?this.childContexts:this.parent.get(e,n)}},nw=new N("");function x$(t,e,n){let r=Sc(t,e._root,n?n._root:void 0);return new xf(r,e)}function Sc(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=M$(t,e,n);return new rn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Sc(t,a)),o}}let r=N$(e.value),i=e.children.map(s=>Sc(t,s));return new rn(r,i)}}function M$(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Sc(t,r,i);return Sc(t,r)})}function N$(t){return new Ms(new Et(t.url),new Et(t.params),new Et(t.queryParams),new Et(t.fragment),new Et(t.data),t.outlet,t.component,t)}var XR="ngNavigationCancelingError";function JR(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=ha(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=ex(!1,sn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function ex(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[XR]=!0,n.cancellationCode=e,n}function P$(t){return tx(t)&&ha(t.url)}function tx(t){return!!t&&t[XR]}var k$=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=En({type:e,selectors:[["ng-component"]],standalone:!0,features:[Cn],decls:1,vars:0,template:function(i,s){i&1&&Vr(0,"router-outlet")},dependencies:[tw],encapsulation:2});let t=e;return t})();function O$(t,e){return t.providers&&!t._injector&&(t._injector=ov(t.providers,e,`Route: ${t.path}`)),t._injector??e}function rw(t){let e=t.children&&t.children.map(rw),n=e?ge(M({},t),{children:e}):M({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==J&&(n.component=k$),n}function sr(t){return t.outlet||J}function F$(t,e){let n=t.filter(r=>sr(r)===e);return n.push(...t.filter(r=>sr(r)!==e)),n}function xc(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var L$=(t,e,n,r)=>F(i=>(new zv(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),zv=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Cv(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=ua(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=ua(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=ua(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=ua(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new jv(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Vv(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(Cv(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Cv(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=xc(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Nf=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},la=class{constructor(e,n){this.component=e,this.route=n}};function V$(t,e,n){let r=t._root,i=e?e._root:null;return mc(r,i,n,[r.value])}function U$(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function pa(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!lS(t)?t:e.get(t):r}function mc(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=ua(e);return t.children.forEach(o=>{j$(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>wc(a,n.getContext(o),i)),i}function j$(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=B$(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new Nf(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?mc(t,e,a?a.children:null,r,i):mc(t,e,n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new la(a.outlet.component,o))}else o&&wc(e,a,i),i.canActivateChecks.push(new Nf(r)),s.component?mc(t,null,a?a.children:null,r,i):mc(t,null,n,r,i);return i}function B$(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Rs(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Rs(t.url,e.url)||!ir(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!qv(t,e)||!ir(t.queryParams,e.queryParams);case"paramsChange":default:return!qv(t,e)}}function wc(t,e,n){let r=ua(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?wc(o,e.children.getContext(s),n):wc(o,null,n):wc(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new la(e.outlet.component,i)):n.canDeactivateChecks.push(new la(null,i)):n.canDeactivateChecks.push(new la(null,i))}function Mc(t){return typeof t=="function"}function $$(t){return typeof t=="boolean"}function H$(t){return t&&Mc(t.canLoad)}function q$(t){return t&&Mc(t.canActivate)}function G$(t){return t&&Mc(t.canActivateChild)}function z$(t){return t&&Mc(t.canDeactivate)}function W$(t){return t&&Mc(t.canMatch)}function nx(t){return t instanceof Rr||t?.name==="EmptyError"}var Ef=Symbol("INITIAL_VALUE");function fa(){return Oe(t=>mh(t.map(e=>e.pipe(xr(1),is(Ef)))).pipe(F(e=>{for(let n of e)if(n!==!0){if(n===Ef)return Ef;if(n===!1||n instanceof mi)return n}return!0}),bt(e=>e!==Ef),xr(1)))}function K$(t,e){return ot(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?V(ge(M({},n),{guardsResult:!0})):Q$(o,r,i,t).pipe(ot(a=>a&&$$(a)?Y$(r,s,t,e):V(a)),F(a=>ge(M({},n),{guardsResult:a})))})}function Q$(t,e,n,r){return ye(t).pipe(ot(i=>tH(i.component,i.route,n,e,r)),mn(i=>i!==!0,!0))}function Y$(t,e,n,r){return ye(e).pipe(Ho(i=>Bo(X$(i.route.parent,r),Z$(i.route,r),eH(t,i.path,n),J$(t,i.route,n))),mn(i=>i!==!0,!0))}function Z$(t,e){return t!==null&&e&&e(new Uv(t)),V(!0)}function X$(t,e){return t!==null&&e&&e(new Lv(t)),V(!0)}function J$(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return V(!0);let i=r.map(s=>yh(()=>{let o=xc(e)??n,a=pa(s,o),u=q$(a)?a.canActivate(e,t):_s(o,()=>a(e,t));return vi(u).pipe(mn())}));return V(i).pipe(fa())}function eH(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>U$(o)).filter(o=>o!==null).map(o=>yh(()=>{let a=o.guards.map(u=>{let c=xc(o.node)??n,l=pa(u,c),d=G$(l)?l.canActivateChild(r,t):_s(c,()=>l(r,t));return vi(d).pipe(mn())});return V(a).pipe(fa())}));return V(s).pipe(fa())}function tH(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return V(!0);let o=s.map(a=>{let u=xc(e)??i,c=pa(a,u),l=z$(c)?c.canDeactivate(t,e,n,r):_s(u,()=>c(t,e,n,r));return vi(l).pipe(mn())});return V(o).pipe(fa())}function nH(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return V(!0);let s=i.map(o=>{let a=pa(o,t),u=H$(a)?a.canLoad(e,n):_s(t,()=>a(e,n));return vi(u)});return V(s).pipe(fa(),rx(r))}function rx(t){return fy(at(e=>{if(ha(e))throw JR(t,e)}),F(e=>e===!0))}function rH(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return V(!0);let s=i.map(o=>{let a=pa(o,t),u=W$(a)?a.canMatch(e,n):_s(t,()=>a(e,n));return vi(u)});return V(s).pipe(fa(),rx(r))}var Ac=class{constructor(e){this.segmentGroup=e||null}},Pf=class extends Error{constructor(e){super(),this.urlTree=e}};function aa(t){return jo(new Ac(t))}function iH(t){return jo(new $(4e3,!1))}function sH(t){return jo(ex(!1,sn.GuardRejected))}var Wv=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return V(r);if(i.numberOfChildren>1||!i.children[J])return iH(e.redirectTo);i=i.children[J]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Pf(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new mi(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new _e(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new $(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},Kv={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function oH(t,e,n,r,i){let s=iw(t,e,n);return s.matched?(r=O$(e,r),rH(r,e,n,i).pipe(F(o=>o===!0?s:M({},Kv)))):V(s)}function iw(t,e,n){if(e.path==="**")return aH(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?M({},Kv):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||r$)(n,t,e);if(!i)return M({},Kv);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?M(M({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function aH(t){return{matched:!0,parameters:t.length>0?FR(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function kR(t,e,n,r){return n.length>0&&lH(t,n,r)?{segmentGroup:new _e(e,cH(r,new _e(n,t.children))),slicedSegments:[]}:n.length===0&&dH(t,n,r)?{segmentGroup:new _e(t.segments,uH(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new _e(t.segments,t.children),slicedSegments:n}}function uH(t,e,n,r){let i={};for(let s of n)if(Of(t,e,s)&&!r[sr(s)]){let o=new _e([],{});i[sr(s)]=o}return M(M({},r),i)}function cH(t,e){let n={};n[J]=e;for(let r of t)if(r.path===""&&sr(r)!==J){let i=new _e([],{});n[sr(r)]=i}return n}function lH(t,e,n){return n.some(r=>Of(t,e,r)&&sr(r)!==J)}function dH(t,e,n){return n.some(r=>Of(t,e,r))}function Of(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function hH(t,e,n,r){return sr(t)!==r&&(r===J||!Of(e,n,t))?!1:iw(e,t,n).matched}function fH(t,e,n){return e.length===0&&!t.children[n]}var Qv=class{};function pH(t,e,n,r,i,s,o="emptyOnly"){return new Yv(t,e,n,r,i,o,s).recognize()}var gH=31,Yv=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Wv(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new $(4002,`'${e.segmentGroup}'`)}recognize(){let e=kR(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(F(n=>{let r=new bc([],Object.freeze({}),Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,{},J,this.rootComponentType,null,{}),i=new rn(r,n),s=new Mf("",i),o=I$(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,J).pipe(ii(r=>{if(r instanceof Pf)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Ac?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=Jv(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(F(s=>s instanceof rn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ye(i).pipe(Ho(s=>{let o=r.children[s],a=F$(n,s);return this.processSegmentGroup(e,a,o,s)}),Zn((s,o)=>(s.push(...o),s)),si(null),Iy(),ot(s=>{if(s===null)return aa(r);let o=ix(s);return mH(o),V(o)}))}processSegment(e,n,r,i,s,o){return ye(n).pipe(Ho(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(ii(u=>{if(u instanceof Ac)return V(null);throw u}))),mn(a=>!!a),ii(a=>{if(nx(a))return fH(r,i,s)?V(new Qv):aa(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return hH(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):aa(i):aa(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:c,remainingSegments:l}=iw(n,i,s);if(!a)return aa(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>gH&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,c);return this.applyRedirects.lineralizeSegments(i,d).pipe(ot(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=oH(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Oe(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Oe(({routes:u})=>{let c=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new bc(l,h,Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,_H(r),sr(r),r.component??r._loadedComponent??null,r,vH(r)),{segmentGroup:p,slicedSegments:g}=kR(n,l,d,u);if(g.length===0&&p.hasChildren())return this.processChildren(c,u,p).pipe(F(I=>I===null?null:new rn(f,I)));if(u.length===0&&g.length===0)return V(new rn(f,[]));let m=sr(r)===s;return this.processSegment(c,u,p,g,m?J:s,!0).pipe(F(I=>new rn(f,I instanceof rn?[I]:[])))}))):aa(n)))}getChildConfig(e,n,r){return n.children?V({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?V({routes:n._loadedRoutes,injector:n._loadedInjector}):nH(e,n,r,this.urlSerializer).pipe(ot(i=>i?this.configLoader.loadChildren(e,n).pipe(at(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):sH(n))):V({routes:[],injector:e})}};function mH(t){t.sort((e,n)=>e.value.outlet===J?-1:n.value.outlet===J?1:e.value.outlet.localeCompare(n.value.outlet))}function yH(t){let e=t.value.routeConfig;return e&&e.path===""}function ix(t){let e=[],n=new Set;for(let r of t){if(!yH(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=ix(r.children);e.push(new rn(r.value,i))}return e.filter(r=>!n.has(r))}function _H(t){return t.data||{}}function vH(t){return t.resolve||{}}function wH(t,e,n,r,i,s){return ot(o=>pH(t,e,n,r,o.extractedUrl,i,s).pipe(F(({state:a,tree:u})=>ge(M({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function EH(t,e){return ot(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return V(n);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let c of sx(u))o.add(c);let a=0;return ye(o).pipe(Ho(u=>s.has(u)?IH(u,r,t,e):(u.data=Jv(u,u.parent,t).resolve,V(void 0))),at(()=>a++),qo(1),ot(u=>a===o.size?V(n):Vt))})}function sx(t){let e=t.children.map(n=>sx(n)).flat();return[t,...e]}function IH(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!ZR(i)&&(s[Rc]=i.title),CH(s,t,e,r).pipe(F(o=>(t._resolvedData=o,t.data=Jv(t,t.parent,n).resolve,null)))}function CH(t,e,n,r){let i=bv(t);if(i.length===0)return V({});let s={};return ye(i).pipe(ot(o=>DH(t[o],e,n,r).pipe(mn(),at(a=>{s[o]=a}))),qo(1),Ey(s),ii(o=>nx(o)?Vt:jo(o)))}function DH(t,e,n,r){let i=xc(e)??r,s=pa(t,i),o=s.resolve?s.resolve(e,n):_s(i,()=>s(e,n));return vi(o)}function Dv(t){return Oe(e=>{let n=t(e);return n?ye(n).pipe(F(()=>e)):V(e)})}var ox=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===J);return i}getResolvedTitleForRoute(r){return r.data[Rc]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:()=>k(TH),providedIn:"root"});let t=e;return t})(),TH=(()=>{let e=class e extends ox{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(T(RR))},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),sw=new N("",{providedIn:"root",factory:()=>({})}),ow=new N(""),bH=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=k(lv)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return V(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=vi(r.loadComponent()).pipe(F(ax),at(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Bu(()=>{this.componentLoaders.delete(r)})),s=new Oo(i,()=>new Be).pipe(ko());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return V({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=SH(i,this.compiler,r,this.onLoadEndListener).pipe(Bu(()=>{this.childrenLoaders.delete(i)})),a=new Oo(o,()=>new Be).pipe(ko());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function SH(t,e,n,r){return vi(t.loadChildren()).pipe(F(ax),ot(i=>i instanceof ec||Array.isArray(i)?V(i):ye(e.compileModuleAsync(i))),F(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(ow,[],{optional:!0,self:!0}).flat()),{routes:o.map(rw),injector:s}}))}function AH(t){return t&&typeof t=="object"&&"default"in t}function ax(t){return AH(t)?t.default:t}var aw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:()=>k(RH),providedIn:"root"});let t=e;return t})(),RH=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),xH=new N("");var MH=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Be,this.transitionAbortSubject=new Be,this.configLoader=k(bH),this.environmentInjector=k(wn),this.urlSerializer=k(Xv),this.rootContexts=k(kf),this.location=k(dc),this.inputBindingEnabled=k(nw,{optional:!0})!==null,this.titleStrategy=k(ox),this.options=k(sw,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=k(aw),this.createViewTransition=k(xH,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>V(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Ov(s)),i=s=>this.events.next(new Fv(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ge(M(M({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Et({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:vc,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(bt(o=>o.id!==0),F(o=>ge(M({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Oe(o=>{let a=!1,u=!1;return V(o).pipe(Oe(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",sn.SupersededByNewNavigation),Vt;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?ge(M({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new xs(c.id,this.urlSerializer.serialize(c.rawUrl),h,xv.IgnoredSameUrlNavigation)),c.resolve(null),Vt}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return V(c).pipe(Oe(h=>{let f=this.transitions?.getValue();return this.events.next(new Ic(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Vt:Promise.resolve(h)}),wH(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),at(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ge(M({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new Af(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:m}=c,I=new Ic(h,this.urlSerializer.serialize(f),p,g);this.events.next(I);let R=QR(this.rootComponentType).snapshot;return this.currentTransition=o=ge(M({},c),{targetSnapshot:R,urlAfterRedirects:f,extras:ge(M({},m),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,V(o)}else{let h="";return this.events.next(new xs(c.id,this.urlSerializer.serialize(c.extractedUrl),h,xv.IgnoredByUrlHandlingStrategy)),c.resolve(null),Vt}}),at(c=>{let l=new Mv(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),F(c=>(this.currentTransition=o=ge(M({},c),{guards:V$(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),K$(this.environmentInjector,c=>this.events.next(c)),at(c=>{if(o.guardsResult=c.guardsResult,ha(c.guardsResult))throw JR(this.urlSerializer,c.guardsResult);let l=new Nv(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),bt(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",sn.GuardRejected),!1)),Dv(c=>{if(c.guards.canActivateChecks.length)return V(c).pipe(at(l=>{let d=new Pv(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Oe(l=>{let d=!1;return V(l).pipe(EH(this.paramsInheritanceStrategy,this.environmentInjector),at({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",sn.NoDataFromResolver)}}))}),at(l=>{let d=new kv(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),Dv(c=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(at(f=>{d.component=f}),F(()=>{})));for(let f of d.children)h.push(...l(f));return h};return mh(l(c.targetSnapshot.root)).pipe(si(null),xr(1))}),Dv(()=>this.afterPreactivation()),Oe(()=>{let{currentSnapshot:c,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?ye(d).pipe(F(()=>o)):V(o)}),F(c=>{let l=x$(r.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=ge(M({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),at(()=>{this.events.next(new Dc)}),L$(this.rootContexts,r.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),xr(1),at({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new yi(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),Ty(this.transitionAbortSubject.pipe(at(c=>{throw c}))),Bu(()=>{!a&&!u&&this.cancelNavigationTransition(o,"",sn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),ii(c=>{if(u=!0,tx(c))this.events.next(new _i(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),P$(c)?this.events.next(new Tc(c.url)):o.resolve(!1);else{this.events.next(new Cc(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return Vt}))}))}cancelNavigationTransition(r,i,s){let o=new _i(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function NH(t){return t!==vc}var PH=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:()=>k(kH),providedIn:"root"});let t=e;return t})(),Zv=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},kH=(()=>{let e=class e extends Zv{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ia(e)))(s||e)}})(),e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),ux=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:()=>k(OH),providedIn:"root"});let t=e;return t})(),OH=(()=>{let e=class e extends ux{constructor(){super(...arguments),this.location=k(dc),this.urlSerializer=k(Xv),this.options=k(sw,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=k(aw),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new mi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=QR(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Ic)this.stateMemento=this.createStateMemento();else if(r instanceof xs)this.rawUrlTree=i.initialUrl;else if(r instanceof Af){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Dc?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof _i&&(r.code===sn.GuardRejected||r.code===sn.NoDataFromResolver)?this.restoreHistory(i):r instanceof Cc?this.restoreHistory(i,!0):r instanceof yi&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=M(M({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=M(M({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ia(e)))(s||e)}})(),e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),yc=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(yc||{});function FH(t,e){t.events.pipe(bt(n=>n instanceof yi||n instanceof _i||n instanceof Cc||n instanceof xs),F(n=>n instanceof yi||n instanceof xs?yc.COMPLETE:(n instanceof _i?n.code===sn.Redirect||n.code===sn.SupersededByNewNavigation:!1)?yc.REDIRECTING:yc.FAILED),bt(n=>n!==yc.REDIRECTING),xr(1)).subscribe(()=>{e()})}function LH(t){throw t}var VH={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},UH={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ns=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=k(gf),this.stateManager=k(ux),this.options=k(sw,{optional:!0})||{},this.pendingTasks=k(df),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=k(MH),this.urlSerializer=k(Xv),this.location=k(dc),this.urlHandlingStrategy=k(aw),this._events=new Be,this.errorHandler=this.options.errorHandler||LH,this.navigated=!1,this.routeReuseStrategy=k(PH),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=k(ow,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!k(nw,{optional:!0}),this.eventsSubscription=new We,this.isNgZoneEnabled=k(se)instanceof se&&se.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof _i&&i.code!==sn.Redirect&&i.code!==sn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof yi)this.navigated=!0;else if(i instanceof Tc){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),u={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||NH(s.source)};this.scheduleNavigation(a,vc,null,u,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}BH(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),vc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let c=M({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let u=this.parseUrl(r);this.scheduleNavigation(u,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(rw),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:a,d=null;switch(u){case"merge":d=M(M({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=GR(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return zR(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=ha(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,vc,null,i)}navigate(r,i={skipLocationChange:!1}){return jH(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=M({},VH):i===!1?s=M({},UH):s=i,ha(r))return xR(this.currentUrlTree,r,s);let o=this.parseUrl(r);return xR(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let u,c,l;a?(u=a.resolve,c=a.reject,l=a.promise):l=new Promise((h,f)=>{u=h,c=f});let d=this.pendingTasks.add();return FH(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:u,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function jH(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new $(4008,!1)}function BH(t){return!(t instanceof Dc)&&!(t instanceof Tc)}var cx=(()=>{let e=class e{constructor(r,i,s,o,a,u){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=u,this.href=null,this.commands=null,this.onChanges=new Be,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let c=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=r.events.subscribe(l=>{l instanceof yi&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let u=this.urlTree;if(u===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(u,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:vA(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(te(Ns),te(Ms),H_("tabindex"),te(vs),te(fi),te(oa))},e.\u0275dir=xt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&rr("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&cc("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[At.HasDecoratorInputTransform,"preserveFragment","preserveFragment",gi],skipLocationChange:[At.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",gi],replaceUrl:[At.HasDecoratorInputTransform,"replaceUrl","replaceUrl",gi],routerLink:"routerLink"},standalone:!0,features:[sv,di]});let t=e;return t})();var $H=new N("");function lx(t,...e){return Zh([{provide:ow,multi:!0,useValue:t},[],{provide:Ms,useFactory:HH,deps:[Ns]},{provide:cv,multi:!0,useFactory:qH},e.map(n=>n.\u0275providers)])}function HH(t){return t.routerState.root}function qH(){let t=k(Xt);return e=>{let n=t.get(lc);if(e!==n.components[0])return;let r=t.get(Ns),i=t.get(GH);t.get(zH)===1&&r.initialNavigation(),t.get(WH,null,ie.Optional)?.setUpPreloading(),t.get($H,null,ie.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var GH=new N("",{factory:()=>new Be}),zH=new N("",{providedIn:"root",factory:()=>1});var WH=new N("");var hx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=En({type:e,selectors:[["app-quien-soy"]],standalone:!0,features:[Cn],decls:17,vars:0,consts:[["src","./assets/fotoAlumno.jpg","width","200"]],template:function(i,s){i&1&&(De(0,"p")(1,"b"),$e(2,"Damian Nicol\xE1s Dattilo"),Se(),Vr(3,"br"),$e(4," Estudiante de la utn fra"),Vr(5,"br"),$e(6," 32 a\xF1os"),Vr(7,"br")(8,"br")(9,"br")(10,"img",0)(11,"br")(12,"br")(13,"br"),De(14,"h3"),$e(15,"Juego propio: generala simple"),Se(),$e(16," 2 jugadores tiran 5 dados al azar por turnos y segun las combinaciones de los numeros se anotan puntajes 5 numeros iguales es 'generala' y vale 100 puntos 4 iguales y 1 distinto es 'poker' y vale 80 puntos 3 iguales y 2 iguales es 'full' y vale 50 puntos El juego concluye cuando uno de los jugadores supera los 200 puntos o cuando se dan 10 tiros por cada jugador. "),Se())}});let t=e;return t})();var Ex=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(te(vs),te(fi))},e.\u0275dir=xt({type:e});let t=e;return t})(),KH=(()=>{let e=class e extends Ex{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ia(e)))(s||e)}})(),e.\u0275dir=xt({type:e,features:[Lr]});let t=e;return t})(),Ix=new N("");var QH={provide:Ix,useExisting:ms(()=>ya),multi:!0};function YH(){let t=Ur()?Ur().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var ZH=new N(""),ya=(()=>{let e=class e extends Ex{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!YH())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(te(vs),te(fi),te(ZH,8))},e.\u0275dir=xt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&rr("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[Is([QH]),Lr]});let t=e;return t})();function XH(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}var cw=new N(""),Cx=new N("");function JH(t){return XH(t.value)?{required:!0}:null}function fx(t){return null}function Dx(t){return t!=null}function Tx(t){return Cs(t)?ye(t):t}function bx(t){let e={};return t.forEach(n=>{e=n!=null?M(M({},e),n):e}),Object.keys(e).length===0?null:e}function Sx(t,e){return e.map(n=>n(t))}function eq(t){return!t.validate}function Ax(t){return t.map(e=>eq(e)?e:n=>e.validate(n))}function tq(t){if(!t)return null;let e=t.filter(Dx);return e.length==0?null:function(n){return bx(Sx(n,e))}}function lw(t){return t!=null?tq(Ax(t)):null}function nq(t){if(!t)return null;let e=t.filter(Dx);return e.length==0?null:function(n){let r=Sx(n,e).map(Tx);return wy(r).pipe(F(bx))}}function dw(t){return t!=null?nq(Ax(t)):null}function px(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function rq(t){return t._rawValidators}function iq(t){return t._rawAsyncValidators}function uw(t){return t?Array.isArray(t)?t:[t]:[]}function Lf(t,e){return Array.isArray(t)?t.includes(e):t===e}function gx(t,e){let n=uw(e);return uw(t).forEach(i=>{Lf(n,i)||n.push(i)}),n}function mx(t,e){return uw(e).filter(n=>!Lf(t,n))}var Vf=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=lw(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=dw(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},ma=class extends Vf{get formDirective(){return null}get path(){return null}},Oc=class extends Vf{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Uf=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},sq={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},ute=ge(M({},sq),{"[class.ng-submitted]":"isSubmitted"}),$f=(()=>{let e=class e extends Uf{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(te(Oc,2))},e.\u0275dir=xt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&ff("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Lr]});let t=e;return t})(),Hf=(()=>{let e=class e extends Uf{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(te(ma,10))},e.\u0275dir=xt({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&ff("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Lr]});let t=e;return t})();var Nc="VALID",Ff="INVALID",ga="PENDING",Pc="DISABLED";function Rx(t){return(qf(t)?t.validators:t)||null}function oq(t){return Array.isArray(t)?lw(t):t||null}function xx(t,e){return(qf(e)?e.asyncValidators:t)||null}function aq(t){return Array.isArray(t)?dw(t):t||null}function qf(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function uq(t,e,n){let r=t.controls;if(!(e?Object.keys(r):r).length)throw new $(1e3,"");if(!r[n])throw new $(1001,"")}function cq(t,e,n){t._forEachChild((r,i)=>{if(n[i]===void 0)throw new $(1002,"")})}var jf=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Nc}get invalid(){return this.status===Ff}get pending(){return this.status==ga}get disabled(){return this.status===Pc}get enabled(){return this.status!==Pc}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(gx(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(gx(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(mx(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(mx(e,this._rawAsyncValidators))}hasValidator(e){return Lf(this._rawValidators,e)}hasAsyncValidator(e){return Lf(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=ga,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Pc,this.errors=null,this._forEachChild(r=>{r.disable(ge(M({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ge(M({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Nc,this._forEachChild(r=>{r.enable(ge(M({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ge(M({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Nc||this.status===ga)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Pc:Nc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=ga,this._hasOwnPendingAsyncValidator=!0;let n=Tx(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new St,this.statusChanges=new St}_calculateStatus(){return this._allControlsDisabled()?Pc:this.errors?Ff:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ga)?ga:this._anyControlsHaveStatus(Ff)?Ff:Nc}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){qf(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=oq(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=aq(this._rawAsyncValidators)}},Bf=class extends jf{constructor(e,n,r){super(Rx(n),xx(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){cq(this,!0,e),Object.keys(e).forEach(r=>{uq(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>r._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,s)=>{r=n(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var hw=new N("CallSetDisabledState",{providedIn:"root",factory:()=>fw}),fw="always";function lq(t,e){return[...e.path,t]}function Mx(t,e,n=fw){Nx(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),hq(t,e),pq(t,e),fq(t,e),dq(t,e)}function yx(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function dq(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function Nx(t,e){let n=rq(t);e.validator!==null?t.setValidators(px(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=iq(t);e.asyncValidator!==null?t.setAsyncValidators(px(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();yx(e._rawValidators,i),yx(e._rawAsyncValidators,i)}function hq(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&Px(t,e)})}function fq(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&Px(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function Px(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function pq(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function gq(t,e){t==null,Nx(t,e)}function mq(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function yq(t){return Object.getPrototypeOf(t.constructor)===KH}function _q(t,e){t._syncPendingControls(),e.forEach(n=>{let r=n.control;r.updateOn==="submit"&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function vq(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===ya?n=s:yq(s)?r=s:i=s}),i||r||n||null}var wq={provide:ma,useExisting:ms(()=>Fc)},kc=Promise.resolve(),Fc=(()=>{let e=class e extends ma{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new St,this.form=new Bf({},lw(r),dw(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){kc.then(()=>{let i=this._findContainer(r.path);r.control=i.registerControl(r.name,r.control),Mx(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){kc.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){kc.then(()=>{let i=this._findContainer(r.path),s=new Bf({});gq(s,r),i.registerControl(r.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){kc.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,i){kc.then(()=>{this.form.get(r.path).setValue(i)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submitted=!0,_q(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}};e.\u0275fac=function(i){return new(i||e)(te(cw,10),te(Cx,10),te(hw,8))},e.\u0275dir=xt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){i&1&&rr("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{options:[At.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Is([wq]),Lr]});let t=e;return t})();function _x(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function vx(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var Eq=class extends jf{constructor(e=null,n,r){super(Rx(n),xx(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),qf(n)&&(n.nonNullable||n.initialValueIsDefault)&&(vx(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){_x(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){_x(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){vx(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Iq={provide:Oc,useExisting:ms(()=>Lc)},wx=Promise.resolve(),Lc=(()=>{let e=class e extends Oc{constructor(r,i,s,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this.control=new Eq,this._registered=!1,this.name="",this.update=new St,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=vq(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),mq(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Mx(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){wx.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&gi(i);wx.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?lq(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(te(ma,9),te(cw,10),te(Cx,10),te(Ix,10),te(Ds,8),te(hw,8))},e.\u0275dir=xt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[At.None,"disabled","isDisabled"],model:[At.None,"ngModel","model"],options:[At.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Is([Iq]),Lr,di]});let t=e;return t})(),Gf=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=xt({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})();var Cq=(()=>{let e=class e{constructor(){this._validator=fx}ngOnChanges(r){if(this.inputName in r){let i=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):fx,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=xt({type:e,features:[di]});let t=e;return t})();var Dq={provide:cw,useExisting:ms(()=>Vc),multi:!0};var Vc=(()=>{let e=class e extends Cq{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=gi,this.createValidator=r=>JH}enabled(r){return r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ia(e)))(s||e)}})(),e.\u0275dir=xt({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,s){i&2&&cc("required",s._enabled?"":null)},inputs:{required:"required"},features:[Is([Dq]),Lr]});let t=e;return t})();var Tq=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ve({type:e}),e.\u0275inj=Le({});let t=e;return t})();var _a=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:hw,useValue:r.callSetDisabledState??fw}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ve({type:e}),e.\u0275inj=Le({imports:[Tq]});let t=e;return t})();var bq="firebase",Sq="10.11.1";Ne(bq,Sq,"app");var ft=new kr("ANGULARFIRE2_VERSION");function wa(t,e,n){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===n);if(s.length===1)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}var ks=(t,e)=>{let n=e?[e]:zd(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Bt=class{constructor(){return ks(Aq)}},Aq="app-check";function va(){}var zf=class{zone;delegate;constructor(e,n=yy){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},pw=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",va,{},va,va)),n.pipe(at({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Jt=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new zf(Zone.current)),this.insideAngular=n.run(()=>new zf(Zone.current,rs)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(T(se))};static \u0275prov=U({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Wf(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Rq(t){return Wf().ngZone.runOutsideAngular(()=>t())}function Ps(t){return Wf().ngZone.run(()=>t())}function He(t){return xq(Wf())(t)}function xq(t){return function(n){return n=n.lift(new pw(t.ngZone)),n.pipe(gn(t.outsideAngular),tn(t.insideAngular))}}var Mq=(t,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Ps(()=>t.apply(void 0,r))},Os=(t,e)=>function(){let n,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(n||=Ps(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",va,{},va,va))),r[s]=Mq(r[s],n));let i=Rq(()=>t.apply(this,r));if(!e)if(i instanceof X){let s=Wf();return i.pipe(gn(s.outsideAngular),tn(s.insideAngular))}else return Ps(()=>i);return i instanceof X?i.pipe(He):i instanceof Promise?Ps(()=>new Promise((s,o)=>i.then(a=>Ps(()=>s(a)),a=>Ps(()=>o(a))))):typeof i=="function"&&n?function(){return setTimeout(()=>{n&&n.state==="scheduled"&&n.invoke()},10),i.apply(this,arguments)}:Ps(()=>i)};var Un=class{constructor(e){return e}},jr=class{constructor(){return zd()}};function Nq(t){return t&&t.length===1?t[0]:new Un(ri())}var mw=new N("angularfire2._apps"),Pq={provide:Un,useFactory:Nq,deps:[[new Ke,mw]]},kq={provide:jr,deps:[[new Ke,mw]]};function Oq(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Un(r)}}var Fq=(()=>{class t{constructor(n){Ne("angularfire",ft.full,"core"),Ne("angularfire",ft.full,"app"),Ne("angular",pf.full,n.toString())}static \u0275fac=function(r){return new(r||t)(T(Mt))};static \u0275mod=Ve({type:t});static \u0275inj=Le({providers:[Pq,kq]})}return t})();function Ox(t,...e){return{ngModule:Fq,providers:[{provide:mw,useFactory:Oq(t),multi:!0,deps:[se,Xt,Jt,...e]}]}}var Lq=new Map,Vq={activated:!1,tokenObservers:[]},Uq={initialized:!1,enabled:!1};function jn(t){return Lq.get(t)||Object.assign({},Vq)}function jx(){return Uq}var jq="https://content-firebaseappcheck.googleapis.com/v1";var Bq="exchangeDebugToken",Fx={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Lte=24*60*60*1e3;var _w=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return _(this,null,function*(){this.stop();try{this.pending=new dt,this.pending.promise.catch(n=>{}),yield $q(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new dt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function $q(t){return new Promise(e=>{setTimeout(e,t)})}var Hq={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},wi=new Kb("appCheck","AppCheck",Hq);function Bx(t){if(!jn(t).activated)throw wi.create("use-before-activation",{appName:t.name})}function $x(r,i){return _(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(t,a)}catch(f){throw wi.create("fetch-network-error",{originalErrorMessage:f?.message})}if(u.status!==200)throw wi.create("fetch-status-error",{httpStatus:u.status});let c;try{c=yield u.json()}catch(f){throw wi.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=c.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw wi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function Hx(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${jq}/projects/${n}/apps/${r}:${Bq}?key=${i}`,body:{debug_token:e}}}var qq="firebase-app-check-database",Gq=1,vw="firebase-app-check-store";var Kf=null;function zq(){return Kf||(Kf=new Promise((t,e)=>{try{let n=indexedDB.open(qq,Gq);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(wi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(vw,{keyPath:"compositeKey"})}}}catch(n){e(wi.create("storage-open",{originalErrorMessage:n?.message}))}}),Kf)}function Wq(t,e){return Kq(Qq(t),e)}function Kq(t,e){return _(this,null,function*(){let r=(yield zq()).transaction(vw,"readwrite"),s=r.objectStore(vw).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var c;a(wi.create("storage-set",{originalErrorMessage:(c=u.target.error)===null||c===void 0?void 0:c.message}))}})})}function Qq(t){return`${t.options.appId}-${t.name}`}var ww=new ni("@firebase/app-check");function yw(t,e){return Bd()?Wq(t,e).catch(n=>{ww.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function qx(){return jx().enabled}function Gx(){return _(this,null,function*(){let t=jx();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Yq={error:"UNKNOWN_ERROR"};function Zq(t){return jd.encodeString(JSON.stringify(t),!1)}function Ew(t,e=!1){return _(this,null,function*(){let n=t.app;Bx(n);let r=jn(n),i=r.token,s;if(i&&!Uc(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(Uc(u)?i=u:yield yw(n,void 0))}if(!e&&i&&Uc(i))return{token:i.token};let o=!1;if(qx()){r.exchangeTokenPromise||(r.exchangeTokenPromise=$x(Hx(n,yield Gx()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let u=yield r.exchangeTokenPromise;return yield yw(n,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield jn(n).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?ww.warn(u.message):ww.error(u),s=u}let a;return i?s?Uc(i)?a={token:i.token,internalError:s}:a=Vx(s):(a={token:i.token},r.token=i,yield yw(n,i)):a=Vx(s),o&&tG(n,a),a})}function Xq(t){return _(this,null,function*(){let e=t.app;Bx(e);let{provider:n}=jn(e);if(qx()){let r=yield Gx(),{token:i}=yield $x(Hx(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function Jq(t,e,n,r){let{app:i}=t,s=jn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Uc(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),Lx(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Lx(t))}function zx(t,e){let n=jn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function Lx(t){let{app:e}=t,n=jn(e),r=n.tokenRefresher;r||(r=eG(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function eG(t){let{app:e}=t;return new _w(()=>_(this,null,function*(){let n=jn(e),r;if(n.token?r=yield Ew(t,!0):r=yield Ew(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=jn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Fx.RETRIAL_MIN_WAIT,Fx.RETRIAL_MAX_WAIT)}function tG(t,e){let n=jn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Uc(t){return t.expireTimeMillis-Date.now()>0}function Vx(t){return{token:Zq(Yq),error:t}}var Iw=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=jn(this.app);for(let n of e)zx(this.app,n.next);return Promise.resolve()}};function nG(t,e){return new Iw(t,e)}function rG(t){return{getToken:e=>Ew(t,e),getLimitedUseToken:()=>Xq(t),addTokenListener:e=>Jq(t,"INTERNAL",e),removeTokenListener:e=>zx(t.app,e)}}var iG="@firebase/app-check",sG="0.8.3";var oG="app-check",Ux="app-check-internal";function aG(){Sr(new Lt(oG,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return nG(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(Ux).initialize()})),Sr(new Lt(Ux,t=>{let e=t.getProvider("app-check").getImmediate();return rG(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Ne(iG,sG)}aG();var uG=["localhost","0.0.0.0","127.0.0.1"],Qte=typeof window<"u"&&uG.includes(window.location.hostname);var cG="firebase",lG="10.11.1";st.registerVersion(cG,lG,"app-compat");var dG=["ngOnDestroy"],Kx=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(dG.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let u=a?.[s];return typeof u=="function"?u.bind(a):u?.then?u.then(c=>n.run(()=>c)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,c)=>o.then(l=>{let d=l?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,d),d})})})});var Qf=class{constructor(e){return e}},or=new N("angularfire2.app.options"),Ei=new N("angularfire2.app.name");function Fs(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=st.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>st.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;hG("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Qf(o)}var hG=(t,...e)=>{hv()&&typeof console<"u"&&console[t](...e)},fG={provide:Qf,useFactory:Fs,deps:[or,se,[new Ke,Ei]]},Qx=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:or,useValue:n},{provide:Ei,useValue:r}]}}constructor(n){st.registerVersion("angularfire",ft.full,"core"),st.registerVersion("angularfire",ft.full,"app-compat"),st.registerVersion("angular",pf.full,n.toString())}static \u0275fac=function(r){return new(r||t)(T(Mt))};static \u0275mod=Ve({type:t});static \u0275inj=Le({providers:[fG]})}return t})();function Ea(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return pG(i,o)||(Wx("error",`${e} was already initialized on the ${n} Firebase App with different settings.${gG?" You may need to reload as Firebase is not HMR aware.":""}`),Wx("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function pG(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var gG=typeof module<"u"&&!!module.hot,Wx=(t,...e)=>{hv()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var jc=new N("angularfire2.auth.use-emulator"),Bc=new N("angularfire2.auth.settings"),$c=new N("angularfire2.auth.tenant-id"),Hc=new N("angularfire2.auth.langugage-code"),qc=new N("angularfire2.auth.use-device-language"),Gc=new N("angularfire.auth.persistence"),zc=(t,e,n,r,i,s,o,a)=>Ea(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(let[c,l]of Object.entries(o))u.settings[c]=l;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]),Ls=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,c,l,d,h,f){let p=new Be,g=V(void 0).pipe(tn(o.outsideAngular),Oe(()=>s.runOutsideAngular(()=>import("./chunk-2WXAWWXN.js"))),F(()=>Fs(n,s,r)),F(m=>zc(m,s,a,c,l,d,u,h)),vh({bufferSize:1,refCount:!1}));if(Ss(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=V(null);else{g.pipe(mn()).subscribe();let m=g.pipe(Oe(C=>C.getRedirectResult().then(P=>P,()=>null)),He,vh({bufferSize:1,refCount:!1})),I=g.pipe(Oe(C=>new X(P=>({unsubscribe:s.runOutsideAngular(()=>C.onAuthStateChanged(j=>P.next(j),j=>P.error(j),()=>P.complete()))})))),R=g.pipe(Oe(C=>new X(P=>({unsubscribe:s.runOutsideAngular(()=>C.onIdTokenChanged(j=>P.next(j),j=>P.error(j),()=>P.complete()))}))));this.authState=m.pipe(wh(I),gn(o.outsideAngular),tn(o.insideAngular)),this.user=m.pipe(wh(R),gn(o.outsideAngular),tn(o.insideAngular)),this.idToken=this.user.pipe(Oe(C=>C?ye(C.getIdToken()):V(null))),this.idTokenResult=this.user.pipe(Oe(C=>C?ye(C.getIdTokenResult()):V(null))),this.credential=$o(m,p,this.authState.pipe(bt(C=>!C))).pipe(F(C=>C?.user?C:null),gn(o.outsideAngular),tn(o.insideAngular))}return Kx(this,g,s,{spy:{apply:(m,I,R)=>{(m.startsWith("signIn")||m.startsWith("createUser"))&&R.then(C=>p.next(C))}}})}static \u0275fac=function(r){return new(r||t)(T(or),T(Ei,8),T(Mt),T(se),T(Jt),T(jc,8),T(Bc,8),T($c,8),T(Hc,8),T(qc,8),T(Gc,8),T(Bt,8))};static \u0275prov=U({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),Yx=(()=>{class t{constructor(){st.registerVersion("angularfire",ft.full,"auth-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ve({type:t});static \u0275inj=Le({providers:[Ls]})}return t})();var Ii=(()=>{let e=class e{constructor(r){this.authF=r,this.userCredentials=null}register(r,i){return _(this,null,function*(){this.userCredentials=yield this.authF.createUserWithEmailAndPassword(r,i),console.log(this.userCredentials)})}login(r,i){this.authF.signInWithEmailAndPassword(r,i).then(s=>{this.imprimeHoraActual(),console.log("19"),this.userCredentials=s.user}).catch(s=>{this.imprimeHoraActual(),console.log("23"),console.error(s)}),this.imprimeHoraActual(),console.log("27"),console.log(this.userCredentials)}logout(){this.authF.signOut()}imprimeHoraActual(){let i=new Date().toLocaleTimeString();console.log(i)}};e.\u0275fac=function(i){return new(i||e)(T(Ls))},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Zx=(()=>{let e=class e{constructor(r,i){this.authF=r,this.router=i,this.userName="",this.password=""}manejarLogin(){this.authF.login(this.userName,this.password),setTimeout(()=>{this.router.navigate(["/home"])},3e3)}};e.\u0275fac=function(i){return new(i||e)(te(Ii),te(Ns))},e.\u0275cmp=En({type:e,selectors:[["app-login"]],standalone:!0,features:[Cn],decls:11,vars:2,consts:[[3,"ngSubmit"],[1,"form-group"],["for","username"],["type","text","id","username","name","username","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","password","name","password","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary"]],template:function(i,s){i&1&&(De(0,"form",0),rr("ngSubmit",function(){return s.manejarLogin()}),De(1,"div",1)(2,"label",2),$e(3,"Username:"),Se(),De(4,"input",3),Es("ngModelChange",function(a){return sa(s.userName,a)||(s.userName=a),a}),Se()(),De(5,"div",1)(6,"label",4),$e(7,"Password:"),Se(),De(8,"input",5),Es("ngModelChange",function(a){return sa(s.password,a)||(s.password=a),a}),Se()(),De(9,"button",6),$e(10,"Login"),Se()()),i&2&&(pi(4),ws("ngModel",s.userName),pi(4),ws("ngModel",s.password))},dependencies:[bs,_a,Gf,ya,$f,Hf,Vc,Lc,Fc]});let t=e;return t})();var Xx=(()=>{let e=class e{constructor(r,i){this.authF=r,this.router=i,this.authF.userCredentials==null&&this.redireccionar()}redireccionar(){this.router.navigate(["/login"])}};e.\u0275fac=function(i){return new(i||e)(te(Ii),te(Ns))},e.\u0275cmp=En({type:e,selectors:[["app-home"]],standalone:!0,features:[Cn],decls:2,vars:0,template:function(i,s){i&1&&(De(0,"h2"),$e(1,"Entrando al home"),Se())}});let t=e;return t})();var Jx=(()=>{let e=class e{constructor(r){this.authF=r,this.userName="",this.password=""}manejarRegistro(){this.authF.register(this.userName,this.password)}};e.\u0275fac=function(i){return new(i||e)(te(Ii))},e.\u0275cmp=En({type:e,selectors:[["app-register"]],standalone:!0,features:[Cn],decls:11,vars:2,consts:[[3,"ngSubmit"],[1,"form-group"],["for","username"],["type","text","id","username","name","username","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","password","name","password","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary"]],template:function(i,s){i&1&&(De(0,"form",0),rr("ngSubmit",function(){return s.manejarRegistro()}),De(1,"div",1)(2,"label",2),$e(3,"Username:"),Se(),De(4,"input",3),Es("ngModelChange",function(a){return sa(s.userName,a)||(s.userName=a),a}),Se()(),De(5,"div",1)(6,"label",4),$e(7,"Password:"),Se(),De(8,"input",5),Es("ngModelChange",function(a){return sa(s.password,a)||(s.password=a),a}),Se()(),De(9,"button",6),$e(10,"Registro"),Se()()),i&2&&(pi(4),ws("ngModel",s.userName),pi(4),ws("ngModel",s.password))},dependencies:[bs,_a,Gf,ya,$f,Hf,Vc,Lc,Fc]});let t=e;return t})();var eM=[{path:"login",component:Zx},{path:"home",component:Xx},{path:"quien-soy",component:hx},{path:"register",component:Jx}];var Zf={production:!1,firebase:{apiKey:"AIzaSyBodhRrppGG8S8bRC5rA4ae1-t-4w9CLeo",authDomain:"dattilodamian-saladejuegos-sp2.firebaseapp.com",databaseURL:"https://dattilodamian-saladejuegos-sp2.firebaseapp.com",projectId:"dattilodamian-saladejuegos-sp2",storageBucket:"dattilodamian-saladejuegos-sp2.appspot.com",messagingSenderId:"988028569182",appId:"1:988028569182:web:3a7a599b5bd4c4a78dd6cf"}};var tM="@firebase/database",nM="1.0.4";var FE="";function LE(t){FE=t}var Nw=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Xe(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Hd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var Pw=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return fn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var PM=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Nw(e)}}catch{}return new Pw},Us=PM("localStorage"),kw=PM("sessionStorage");var Ta=new ni("@firebase/database"),kM=function(){let t=1;return function(){return t++}}(),OM=function(t){let e=Jb(t),n=new Xb;n.update(e);let r=n.digest();return jd.encodeByteArray(r)},ml=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=ml.apply(null,r):typeof r=="object"?e+=Xe(r):e+=r,e+=" "}return e},js=null,rM=!0,FM=function(t,e){D(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Ta.logLevel=pn.VERBOSE,js=Ta.log.bind(Ta),e&&kw.set("logging_enabled",!0)):typeof t=="function"?js=t:(js=null,kw.remove("logging_enabled"))},pt=function(...t){if(rM===!0&&(rM=!1,js===null&&kw.get("logging_enabled")===!0&&FM(!0)),js){let e=ml.apply(null,t);js(e)}},yl=function(t){return function(...e){pt(t,...e)}},Ow=function(...t){let e="FIREBASE INTERNAL ERROR: "+ml(...t);Ta.error(e)},cr=function(...t){let e=`FIREBASE FATAL ERROR: ${ml(...t)}`;throw Ta.error(e),new Error(e)},Nt=function(...t){let e="FIREBASE WARNING: "+ml(...t);Ta.warn(e)},mG=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Nt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Tp=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},yG=function(t){if(Qn()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},bi="[MIN_NAME]",Br="[MAX_NAME]",$s=function(t,e){if(t===e)return 0;if(t===bi||e===Br)return-1;if(e===bi||t===Br)return 1;{let n=iM(t),r=iM(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},_G=function(t,e){return t===e?0:t<e?-1:1},Wc=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Xe(e))},VE=function(t){if(typeof t!="object"||t===null)return Xe(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Xe(e[r]),n+=":",n+=VE(t[e[r]]);return n+="}",n},LM=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function gt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var VM=function(t){D(!Tp(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,u;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let c=[];for(u=n;u;u-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();let l=c.join(""),d="";for(u=0;u<64;u+=8){let h=parseInt(l.substr(u,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},vG=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},wG=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function EG(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var IG=new RegExp("^-?(0*)\\d{1,10}$"),CG=-2147483648,DG=2147483647,iM=function(t){if(IG.test(t)){let e=Number(t);if(e>=CG&&e<=DG)return e}return null},ka=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Nt("Exception was thrown by user callback.",n),e},Math.floor(0))}},TG=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Zc=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var Fw=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Nt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Lw=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(pt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Nt(e)}},Xc=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Jf="5",UM="v",jM="s",BM="r",$M="f",HM=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,qM="ls",GM="p",Vw="ac",zM="websocket",WM="long_polling";var ep=class{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Us.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Us.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function bG(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function KM(t,e,n){D(typeof e=="string","typeof type must == string"),D(typeof n=="object","typeof params must == object");let r;if(e===zM)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===WM)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);bG(t)&&(n.ns=t.namespace);let i=[];return gt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var Uw=class{constructor(){this.counters_={}}incrementCounter(e,n=1){fn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return zb(this.counters_)}};var Tw={},bw={};function UE(t){let e=t.toString();return Tw[e]||(Tw[e]=new Uw),Tw[e]}function SG(t,e){let n=t.toString();return bw[n]||(bw[n]=e()),bw[n]}var jw=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&ka(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var sM="start",AG="close",RG="pLPCommand",xG="pRTLPCB",QM="id",YM="pw",ZM="ser",MG="cb",NG="seg",PG="ts",kG="d",OG="dframe",XM=1870,JM=30,FG=XM-JM,LG=25e3,VG=3e4,nl=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=yl(e),this.stats_=UE(n),this.urlFn=u=>(this.appCheckToken&&(u[Vw]=this.appCheckToken),KM(n,WM,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new jw(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(VG)),yG(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Bw((...s)=>{let[o,a,u,c,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===sM)this.id=a,this.password=u;else if(o===AG)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[sM]="t",r[ZM]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[MG]=this.scriptTagHolder.uniqueCallbackIdentifier),r[UM]=Jf,this.transportSessionId&&(r[jM]=this.transportSessionId),this.lastSessionId&&(r[qM]=this.lastSessionId),this.applicationId&&(r[GM]=this.applicationId),this.appCheckToken&&(r[Vw]=this.appCheckToken),typeof location<"u"&&location.hostname&&HM.test(location.hostname)&&(r[BM]=$M);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return Qn()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!vG()&&!wG()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=Xe(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=Gb(n),i=LM(r,FG);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(Qn())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[OG]="t",r[QM]=e,r[YM]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=Xe(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},Bw=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Qn())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=kM(),window[RG+this.uniqueCallbackIdentifier]=e,window[xG+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){pt("frame writing exception"),a.stack&&pt(a.stack),pt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||pt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[QM]=this.myID,e[YM]=this.myPW,e[ZM]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+JM+r.length<=XM;){let o=this.pendingSegs.shift();r=r+"&"+NG+i+"="+o.seg+"&"+PG+i+"="+o.ts+"&"+kG+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(LG)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){Qn()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{pt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var UG=16384,jG=45e3,tp=null;typeof MozWebSocket<"u"?tp=MozWebSocket:typeof WebSocket<"u"&&(tp=WebSocket);var Ca=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=yl(this.connId),this.stats_=UE(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[UM]=Jf,!Qn()&&typeof location<"u"&&location.hostname&&HM.test(location.hostname)&&(a[BM]=$M),r&&(a[jM]=r),i&&(a[qM]=i),s&&(a[Vw]=s),o&&(a[GM]=o),KM(n,zM,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Us.set("previous_websocket_failure",!0);try{let i;if(Qn()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Jf}/${FE}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new tp(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&tp!==null&&!t.forceDisallow_}static previouslyFailed(){return Us.isInMemoryStorage||Us.get("previous_websocket_failure")===!0}markConnectionHealthy(){Us.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Hd(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(D(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=Xe(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=LM(r,UG);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(jG))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),eN=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[nl,Ca]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Ca&&Ca.isAvailable(),i=r&&!Ca.previouslyFailed();if(n.webSocketOnly&&(r||Nt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ca];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),BG=6e4,$G=5e3,HG=10*1024,qG=100*1024,Sw="t",oM="d",GG="s",aM="r",zG="e",uM="o",cM="a",lM="n",dM="p",WG="h",$w=class{constructor(e,n,r,i,s,o,a,u,c,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=yl("c:"+this.id+":"),this.transportManager_=new eN(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Zc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>qG?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>HG?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Sw in e){let n=e[Sw];n===cM?this.upgradeIfSecondaryHealthy_():n===aM?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===uM&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Wc("t",e),r=Wc("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:dM,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:cM,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:lM,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Wc("t",e),r=Wc("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Wc(Sw,e);if(oM in e){let r=e[oM];if(n===WG){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===lM){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===GG?this.onConnectionShutdown_(r):n===aM?this.onReset_(r):n===zG?Ow("Server Error: "+r):n===uM?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ow("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Jf!==r&&Nt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Zc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(BG))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Zc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor($G))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:dM,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Us.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var np=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var rp=class{constructor(e){this.allowedEvents_=e,this.listeners_={},D(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){D(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var ip=class t extends rp{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Ym()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return D(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var hM=32,fM=768,pe=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function fe(){return new pe("")}function ne(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Si(t){return t.pieces_.length-t.pieceNum_}function Te(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new pe(t.pieces_,e)}function jE(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function KG(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function rl(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function tN(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new pe(e,0)}function Pe(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof pe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new pe(n,0)}function re(t){return t.pieceNum_>=t.pieces_.length}function $t(t,e){let n=ne(t),r=ne(e);if(n===null)return e;if(n===r)return $t(Te(t),Te(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function QG(t,e){let n=rl(t,0),r=rl(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=$s(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function BE(t,e){if(Si(t)!==Si(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function bn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Si(t)>Si(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var Hw=class{constructor(e,n){this.errorPrefix_=n,this.parts_=rl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Fu(this.parts_[r]);nN(this)}};function YG(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Fu(e),nN(t)}function ZG(t){let e=t.parts_.pop();t.byteLength_-=Fu(e),t.parts_.length>0&&(t.byteLength_-=1)}function nN(t){if(t.byteLength_>fM)throw new Error(t.errorPrefix_+"has a key path longer than "+fM+" bytes ("+t.byteLength_+").");if(t.parts_.length>hM)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+hM+") or object contains a cycle "+Vs(t))}function Vs(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var qw=class t extends rp{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return D(e==="visible","Unknown event type: "+e),[this.visible_]}};var Kc=1e3,XG=60*5*1e3,pM=30*1e3,JG=1.3,e4=3e4,t4="server_kill",gM=3,$E=(()=>{class t extends np{constructor(n,r,i,s,o,a,u,c){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=yl("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Kc,this.maxReconnectDelay_=XG,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!Qn())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");qw.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&ip.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(Xe(o)),D(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new dt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let u=a.d;a.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),D(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,u=>{let c=u.d,l=u.s;t.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,c))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&fn(n,"w")){let i=ti(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Nt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||Yb(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=pM)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=Qb(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Xe(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):Ow("Unrecognized action received from server: "+Xe(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){D(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Kc,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Kc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>e4&&(this.reconnectDelay_=Kc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*JG)}this.onConnectStatus_(!1)}establishConnection_(){return _(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,u=null,c=function(){u?u.close():(a=!0,i())},l=function(h){D(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(h)};this.realtime_={close:c,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?pt("getToken() completed but was canceled"):(pt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,u=new $w(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{Nt(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(t4)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&Nt(h),c())}}})}interrupt(n){pt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){pt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],qd(this.interruptReasons_)&&(this.reconnectDelay_=Kc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>VE(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new pe(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){pt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=gM&&(this.reconnectDelay_=pM,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){pt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=gM&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";Qn()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+FE.replace(/\./g,"-")]=1,Ym()?n["framework.cordova"]=1:Wb()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=ip.getInstance().currentlyOnline();return qd(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),oe=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var ba=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new oe(bi,e),i=new oe(bi,n);return this.compare(r,i)!==0}minPost(){return oe.MIN}};var Xf,sp=class extends ba{static get __EMPTY_NODE(){return Xf}static set __EMPTY_NODE(e){Xf=e}compare(e,n){return $s(e.name,n.name)}isDefinedOn(e){throw bo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return oe.MIN}maxPost(){return new oe(Br,Xf)}makePost(e,n){return D(typeof e=="string","KeyIndex indexValue must always be a string."),new oe(e,Xf)}toString(){return".key"}},ur=new sp;var Da=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Bn=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Sn.EMPTY_NODE,this.right=o??Sn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Sn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Sn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),Gw=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new Bn(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Sn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Bn.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Bn.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Da(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Da(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Da(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Da(this.root_,null,this.comparator_,!0,e)}};Sn.EMPTY_NODE=new Gw;function n4(t,e){return $s(t.name,e.name)}function HE(t,e){return $s(t,e)}var zw;function r4(t){zw=t}var rN=function(t){return typeof t=="number"?"number:"+VM(t):"string:"+t},iN=function(t){if(t.isLeafNode()){let e=t.val();D(typeof e=="string"||typeof e=="number"||typeof e=="object"&&fn(e,".sv"),"Priority must be a string or number.")}else D(t===zw||t.isEmpty(),"priority of unexpected type.");D(t===zw||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var mM,Sa=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,D(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),iN(this.priorityNode_)}static set __childrenNodeConstructor(n){mM=n}static get __childrenNodeConstructor(){return mM}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return re(n)?this:ne(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=ne(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(D(i!==".priority"||Si(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Te(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+rN(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=VM(this.value_):n+=this.value_,this.lazyHash_=OM(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(D(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return D(s>=0,"Unknown leaf type: "+r),D(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),sN,oN;function i4(t){sN=t}function s4(t){oN=t}var Ww=class extends ba{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?$s(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return oe.MIN}maxPost(){return new oe(Br,new Sa("[PRIORITY-POST]",oN))}makePost(e,n){let r=sN(e);return new oe(n,new Sa("[PRIORITY-POST]",r))}toString(){return".priority"}},Ae=new Ww;var o4=Math.log(2),Kw=class{constructor(e){let n=s=>parseInt(Math.log(s)/o4,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},op=function(t,e,n,r){t.sort(e);let i=function(u,c){let l=c-u,d,h;if(l===0)return null;if(l===1)return d=t[u],h=n?n(d):d,new Bn(h,d.node,Bn.BLACK,null,null);{let f=parseInt(l/2,10)+u,p=i(u,f),g=i(f+1,c);return d=t[f],h=n?n(d):d,new Bn(h,d.node,Bn.BLACK,p,g)}},s=function(u){let c=null,l=null,d=t.length,h=function(p,g){let m=d-p,I=d;d-=p;let R=i(m+1,I),C=t[m],P=n?n(C):C;f(new Bn(P,C.node,g,null,R))},f=function(p){c?(c.left=p,c=p):(l=p,c=p)};for(let p=0;p<u.count;++p){let g=u.nextBitIsOne(),m=Math.pow(2,u.count-(p+1));g?h(m,Bn.BLACK):(h(m,Bn.BLACK),h(m,Bn.RED))}return l},o=new Kw(t.length),a=s(o);return new Sn(r||e,a)};var Aw,Ia={},Aa=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return D(Ia&&Ae,"ChildrenNode.ts has not been loaded"),Aw=Aw||new t({".priority":Ia},{".priority":Ae}),Aw}get(e){let n=ti(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Sn?n:null}hasIndex(e){return fn(this.indexSet_,e.toString())}addIndex(e,n){D(e!==ur,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(oe.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=op(r,e.getCompare()):a=Ia;let u=e.toString(),c=Object.assign({},this.indexSet_);c[u]=e;let l=Object.assign({},this.indexes_);return l[u]=a,new t(l,c)}addToIndexes(e,n){let r=Ou(this.indexes_,(i,s)=>{let o=ti(this.indexSet_,s);if(D(o,"Missing index implementation for "+s),i===Ia)if(o.isDefinedOn(e.node)){let a=[],u=n.getIterator(oe.Wrap),c=u.getNext();for(;c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),op(a,o.getCompare())}else return Ia;else{let a=n.get(e.name),u=i;return a&&(u=u.remove(new oe(e.name,a))),u.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=Ou(this.indexes_,i=>{if(i===Ia)return i;{let s=n.get(e.name);return s?i.remove(new oe(e.name,s)):i}});return new t(r,this.indexSet_)}};var Qc,Q=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&iN(this.priorityNode_),this.children_.isEmpty()&&D(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Qc||(Qc=new t(new Sn(HE),null,Aa.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Qc}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Qc:r}}getChild(n){let r=ne(n);return r===null?this:this.getImmediateChild(r).getChild(Te(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(D(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new oe(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Qc:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=ne(n);if(i===null)return r;{D(ne(n)!==".priority"||Si(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Te(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Ae,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let u in r)a[u]=r[u];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+rN(this.getPriority().val())+":"),this.forEachChild(Ae,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":OM(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new oe(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new oe(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new oe(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,oe.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,oe.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===_l?-1:0}withIndex(n){if(n===ur||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===ur||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Ae),s=r.getIterator(Ae),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===ur?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),Qw=class extends Q{constructor(){super(new Sn(HE),Q.EMPTY_NODE,Aa.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Q.EMPTY_NODE}isEmpty(){return!1}},_l=new Qw;Object.defineProperties(oe,{MIN:{value:new oe(bi,Q.EMPTY_NODE)},MAX:{value:new oe(Br,_l)}});sp.__EMPTY_NODE=Q.EMPTY_NODE;Sa.__childrenNodeConstructor=Q;r4(_l);s4(_l);var a4=!0;function Ue(t,e=null){if(t===null)return Q.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),D(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Sa(n,Ue(e))}if(!(t instanceof Array)&&a4){let n=[],r=!1;if(gt(t,(o,a)=>{if(o.substring(0,1)!=="."){let u=Ue(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new oe(o,u)))}}),n.length===0)return Q.EMPTY_NODE;let s=op(n,n4,o=>o.name,HE);if(r){let o=op(n,Ae.getCompare());return new Q(s,Ue(e),new Aa({".priority":o},{".priority":Ae}))}else return new Q(s,Ue(e),Aa.Default)}else{let n=Q.EMPTY_NODE;return gt(t,(r,i)=>{if(fn(t,r)&&r.substring(0,1)!=="."){let s=Ue(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Ue(e))}}i4(Ue);var il=class extends ba{constructor(e){super(),this.indexPath_=e,D(!re(e)&&ne(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?$s(e.name,n.name):s}makePost(e,n){let r=Ue(e),i=Q.EMPTY_NODE.updateChild(this.indexPath_,r);return new oe(n,i)}maxPost(){let e=Q.EMPTY_NODE.updateChild(this.indexPath_,_l);return new oe(Br,e)}toString(){return rl(this.indexPath_,0).join("/")}};var Yw=class extends ba{compare(e,n){let r=e.node.compareTo(n.node);return r===0?$s(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return oe.MIN}maxPost(){return oe.MAX}makePost(e,n){let r=Ue(e);return new oe(n,r)}toString(){return".value"}},qE=new Yw;function aN(t){return{type:"value",snapshotNode:t}}function Ra(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function sl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function ol(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function u4(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var al=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){D(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(sl(n,a)):D(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ra(n,r)):o.trackChildChange(ol(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ae,(i,s)=>{n.hasChild(i)||r.trackChildChange(sl(i,s))}),n.isLeafNode()||n.forEachChild(Ae,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(ol(i,s,o))}else r.trackChildChange(Ra(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?Q.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var ap=class t{constructor(e){this.indexedFilter_=new al(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new oe(n,r))||(r=Q.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=Q.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(Q.EMPTY_NODE);let s=this;return n.forEachChild(Ae,(o,a)=>{s.matches(new oe(o,a))||(i=i.updateImmediateChild(o,Q.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var Zw=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new ap(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new oe(n,r))||(r=Q.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=Q.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=Q.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(Q.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,Q.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;D(a.numChildren()===this.limit_,"");let u=new oe(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,u);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(ol(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(sl(n,d));let g=a.updateImmediateChild(n,Q.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Ra(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:l&&o(c,u)>=0?(s!=null&&(s.trackChildChange(sl(c.name,c.node)),s.trackChildChange(Ra(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,Q.EMPTY_NODE)):e}};var ul=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ae}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return D(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return D(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:bi}hasEnd(){return this.endSet_}getIndexEndValue(){return D(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return D(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Br}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return D(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ae}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function c4(t){return t.loadsAllData()?new al(t.getIndex()):t.hasLimit()?new Zw(t):new ap(t)}function l4(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function d4(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Xw(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function h4(t,e,n){let r;return t.index_===ur||n?r=Xw(t,e,n):r=Xw(t,e,Br),r.startAfterSet_=!0,r}function Jw(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function f4(t,e,n){let r;return t.index_===ur||n?r=Jw(t,e,n):r=Jw(t,e,bi),r.endBeforeSet_=!0,r}function bp(t,e){let n=t.copy();return n.index_=e,n}function yM(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Ae?n="$priority":t.index_===qE?n="$value":t.index_===ur?n="$key":(D(t.index_ instanceof il,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Xe(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=Xe(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Xe(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Xe(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Xe(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function _M(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ae&&(e.i=t.index_.toString()),e}var eE=class t extends np{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=yl("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(D(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let u=yM(e._queryParams);this.restRequest_(s+".json",u,(c,l)=>{let d=l;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,r),ti(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=yM(e._queryParams),r=e._path.toString(),i=new dt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Zb(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=Hd(a.responseText)}catch{Nt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&Nt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var tE=class{constructor(){this.rootNode_=Q.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function up(){return{value:null,children:new Map}}function Oa(t,e,n){if(re(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=ne(e);t.children.has(r)||t.children.set(r,up());let i=t.children.get(r);e=Te(e),Oa(i,e,n)}}function nE(t,e){if(re(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Ae,(r,i)=>{Oa(t,new pe(r),i)}),nE(t,e)}}else if(t.children.size>0){let n=ne(e);return e=Te(e),t.children.has(n)&&nE(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function rE(t,e,n){t.value!==null?n(e,t.value):p4(t,(r,i)=>{let s=new pe(e.toString()+"/"+r);rE(i,s,n)})}function p4(t,e){t.children.forEach((n,r)=>{e(r,n)})}var iE=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&gt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var vM=10*1e3,g4=30*1e3,m4=5*60*1e3,sE=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new iE(e);let r=vM+(g4-vM)*Math.random();Zc(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;gt(e,(i,s)=>{s>0&&fn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Zc(this.reportStats_.bind(this),Math.floor(Math.random()*2*m4))}};var ar=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(ar||{});function GE(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function zE(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function WE(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var oE=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=ar.ACK_USER_WRITE,this.source=GE()}operationForChild(e){if(re(this.path)){if(this.affectedTree.value!=null)return D(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new pe(e));return new t(fe(),n,this.revert)}}else return D(ne(this.path)===e,"operationForChild called for unrelated child."),new t(Te(this.path),this.affectedTree,this.revert)}};var cp=class t{constructor(e,n){this.source=e,this.path=n,this.type=ar.LISTEN_COMPLETE}operationForChild(e){return re(this.path)?new t(this.source,fe()):new t(this.source,Te(this.path))}};var xa=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=ar.OVERWRITE}operationForChild(e){return re(this.path)?new t(this.source,fe(),this.snap.getImmediateChild(e)):new t(this.source,Te(this.path),this.snap)}};var cl=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=ar.MERGE}operationForChild(e){if(re(this.path)){let n=this.children.subtree(new pe(e));return n.isEmpty()?null:n.value?new xa(this.source,fe(),n.value):new t(this.source,fe(),n)}else return D(ne(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Te(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var lr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(re(e))return this.isFullyInitialized()&&!this.filtered_;let n=ne(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var aE=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function y4(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(u4(o.childName,o.snapshotNode))}),Yc(t,i,"child_removed",e,r,n),Yc(t,i,"child_added",e,r,n),Yc(t,i,"child_moved",s,r,n),Yc(t,i,"child_changed",e,r,n),Yc(t,i,"value",e,r,n),i}function Yc(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,u)=>v4(t,a,u)),o.forEach(a=>{let u=_4(t,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(u,t.query_))})})}function _4(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function v4(t,e,n){if(e.childName==null||n.childName==null)throw bo("Should only compare child_ events.");let r=new oe(e.childName,e.snapshotNode),i=new oe(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function Sp(t,e){return{eventCache:t,serverCache:e}}function Jc(t,e,n,r){return Sp(new lr(e,n,r),t.serverCache)}function uN(t,e,n,r){return Sp(t.eventCache,new lr(e,n,r))}function lp(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Bs(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var Rw,w4=()=>(Rw||(Rw=new Sn(_G)),Rw),Ht=class t{constructor(e,n=w4()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return gt(e,(r,i)=>{n=n.set(new pe(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:fe(),value:this.value};if(re(e))return null;{let r=ne(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Te(e),n);return s!=null?{path:Pe(new pe(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(re(e))return this;{let n=ne(e),r=this.children.get(n);return r!==null?r.subtree(Te(e)):new t(null)}}set(e,n){if(re(e))return new t(n,this.children);{let r=ne(e),s=(this.children.get(r)||new t(null)).set(Te(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(re(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=ne(e),r=this.children.get(n);if(r){let i=r.remove(Te(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(re(e))return this.value;{let n=ne(e),r=this.children.get(n);return r?r.get(Te(e)):null}}setTree(e,n){if(re(e))return n;{let r=ne(e),s=(this.children.get(r)||new t(null)).setTree(Te(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(fe(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Pe(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,fe(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(re(e))return null;{let s=ne(e),o=this.children.get(s);return o?o.findOnPath_(Te(e),Pe(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,fe(),n)}foreachOnPath_(e,n,r){if(re(e))return this;{this.value&&r(n,this.value);let i=ne(e),s=this.children.get(i);return s?s.foreachOnPath_(Te(e),Pe(n,i),r):new t(null)}}foreach(e){this.foreach_(fe(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Pe(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var $n=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Ht(null))}};function el(t,e,n){if(re(e))return new $n(new Ht(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=$t(i,e);return s=s.updateChild(o,n),new $n(t.writeTree_.set(i,s))}else{let i=new Ht(n),s=t.writeTree_.setTree(e,i);return new $n(s)}}}function uE(t,e,n){let r=t;return gt(n,(i,s)=>{r=el(r,Pe(e,i),s)}),r}function wM(t,e){if(re(e))return $n.empty();{let n=t.writeTree_.setTree(e,new Ht(null));return new $n(n)}}function cE(t,e){return Hs(t,e)!=null}function Hs(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild($t(n.path,e)):null}function EM(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ae,(r,i)=>{e.push(new oe(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new oe(r,i.value))}),e}function Di(t,e){if(re(e))return t;{let n=Hs(t,e);return n!=null?new $n(new Ht(n)):new $n(t.writeTree_.subtree(e))}}function lE(t){return t.writeTree_.isEmpty()}function Ma(t,e){return cN(fe(),t.writeTree_,e)}function cN(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(D(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=cN(Pe(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Pe(t,".priority"),r)),n}}function Ap(t,e){return fN(e,t)}function E4(t,e,n,r,i){D(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=el(t.visibleWrites,e,n)),t.lastWriteId=r}function I4(t,e,n,r){D(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=uE(t.visibleWrites,e,n),t.lastWriteId=r}function C4(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function D4(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);D(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&T4(a,r.path)?i=!1:bn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return b4(t),!0;if(r.snap)t.visibleWrites=wM(t.visibleWrites,r.path);else{let a=r.children;gt(a,u=>{t.visibleWrites=wM(t.visibleWrites,Pe(r.path,u))})}return!0}else return!1}function T4(t,e){if(t.snap)return bn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&bn(Pe(t.path,n),e))return!0;return!1}function b4(t){t.visibleWrites=lN(t.allWrites,S4,fe()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function S4(t){return t.visible}function lN(t,e,n){let r=$n.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)bn(n,o)?(a=$t(n,o),r=el(r,a,s.snap)):bn(o,n)&&(a=$t(o,n),r=el(r,fe(),s.snap.getChild(a)));else if(s.children){if(bn(n,o))a=$t(n,o),r=uE(r,a,s.children);else if(bn(o,n))if(a=$t(o,n),re(a))r=uE(r,fe(),s.children);else{let u=ti(s.children,ne(a));if(u){let c=u.getChild(Te(a));r=el(r,fe(),c)}}}else throw bo("WriteRecord should have .snap or .children")}}return r}function dN(t,e,n,r,i){if(!r&&!i){let s=Hs(t.visibleWrites,e);if(s!=null)return s;{let o=Di(t.visibleWrites,e);if(lE(o))return n;if(n==null&&!cE(o,fe()))return null;{let a=n||Q.EMPTY_NODE;return Ma(o,a)}}}else{let s=Di(t.visibleWrites,e);if(!i&&lE(s))return n;if(!i&&n==null&&!cE(s,fe()))return null;{let o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(bn(c.path,e)||bn(e,c.path))},a=lN(t.allWrites,o,e),u=n||Q.EMPTY_NODE;return Ma(a,u)}}}function A4(t,e,n){let r=Q.EMPTY_NODE,i=Hs(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ae,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=Di(t.visibleWrites,e);return n.forEachChild(Ae,(o,a)=>{let u=Ma(Di(s,new pe(o)),a);r=r.updateImmediateChild(o,u)}),EM(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Di(t.visibleWrites,e);return EM(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function R4(t,e,n,r,i){D(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Pe(e,n);if(cE(t.visibleWrites,s))return null;{let o=Di(t.visibleWrites,s);return lE(o)?i.getChild(n):Ma(o,i.getChild(n))}}function x4(t,e,n,r){let i=Pe(e,n),s=Hs(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=Di(t.visibleWrites,i);return Ma(o,r.getNode().getImmediateChild(n))}else return null}function M4(t,e){return Hs(t.visibleWrites,e)}function N4(t,e,n,r,i,s,o){let a,u=Di(t.visibleWrites,e),c=Hs(u,fe());if(c!=null)a=c;else if(n!=null)a=Ma(u,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function P4(){return{visibleWrites:$n.empty(),allWrites:[],lastWriteId:-1}}function dp(t,e,n,r){return dN(t.writeTree,t.treePath,e,n,r)}function KE(t,e){return A4(t.writeTree,t.treePath,e)}function IM(t,e,n,r){return R4(t.writeTree,t.treePath,e,n,r)}function hp(t,e){return M4(t.writeTree,Pe(t.treePath,e))}function k4(t,e,n,r,i,s){return N4(t.writeTree,t.treePath,e,n,r,i,s)}function QE(t,e,n){return x4(t.writeTree,t.treePath,e,n)}function hN(t,e){return fN(Pe(t.treePath,e),t.writeTree)}function fN(t,e){return{treePath:t,writeTree:e}}var dE=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;D(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),D(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,ol(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,sl(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Ra(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,ol(r,e.snapshotNode,i.oldSnap));else throw bo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var hE=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},pN=new hE,ll=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new lr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return QE(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Bs(this.viewCache_),s=k4(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function O4(t){return{filter:t}}function F4(t,e){D(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),D(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function L4(t,e,n,r,i){let s=new dE,o,a;if(n.type===ar.OVERWRITE){let c=n;c.source.fromUser?o=fE(t,e,c.path,c.snap,r,i,s):(D(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!re(c.path),o=fp(t,e,c.path,c.snap,r,i,a,s))}else if(n.type===ar.MERGE){let c=n;c.source.fromUser?o=U4(t,e,c.path,c.children,r,i,s):(D(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=pE(t,e,c.path,c.children,r,i,a,s))}else if(n.type===ar.ACK_USER_WRITE){let c=n;c.revert?o=$4(t,e,c.path,r,i,s):o=j4(t,e,c.path,c.affectedTree,r,i,s)}else if(n.type===ar.LISTEN_COMPLETE)o=B4(t,e,n.path,r,s);else throw bo("Unknown operation type: "+n.type);let u=s.getChanges();return V4(e,o,u),{viewCache:o,changes:u}}function V4(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=lp(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(aN(lp(e)))}}function gN(t,e,n,r,i,s){let o=e.eventCache;if(hp(r,n)!=null)return e;{let a,u;if(re(n))if(D(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=Bs(e),l=c instanceof Q?c:Q.EMPTY_NODE,d=KE(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=dp(r,Bs(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=ne(n);if(c===".priority"){D(Si(n)===1,"Can't have a priority with additional path components");let l=o.getNode();u=e.serverCache.getNode();let d=IM(r,n,l,u);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=Te(n),d;if(o.isCompleteForChild(c)){u=e.serverCache.getNode();let h=IM(r,n,o.getNode(),u);h!=null?d=o.getNode().getImmediateChild(c).updateChild(l,h):d=o.getNode().getImmediateChild(c)}else d=QE(r,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,l,i,s):a=o.getNode()}}return Jc(e,a,o.isFullyInitialized()||re(n),t.filter.filtersNodes())}}function fp(t,e,n,r,i,s,o,a){let u=e.serverCache,c,l=o?t.filter:t.filter.getIndexedFilter();if(re(n))c=l.updateFullNode(u.getNode(),r,null);else if(l.filtersNodes()&&!u.isFiltered()){let f=u.getNode().updateChild(n,r);c=l.updateFullNode(u.getNode(),f,null)}else{let f=ne(n);if(!u.isCompleteForPath(n)&&Si(n)>1)return e;let p=Te(n),m=u.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?c=l.updatePriority(u.getNode(),m):c=l.updateChild(u.getNode(),f,m,p,pN,null)}let d=uN(e,c,u.isFullyInitialized()||re(n),l.filtersNodes()),h=new ll(i,d,s);return gN(t,d,n,i,h,a)}function fE(t,e,n,r,i,s,o){let a=e.eventCache,u,c,l=new ll(i,e,s);if(re(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=Jc(e,c,!0,t.filter.filtersNodes());else{let d=ne(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),u=Jc(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=Te(n),f=a.getNode().getImmediateChild(d),p;if(re(h))p=r;else{let g=l.getCompleteChild(d);g!=null?jE(h)===".priority"&&g.getChild(tN(h)).isEmpty()?p=g:p=g.updateChild(h,r):p=Q.EMPTY_NODE}if(f.equals(p))u=e;else{let g=t.filter.updateChild(a.getNode(),d,p,h,l,o);u=Jc(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function CM(t,e){return t.eventCache.isCompleteForChild(e)}function U4(t,e,n,r,i,s,o){let a=e;return r.foreach((u,c)=>{let l=Pe(n,u);CM(e,ne(l))&&(a=fE(t,a,l,c,i,s,o))}),r.foreach((u,c)=>{let l=Pe(n,u);CM(e,ne(l))||(a=fE(t,a,l,c,i,s,o))}),a}function DM(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function pE(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,c;re(n)?c=r:c=new Ht(null).setTree(n,r);let l=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=DM(t,f,h);u=fp(t,u,new pe(d),p,i,s,o,a)}}),c.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),g=DM(t,p,h);u=fp(t,u,new pe(d),g,i,s,o,a)}}),u}function j4(t,e,n,r,i,s,o){if(hp(i,n)!=null)return e;let a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(re(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return fp(t,e,n,u.getNode().getChild(n),i,s,a,o);if(re(n)){let c=new Ht(null);return u.getNode().forEachChild(ur,(l,d)=>{c=c.set(new pe(l),d)}),pE(t,e,n,c,i,s,a,o)}else return e}else{let c=new Ht(null);return r.foreach((l,d)=>{let h=Pe(n,l);u.isCompleteForPath(h)&&(c=c.set(l,u.getNode().getChild(h)))}),pE(t,e,n,c,i,s,a,o)}}function B4(t,e,n,r,i){let s=e.serverCache,o=uN(e,s.getNode(),s.isFullyInitialized()||re(n),s.isFiltered());return gN(t,o,n,r,pN,i)}function $4(t,e,n,r,i,s){let o;if(hp(r,n)!=null)return e;{let a=new ll(r,e,i),u=e.eventCache.getNode(),c;if(re(n)||ne(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=dp(r,Bs(e));else{let d=e.serverCache.getNode();D(d instanceof Q,"serverChildren would be complete if leaf node"),l=KE(r,d)}l=l,c=t.filter.updateFullNode(u,l,s)}else{let l=ne(n),d=QE(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=u.getImmediateChild(l)),d!=null?c=t.filter.updateChild(u,l,d,Te(n),a,s):e.eventCache.getNode().hasChild(l)?c=t.filter.updateChild(u,l,Q.EMPTY_NODE,Te(n),a,s):c=u,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=dp(r,Bs(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||hp(r,fe())!=null,Jc(e,c,o,t.filter.filtersNodes())}}var gE=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new al(r.getIndex()),s=c4(r);this.processor_=O4(s);let o=n.serverCache,a=n.eventCache,u=i.updateFullNode(Q.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(Q.EMPTY_NODE,a.getNode(),null),l=new lr(u,o.isFullyInitialized(),i.filtersNodes()),d=new lr(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Sp(d,l),this.eventGenerator_=new aE(this.query_)}get query(){return this.query_}};function H4(t){return t.viewCache_.serverCache.getNode()}function q4(t){return lp(t.viewCache_)}function G4(t,e){let n=Bs(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!re(e)&&!n.getImmediateChild(ne(e)).isEmpty())?n.getChild(e):null}function TM(t){return t.eventRegistrations_.length===0}function z4(t,e){t.eventRegistrations_.push(e)}function bM(t,e,n){let r=[];if(n){D(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function SM(t,e,n,r){e.type===ar.MERGE&&e.source.queryId!==null&&(D(Bs(t.viewCache_),"We should always have a full cache before handling merges"),D(lp(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=L4(t.processor_,i,e,n,r);return F4(t.processor_,s.viewCache),D(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,mN(t,s.changes,s.viewCache.eventCache.getNode(),null)}function W4(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ae,(s,o)=>{r.push(Ra(s,o))}),n.isFullyInitialized()&&r.push(aN(n.getNode())),mN(t,r,n.getNode(),e)}function mN(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return y4(t.eventGenerator_,e,n,i)}var pp,gp=class{constructor(){this.views=new Map}};function K4(t){D(!pp,"__referenceConstructor has already been defined"),pp=t}function Q4(){return D(pp,"Reference.ts has not been loaded"),pp}function Y4(t){return t.views.size===0}function YE(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return D(s!=null,"SyncTree gave us an op for an invalid query."),SM(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(SM(o,e,n,r));return s}}function yN(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=dp(n,i?r:null),u=!1;a?u=!0:r instanceof Q?(a=KE(n,r),u=!1):(a=Q.EMPTY_NODE,u=!1);let c=Sp(new lr(a,u,!1),new lr(r,i,!1));return new gE(e,c)}return o}function Z4(t,e,n,r,i,s){let o=yN(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),z4(o,n),W4(o,n)}function X4(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=Ai(t);if(i==="default")for(let[u,c]of t.views.entries())o=o.concat(bM(c,n,r)),TM(c)&&(t.views.delete(u),c.query._queryParams.loadsAllData()||s.push(c.query));else{let u=t.views.get(i);u&&(o=o.concat(bM(u,n,r)),TM(u)&&(t.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!Ai(t)&&s.push(new(Q4())(e._repo,e._path)),{removed:s,events:o}}function _N(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Ti(t,e){let n=null;for(let r of t.views.values())n=n||G4(r,e);return n}function vN(t,e){if(e._queryParams.loadsAllData())return Rp(t);{let r=e._queryIdentifier;return t.views.get(r)}}function wN(t,e){return vN(t,e)!=null}function Ai(t){return Rp(t)!=null}function Rp(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var mp;function J4(t){D(!mp,"__referenceConstructor has already been defined"),mp=t}function ez(){return D(mp,"Reference.ts has not been loaded"),mp}var tz=1,yp=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ht(null),this.pendingWriteTree_=P4(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function ZE(t,e,n,r,i){return E4(t.pendingWriteTree_,e,n,r,i),i?Fa(t,new xa(GE(),e,n)):[]}function nz(t,e,n,r){I4(t.pendingWriteTree_,e,n,r);let i=Ht.fromObject(n);return Fa(t,new cl(GE(),e,i))}function Ci(t,e,n=!1){let r=C4(t.pendingWriteTree_,e);if(D4(t.pendingWriteTree_,e)){let s=new Ht(null);return r.snap!=null?s=s.set(fe(),!0):gt(r.children,o=>{s=s.set(new pe(o),!0)}),Fa(t,new oE(r.path,s,n))}else return[]}function vl(t,e,n){return Fa(t,new xa(zE(),e,n))}function rz(t,e,n){let r=Ht.fromObject(n);return Fa(t,new cl(zE(),e,r))}function iz(t,e){return Fa(t,new cp(zE(),e))}function sz(t,e,n){let r=XE(t,n);if(r){let i=JE(r),s=i.path,o=i.queryId,a=$t(s,e),u=new cp(WE(o),a);return eI(t,s,u)}else return[]}function _p(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||wN(o,e))){let u=X4(o,e,n,r);Y4(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=u.removed;if(a=u.events,!i){let l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>Ai(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=uz(h);for(let p=0;p<f.length;++p){let g=f[p],m=g.query,I=DN(t,g);t.listenProvider_.startListening(tl(m),dl(t,m),I.hashFn,I.onComplete)}}}!d&&c.length>0&&!r&&(l?t.listenProvider_.stopListening(tl(e),null):c.forEach(h=>{let f=t.queryToTagMap.get(Mp(h));t.listenProvider_.stopListening(tl(h),f)}))}cz(t,c)}return a}function EN(t,e,n,r){let i=XE(t,r);if(i!=null){let s=JE(i),o=s.path,a=s.queryId,u=$t(o,e),c=new xa(WE(a),u,n);return eI(t,o,c)}else return[]}function oz(t,e,n,r){let i=XE(t,r);if(i){let s=JE(i),o=s.path,a=s.queryId,u=$t(o,e),c=Ht.fromObject(n),l=new cl(WE(a),u,c);return eI(t,o,l)}else return[]}function mE(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=$t(h,i);s=s||Ti(f,p),o=o||Ai(f)});let a=t.syncPointTree_.get(i);a?(o=o||Ai(a),s=s||Ti(a,fe())):(a=new gp,t.syncPointTree_=t.syncPointTree_.set(i,a));let u;s!=null?u=!0:(u=!1,s=Q.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let g=Ti(p,fe());g&&(s=s.updateImmediateChild(f,g))}));let c=wN(a,e);if(!c&&!e._queryParams.loadsAllData()){let h=Mp(e);D(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=lz();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=Ap(t.pendingWriteTree_,i),d=Z4(a,e,n,l,s,u);if(!c&&!o&&!r){let h=vN(a,e);d=d.concat(dz(t,e,h))}return d}function xp(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let u=$t(o,e),c=Ti(a,u);if(c)return c});return dN(i,e,s,n,!0)}function az(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(c,l)=>{let d=$t(c,n);r=r||Ti(l,d)});let i=t.syncPointTree_.get(n);i?r=r||Ti(i,fe()):(i=new gp,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new lr(r,!0,!1):null,a=Ap(t.pendingWriteTree_,e._path),u=yN(i,e,a,s?o.getNode():Q.EMPTY_NODE,s);return q4(u)}function Fa(t,e){return IN(e,t.syncPointTree_,null,Ap(t.pendingWriteTree_,fe()))}function IN(t,e,n,r){if(re(t.path))return CN(t,e,n,r);{let i=e.get(fe());n==null&&i!=null&&(n=Ti(i,fe()));let s=[],o=ne(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){let c=n?n.getImmediateChild(o):null,l=hN(r,o);s=s.concat(IN(a,u,c,l))}return i&&(s=s.concat(YE(i,t,r,n))),s}}function CN(t,e,n,r){let i=e.get(fe());n==null&&i!=null&&(n=Ti(i,fe()));let s=[];return e.children.inorderTraversal((o,a)=>{let u=n?n.getImmediateChild(o):null,c=hN(r,o),l=t.operationForChild(o);l&&(s=s.concat(CN(l,a,u,c)))}),i&&(s=s.concat(YE(i,t,r,n))),s}function DN(t,e){let n=e.query,r=dl(t,n);return{hashFn:()=>(H4(e)||Q.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?sz(t,n._path,r):iz(t,n._path);{let s=EG(i,n);return _p(t,n,null,s)}}}}function dl(t,e){let n=Mp(e);return t.queryToTagMap.get(n)}function Mp(t){return t._path.toString()+"$"+t._queryIdentifier}function XE(t,e){return t.tagToQueryMap.get(e)}function JE(t){let e=t.indexOf("$");return D(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new pe(t.substr(0,e))}}function eI(t,e,n){let r=t.syncPointTree_.get(e);D(r,"Missing sync point for query tag that we're tracking");let i=Ap(t.pendingWriteTree_,e);return YE(r,n,i,null)}function uz(t){return t.fold((e,n,r)=>{if(n&&Ai(n))return[Rp(n)];{let i=[];return n&&(i=_N(n)),gt(r,(s,o)=>{i=i.concat(o)}),i}})}function tl(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(ez())(t._repo,t._path):t}function cz(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=Mp(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function lz(){return tz++}function dz(t,e,n){let r=e._path,i=dl(t,e),s=DN(t,n),o=t.listenProvider_.startListening(tl(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)D(!Ai(a.value),"If we're adding a query, it shouldn't be shadowed");else{let u=a.fold((c,l,d)=>{if(!re(c)&&l&&Ai(l))return[Rp(l).query];{let h=[];return l&&(h=h.concat(_N(l).map(f=>f.query))),gt(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<u.length;++c){let l=u[c];t.listenProvider_.stopListening(tl(l),dl(t,l))}}return o}var yE=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},_E=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Pe(this.path_,e);return new t(this.syncTree_,n)}node(){return xp(this.syncTree_,this.path_)}},hz=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},AM=function(t,e,n){if(!t||typeof t!="object")return t;if(D(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return fz(t[".sv"],e,n);if(typeof t[".sv"]=="object")return pz(t[".sv"],e);D(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},fz=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:D(!1,"Unexpected server value: "+t)}},pz=function(t,e,n){t.hasOwnProperty("increment")||D(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&D(!1,"Unexpected increment value: "+r);let i=e.node();if(D(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},TN=function(t,e,n,r){return nI(e,new _E(n,t),r)},tI=function(t,e,n){return nI(t,new yE(e),n)};function nI(t,e,n){let r=t.getPriority().val(),i=AM(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=AM(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Sa(a,Ue(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Sa(i))),o.forEachChild(Ae,(a,u)=>{let c=nI(u,e.getImmediateChild(a),n);c!==u&&(s=s.updateImmediateChild(a,c))}),s}}var hl=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function Np(t,e){let n=e instanceof pe?e:new pe(e),r=t,i=ne(n);for(;i!==null;){let s=ti(r.node.children,i)||{children:{},childCount:0};r=new hl(i,r,s),n=Te(n),i=ne(n)}return r}function qs(t){return t.node.value}function rI(t,e){t.node.value=e,vE(t)}function bN(t){return t.node.childCount>0}function gz(t){return qs(t)===void 0&&!bN(t)}function Pp(t,e){gt(t.node.children,(n,r)=>{e(new hl(n,t,r))})}function SN(t,e,n,r){n&&!r&&e(t),Pp(t,i=>{SN(i,e,!0,r)}),n&&r&&e(t)}function mz(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function wl(t){return new pe(t.parent===null?t.name:wl(t.parent)+"/"+t.name)}function vE(t){t.parent!==null&&yz(t.parent,t.name,t)}function yz(t,e,n){let r=gz(n),i=fn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,vE(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,vE(t))}var _z=/[\[\].#$\/\u0000-\u001F\u007F]/,vz=/[\[\].#$\u0000-\u001F\u007F]/,xw=10*1024*1024,kp=function(t){return typeof t=="string"&&t.length!==0&&!_z.test(t)},AN=function(t){return typeof t=="string"&&t.length!==0&&!vz.test(t)},wz=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),AN(t)},fl=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Tp(t)||t&&typeof t=="object"&&fn(t,".sv")},dr=function(t,e,n,r){r&&e===void 0||El(Qt(t,"value"),e,n)},El=function(t,e,n){let r=n instanceof pe?new Hw(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Vs(r));if(typeof e=="function")throw new Error(t+"contains a function "+Vs(r)+" with contents = "+e.toString());if(Tp(e))throw new Error(t+"contains "+e.toString()+" "+Vs(r));if(typeof e=="string"&&e.length>xw/3&&Fu(e)>xw)throw new Error(t+"contains a string greater than "+xw+" utf8 bytes "+Vs(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(gt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!kp(o)))throw new Error(t+" contains an invalid key ("+o+") "+Vs(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);YG(r,o),El(t,a,r),ZG(r)}),i&&s)throw new Error(t+' contains ".value" child '+Vs(r)+" in addition to actual children.")}},Ez=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=rl(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!kp(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(QG);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&bn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},RN=function(t,e,n,r){if(r&&e===void 0)return;let i=Qt(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];gt(e,(o,a)=>{let u=new pe(o);if(El(i,a,Pe(n,u)),jE(u)===".priority"&&!fl(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),Ez(i,s)},iI=function(t,e,n){if(!(n&&e===void 0)){if(Tp(e))throw new Error(Qt(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!fl(e))throw new Error(Qt(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Il=function(t,e,n,r){if(!(r&&n===void 0)&&!kp(n))throw new Error(Qt(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},La=function(t,e,n,r){if(!(r&&n===void 0)&&!AN(n))throw new Error(Qt(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Iz=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),La(t,e,n,r)},on=function(t,e){if(ne(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},xN=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!kp(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!wz(n))throw new Error(Qt(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var wE=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Op(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!BE(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function MN(t,e,n){Op(t,n),NN(t,r=>BE(r,e))}function an(t,e,n){Op(t,n),NN(t,r=>bn(r,e)||bn(e,r))}function NN(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(Cz(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Cz(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();js&&pt("event: "+n.toString()),ka(r)}}}var PN="repo_interrupt",Dz=25,EE=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new wE,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=up(),this.transactionQueueTree_=new hl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function Tz(t,e,n){if(t.stats_=UE(t.repoInfo_),t.forceRestClient_||TG())t.server_=new eE(t.repoInfo_,(r,i,s,o)=>{RM(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>xM(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Xe(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new $E(t.repoInfo_,e,(r,i,s,o)=>{RM(t,r,i,s,o)},r=>{xM(t,r)},r=>{bz(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=SG(t.repoInfo_,()=>new sE(t.stats_,t.server_)),t.infoData_=new tE,t.infoSyncTree_=new yp({startListening:(r,i,s,o)=>{let a=[],u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=vl(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),sI(t,"connected",!1),t.serverSyncTree_=new yp({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{let c=o(a,u);an(t.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function kN(t){let n=t.infoData_.getNode(new pe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Cl(t){return hz({timestamp:kN(t)})}function RM(t,e,n,r,i){t.dataUpdateCount++;let s=new pe(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let u=Ou(n,c=>Ue(c));o=oz(t.serverSyncTree_,s,u,i)}else{let u=Ue(n);o=EN(t.serverSyncTree_,s,u,i)}else if(r){let u=Ou(n,c=>Ue(c));o=rz(t.serverSyncTree_,s,u)}else{let u=Ue(n);o=vl(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=Na(t,s)),an(t.eventQueue_,a,o)}function xM(t,e){sI(t,"connected",e),e===!1&&Rz(t)}function bz(t,e){gt(e,(n,r)=>{sI(t,n,r)})}function sI(t,e,n){let r=new pe("/.info/"+e),i=Ue(n);t.infoData_.updateSnapshot(r,i);let s=vl(t.infoSyncTree_,r,i);an(t.eventQueue_,r,s)}function Fp(t){return t.nextWriteId_++}function Sz(t,e,n){let r=az(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=Ue(i).withIndex(e._queryParams.getIndex());mE(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=vl(t.serverSyncTree_,e._path,s);else{let a=dl(t.serverSyncTree_,e);o=EN(t.serverSyncTree_,e._path,s,a)}return an(t.eventQueue_,e._path,o),_p(t.serverSyncTree_,e,n,null,!0),s},i=>(Va(t,"get for query "+Xe(e)+" failed: "+i),Promise.reject(new Error(i))))}function oI(t,e,n,r,i){Va(t,"set",{path:e.toString(),value:n,priority:r});let s=Cl(t),o=Ue(n,r),a=xp(t.serverSyncTree_,e),u=tI(o,a,s),c=Fp(t),l=ZE(t.serverSyncTree_,e,u,c,!0);Op(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||Nt("set at "+e+" failed: "+h);let g=Ci(t.serverSyncTree_,c,!p);an(t.eventQueue_,e,g),Ri(t,i,h,f)});let d=uI(t,e);Na(t,d),an(t.eventQueue_,d,[])}function Az(t,e,n,r){Va(t,"update",{path:e.toString(),value:n});let i=!0,s=Cl(t),o={};if(gt(n,(a,u)=>{i=!1,o[a]=TN(Pe(e,a),Ue(u),t.serverSyncTree_,s)}),i)pt("update() called with empty data.  Don't do anything."),Ri(t,r,"ok",void 0);else{let a=Fp(t),u=nz(t.serverSyncTree_,e,o,a);Op(t.eventQueue_,u),t.server_.merge(e.toString(),n,(c,l)=>{let d=c==="ok";d||Nt("update at "+e+" failed: "+c);let h=Ci(t.serverSyncTree_,a,!d),f=h.length>0?Na(t,e):e;an(t.eventQueue_,f,h),Ri(t,r,c,l)}),gt(n,c=>{let l=uI(t,Pe(e,c));Na(t,l)}),an(t.eventQueue_,e,[])}}function Rz(t){Va(t,"onDisconnectEvents");let e=Cl(t),n=up();rE(t.onDisconnect_,fe(),(i,s)=>{let o=TN(i,s,t.serverSyncTree_,e);Oa(n,i,o)});let r=[];rE(n,fe(),(i,s)=>{r=r.concat(vl(t.serverSyncTree_,i,s));let o=uI(t,i);Na(t,o)}),t.onDisconnect_=up(),an(t.eventQueue_,fe(),r)}function xz(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&nE(t.onDisconnect_,e),Ri(t,n,r,i)})}function MM(t,e,n,r){let i=Ue(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Oa(t.onDisconnect_,e,i),Ri(t,r,s,o)})}function Mz(t,e,n,r,i){let s=Ue(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Oa(t.onDisconnect_,e,s),Ri(t,i,o,a)})}function Nz(t,e,n,r){if(qd(n)){pt("onDisconnect().update() called with empty data.  Don't do anything."),Ri(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&gt(n,(o,a)=>{let u=Ue(a);Oa(t.onDisconnect_,Pe(e,o),u)}),Ri(t,r,i,s)})}function Pz(t,e,n){let r;ne(e._path)===".info"?r=mE(t.infoSyncTree_,e,n):r=mE(t.serverSyncTree_,e,n),MN(t.eventQueue_,e._path,r)}function IE(t,e,n){let r;ne(e._path)===".info"?r=_p(t.infoSyncTree_,e,n):r=_p(t.serverSyncTree_,e,n),MN(t.eventQueue_,e._path,r)}function ON(t){t.persistentConnection_&&t.persistentConnection_.interrupt(PN)}function kz(t){t.persistentConnection_&&t.persistentConnection_.resume(PN)}function Va(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),pt(n,...e)}function Ri(t,e,n,r){e&&ka(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function Oz(t,e,n,r,i,s){Va(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:kM(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=aI(t,e,void 0);o.currentInputSnapshot=a;let u=o.update(a.val());if(u===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{El("transaction failed: Data returned ",u,o.path),o.status=0;let c=Np(t.transactionQueueTree_,e),l=qs(c)||[];l.push(o),rI(c,l);let d;typeof u=="object"&&u!==null&&fn(u,".priority")?(d=ti(u,".priority"),D(fl(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(xp(t.serverSyncTree_,e)||Q.EMPTY_NODE).getPriority().val();let h=Cl(t),f=Ue(u,d),p=tI(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Fp(t);let g=ZE(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);an(t.eventQueue_,e,g),Lp(t,t.transactionQueueTree_)}}function aI(t,e,n){return xp(t.serverSyncTree_,e,n)||Q.EMPTY_NODE}function Lp(t,e=t.transactionQueueTree_){if(e||Vp(t,e),qs(e)){let n=LN(t,e);D(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&Fz(t,wl(e),n)}else bN(e)&&Pp(e,n=>{Lp(t,n)})}function Fz(t,e,n){let r=n.map(c=>c.currentWriteId),i=aI(t,e,r),s=i,o=i.hash();for(let c=0;c<n.length;c++){let l=n[c];D(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=$t(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),u=e;t.server_.put(u.toString(),a,c=>{Va(t,"transaction put response",{path:u.toString(),status:c});let l=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat(Ci(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Vp(t,Np(t.transactionQueueTree_,e)),Lp(t,t.transactionQueueTree_),an(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)ka(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Nt("transaction at "+u.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}Na(t,e)}},o)}function Na(t,e){let n=FN(t,e),r=wl(n),i=LN(t,n);return Lz(t,i,r),r}function Lz(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let u=e[a],c=$t(n,u.path),l=!1,d;if(D(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)l=!0,d=u.abortReason,i=i.concat(Ci(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=Dz)l=!0,d="maxretry",i=i.concat(Ci(t.serverSyncTree_,u.currentWriteId,!0));else{let h=aI(t,u.path,o);u.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){El("transaction failed: Data returned ",f,u.path);let p=Ue(f);typeof f=="object"&&f!=null&&fn(f,".priority")||(p=p.updatePriority(h.getPriority()));let m=u.currentWriteId,I=Cl(t),R=tI(p,h,I);u.currentOutputSnapshotRaw=p,u.currentOutputSnapshotResolved=R,u.currentWriteId=Fp(t),o.splice(o.indexOf(m),1),i=i.concat(ZE(t.serverSyncTree_,u.path,R,u.currentWriteId,u.applyLocally)),i=i.concat(Ci(t.serverSyncTree_,m,!0))}else l=!0,d="nodata",i=i.concat(Ci(t.serverSyncTree_,u.currentWriteId,!0))}an(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}Vp(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)ka(r[a]);Lp(t,t.transactionQueueTree_)}function FN(t,e){let n,r=t.transactionQueueTree_;for(n=ne(e);n!==null&&qs(r)===void 0;)r=Np(r,n),e=Te(e),n=ne(e);return r}function LN(t,e){let n=[];return VN(t,e,n),n.sort((r,i)=>r.order-i.order),n}function VN(t,e,n){let r=qs(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Pp(e,i=>{VN(t,i,n)})}function Vp(t,e){let n=qs(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,rI(e,n.length>0?n:void 0)}Pp(e,r=>{Vp(t,r)})}function uI(t,e){let n=wl(FN(t,e)),r=Np(t.transactionQueueTree_,e);return mz(r,i=>{Mw(t,i)}),Mw(t,r),SN(r,i=>{Mw(t,i)}),n}function Mw(t,e){let n=qs(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(D(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(D(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Ci(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?rI(e,void 0):n.length=s+1,an(t.eventQueue_,wl(e),i);for(let o=0;o<r.length;o++)ka(r[o])}}function Vz(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function Uz(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Nt(`Invalid query segment '${n}' in query '${t}'`)}return e}var CE=function(t,e){let n=jz(t),r=n.namespace;n.domain==="firebase.com"&&cr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&cr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||mG();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new ep(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new pe(n.pathString)}},jz=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=Vz(t.substring(l,d)));let h=Uz(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var NM="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Bz=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=NM.charAt(n%64),n=Math.floor(n/64);D(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=NM.charAt(e[i]);return D(o.length===20,"nextPushId: Length should be 20."),o}}();var vp=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Xe(this.snapshot.exportVal())}},wp=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var pl=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return D(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Ep=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new dt;return xz(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){on("OnDisconnect.remove",this._path);let e=new dt;return MM(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){on("OnDisconnect.set",this._path),dr("OnDisconnect.set",e,this._path,!1);let n=new dt;return MM(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){on("OnDisconnect.setWithPriority",this._path),dr("OnDisconnect.setWithPriority",e,this._path,!1),iI("OnDisconnect.setWithPriority",n,!1);let r=new dt;return Mz(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){on("OnDisconnect.update",this._path),RN("OnDisconnect.update",e,this._path,!1);let n=new dt;return Nz(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var qt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return re(this._path)?null:jE(this._path)}get ref(){return new un(this._repo,this._path)}get _queryIdentifier(){let e=_M(this._queryParams),n=VE(e);return n==="{}"?"default":n}get _queryObject(){return _M(this._queryParams)}isEqual(e){if(e=ee(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=BE(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+KG(this._path)}};function Up(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Mi(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===ur){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==bi)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Br)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Ae){if(e!=null&&!fl(e)||n!=null&&!fl(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(D(t.getIndex()instanceof il||t.getIndex()===qE,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function jp(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var un=class t extends qt{constructor(e,n){super(e,n,new ul,!1)}get parent(){let e=tN(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Pa=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new pe(e),r=xi(this.ref,e);return new t(this._node.getChild(n),r,Ae)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,xi(this.ref,r),Ae)))}hasChild(e){let n=new pe(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function cI(t,e){return t=ee(t),t._checkNotDeleted("ref"),e!==void 0?xi(t._root,e):t._root}function lI(t,e){t=ee(t),t._checkNotDeleted("refFromURL");let n=CE(e,t._repo.repoInfo_.nodeAdmin);xN("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&cr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),cI(t,n.path.toString())}function xi(t,e){return t=ee(t),ne(t._path)===null?Iz("child","path",e,!1):La("child","path",e,!1),new un(t._repo,Pe(t._path,e))}function UN(t,e){t=ee(t),on("push",t._path),dr("push",e,t._path,!0);let n=kN(t._repo),r=Bz(n),i=xi(t,r),s=xi(t,r),o;return e!=null?o=Bp(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function jN(t){return on("remove",t._path),Bp(t,null)}function Bp(t,e){t=ee(t),on("set",t._path),dr("set",e,t._path,!1);let n=new dt;return oI(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function BN(t,e){t=ee(t),on("setPriority",t._path),iI("setPriority",e,!1);let n=new dt;return oI(t._repo,Pe(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function $N(t,e,n){if(on("setWithPriority",t._path),dr("setWithPriority",e,t._path,!1),iI("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new dt;return oI(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function HN(t,e){RN("update",e,t._path,!1);let n=new dt;return Az(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function qN(t){t=ee(t);let e=new pl(()=>{}),n=new gl(e);return Sz(t._repo,t,n).then(r=>new Pa(r,new un(t._repo,t._path),t._queryParams.getIndex()))}var gl=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new vp("value",this,new Pa(e.snapshotNode,new un(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new wp(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Ip=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new wp(this,e,n):null}createEvent(e,n){D(e.childName!=null,"Child events should have a childName.");let r=xi(new un(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new vp(e.type,this,new Pa(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Dl(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let u=n,c=(l,d)=>{IE(t._repo,t,a),u(l,d)};c.userCallback=n.userCallback,c.context=n.context,n=c}let o=new pl(n,s||void 0),a=e==="value"?new gl(o):new Ip(e,o);return Pz(t._repo,t,a),()=>IE(t._repo,t,a)}function $p(t,e,n,r){return Dl(t,"value",e,n,r)}function dI(t,e,n,r){return Dl(t,"child_added",e,n,r)}function hI(t,e,n,r){return Dl(t,"child_changed",e,n,r)}function fI(t,e,n,r){return Dl(t,"child_moved",e,n,r)}function pI(t,e,n,r){return Dl(t,"child_removed",e,n,r)}function gI(t,e,n){let r=null,i=n?new pl(n):null;e==="value"?r=new gl(i):e&&(r=new Ip(e,i)),IE(t._repo,t,r)}var cn=class{},Cp=class extends cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){dr("endAt",this._value,e._path,!0);let n=Jw(e._queryParams,this._value,this._key);if(jp(n),Mi(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new qt(e._repo,e._path,n,e._orderByCalled)}};function GN(t,e){return Il("endAt","key",e,!0),new Cp(t,e)}var DE=class extends cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){dr("endBefore",this._value,e._path,!1);let n=f4(e._queryParams,this._value,this._key);if(jp(n),Mi(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new qt(e._repo,e._path,n,e._orderByCalled)}};function zN(t,e){return Il("endBefore","key",e,!0),new DE(t,e)}var Dp=class extends cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){dr("startAt",this._value,e._path,!0);let n=Xw(e._queryParams,this._value,this._key);if(jp(n),Mi(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new qt(e._repo,e._path,n,e._orderByCalled)}};function WN(t=null,e){return Il("startAt","key",e,!0),new Dp(t,e)}var TE=class extends cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){dr("startAfter",this._value,e._path,!1);let n=h4(e._queryParams,this._value,this._key);if(jp(n),Mi(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new qt(e._repo,e._path,n,e._orderByCalled)}};function KN(t,e){return Il("startAfter","key",e,!0),new TE(t,e)}var bE=class extends cn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new qt(e._repo,e._path,l4(e._queryParams,this._limit),e._orderByCalled)}};function QN(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new bE(t)}var SE=class extends cn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new qt(e._repo,e._path,d4(e._queryParams,this._limit),e._orderByCalled)}};function YN(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new SE(t)}var AE=class extends cn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Up(e,"orderByChild");let n=new pe(this._path);if(re(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new il(n),i=bp(e._queryParams,r);return Mi(i),new qt(e._repo,e._path,i,!0)}};function ZN(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return La("orderByChild","path",t,!1),new AE(t)}var RE=class extends cn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Up(e,"orderByKey");let n=bp(e._queryParams,ur);return Mi(n),new qt(e._repo,e._path,n,!0)}};function XN(){return new RE}var xE=class extends cn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Up(e,"orderByPriority");let n=bp(e._queryParams,Ae);return Mi(n),new qt(e._repo,e._path,n,!0)}};function JN(){return new xE}var ME=class extends cn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Up(e,"orderByValue");let n=bp(e._queryParams,qE);return Mi(n),new qt(e._repo,e._path,n,!0)}};function eP(){return new ME}var NE=class extends cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(dr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Cp(this._value,this._key)._apply(new Dp(this._value,this._key)._apply(e))}};function tP(t,e){return Il("equalTo","key",e,!0),new NE(t,e)}function An(t,...e){let n=ee(t);for(let r of e)n=r._apply(n);return n}K4(un);J4(un);var $z="FIREBASE_DATABASE_EMULATOR_HOST",PE={},Hz=!1;function qz(t,e,n,r){t.repoInfo_=new ep(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function mI(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||cr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),pt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=CE(s,i),a=o.repoInfo,u,c;typeof process<"u"&&process.env&&(c=process.env[$z]),c?(u=!0,s=`http://${c}?ns=${a.namespace}`,o=CE(s,i),a=o.repoInfo):u=!o.repoInfo.secure;let l=i&&u?new Xc(Xc.OWNER):new Lw(t.name,t.options,e);xN("Invalid Firebase Database URL",o),re(o.path)||cr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=zz(a,t,l,new Fw(t.name,n));return new kE(d,t)}function Gz(t,e){let n=PE[e];(!n||n[t.key]!==t)&&cr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),ON(t),delete n[t.key]}function zz(t,e,n,r){let i=PE[e.name];i||(i={},PE[e.name]=i);let s=i[t.toURLString()];return s&&cr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new EE(t,Hz,n,r),i[t.toURLString()]=s,s}var kE=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Tz(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new un(this._repo,fe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Gz(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&cr("Cannot call "+e+" on a deleted database.")}};function nP(){eN.IS_TRANSPORT_INITIALIZED&&Nt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function rP(){nP(),nl.forceDisallow()}function iP(){nP(),Ca.forceDisallow(),nl.forceAllow()}function sP(t,e,n,r={}){t=ee(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&cr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&cr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Xc(Xc.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:So(r.mockUserToken,t.app.options.projectId);s=new Xc(o)}qz(i,e,n,s)}function oP(t){t=ee(t),t._checkNotDeleted("goOffline"),ON(t._repo)}function aP(t){t=ee(t),t._checkNotDeleted("goOnline"),kz(t._repo)}function uP(t,e){FM(t,e)}function Wz(t){LE(Ro),Sr(new Lt("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return mI(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Ne(tM,nM,t),Ne(tM,nM,"esm2017")}var Kz={".sv":"timestamp"};function cP(){return Kz}function lP(t){return{".sv":{increment:t}}}var OE=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function dP(t,e,n){var r;if(t=ee(t),on("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new dt,o=(u,c,l)=>{let d=null;u?s.reject(u):(d=new Pa(l,new un(t._repo,t._path),Ae),s.resolve(new OE(c,d)))},a=$p(t,()=>{});return Oz(t._repo,t._path,e,o,a,i),s.promise}$E.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};$E.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Wz();var Qz="@firebase/database-compat",Yz="1.0.4";var Zz=new ni("@firebase/database-compat"),hP=function(t){let e="FIREBASE WARNING: "+t;Zz.warn(e)};var Xz=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(Qt(t,e)+"must be a boolean.")},Jz=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Qt(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var yI=class{constructor(e){this._delegate=e}cancel(e){B("OnDisconnect.cancel",0,1,arguments.length),it("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){B("OnDisconnect.remove",0,1,arguments.length),it("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){B("OnDisconnect.set",1,2,arguments.length),it("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){B("OnDisconnect.setWithPriority",2,3,arguments.length),it("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(B("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,hP("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}it("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var _I=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return B("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Gs=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return B("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return B("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return B("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return B("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return B("DataSnapshot.child",0,1,arguments.length),e=String(e),La("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return B("DataSnapshot.hasChild",1,1,arguments.length),La("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return B("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return B("DataSnapshot.forEach",1,1,arguments.length),it("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return B("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return B("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return B("DataSnapshot.ref",0,0,arguments.length),new $r(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Hp=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;B("Query.on",2,4,arguments.length),it("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(c,l)=>{n.call(o.context,new Gs(this.database,c),l)};a.userCallback=n,a.context=o.context;let u=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return $p(this._delegate,a,u),n;case"child_added":return dI(this._delegate,a,u),n;case"child_removed":return pI(this._delegate,a,u),n;case"child_changed":return hI(this._delegate,a,u),n;case"child_moved":return fI(this._delegate,a,u),n;default:throw new Error(Qt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(B("Query.off",0,3,arguments.length),Jz("Query.off",e,!0),it("Query.off","callback",n,!0),Jm("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,gI(this._delegate,e,i)}else gI(this._delegate,e)}get(){return qN(this._delegate).then(e=>new Gs(this.database,e))}once(e,n,r,i){B("Query.once",1,4,arguments.length),it("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new dt,a=(c,l)=>{let d=new Gs(this.database,c);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let u=c=>{s.cancel&&s.cancel.call(s.context,c),o.reject(c)};switch(e){case"value":$p(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":dI(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":pI(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":hI(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":fI(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error(Qt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return B("Query.limitToFirst",1,1,arguments.length),new t(this.database,An(this._delegate,QN(e)))}limitToLast(e){return B("Query.limitToLast",1,1,arguments.length),new t(this.database,An(this._delegate,YN(e)))}orderByChild(e){return B("Query.orderByChild",1,1,arguments.length),new t(this.database,An(this._delegate,ZN(e)))}orderByKey(){return B("Query.orderByKey",0,0,arguments.length),new t(this.database,An(this._delegate,XN()))}orderByPriority(){return B("Query.orderByPriority",0,0,arguments.length),new t(this.database,An(this._delegate,JN()))}orderByValue(){return B("Query.orderByValue",0,0,arguments.length),new t(this.database,An(this._delegate,eP()))}startAt(e=null,n){return B("Query.startAt",0,2,arguments.length),new t(this.database,An(this._delegate,WN(e,n)))}startAfter(e=null,n){return B("Query.startAfter",0,2,arguments.length),new t(this.database,An(this._delegate,KN(e,n)))}endAt(e=null,n){return B("Query.endAt",0,2,arguments.length),new t(this.database,An(this._delegate,GN(e,n)))}endBefore(e=null,n){return B("Query.endBefore",0,2,arguments.length),new t(this.database,An(this._delegate,zN(e,n)))}equalTo(e,n){return B("Query.equalTo",1,2,arguments.length),new t(this.database,An(this._delegate,tP(e,n)))}toString(){return B("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return B("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(B("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,it(e,"cancel",i.cancel,!0),i.context=r,Jm(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(Qt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new $r(this.database,new un(this._delegate._repo,this._delegate._path))}},$r=class t extends Hp{constructor(e,n){super(e,new qt(n._repo,n._path,new ul,!1)),this.database=e,this._delegate=n}getKey(){return B("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return B("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,xi(this._delegate,e))}getParent(){B("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return B("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){B("Reference.set",1,2,arguments.length),it("Reference.set","onComplete",n,!0);let r=Bp(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(B("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,hP("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}on("Reference.update",this._delegate._path),it("Reference.update","onComplete",n,!0);let r=HN(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){B("Reference.setWithPriority",2,3,arguments.length),it("Reference.setWithPriority","onComplete",r,!0);let i=$N(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){B("Reference.remove",0,1,arguments.length),it("Reference.remove","onComplete",e,!0);let n=jN(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){B("Reference.transaction",1,3,arguments.length),it("Reference.transaction","transactionUpdate",e,!1),it("Reference.transaction","onComplete",n,!0),Xz("Reference.transaction","applyLocally",r,!0);let i=dP(this._delegate,e,{applyLocally:r}).then(s=>new _I(s.committed,new Gs(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){B("Reference.setPriority",1,2,arguments.length),it("Reference.setPriority","onComplete",n,!0);let r=BN(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){B("Reference.push",0,2,arguments.length),it("Reference.push","onComplete",n,!0);let r=UN(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return on("Reference.onDisconnect",this._delegate._path),new yI(new Ep(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var zs=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:rP,forceLongPolling:iP}}useEmulator(e,n,r={}){sP(this._delegate,e,n,r)}ref(e){if(B("database.ref",0,1,arguments.length),e instanceof $r){let n=lI(this._delegate,e.toString());return new $r(this,n)}else{let n=cI(this._delegate,e);return new $r(this,n)}}refFromURL(e){B("database.refFromURL",1,1,arguments.length);let r=lI(this._delegate,e);return new $r(this,r)}goOffline(){return B("database.goOffline",0,0,arguments.length),oP(this._delegate)}goOnline(){return B("database.goOnline",0,0,arguments.length),aP(this._delegate)}};zs.ServerValue={TIMESTAMP:cP(),increment:t=>lP(t)};function eW({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){LE(n);let a=new ey("database-standalone"),u=new Gd("auth-internal",a);u.setComponent(new Lt("auth-internal",()=>r,"PRIVATE"));let c;return i&&(c=new Gd("app-check-internal",a),c.setComponent(new Lt("app-check-internal",()=>i,"PRIVATE"))),{instance:new zs(mI(t,u,c,e,o),t),namespace:s}}var tW=Object.freeze({__proto__:null,initStandalone:eW});var nW=zs.ServerValue;function rW(t){t.INTERNAL.registerComponent(new Lt("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new zs(i,r)},"PUBLIC").setServiceProps({Reference:$r,Query:Hp,Database:zs,DataSnapshot:Gs,enableLogging:uP,INTERNAL:tW,ServerValue:nW}).setMultipleInstances(!0)),t.registerVersion(Qz,Yz)}rW(st);function Tl(t,e,n="on",r=rs){return new X(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(F(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Hu())}function iW(t){return typeof t=="string"}function sW(t){return typeof t.exportVal=="function"}function yP(t){return t==null}function _P(t){return typeof t.set=="function"}function fP(t,e){return _P(e)?e:t.ref(e)}function vP(t,e){if(iW(t))return e.stringCase();if(_P(t))return e.firebaseCase();if(sW(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function wP(t){return(yP(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function EP(t,e,n){e=wP(e);let r=e.map(i=>Tl(t,i,"on",n));return $o(...r)}function oW(t,e,n){let r=EP(t,e).pipe(Zn((i,s)=>[...i,s],[]));return uW(t,r,n)}function aW(t,e){return Tl(t,"value","on",e).pipe(F(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function uW(t,e,n){return aW(t,n).pipe(by(e),F(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),Dy(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),F(i=>i.actions))}function pP(t,e){return function(r,i){return vP(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function cW(t){return function(n){return n?vP(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function lW(t,e,n){return Tl(t,"value","once",n).pipe(Oe(r=>{let i=[V(r)];return e.forEach(s=>i.push(Tl(t,s,"on",n))),$o(...i).pipe(Zn(hW,[]))}),ju())}function IP(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function dW(t,e){if(yP(e))return 0;{let n=IP(t,e);return n===-1?t.length:n+1}}function hW(t,e){let{payload:n,prevKey:r,key:i}=e,s=IP(t,i),o=dW(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{let c={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(u=>u.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function gP(t,e,n){return e=wP(e),lW(t,e,n)}function fW(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:pP(r,"update"),set:pP(r,"set"),push:i=>r.push(i),remove:cW(r),snapshotChanges(i){return gP(t,i,n).pipe(He)},stateChanges(i){return EP(t,i,n).pipe(He)},auditTrail(i){return oW(t,i,n).pipe(He)},valueChanges(i,s){return gP(t,i,n).pipe(F(a=>a.map(u=>s&&s.idField?ge(M({},u.payload.val()),{[s.idField]:u.key}):u.payload.val())),He)}}}function mP(t,e){return function(){return Tl(t,"value","on",e)}}function pW(t,e){return{query:t,snapshotChanges(){return mP(t,e.schedulers.outsideAngular)().pipe(He)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return mP(t,e.schedulers.outsideAngular)().pipe(He,F(r=>r.payload.exists()?r.payload.val():null))}}}var gW=new N("angularfire2.realtimeDatabaseURL"),mW=new N("angularfire2.database.use-emulator"),yW=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,m){this.schedulers=a;let I=u,R=Fs(n,o,r);c&&zc(R,o,l,h,f,p,d,g),this.database=Ea(`${R.name}.database.${i}`,"AngularFireDatabase",R.name,()=>{let C=o.runOutsideAngular(()=>R.database(i||void 0));return I&&C.useEmulator(...I),C},[I])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>fP(this.database,n)),s=i;return r&&(s=r(i)),fW(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>fP(this.database,n));return pW(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(T(or),T(Ei,8),T(gW,8),T(Mt),T(se),T(Jt),T(mW,8),T(Ls,8),T(jc,8),T(Bc,8),T($c,8),T(Hc,8),T(qc,8),T(Gc,8),T(Bt,8))};static \u0275prov=U({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),CP=(()=>{class t{constructor(){st.registerVersion("angularfire",ft.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ve({type:t});static \u0275inj=Le({providers:[yW]})}return t})();var _W=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},qn={},A,jI=jI||{},W=_W||self;function rg(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Ul(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function vW(t){return Object.prototype.hasOwnProperty.call(t,vI)&&t[vI]||(t[vI]=++wW)}var vI="closure_uid_"+(1e9*Math.random()>>>0),wW=0;function EW(t,e,n){return t.call.apply(t.bind,arguments)}function IW(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Pt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Pt=EW:Pt=IW,Pt.apply(null,arguments)}function qp(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function yt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Ni(){this.s=this.s,this.o=this.o}var CW=0;Ni.prototype.s=!1;Ni.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),CW!=0)&&vW(this)};Ni.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var FP=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function BI(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function DP(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(rg(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function kt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}kt.prototype.h=function(){this.defaultPrevented=!0};var DW=function(){if(!W.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};W.addEventListener("test",n,e),W.removeEventListener("test",n,e)}catch{}return t}();function Ml(t){return/^[\s\xa0]*$/.test(t)}function ig(){var t=W.navigator;return t&&(t=t.userAgent)?t:""}function hr(t){return ig().indexOf(t)!=-1}function $I(t){return $I[" "](t),t}$I[" "]=function(){};function TW(t,e){var n=f9;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var bW=hr("Opera"),$a=hr("Trident")||hr("MSIE"),LP=hr("Edge"),DI=LP||$a,VP=hr("Gecko")&&!(ig().toLowerCase().indexOf("webkit")!=-1&&!hr("Edge"))&&!(hr("Trident")||hr("MSIE"))&&!hr("Edge"),SW=ig().toLowerCase().indexOf("webkit")!=-1&&!hr("Edge");function UP(){var t=W.document;return t?t.documentMode:void 0}var TI;e:{if(Gp="",zp=function(){var t=ig();if(VP)return/rv:([^\);]+)(\)|;)/.exec(t);if(LP)return/Edge\/([\d\.]+)/.exec(t);if($a)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(SW)return/WebKit\/(\S+)/.exec(t);if(bW)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),zp&&(Gp=zp?zp[1]:""),$a&&(Wp=UP(),Wp!=null&&Wp>parseFloat(Gp))){TI=String(Wp);break e}TI=Gp}var Gp,zp,Wp,bI;W.document&&$a?(wI=UP(),bI=wI||parseInt(TI,10)||void 0):bI=void 0;var wI,AW=bI;function Nl(t,e){if(kt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(VP){e:{try{$I(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:RW[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Nl.$.h.call(this)}}yt(Nl,kt);var RW={2:"touch",3:"pen",4:"mouse"};Nl.prototype.h=function(){Nl.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var jl="closure_listenable_"+(1e6*Math.random()|0),xW=0;function MW(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++xW,this.fa=this.ia=!1}function sg(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function HI(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function NW(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function jP(t){let e={};for(let n in t)e[n]=t[n];return e}var TP="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function BP(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<TP.length;s++)n=TP[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function og(t){this.src=t,this.g={},this.h=0}og.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=AI(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new MW(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function SI(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=FP(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(sg(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function AI(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var qI="closure_lm_"+(1e6*Math.random()|0),EI={};function $P(t,e,n,r,i){if(r&&r.once)return qP(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)$P(t,e[s],n,r,i);return null}return n=WI(n),t&&t[jl]?t.O(e,n,Ul(r)?!!r.capture:!!r,i):HP(t,e,n,!1,r,i)}function HP(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Ul(i)?!!i.capture:!!i,a=zI(t);if(a||(t[qI]=a=new og(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=PW(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)DW||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(zP(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function PW(){function t(n){return e.call(t.src,t.listener,n)}let e=kW;return t}function qP(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)qP(t,e[s],n,r,i);return null}return n=WI(n),t&&t[jl]?t.P(e,n,Ul(r)?!!r.capture:!!r,i):HP(t,e,n,!0,r,i)}function GP(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)GP(t,e[s],n,r,i);else r=Ul(r)?!!r.capture:!!r,n=WI(n),t&&t[jl]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=AI(s,n,r,i),-1<n&&(sg(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=zI(t))&&(e=t.g[e.toString()],t=-1,e&&(t=AI(e,n,r,i)),(n=-1<t?e[t]:null)&&GI(n))}function GI(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[jl])SI(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(zP(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=zI(e))?(SI(n,t),n.h==0&&(n.src=null,e[qI]=null)):sg(t)}}}function zP(t){return t in EI?EI[t]:EI[t]="on"+t}function kW(t,e){if(t.fa)t=!0;else{e=new Nl(e,this);var n=t.listener,r=t.la||t.src;t.ia&&GI(t),t=n.call(r,e)}return t}function zI(t){return t=t[qI],t instanceof og?t:null}var II="__closure_events_fn_"+(1e9*Math.random()>>>0);function WI(t){return typeof t=="function"?t:(t[II]||(t[II]=function(e){return t.handleEvent(e)}),t[II])}function mt(){Ni.call(this),this.i=new og(this),this.S=this,this.J=null}yt(mt,Ni);mt.prototype[jl]=!0;mt.prototype.removeEventListener=function(t,e,n,r){GP(this,t,e,n,r)};function Dt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new kt(e,t);else if(e instanceof kt)e.target=e.target||t;else{var i=e;e=new kt(r,t),BP(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Kp(o,r,!0,e)&&i}if(o=e.g=t,i=Kp(o,r,!0,e)&&i,i=Kp(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Kp(o,r,!1,e)&&i}mt.prototype.N=function(){if(mt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)sg(n[r]);delete t.g[e],t.h--}}this.J=null};mt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};mt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Kp(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&SI(t.i,o),i=a.call(u,r)!==!1&&i}}return i&&!r.defaultPrevented}var KI=W.JSON.stringify,RI=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function OW(){var t=QI;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var xI=class{constructor(){this.h=this.g=null}add(e,n){let r=WP.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},WP=new RI(()=>new MI,t=>t.reset()),MI=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function FW(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function LW(t){W.setTimeout(()=>{throw t},0)}var Pl,kl=!1,QI=new xI,KP=()=>{let t=W.Promise.resolve(void 0);Pl=()=>{t.then(VW)}},VW=()=>{for(var t;t=OW();){try{t.h.call(t.g)}catch(n){LW(n)}var e=WP;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}kl=!1};function ag(t,e){mt.call(this),this.h=t||1,this.g=e||W,this.j=Pt(this.qb,this),this.l=Date.now()}yt(ag,mt);A=ag.prototype;A.ga=!1;A.T=null;A.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Dt(this,"tick"),this.ga&&(YI(this),this.start()))}};A.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function YI(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}A.N=function(){ag.$.N.call(this),YI(this),delete this.g};function ZI(t,e,n){if(typeof t=="function")n&&(t=Pt(t,n));else if(t&&typeof t.handleEvent=="function")t=Pt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:W.setTimeout(t,e||0)}function QP(t){t.g=ZI(()=>{t.g=null,t.i&&(t.i=!1,QP(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var NI=class extends Ni{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:QP(this)}N(){super.N(),this.g&&(W.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Ol(t){Ni.call(this),this.h=t,this.g={}}yt(Ol,Ni);var bP=[];function YP(t,e,n,r){Array.isArray(n)||(n&&(bP[0]=n.toString()),n=bP);for(var i=0;i<n.length;i++){var s=$P(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function ZP(t){HI(t.g,function(e,n){this.g.hasOwnProperty(n)&&GI(e)},t),t.g={}}Ol.prototype.N=function(){Ol.$.N.call(this),ZP(this)};Ol.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ug(){this.g=!0}ug.prototype.Ea=function(){this.g=!1};function UW(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+c+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function jW(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function ja(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+$W(t,n)+(r?" "+r:"")})}function BW(t,e){t.info(function(){return"TIMEOUT: "+e})}ug.prototype.info=function(){};function $W(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return KI(n)}catch{return e}}var Ys={},SP=null;function cg(){return SP=SP||new mt}Ys.Ta="serverreachability";function XP(t){kt.call(this,Ys.Ta,t)}yt(XP,kt);function Fl(t){let e=cg();Dt(e,new XP(e))}Ys.STAT_EVENT="statevent";function JP(t,e){kt.call(this,Ys.STAT_EVENT,t),this.stat=e}yt(JP,kt);function Gt(t){let e=cg();Dt(e,new JP(e,t))}Ys.Ua="timingevent";function ek(t,e){kt.call(this,Ys.Ua,t),this.size=e}yt(ek,kt);function Bl(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return W.setTimeout(function(){t()},e)}var lg={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},tk={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function XI(){}XI.prototype.h=null;function AP(t){return t.h||(t.h=t.i())}function nk(){}var $l={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function JI(){kt.call(this,"d")}yt(JI,kt);function eC(){kt.call(this,"c")}yt(eC,kt);var PI;function dg(){}yt(dg,XI);dg.prototype.g=function(){return new XMLHttpRequest};dg.prototype.i=function(){return{}};PI=new dg;function Hl(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Ol(this),this.P=HW,t=DI?125:void 0,this.V=new ag(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new rk}function rk(){this.i=null,this.g="",this.h=!1}var HW=45e3,ik={},kI={};A=Hl.prototype;A.setTimeout=function(t){this.P=t};function OI(t,e,n){t.L=1,t.A=fg(qr(e)),t.u=n,t.S=!0,sk(t,null)}function sk(t,e){t.G=Date.now(),ql(t),t.B=qr(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),fk(n.i,"t",r),t.o=0,n=t.l.J,t.h=new rk,t.g=kk(t.l,n?e:null,!t.u),0<t.O&&(t.M=new NI(Pt(t.Pa,t,t.g),t.O)),YP(t.U,t.g,"readystatechange",t.nb),e=t.I?jP(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Fl(),UW(t.j,t.v,t.B,t.m,t.W,t.u)}A.nb=function(t){t=t.target;let e=this.M;e&&fr(t)==3?e.l():this.Pa(t)};A.Pa=function(t){try{if(t==this.g)e:{let l=fr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||DI||this.g&&(this.h.h||this.g.ja()||NP(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?Fl(3):Fl(2)),hg(this);var n=this.g.da();this.ca=n;t:if(ok(this)){var r=NP(this.g);t="";var i=r.length,s=fr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ws(this),xl(this);var o="";break t}this.h.i=new W.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,jW(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ml(a)){var c=a;break t}}c=null}if(n=c)ja(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,FI(this,n);else{this.i=!1,this.s=3,Gt(12),Ws(this),xl(this);break e}}this.S?(ak(this,l,o),DI&&this.i&&l==3&&(YP(this.U,this.V,"tick",this.mb),this.V.start())):(ja(this.j,this.m,o,null),FI(this,o)),l==4&&Ws(this),this.i&&!this.J&&(l==4?xk(this.l,this):(this.i=!1,ql(this)))}else l9(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,Gt(12)):(this.s=0,Gt(13)),Ws(this),xl(this)}}}catch{}finally{}};function ok(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function ak(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=qW(t,n),i==kI){e==4&&(t.s=4,Gt(14),r=!1),ja(t.j,t.m,null,"[Incomplete Response]");break}else if(i==ik){t.s=4,Gt(15),ja(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else ja(t.j,t.m,i,null),FI(t,i);ok(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,Gt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),oC(e),e.M=!0,Gt(11))):(ja(t.j,t.m,n,"[Invalid Chunked Response]"),Ws(t),xl(t))}A.mb=function(){if(this.g){var t=fr(this.g),e=this.g.ja();this.o<e.length&&(hg(this),ak(this,t,e),this.i&&t!=4&&ql(this))}};function qW(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?kI:(n=Number(e.substring(n,r)),isNaN(n)?ik:(r+=1,r+n>e.length?kI:(e=e.slice(r,r+n),t.o=r+n,e)))}A.cancel=function(){this.J=!0,Ws(this)};function ql(t){t.Y=Date.now()+t.P,uk(t,t.P)}function uk(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Bl(Pt(t.lb,t),e)}function hg(t){t.C&&(W.clearTimeout(t.C),t.C=null)}A.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(BW(this.j,this.B),this.L!=2&&(Fl(),Gt(17)),Ws(this),this.s=2,xl(this)):uk(this,this.Y-t)};function xl(t){t.l.H==0||t.J||xk(t.l,t)}function Ws(t){hg(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,YI(t.V),ZP(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function FI(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||LI(n.i,t))){if(!t.K&&LI(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Jp(n),mg(n);else break e;sC(n),Gt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Bl(Pt(n.ib,n),6e3));if(1>=mk(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Ks(n,11)}else if((t.K||n.g==t)&&Jp(n),!Ml(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];let l=c[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=c[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(tC(s,s.h),s.h=null))}if(r.F){let g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,xe(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=Pk(r,r.J?r.pa:null,r.Y),o.K){yk(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&(hg(a),ql(a)),r.g=o}else Ak(r);0<n.j.length&&yg(n)}else c[0]!="stop"&&c[0]!="close"||Ks(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Ks(n,7):iC(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}Fl(4)}catch{}}function GW(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(rg(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function zW(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(rg(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function ck(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(rg(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=zW(t),r=GW(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var lk=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function WW(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Qs(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Qs){this.h=t.h,Zp(this,t.j),this.s=t.s,this.g=t.g,Xp(this,t.m),this.l=t.l;var e=t.i,n=new Ll;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),RP(this,n),this.o=t.o}else t&&(e=String(t).match(lk))?(this.h=!1,Zp(this,e[1]||"",!0),this.s=Al(e[2]||""),this.g=Al(e[3]||"",!0),Xp(this,e[4]),this.l=Al(e[5]||"",!0),RP(this,e[6]||"",!0),this.o=Al(e[7]||"")):(this.h=!1,this.i=new Ll(null,this.h))}Qs.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Rl(e,xP,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Rl(e,xP,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Rl(n,n.charAt(0)=="/"?YW:QW,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Rl(n,XW)),t.join("")};function qr(t){return new Qs(t)}function Zp(t,e,n){t.j=n?Al(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Xp(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function RP(t,e,n){e instanceof Ll?(t.i=e,JW(t.i,t.h)):(n||(e=Rl(e,ZW)),t.i=new Ll(e,t.h))}function xe(t,e,n){t.i.set(e,n)}function fg(t){return xe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Al(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Rl(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,KW),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function KW(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var xP=/[#\/\?@]/g,QW=/[#\?:]/g,YW=/[#\?]/g,ZW=/[#\?@]/g,XW=/#/g;function Ll(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Pi(t){t.g||(t.g=new Map,t.h=0,t.i&&WW(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}A=Ll.prototype;A.add=function(t,e){Pi(this),this.i=null,t=Ha(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function dk(t,e){Pi(t),e=Ha(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function hk(t,e){return Pi(t),e=Ha(t,e),t.g.has(e)}A.forEach=function(t,e){Pi(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};A.ta=function(){Pi(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};A.Z=function(t){Pi(this);let e=[];if(typeof t=="string")hk(this,t)&&(e=e.concat(this.g.get(Ha(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};A.set=function(t,e){return Pi(this),this.i=null,t=Ha(this,t),hk(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};A.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function fk(t,e,n){dk(t,e),0<n.length&&(t.i=null,t.g.set(Ha(t,e),BI(n)),t.h+=n.length)}A.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Ha(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function JW(t,e){e&&!t.j&&(Pi(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(dk(this,r),fk(this,i,n))},t)),t.j=e}var e9=class{constructor(t,e){this.g=t,this.map=e}};function pk(t){this.l=t||t9,W.PerformanceNavigationTiming?(t=W.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(W.g&&W.g.Ka&&W.g.Ka()&&W.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var t9=10;function gk(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function mk(t){return t.h?1:t.g?t.g.size:0}function LI(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function tC(t,e){t.g?t.g.add(e):t.h=e}function yk(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}pk.prototype.cancel=function(){if(this.i=_k(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function _k(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return BI(t.i)}var n9=class{stringify(t){return W.JSON.stringify(t,void 0)}parse(t){return W.JSON.parse(t,void 0)}};function r9(){this.g=new n9}function i9(t,e,n){let r=n||"";try{ck(t,function(i,s){let o=i;Ul(i)&&(o=KI(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function s9(t,e){let n=new ug;if(W.Image){let r=new Image;r.onload=qp(Qp,n,r,"TestLoadImage: loaded",!0,e),r.onerror=qp(Qp,n,r,"TestLoadImage: error",!1,e),r.onabort=qp(Qp,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=qp(Qp,n,r,"TestLoadImage: timeout",!1,e),W.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Qp(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Gl(t){this.l=t.ec||null,this.j=t.ob||!1}yt(Gl,XI);Gl.prototype.g=function(){return new pg(this.l,this.j)};Gl.prototype.i=function(t){return function(){return t}}({});function pg(t,e){mt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=nC,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}yt(pg,mt);var nC=0;A=pg.prototype;A.open=function(t,e){if(this.readyState!=nC)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Vl(this)};A.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||W).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};A.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,zl(this)),this.readyState=nC};A.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Vl(this)),this.g&&(this.readyState=3,Vl(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof W.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vk(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function vk(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}A.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?zl(this):Vl(this),this.readyState==3&&vk(this)}};A.Za=function(t){this.g&&(this.response=this.responseText=t,zl(this))};A.Ya=function(t){this.g&&(this.response=t,zl(this))};A.ka=function(){this.g&&zl(this)};function zl(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Vl(t)}A.setRequestHeader=function(t,e){this.v.append(t,e)};A.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};A.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Vl(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(pg.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var o9=W.JSON.parse;function qe(t){mt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=wk,this.L=this.M=!1}yt(qe,mt);var wk="",a9=/^https?$/i,u9=["POST","PUT"];A=qe.prototype;A.Oa=function(t){this.M=t};A.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():PI.g(),this.C=this.u?AP(this.u):AP(PI),this.g.onreadystatechange=Pt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){MP(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=W.FormData&&t instanceof W.FormData,!(0<=FP(u9,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Ck(this),0<this.B&&((this.L=c9(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Pt(this.ua,this)):this.A=ZI(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){MP(this,s)}};function c9(t){return $a&&typeof t.timeout=="number"&&t.ontimeout!==void 0}A.ua=function(){typeof jI<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Dt(this,"timeout"),this.abort(8))};function MP(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ek(t),gg(t)}function Ek(t){t.F||(t.F=!0,Dt(t,"complete"),Dt(t,"error"))}A.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Dt(this,"complete"),Dt(this,"abort"),gg(this))};A.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),gg(this,!0)),qe.$.N.call(this)};A.La=function(){this.s||(this.G||this.v||this.l?Ik(this):this.kb())};A.kb=function(){Ik(this)};function Ik(t){if(t.h&&typeof jI<"u"&&(!t.C[1]||fr(t)!=4||t.da()!=2)){if(t.v&&fr(t)==4)ZI(t.La,0,t);else if(Dt(t,"readystatechange"),fr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(lk)[1]||null;!i&&W.self&&W.self.location&&(i=W.self.location.protocol.slice(0,-1)),r=!a9.test(i?i.toLowerCase():"")}n=r}if(n)Dt(t,"complete"),Dt(t,"success");else{t.m=6;try{var s=2<fr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",Ek(t)}}finally{gg(t)}}}}function gg(t,e){if(t.g){Ck(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Dt(t,"ready");try{n.onreadystatechange=r}catch{}}}function Ck(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(W.clearTimeout(t.A),t.A=null)}A.isActive=function(){return!!this.g};function fr(t){return t.g?t.g.readyState:0}A.da=function(){try{return 2<fr(this)?this.g.status:-1}catch{return-1}};A.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};A.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),o9(e)}};function NP(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case wk:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function l9(t){let e={};t=(t.g&&2<=fr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Ml(t[r]))continue;var n=FW(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}NW(e,function(r){return r.join(", ")})}A.Ia=function(){return this.m};A.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function Dk(t){let e="";return HI(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function rC(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Dk(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):xe(t,e,n))}function bl(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Tk(t){this.Ga=0,this.j=[],this.l=new ug,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=bl("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=bl("baseRetryDelayMs",5e3,t),this.hb=bl("retryDelaySeedMs",1e4,t),this.eb=bl("forwardChannelMaxRetries",2,t),this.xa=bl("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new pk(t&&t.concurrentRequestLimit),this.Ja=new r9,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}A=Tk.prototype;A.ra=8;A.H=1;function iC(t){if(bk(t),t.H==3){var e=t.W++,n=qr(t.I);if(xe(n,"SID",t.K),xe(n,"RID",e),xe(n,"TYPE","terminate"),Wl(t,n),e=new Hl(t,t.l,e),e.L=2,e.A=fg(qr(n)),n=!1,W.navigator&&W.navigator.sendBeacon)try{n=W.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&W.Image&&(new Image().src=e.A,n=!0),n||(e.g=kk(e.l,null),e.g.ha(e.A)),e.G=Date.now(),ql(e)}Nk(t)}function mg(t){t.g&&(oC(t),t.g.cancel(),t.g=null)}function bk(t){mg(t),t.u&&(W.clearTimeout(t.u),t.u=null),Jp(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&W.clearTimeout(t.m),t.m=null)}function yg(t){if(!gk(t.i)&&!t.m){t.m=!0;var e=t.Na;Pl||KP(),kl||(Pl(),kl=!0),QI.add(e,t),t.C=0}}function d9(t,e){return mk(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Bl(Pt(t.Na,t,e),Mk(t,t.C)),t.C++,!0)}A.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Hl(this,this.l,t),s=this.s;if(this.U&&(s?(s=jP(s),BP(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=Sk(this,i,e),n=qr(this.I),xe(n,"RID",t),xe(n,"CVER",22),this.F&&xe(n,"X-HTTP-Session-Id",this.F),Wl(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Dk(s)))+"&"+e:this.o&&rC(n,this.o,s)),tC(this.i,i),this.bb&&xe(n,"TYPE","init"),this.P?(xe(n,"$req",e),xe(n,"SID","null"),i.aa=!0,OI(i,n,null)):OI(i,n,e),this.H=2}}else this.H==3&&(t?PP(this,t):this.j.length==0||gk(this.i)||PP(this))};function PP(t,e){var n;e?n=e.m:n=t.W++;let r=qr(t.I);xe(r,"SID",t.K),xe(r,"RID",n),xe(r,"AID",t.V),Wl(t,r),t.o&&t.s&&rC(r,t.o,t.s),n=new Hl(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Sk(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),tC(t.i,n),OI(n,r,e)}function Wl(t,e){t.na&&HI(t.na,function(n,r){xe(e,r,n)}),t.h&&ck({},function(n,r){xe(e,r,n)})}function Sk(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Pt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let c=i[u].g,l=i[u].map;if(c-=s,0>c)s=Math.max(0,i[u].g-100),a=!1;else try{i9(l,o,"req"+c+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function Ak(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Pl||KP(),kl||(Pl(),kl=!0),QI.add(e,t),t.A=0}}function sC(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Bl(Pt(t.Ma,t),Mk(t,t.A)),t.A++,!0)}A.Ma=function(){if(this.u=null,Rk(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Bl(Pt(this.jb,this),t)}};A.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Gt(10),mg(this),Rk(this))};function oC(t){t.B!=null&&(W.clearTimeout(t.B),t.B=null)}function Rk(t){t.g=new Hl(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=qr(t.wa);xe(e,"RID","rpc"),xe(e,"SID",t.K),xe(e,"AID",t.V),xe(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&xe(e,"TO",t.qa),xe(e,"TYPE","xmlhttp"),Wl(t,e),t.o&&t.s&&rC(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=fg(qr(e)),n.u=null,n.S=!0,sk(n,t)}A.ib=function(){this.v!=null&&(this.v=null,mg(this),sC(this),Gt(19))};function Jp(t){t.v!=null&&(W.clearTimeout(t.v),t.v=null)}function xk(t,e){var n=null;if(t.g==e){Jp(t),oC(t),t.g=null;var r=2}else if(LI(t.i,e))n=e.F,yk(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=cg(),Dt(r,new ek(r,n)),yg(t)}else Ak(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&d9(t,e)||r==2&&sC(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Ks(t,5);break;case 4:Ks(t,10);break;case 3:Ks(t,6);break;default:Ks(t,2)}}}function Mk(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Ks(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Pt(t.pb,t);n||(n=new Qs("//www.google.com/images/cleardot.gif"),W.location&&W.location.protocol=="http"||Zp(n,"https"),fg(n)),s9(n.toString(),r)}else Gt(2);t.H=0,t.h&&t.h.za(e),Nk(t),bk(t)}A.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Gt(2)):(this.l.info("Failed to ping google.com"),Gt(1))};function Nk(t){if(t.H=0,t.ma=[],t.h){let e=_k(t.i);(e.length!=0||t.j.length!=0)&&(DP(t.ma,e),DP(t.ma,t.j),t.i.i.length=0,BI(t.j),t.j.length=0),t.h.ya()}}function Pk(t,e,n){var r=n instanceof Qs?qr(n):new Qs(n);if(r.g!="")e&&(r.g=e+"."+r.g),Xp(r,r.m);else{var i=W.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Qs(null);r&&Zp(s,r),e&&(s.g=e),i&&Xp(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&xe(r,n,e),xe(r,"VER",t.ra),Wl(t,r),r}function kk(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new qe(new Gl({ob:n})):new qe(t.va),e.Oa(t.J),e}A.isActive=function(){return!!this.h&&this.h.isActive(this)};function Ok(){}A=Ok.prototype;A.Ba=function(){};A.Aa=function(){};A.za=function(){};A.ya=function(){};A.isActive=function(){return!0};A.Va=function(){};function eg(){if($a&&!(10<=Number(AW)))throw Error("Environmental error: no available transport.")}eg.prototype.g=function(t,e){return new ln(t,e)};function ln(t,e){mt.call(this),this.g=new Tk(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Ml(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ml(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new qa(this)}yt(ln,mt);ln.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Gt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=Pk(t,null,t.Y),yg(t)};ln.prototype.close=function(){iC(this.g)};ln.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=KI(t),t=n);e.j.push(new e9(e.fb++,t)),e.H==3&&yg(e)};ln.prototype.N=function(){this.g.h=null,delete this.j,iC(this.g),delete this.g,ln.$.N.call(this)};function Fk(t){JI.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}yt(Fk,JI);function Lk(){eC.call(this),this.status=1}yt(Lk,eC);function qa(t){this.g=t}yt(qa,Ok);qa.prototype.Ba=function(){Dt(this.g,"a")};qa.prototype.Aa=function(t){Dt(this.g,new Fk(t))};qa.prototype.za=function(t){Dt(this.g,new Lk)};qa.prototype.ya=function(){Dt(this.g,"b")};function h9(){this.blockSize=-1}function Hn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}yt(Hn,h9);Hn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function CI(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Hn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)CI(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){CI(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){CI(this,r),i=0;break}}this.h=i,this.i+=e};Hn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function we(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var f9={};function aC(t){return-128<=t&&128>t?TW(t,function(e){return new we([e|0],0>e?-1:0)}):new we([t|0],0>t?-1:0)}function pr(t){if(isNaN(t)||!isFinite(t))return Ba;if(0>t)return Ct(pr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=VI;return new we(e,0)}function Vk(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Ct(Vk(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=pr(Math.pow(e,8)),r=Ba,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=pr(Math.pow(e,s)),r=r.R(s).add(pr(o))):(r=r.R(n),r=r.add(pr(o)))}return r}var VI=4294967296,Ba=aC(0),UI=aC(1),kP=aC(16777216);A=we.prototype;A.ea=function(){if(Rn(this))return-Ct(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:VI+r)*e,e*=VI}return t};A.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Hr(this))return"0";if(Rn(this))return"-"+Ct(this).toString(t);for(var e=pr(Math.pow(t,6)),n=this,r="";;){var i=ng(n,e).g;n=tg(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Hr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};A.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Hr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Rn(t){return t.h==-1}A.X=function(t){return t=tg(this,t),Rn(t)?-1:Hr(t)?0:1};function Ct(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new we(n,~t.h).add(UI)}A.abs=function(){return Rn(this)?Ct(this):this};A.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new we(n,n[n.length-1]&-2147483648?-1:0)};function tg(t,e){return t.add(Ct(e))}A.R=function(t){if(Hr(this)||Hr(t))return Ba;if(Rn(this))return Rn(t)?Ct(this).R(Ct(t)):Ct(Ct(this).R(t));if(Rn(t))return Ct(this.R(Ct(t)));if(0>this.X(kP)&&0>t.X(kP))return pr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,u=t.D(i)&65535;n[2*r+2*i]+=o*u,Yp(n,2*r+2*i),n[2*r+2*i+1]+=s*u,Yp(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Yp(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Yp(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new we(n,0)};function Yp(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Sl(t,e){this.g=t,this.h=e}function ng(t,e){if(Hr(e))throw Error("division by zero");if(Hr(t))return new Sl(Ba,Ba);if(Rn(t))return e=ng(Ct(t),e),new Sl(Ct(e.g),Ct(e.h));if(Rn(e))return e=ng(t,Ct(e)),new Sl(Ct(e.g),e.h);if(30<t.g.length){if(Rn(t)||Rn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=UI,r=e;0>=r.X(t);)n=OP(n),r=OP(r);var i=Ua(n,1),s=Ua(r,1);for(r=Ua(r,2),n=Ua(n,2);!Hr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Ua(r,1),n=Ua(n,1)}return e=tg(t,i.R(e)),new Sl(i,e)}for(i=Ba;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=pr(n),o=s.R(e);Rn(o)||0<o.X(t);)n-=r,s=pr(n),o=s.R(e);Hr(s)&&(s=UI),i=i.add(s),t=tg(t,o)}return new Sl(i,t)}A.gb=function(t){return ng(this,t).h};A.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new we(n,this.h&t.h)};A.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new we(n,this.h|t.h)};A.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new we(n,this.h^t.h)};function OP(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new we(n,t.h)}function Ua(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new we(i,t.h)}eg.prototype.createWebChannel=eg.prototype.g;ln.prototype.send=ln.prototype.u;ln.prototype.open=ln.prototype.m;ln.prototype.close=ln.prototype.close;lg.NO_ERROR=0;lg.TIMEOUT=8;lg.HTTP_ERROR=6;tk.COMPLETE="complete";nk.EventType=$l;$l.OPEN="a";$l.CLOSE="b";$l.ERROR="c";$l.MESSAGE="d";mt.prototype.listen=mt.prototype.O;qe.prototype.listenOnce=qe.prototype.P;qe.prototype.getLastError=qe.prototype.Sa;qe.prototype.getLastErrorCode=qe.prototype.Ia;qe.prototype.getStatus=qe.prototype.da;qe.prototype.getResponseJson=qe.prototype.Wa;qe.prototype.getResponseText=qe.prototype.ja;qe.prototype.send=qe.prototype.ha;qe.prototype.setWithCredentials=qe.prototype.Oa;Hn.prototype.digest=Hn.prototype.l;Hn.prototype.reset=Hn.prototype.reset;Hn.prototype.update=Hn.prototype.j;we.prototype.add=we.prototype.add;we.prototype.multiply=we.prototype.R;we.prototype.modulo=we.prototype.gb;we.prototype.compare=we.prototype.X;we.prototype.toNumber=we.prototype.ea;we.prototype.toString=we.prototype.toString;we.prototype.getBits=we.prototype.D;we.fromNumber=pr;we.fromString=Vk;var Uk=qn.createWebChannelTransport=function(){return new eg},jk=qn.getStatEventTarget=function(){return cg()},_g=qn.ErrorCode=lg,Bk=qn.EventType=tk,$k=qn.Event=Ys,uC=qn.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Hk=qn.FetchXmlHttpFactory=Gl,Kl=qn.WebChannel=nk,qk=qn.XhrIo=qe,Gk=qn.Md5=Hn,Zs=qn.Integer=we;var zk="@firebase/firestore";var tt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};tt.UNAUTHENTICATED=new tt(null),tt.GOOGLE_CREDENTIALS=new tt("google-credentials-uid"),tt.FIRST_PARTY=new tt("first-party-uid"),tt.MOCK_USER=new tt("mock-user");var Eu="10.11.1";var ji=new ni("@firebase/firestore");function Qa(){return ji.logLevel}function dT(t){ji.setLogLevel(t)}function E(t,...e){if(ji.logLevel<=pn.DEBUG){let n=e.map(hT);ji.debug(`Firestore (${Eu}): ${t}`,...n)}}function Qe(t,...e){if(ji.logLevel<=pn.ERROR){let n=e.map(hT);ji.error(`Firestore (${Eu}): ${t}`,...n)}}function Mn(t,...e){if(ji.logLevel<=pn.WARN){let n=e.map(hT);ji.warn(`Firestore (${Eu}): ${t}`,...n)}}function hT(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function x(t="Unexpected state"){let e=`FIRESTORE (${Eu}) INTERNAL ASSERTION FAILED: `+t;throw Qe(e),new Error(e)}function O(t,e){t||x()}function zO(t,e){t||x()}function S(t,e){return t}var v={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},w=class extends $d{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var nt=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Rg=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},fC=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(tt.UNAUTHENTICATED))}shutdown(){}},pC=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},gC=class{constructor(e){this.t=e,this.currentUser=tt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve(),s=new nt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new nt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>_(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{E("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(E("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new nt)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(E("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(O(typeof r.accessToken=="string"),new Rg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return O(e===null||typeof e=="string"),new tt(e)}},mC=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=tt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},yC=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new mC(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(tt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},_C=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},vC=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&E("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,E("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{E("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):E("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(O(typeof n.token=="string"),this.R=n.token,new _C(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function p9(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var xg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=p9(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function Y(t,e){return t<e?-1:t>e?1:0}function iu(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function WO(t){return t+"\0"}var je=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new w(v.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new w(v.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new w(v.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new w(v.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var L=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new je(0,0))}static max(){return new t(new je(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Mg=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&x(),r===void 0?r=e.length-n:r>e.length-n&&x(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},le=class t extends Mg{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new w(v.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},g9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ye=class t extends Mg{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return g9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new w(v.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new w(v.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new w(v.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new w(v.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var b=class t{constructor(e){this.path=e}static fromPath(e){return new t(le.fromString(e))}static fromName(e){return new t(le.fromString(e).popFirst(5))}static empty(){return new t(le.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&le.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return le.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new le(e.slice()))}};var su=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function wC(t){return t.fields.find(e=>e.kind===2)}function Js(t){return t.fields.filter(e=>e.kind!==2)}su.UNKNOWN_ID=-1;var tu=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var od=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Nn.min())}};function KO(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=L.fromTimestamp(r===1e9?new je(n+1,0):new je(n,r));return new Nn(i,b.empty(),e)}function QO(t){return new Nn(t.readTime,t.key,-1)}var Nn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(L.min(),b.empty(),-1)}static max(){return new t(L.max(),b.empty(),-1)}};function fT(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=b.comparator(t.documentKey,e.documentKey),n!==0?n:Y(t.largestBatchId,e.largestBatchId))}var YO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ng=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Yi(t){return _(this,null,function*(){if(t.code!==v.FAILED_PRECONDITION||t.message!==YO)throw t;E("LocalStore","Unexpectedly lost primary lease")})}var y=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&x(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let c=u;n(e[c]).next(l=>{o[c]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Pg=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new nt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new so(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=pT(r.target.error);this.V.reject(new so(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new so(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(E("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new IC(n)}},Bi=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(ku())===12.2&&Qe("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return E("SimpleDb","Removing database:",e),eo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Bd())return!1;if(t.C())return!0;let e=ku(),n=t.S(e),r=0<n&&n<10,i=ZO(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return _(this,null,function*(){return this.db||(E("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new so(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new w(v.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new w(v.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new so(e,o))},i.onupgradeneeded=s=>{E("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{E("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return _(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=Pg.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),y.reject(c))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,c=u.name!=="FirebaseError"&&o<3;if(E("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function ZO(t){let e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}var EC=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return eo(this.B.delete())}},so=class extends w{constructor(e,n){super(v.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function Zi(t){return t.name==="IndexedDbTransactionError"}var IC=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(E("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(E("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),eo(r)}add(e){return E("SimpleDb","ADD",this.store.name,e,e),eo(this.store.add(e))}get(e){return eo(this.store.get(e)).next(n=>(n===void 0&&(n=null),E("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return E("SimpleDb","DELETE",this.store.name,e),eo(this.store.delete(e))}count(){return E("SimpleDb","COUNT",this.store.name),eo(this.store.count())}U(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new y((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,u)=>{o.push(u)}).next(()=>o)}}G(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new y((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){E("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.W(i,n)}Y(e){let n=this.cursor({});return new y((r,i)=>{n.onerror=s=>{let o=pT(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){let r=[];return new y((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let u=new EC(a),c=n(a.primaryKey,a.value,u);if(c instanceof y){let l=c.catch(d=>(u.done(),y.reject(d)));r.push(l)}u.isDone?i():u.K===null?a.continue():a.continue(u.K)}}).next(()=>y.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function eo(t){return new y((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=pT(r.target.error);n(i)}})}var Wk=!1;function pT(t){let e=Bi.S(ku());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new w("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Wk||(Wk=!0,setTimeout(()=>{throw r},0)),r}}return t}var CC=class{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){E("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>_(this,null,function*(){this.task=null;try{E("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(n){Zi(n)?E("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Yi(n)}yield this.X(6e4)}))}},DC=class{constructor(e,n){this.localStore=e,this.persistence=n}ee(e=50){return _(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))})}te(e,n){let r=new Set,i=n,s=!0;return y.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return E("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(E("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=QO(s);fT(o,r)>0&&(r=o)}),new Nn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var dn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.se&&this.se(n),n}}return t.oe=-1,t})();function Ad(t){return t==null}function ad(t){return t===0&&1/t==-1/0}function XO(t){return typeof t=="number"&&Number.isInteger(t)&&!ad(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function zt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Kk(e)),e=m9(t.get(n),e);return Kk(e)}function m9(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function Kk(t){return t+""}function gr(t){let e=t.length;if(O(e>=2),e===2)return O(t.charAt(0)===""&&t.charAt(1)===""),le.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&x(),t.charAt(o+1)){case"":let a=t.substring(s,o),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:x()}s=o+2}return new le(r)}var Qk=["userId","batchId"];function Cg(t,e){return[t,zt(e)]}function JO(t,e,n){return[t,zt(e),n]}var y9={},_9=["prefixPath","collectionGroup","readTime","documentId"],v9=["prefixPath","collectionGroup","documentId"],w9=["collectionGroup","readTime","prefixPath","documentId"],E9=["canonicalId","targetId"],I9=["targetId","path"],C9=["path","targetId"],D9=["collectionId","parent"],T9=["indexId","uid"],b9=["uid","sequenceNumber"],S9=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],A9=["indexId","uid","orderedDocumentKey"],R9=["userId","collectionPath","documentId"],x9=["userId","collectionPath","largestBatchId"],M9=["userId","collectionGroup","largestBatchId"],e1=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],N9=[...e1,"documentOverlays"],t1=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],n1=t1,r1=[...n1,"indexConfiguration","indexState","indexEntries"],P9=r1;var ud=class extends Ng{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}};function vt(t,e){let n=S(t);return Bi.F(n._e,e)}function Yk(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function _o(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function i1(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Me=class t{constructor(e,n){this.comparator=e,this.root=n||yr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,yr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new eu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new eu(this.root,e,this.comparator,!1)}getReverseIterator(){return new eu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new eu(this.root,e,this.comparator,!0)}},eu=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},yr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw x();let e=this.left.check();if(e!==this.right.check())throw x();return e+(this.isRed()?0:1)}};yr.EMPTY=null,yr.RED=!0,yr.BLACK=!1;yr.EMPTY=new class{constructor(){this.size=0}get key(){throw x()}get value(){throw x()}get color(){throw x()}get left(){throw x()}get right(){throw x()}copy(e,n,r,i,s){return this}insert(e,n,r){return new yr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var be=class t{constructor(e){this.comparator=e,this.data=new Me(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new kg(this.data.getIterator())}getIteratorFrom(e){return new kg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},kg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ga(t){return t.hasNext()?t.getNext():void 0}var hn=class t{constructor(e){this.fields=e,e.sort(Ye.comparator)}static empty(){return new t([])}unionWith(e){let n=new be(Ye.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return iu(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Og=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function s1(){return typeof atob<"u"}var _t=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Og("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};_t.EMPTY_BYTE_STRING=new _t("");var k9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wr(t){if(O(!!t),typeof t=="string"){let e=0,n=k9.exec(t);if(O(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ge(t.seconds),nanos:Ge(t.nanos)}}function Ge(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function $i(t){return typeof t=="string"?_t.fromBase64String(t):_t.fromUint8Array(t)}function Tm(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function gT(t){let e=t.mapValue.fields.__previous_value__;return Tm(e)?gT(e):e}function cd(t){let e=Wr(t.mapValue.fields.__local_write_time__.timestampValue);return new je(e.seconds,e.nanos)}var TC=class{constructor(e,n,r,i,s,o,a,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}},Hi=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Vi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Dg={nullValue:"NULL_VALUE"};function oo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Tm(t)?4:o1(t)?9007199254740991:10:x()}function wr(t,e){if(t===e)return!0;let n=oo(t);if(n!==oo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return cd(t).isEqual(cd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Wr(i.timestampValue),a=Wr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return $i(i.bytesValue).isEqual($i(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Ge(i.geoPointValue.latitude)===Ge(s.geoPointValue.latitude)&&Ge(i.geoPointValue.longitude)===Ge(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ge(i.integerValue)===Ge(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ge(i.doubleValue),a=Ge(s.doubleValue);return o===a?ad(o)===ad(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return iu(t.arrayValue.values||[],e.arrayValue.values||[],wr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Yk(o)!==Yk(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!wr(o[u],a[u])))return!1;return!0}(t,e);default:return x()}}function ld(t,e){return(t.values||[]).find(n=>wr(n,e))!==void 0}function qi(t,e){if(t===e)return 0;let n=oo(t),r=oo(e);if(n!==r)return Y(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Y(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Ge(s.integerValue||s.doubleValue),u=Ge(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return Zk(t.timestampValue,e.timestampValue);case 4:return Zk(cd(t),cd(e));case 5:return Y(t.stringValue,e.stringValue);case 6:return function(s,o){let a=$i(s),u=$i(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){let l=Y(a[c],u[c]);if(l!==0)return l}return Y(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=Y(Ge(s.latitude),Ge(o.latitude));return a!==0?a:Y(Ge(s.longitude),Ge(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],u=o.values||[];for(let c=0;c<a.length&&c<u.length;++c){let l=qi(a[c],u[c]);if(l)return l}return Y(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Vi.mapValue&&o===Vi.mapValue)return 0;if(s===Vi.mapValue)return 1;if(o===Vi.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),c=o.fields||{},l=Object.keys(c);u.sort(),l.sort();for(let d=0;d<u.length&&d<l.length;++d){let h=Y(u[d],l[d]);if(h!==0)return h;let f=qi(a[u[d]],c[l[d]]);if(f!==0)return f}return Y(u.length,l.length)}(t.mapValue,e.mapValue);default:throw x()}}function Zk(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Y(t,e);let n=Wr(t),r=Wr(e),i=Y(n.seconds,r.seconds);return i!==0?i:Y(n.nanos,r.nanos)}function ou(t){return bC(t)}function bC(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Wr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return $i(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return b.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=bC(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${bC(n.fields[o])}`;return i+"}"}(t.mapValue):x()}function ao(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function SC(t){return!!t&&"integerValue"in t}function dd(t){return!!t&&"arrayValue"in t}function Xk(t){return!!t&&"nullValue"in t}function Jk(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Tg(t){return!!t&&"mapValue"in t}function td(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return _o(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=td(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=td(t.arrayValue.values[n]);return e}return Object.assign({},t)}function o1(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function O9(t){return"nullValue"in t?Dg:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ao(Hi.empty(),b.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:x()}function F9(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ao(Hi.empty(),b.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Vi:x()}function eO(t,e){let n=qi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function tO(t,e){let n=qi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var Ft=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Tg(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=td(n)}setAll(e){let n=Ye.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=td(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Tg(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return wr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Tg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){_o(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(td(this.value))}};function a1(t){let e=[];return _o(t.fields,(n,r)=>{let i=new Ye([n]);if(Tg(r)){let s=a1(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new hn(e)}var rt=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,L.min(),L.min(),L.min(),Ft.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,L.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,L.min(),L.min(),Ft.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,L.min(),L.min(),Ft.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(L.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ft.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ft.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=L.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Er=class{constructor(e,n){this.position=e,this.inclusive=n}};function nO(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=b.comparator(b.fromName(o.referenceValue),n.key):r=qi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function rO(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!wr(t.position[n],e.position[n]))return!1;return!0}var uo=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function L9(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Fg=class{},ae=class t extends Fg{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new xC(e,n,r):n==="array-contains"?new PC(e,r):n==="in"?new Lg(e,r):n==="not-in"?new kC(e,r):n==="array-contains-any"?new OC(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new MC(e,r):new NC(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(qi(n,this.value)):n!==null&&oo(this.value)===oo(n)&&this.matchesComparison(qi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return x()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ee=class t extends Fg{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new t(e,n)}matches(e){return au(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function au(t){return t.op==="and"}function AC(t){return t.op==="or"}function mT(t){return u1(t)&&au(t)}function u1(t){for(let e of t.filters)if(e instanceof Ee)return!1;return!0}function RC(t){if(t instanceof ae)return t.field.canonicalString()+t.op.toString()+ou(t.value);if(mT(t))return t.filters.map(e=>RC(e)).join(",");{let e=t.filters.map(n=>RC(n)).join(",");return`${t.op}(${e})`}}function c1(t,e){return t instanceof ae?function(r,i){return i instanceof ae&&r.op===i.op&&r.field.isEqual(i.field)&&wr(r.value,i.value)}(t,e):t instanceof Ee?function(r,i){return i instanceof Ee&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&c1(o,i.filters[a]),!0):!1}(t,e):void x()}function l1(t,e){let n=t.filters.concat(e);return Ee.create(n,t.op)}function d1(t){return t instanceof ae?function(n){return`${n.field.canonicalString()} ${n.op} ${ou(n.value)}`}(t):t instanceof Ee?function(n){return n.op.toString()+" {"+n.getFilters().map(d1).join(" ,")+"}"}(t):"Filter"}var xC=class extends ae{constructor(e,n,r){super(e,n,r),this.key=b.fromName(r.referenceValue)}matches(e){let n=b.comparator(e.key,this.key);return this.matchesComparison(n)}},MC=class extends ae{constructor(e,n){super(e,"in",n),this.keys=h1("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},NC=class extends ae{constructor(e,n){super(e,"not-in",n),this.keys=h1("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function h1(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>b.fromName(r.referenceValue))}var PC=class extends ae{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return dd(n)&&ld(n.arrayValue,this.value)}},Lg=class extends ae{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&ld(this.value.arrayValue,n)}},kC=class extends ae{constructor(e,n){super(e,"not-in",n)}matches(e){if(ld(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!ld(this.value.arrayValue,n)}},OC=class extends ae{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!dd(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ld(this.value.arrayValue,r))}};var FC=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function LC(t,e=null,n=[],r=[],i=null,s=null,o=null){return new FC(t,e,n,r,i,s,o)}function co(t){let e=S(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>RC(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ad(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ou(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ou(r)).join(",")),e.ue=n}return e.ue}function Rd(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!L9(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!c1(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!rO(t.startAt,e.startAt)&&rO(t.endAt,e.endAt)}function Vg(t){return b.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Ug(t,e){return t.filters.filter(n=>n instanceof ae&&n.field.isEqual(e))}function iO(t,e,n){let r=Dg,i=!0;for(let s of Ug(t,e)){let o=Dg,a=!0;switch(s.op){case"<":case"<=":o=O9(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Dg}eO({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];eO({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function sO(t,e,n){let r=Vi,i=!0;for(let s of Ug(t,e)){let o=Vi,a=!0;switch(s.op){case">=":case">":o=F9(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Vi}tO({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];tO({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var Gn=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function f1(t,e,n,r,i,s,o,a){return new Gn(t,e,n,r,i,s,o,a)}function Iu(t){return new Gn(t)}function oO(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function yT(t){return t.collectionGroup!==null}function nu(t){let e=S(t);if(e.ce===null){e.ce=[];let n=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new be(Ye.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new uo(s,r))}),n.has(Ye.keyField().canonicalString())||e.ce.push(new uo(Ye.keyField(),r))}return e.ce}function Wt(t){let e=S(t);return e.le||(e.le=V9(e,nu(t))),e.le}function V9(t,e){if(t.limitType==="F")return LC(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new uo(i.field,s)});let n=t.endAt?new Er(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Er(t.startAt.position,t.startAt.inclusive):null;return LC(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function VC(t,e){let n=t.filters.concat([e]);return new Gn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function jg(t,e,n){return new Gn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function xd(t,e){return Rd(Wt(t),Wt(e))&&t.limitType===e.limitType}function p1(t){return`${co(Wt(t))}|lt:${t.limitType}`}function Ya(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>d1(i)).join(", ")}]`),Ad(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>ou(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>ou(i)).join(",")),`Target(${r})`}(Wt(t))}; limitType=${t.limitType})`}function Md(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):b.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of nu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let c=nO(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,nu(r),i)||r.endAt&&!function(o,a,u){let c=nO(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,nu(r),i))}(t,e)}function g1(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function m1(t){return(e,n)=>{let r=!1;for(let i of nu(t)){let s=U9(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function U9(t,e,n){let r=t.field.isKeyField()?b.comparator(e.key,n.key):function(s,o,a){let u=o.data.field(s),c=a.data.field(s);return u!==null&&c!==null?qi(u,c):x()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return x()}}var Ir=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){_o(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return i1(this.inner)}size(){return this.innerSize}};var j9=new Me(b.comparator);function en(){return j9}var y1=new Me(b.comparator);function Jl(...t){let e=y1;for(let n of t)e=e.insert(n.key,n);return e}function _1(t){let e=y1;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function mr(){return nd()}function v1(){return nd()}function nd(){return new Ir(t=>t.toString(),(t,e)=>t.isEqual(e))}var B9=new Me(b.comparator),$9=new be(b.comparator);function Z(...t){let e=$9;for(let n of t)e=e.add(n);return e}var H9=new be(Y);function _T(){return H9}function w1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ad(e)?"-0":e}}function E1(t){return{integerValue:""+t}}function I1(t,e){return XO(e)?E1(e):w1(t,e)}var uu=class{constructor(){this._=void 0}};function q9(t,e,n){return t instanceof Gi?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Tm(s)&&(s=gT(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Kr?D1(t,e):t instanceof Qr?T1(t,e):function(i,s){let o=C1(i,s),a=aO(o)+aO(i.Pe);return SC(o)&&SC(i.Pe)?E1(a):w1(i.serializer,a)}(t,e)}function G9(t,e,n){return t instanceof Kr?D1(t,e):t instanceof Qr?T1(t,e):n}function C1(t,e){return t instanceof zi?function(r){return SC(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Gi=class extends uu{},Kr=class extends uu{constructor(e){super(),this.elements=e}};function D1(t,e){let n=b1(e);for(let r of t.elements)n.some(i=>wr(i,r))||n.push(r);return{arrayValue:{values:n}}}var Qr=class extends uu{constructor(e){super(),this.elements=e}};function T1(t,e){let n=b1(e);for(let r of t.elements)n=n.filter(i=>!wr(i,r));return{arrayValue:{values:n}}}var zi=class extends uu{constructor(e,n){super(),this.serializer=e,this.Pe=n}};function aO(t){return Ge(t.integerValue||t.doubleValue)}function b1(t){return dd(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var lo=class{constructor(e,n){this.field=e,this.transform=n}};function z9(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Kr&&i instanceof Kr||r instanceof Qr&&i instanceof Qr?iu(r.elements,i.elements,wr):r instanceof zi&&i instanceof zi?wr(r.Pe,i.Pe):r instanceof Gi&&i instanceof Gi}(t.transform,e.transform)}var UC=class{constructor(e,n){this.version=e,this.transformResults=n}},ze=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function bg(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var cu=class{};function S1(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ki(t.key,ze.none()):new Wi(t.key,t.data,ze.none());{let n=t.data,r=Ft.empty(),i=new be(Ye.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new zn(t.key,r,new hn(i.toArray()),ze.none())}}function W9(t,e,n){t instanceof Wi?function(i,s,o){let a=i.value.clone(),u=cO(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof zn?function(i,s,o){if(!bg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=cO(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(A1(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function rd(t,e,n,r){return t instanceof Wi?function(s,o,a,u){if(!bg(s.precondition,o))return a;let c=s.value.clone(),l=lO(s.fieldTransforms,u,o);return c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof zn?function(s,o,a,u){if(!bg(s.precondition,o))return a;let c=lO(s.fieldTransforms,u,o),l=o.data;return l.setAll(A1(s)),l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return bg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function K9(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=C1(r.transform,i||null);s!=null&&(n===null&&(n=Ft.empty()),n.set(r.field,s))}return n||null}function uO(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&iu(r,i,(s,o)=>z9(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Wi=class extends cu{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},zn=class extends cu{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function A1(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function cO(t,e,n){let r=new Map;O(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,G9(o,a,n[i]))}return r}function lO(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,q9(s,o,e))}return r}var Ki=class extends cu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},hd=class extends cu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var fd=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&W9(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=rd(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=rd(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=v1();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let u=S1(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(L.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Z())}isEqual(e){return this.batchId===e.batchId&&iu(this.mutations,e.mutations,(n,r)=>uO(n,r))&&iu(this.baseMutations,e.baseMutations,(n,r)=>uO(n,r))}},jC=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){O(e.mutations.length===r.length);let i=function(){return B9}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var pd=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var BC=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var Je,ce;function R1(t){switch(t){default:return x();case v.CANCELLED:case v.UNKNOWN:case v.DEADLINE_EXCEEDED:case v.RESOURCE_EXHAUSTED:case v.INTERNAL:case v.UNAVAILABLE:case v.UNAUTHENTICATED:return!1;case v.INVALID_ARGUMENT:case v.NOT_FOUND:case v.ALREADY_EXISTS:case v.PERMISSION_DENIED:case v.FAILED_PRECONDITION:case v.ABORTED:case v.OUT_OF_RANGE:case v.UNIMPLEMENTED:case v.DATA_LOSS:return!0}}function x1(t){if(t===void 0)return Qe("GRPC error has no .code"),v.UNKNOWN;switch(t){case Je.OK:return v.OK;case Je.CANCELLED:return v.CANCELLED;case Je.UNKNOWN:return v.UNKNOWN;case Je.DEADLINE_EXCEEDED:return v.DEADLINE_EXCEEDED;case Je.RESOURCE_EXHAUSTED:return v.RESOURCE_EXHAUSTED;case Je.INTERNAL:return v.INTERNAL;case Je.UNAVAILABLE:return v.UNAVAILABLE;case Je.UNAUTHENTICATED:return v.UNAUTHENTICATED;case Je.INVALID_ARGUMENT:return v.INVALID_ARGUMENT;case Je.NOT_FOUND:return v.NOT_FOUND;case Je.ALREADY_EXISTS:return v.ALREADY_EXISTS;case Je.PERMISSION_DENIED:return v.PERMISSION_DENIED;case Je.FAILED_PRECONDITION:return v.FAILED_PRECONDITION;case Je.ABORTED:return v.ABORTED;case Je.OUT_OF_RANGE:return v.OUT_OF_RANGE;case Je.UNIMPLEMENTED:return v.UNIMPLEMENTED;case Je.DATA_LOSS:return v.DATA_LOSS;default:return x()}}(ce=Je||(Je={}))[ce.OK=0]="OK",ce[ce.CANCELLED=1]="CANCELLED",ce[ce.UNKNOWN=2]="UNKNOWN",ce[ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ce[ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ce[ce.NOT_FOUND=5]="NOT_FOUND",ce[ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",ce[ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",ce[ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",ce[ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ce[ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ce[ce.ABORTED=10]="ABORTED",ce[ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",ce[ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",ce[ce.INTERNAL=13]="INTERNAL",ce[ce.UNAVAILABLE=14]="UNAVAILABLE",ce[ce.DATA_LOSS=15]="DATA_LOSS";var dO=null;function M1(){return new TextEncoder}var Q9=new Zs([4294967295,4294967295],0);function hO(t){let e=M1().encode(t),n=new Gk;return n.update(e),new Uint8Array(n.digest())}function fO(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Zs([n,r],0),new Zs([i,s],0)]}var $C=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new io(`Invalid padding: ${n}`);if(r<0)throw new io(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new io(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new io(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Zs.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Zs.fromNumber(r)));return i.compare(Q9)===1&&(i=new Zs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let n=hO(e),[r,i]=fO(n);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let n=hO(e),[r,i]=fO(n);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},io=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var gd=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,md.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(L.min(),i,new Me(Y),en(),Z())}},md=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,Z(),Z(),Z())}};var ru=class{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}},Bg=class{constructor(e,n){this.targetId=e,this.me=n}},$g=class{constructor(e,n,r=_t.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},Hg=class{constructor(){this.fe=0,this.ge=gO(),this.pe=_t.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=Z(),n=Z(),r=Z();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:x()}}),new md(this.pe,this.ye,e,n,r)}ve(){this.we=!1,this.ge=gO()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,O(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},HC=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=en(),this.qe=pO(),this.Qe=new Me(Y)}Ke(e){for(let n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(let n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{let r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:x()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){let n=e.targetId,r=e.me.count,i=this.Je(n);if(i){let s=i.target;if(Vg(s))if(r===0){let o=new b(s.path);this.Ue(n,o,rt.newNoDocument(o,L.min()))}else O(r===1);else{let o=this.Ye(n);if(o!==r){let a=this.Ze(e),u=a?this.Xe(a,e,o):1;if(u!==0){this.je(n);let c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}dO?.et(function(l,d,h,f,p){var g,m,I,R,C,P;let j={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},H=d.unchangedNames;return H&&(j.bloomFilter={applied:p===0,hashCount:(g=H?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(R=(I=(m=H?.bits)===null||m===void 0?void 0:m.bitmap)===null||I===void 0?void 0:I.length)!==null&&R!==void 0?R:0,padding:(P=(C=H?.bits)===null||C===void 0?void 0:C.padding)!==null&&P!==void 0?P:0,mightContain:ve=>{var lt;return(lt=f?.mightContain(ve))!==null&&lt!==void 0&&lt}}),j}(o,e.me,this.Le.tt(),a,u))}}}}Ze(e){let n=e.me.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=$i(r).toUint8Array()}catch(u){if(u instanceof Og)return Mn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new $C(o,i,s)}catch(u){return Mn(u instanceof io?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){let n=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&Vg(a.target)){let u=new b(a.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,rt.newNoDocument(u,e))}s.be&&(n.set(o,s.Ce()),s.ve())}});let r=Z();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{let c=this.Je(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new gd(e,n,this.Qe,this.ke,r);return this.ke=en(),this.qe=pO(),this.Qe=new Me(Y),i}$e(e,n){if(!this.ze(e))return;let r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let n=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Hg,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new be(Y),this.qe=this.qe.insert(e,n)),n}ze(e){let n=this.Je(e)!==null;return n||E("WatchChangeAggregator","Detected inactive target",e),n}Je(e){let n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Hg),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function pO(){return new Me(b.comparator)}function gO(){return new Me(b.comparator)}var Y9={asc:"ASCENDING",desc:"DESCENDING"},Z9={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},X9={and:"AND",or:"OR"},qC=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function GC(t,e){return t.useProto3Json||Ad(e)?e:{value:e}}function lu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function N1(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function J9(t,e){return lu(t,e.toTimestamp())}function Ze(t){return O(!!t),L.fromTimestamp(function(n){let r=Wr(n);return new je(r.seconds,r.nanos)}(t))}function vT(t,e){return zC(t,e).canonicalString()}function zC(t,e){let n=function(i){return new le(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function P1(t){let e=le.fromString(t);return O(H1(e)),e}function yd(t,e){return vT(t.databaseId,e.path)}function _r(t,e){let n=P1(e);if(n.get(1)!==t.databaseId.projectId)throw new w(v.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new w(v.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new b(F1(n))}function k1(t,e){return vT(t.databaseId,e)}function O1(t){let e=P1(t);return e.length===4?le.emptyPath():F1(e)}function WC(t){return new le(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function F1(t){return O(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function mO(t,e,n){return{name:yd(t,e),fields:n.value.mapValue.fields}}function L1(t,e,n){let r=_r(t,e.name),i=Ze(e.updateTime),s=e.createTime?Ze(e.createTime):L.min(),o=new Ft({mapValue:{fields:e.fields}}),a=rt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function e3(t,e){return"found"in e?function(r,i){O(!!i.found),i.found.name,i.found.updateTime;let s=_r(r,i.found.name),o=Ze(i.found.updateTime),a=i.found.createTime?Ze(i.found.createTime):L.min(),u=new Ft({mapValue:{fields:i.found.fields}});return rt.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){O(!!i.missing),O(!!i.readTime);let s=_r(r,i.missing),o=Ze(i.readTime);return rt.newNoDocument(s,o)}(t,e):x()}function t3(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:x()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(O(l===void 0||typeof l=="string"),_t.fromBase64String(l||"")):(O(l===void 0||l instanceof Buffer||l instanceof Uint8Array),_t.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let l=c.code===void 0?v.UNKNOWN:x1(c.code);return new w(l,c.message||"")}(o);n=new $g(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=_r(t,r.document.name),s=Ze(r.document.updateTime),o=r.document.createTime?Ze(r.document.createTime):L.min(),a=new Ft({mapValue:{fields:r.document.fields}}),u=rt.newFoundDocument(i,s,o,a),c=r.targetIds||[],l=r.removedTargetIds||[];n=new ru(c,l,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=_r(t,r.document),s=r.readTime?Ze(r.readTime):L.min(),o=rt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new ru([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=_r(t,r.document),s=r.removedTargetIds||[];n=new ru([],s,i,null)}else{if(!("filter"in e))return x();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new BC(i,s),a=r.targetId;n=new Bg(a,o)}}return n}function _d(t,e){let n;if(e instanceof Wi)n={update:mO(t,e.key,e.value)};else if(e instanceof Ki)n={delete:yd(t,e.key)};else if(e instanceof zn)n={update:mO(t,e.key,e.data),updateMask:a3(e.fieldMask)};else{if(!(e instanceof hd))return x();n={verify:yd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Gi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Kr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Qr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof zi)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw x()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:J9(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:x()}(t,e.precondition)),n}function KC(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?ze.updateTime(Ze(s.updateTime)):s.exists!==void 0?ze.exists(s.exists):ze.none()}(e.currentDocument):ze.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)O(a.setToServerValue==="REQUEST_TIME"),u=new Gi;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];u=new Kr(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];u=new Qr(l)}else"increment"in a?u=new zi(o,a.increment):x();let c=Ye.fromServerFormat(a.fieldPath);return new lo(c,u)}(t,i)):[];if(e.update){e.update.name;let i=_r(t,e.update.name),s=new Ft({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(u){let c=u.fieldPaths||[];return new hn(c.map(l=>Ye.fromServerFormat(l)))}(e.updateMask);return new zn(i,s,o,n,r)}return new Wi(i,s,n,r)}if(e.delete){let i=_r(t,e.delete);return new Ki(i,n)}if(e.verify){let i=_r(t,e.verify);return new hd(i,n)}return x()}function n3(t,e){return t&&t.length>0?(O(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Ze(i.updateTime):Ze(s);return o.isEqual(L.min())&&(o=Ze(s)),new UC(o,i.transformResults||[])}(n,e))):[]}function V1(t,e){return{documents:[k1(t,e.path)]}}function U1(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=k1(t,i);let s=function(c){if(c.length!==0)return $1(Ee.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(c){if(c.length!==0)return c.map(l=>function(h){return{field:Za(h.field),direction:i3(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=GC(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:i}}function j1(t){let e=O1(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){O(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=B1(d);return h instanceof Ee&&mT(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new uo(Xa(p.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Ad(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(d){let h=!!d.before,f=d.values||[];return new Er(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){let h=!d.before,f=d.values||[];return new Er(f,h)}(n.endAt)),f1(e,i,o,s,a,"F",u,c)}function r3(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return x()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function B1(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Xa(n.unaryFilter.field);return ae.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Xa(n.unaryFilter.field);return ae.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Xa(n.unaryFilter.field);return ae.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Xa(n.unaryFilter.field);return ae.create(o,"!=",{nullValue:"NULL_VALUE"});default:return x()}}(t):t.fieldFilter!==void 0?function(n){return ae.create(Xa(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return x()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ee.create(n.compositeFilter.filters.map(r=>B1(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return x()}}(n.compositeFilter.op))}(t):x()}function i3(t){return Y9[t]}function s3(t){return Z9[t]}function o3(t){return X9[t]}function Za(t){return{fieldPath:t.canonicalString()}}function Xa(t){return Ye.fromServerFormat(t.fieldPath)}function $1(t){return t instanceof ae?function(n){if(n.op==="=="){if(Jk(n.value))return{unaryFilter:{field:Za(n.field),op:"IS_NAN"}};if(Xk(n.value))return{unaryFilter:{field:Za(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Jk(n.value))return{unaryFilter:{field:Za(n.field),op:"IS_NOT_NAN"}};if(Xk(n.value))return{unaryFilter:{field:Za(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Za(n.field),op:s3(n.op),value:n.value}}}(t):t instanceof Ee?function(n){let r=n.getFilters().map(i=>$1(i));return r.length===1?r[0]:{compositeFilter:{op:o3(n.op),filters:r}}}(t):x()}function a3(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function H1(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var du=class t{constructor(e,n,r,i,s=L.min(),o=L.min(),a=_t.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var qg=class{constructor(e){this.ut=e}};function u3(t,e){let n;if(e.document)n=L1(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=b.fromSegments(e.noDocument.path),i=fo(e.noDocument.readTime);n=rt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return x();{let r=b.fromSegments(e.unknownDocument.path),i=fo(e.unknownDocument.version);n=rt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new je(i[0],i[1]);return L.fromTimestamp(s)}(e.readTime)),n}function yO(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Gg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:yd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:lu(s,o.version.toTimestamp()),createTime:lu(s,o.createTime.toTimestamp())}}(t.ut,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ho(e.version)};else{if(!e.isUnknownDocument())return x();r.unknownDocument={path:n.path.toArray(),version:ho(e.version)}}return r}function Gg(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ho(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function fo(t){let e=new je(t.seconds,t.nanoseconds);return L.fromTimestamp(e)}function to(t,e){let n=(e.baseMutations||[]).map(s=>KC(t.ut,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>KC(t.ut,s)),i=je.fromMillis(e.localWriteTimeMs);return new fd(e.batchId,i,n,r)}function ed(t){let e=fo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?fo(t.lastLimboFreeSnapshotVersion):L.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return O(s.documents.length===1),Wt(Iu(O1(s.documents[0])))}(t.query):function(s){return Wt(j1(s))}(t.query),new du(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,_t.fromBase64String(t.resumeToken))}function q1(t,e){let n=ho(e.snapshotVersion),r=ho(e.lastLimboFreeSnapshotVersion),i;i=Vg(e.target)?V1(t.ut,e.target):U1(t.ut,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:co(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function wT(t){let e=j1({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?jg(e,e.limit,"L"):e}function cC(t,e){return new pd(e.largestBatchId,KC(t.ut,e.overlayMutation))}function _O(t,e){let n=e.path.lastSegment();return[t,zt(e.path.popLast()),n]}function vO(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ho(r.readTime),documentKey:zt(r.documentKey.path),largestBatchId:r.largestBatchId}}var QC=class{getBundleMetadata(e,n){return wO(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:fo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return wO(e).put(function(i){return{bundleId:i.id,createTime:ho(Ze(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return EO(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:wT(s.bundledQuery),readTime:fo(s.readTime)}}(r)})}saveNamedQuery(e,n){return EO(e).put(function(i){return{name:i.name,readTime:ho(Ze(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function wO(t){return vt(t,"bundles")}function EO(t){return vt(t,"namedQueries")}var zg=class t{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return Ql(e).get(_O(this.userId,n)).next(r=>r?cC(this.serializer,r):null)}getOverlays(e,n){let r=mr();return y.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new pd(n,o);i.push(this.lt(e,a))}),y.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(zt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Ql(e).j("collectionPathOverlayIndex",a))}),y.waitFor(s)}getOverlaysForCollection(e,n,r){let i=mr(),s=zt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Ql(e).U("collectionPathOverlayIndex",o).next(a=>{for(let u of a){let c=cC(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=mr(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Ql(e).J({index:"collectionGroupOverlayIndex",range:a},(u,c,l)=>{let d=cC(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}lt(e,n){return Ql(e).put(function(i,s,o){let[a,u,c]=_O(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:_d(i.ut,o.mutation)}}(this.serializer,this.userId,n))}};function Ql(t){return vt(t,"documentOverlays")}var Gr=class{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(Ge(e.integerValue));else if("doubleValue"in e){let r=Ge(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),ad(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Tt(n,20),typeof r=="string"&&(r=Wr(r)),n.dt(`${r.seconds||""}`),n.Et(r.nanos||0)}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt($i(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?o1(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):x()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){let r=e.fields||{};this.Tt(n,55);for(let i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){let r=e.values||[];this.Tt(n,50);for(let i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),b.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}};Gr.St=new Gr;function c3(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function IO(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=c3(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var YC=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{let i=n.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){let n=this.Lt(e),r=IO(n);this.Bt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}kt(e){let n=this.Lt(e),r=IO(n);this.Bt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Bt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Lt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Dt(e){let n=255&e;n===0?(this.Qt(0),this.Qt(255)):n===255?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){let n=255&e;n===0?(this.$t(0),this.$t(255)):n===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Bt(1),this.buffer[this.position++]=e}$t(e){this.Bt(1),this.buffer[this.position++]=~e}Bt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},ZC=class{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}},XC=class{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}},no=class{constructor(){this.Wt=new YC,this.Gt=new ZC(this.Wt),this.zt=new XC(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}};var ro=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ht(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function ki(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=CO(t.arrayValue,e.arrayValue),n!==0?n:(n=CO(t.directionalValue,e.directionalValue),n!==0?n:b.comparator(t.documentKey,e.documentKey)))}function CO(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var Wg=class{constructor(e){this.Jt=new be((n,r)=>Ye.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(O(e.collectionGroup===this.collectionId),this.Xt)return!1;let n=wC(e);if(n!==void 0&&!this.tn(n))return!1;let r=Js(e),i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){let a=this.Jt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[s];if(!this.nn(a,u)||!this.rn(this.Yt[o++],u))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Yt.length||!this.rn(this.Yt[o++],a))return!1}return!0}sn(){if(this.Xt)return null;let e=new be(Ye.comparator),n=[];for(let r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new tu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new tu(r.field,0))}for(let r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new tu(r.field,r.dir==="asc"?0:1)));return new su(su.UNKNOWN_ID,this.collectionId,n,od.empty())}tn(e){for(let n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function G1(t){var e,n;if(O(t instanceof ae||t instanceof Ee),t instanceof ae){if(t instanceof Lg){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>ae.create(t.field,"==",s)))||[];return Ee.create(i,"or")}return t}let r=t.filters.map(i=>G1(i));return Ee.create(r,t.op)}function l3(t){if(t.getFilters().length===0)return[];let e=tD(G1(t));return O(z1(e)),JC(e)||eD(e)?[e]:e.getFilters()}function JC(t){return t instanceof ae}function eD(t){return t instanceof Ee&&mT(t)}function z1(t){return JC(t)||eD(t)||function(n){if(n instanceof Ee&&AC(n)){for(let r of n.getFilters())if(!JC(r)&&!eD(r))return!1;return!0}return!1}(t)}function tD(t){if(O(t instanceof ae||t instanceof Ee),t instanceof ae)return t;if(t.filters.length===1)return tD(t.filters[0]);let e=t.filters.map(r=>tD(r)),n=Ee.create(e,t.op);return n=Kg(n),z1(n)?n:(O(n instanceof Ee),O(au(n)),O(n.filters.length>1),n.filters.reduce((r,i)=>ET(r,i)))}function ET(t,e){let n;return O(t instanceof ae||t instanceof Ee),O(e instanceof ae||e instanceof Ee),n=t instanceof ae?e instanceof ae?function(i,s){return Ee.create([i,s],"and")}(t,e):DO(t,e):e instanceof ae?DO(e,t):function(i,s){if(O(i.filters.length>0&&s.filters.length>0),au(i)&&au(s))return l1(i,s.getFilters());let o=AC(i)?i:s,a=AC(i)?s:i,u=o.filters.map(c=>ET(c,a));return Ee.create(u,"or")}(t,e),Kg(n)}function DO(t,e){if(au(e))return l1(e,t.getFilters());{let n=e.filters.map(r=>ET(t,r));return Ee.create(n,"or")}}function Kg(t){if(O(t instanceof ae||t instanceof Ee),t instanceof ae)return t;let e=t.getFilters();if(e.length===1)return Kg(e[0]);if(u1(t))return t;let n=e.map(i=>Kg(i)),r=[];return n.forEach(i=>{i instanceof ae?r.push(i):i instanceof Ee&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ee.create(r,t.op)}var nD=class{constructor(){this.on=new vd}addToCollectionParentIndex(e,n){return this.on.add(n),y.resolve()}getCollectionParents(e,n){return y.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return y.resolve()}deleteFieldIndex(e,n){return y.resolve()}deleteAllFieldIndexes(e){return y.resolve()}createTargetIndexes(e,n){return y.resolve()}getDocumentsMatchingTarget(e,n){return y.resolve(null)}getIndexType(e,n){return y.resolve(0)}getFieldIndexes(e,n){return y.resolve([])}getNextCollectionGroupToUpdate(e){return y.resolve(null)}getMinOffset(e,n){return y.resolve(Nn.min())}getMinOffsetFromCollectionGroup(e,n){return y.resolve(Nn.min())}updateCollectionGroup(e,n,r){return y.resolve()}updateIndexEntries(e,n){return y.resolve()}},vd=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new be(le.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new be(le.comparator)).toArray()}};var vg=new Uint8Array(0),rD=class{constructor(e,n){this.databaseId=n,this._n=new vd,this.an=new Ir(r=>co(r),(r,i)=>Rd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});let s={collectionId:r,parent:zt(i)};return TO(e).put(s)}return y.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[WO(n),""],!1,!0);return TO(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(gr(o.parent))}return r})}addFieldIndex(e,n){let r=Yl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=Wa(e);return s.next(a=>{o.put(vO(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=Yl(e),i=Wa(e),s=za(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=Yl(e),r=za(e),i=Wa(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return y.forEach(this.un(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Wg(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=za(e),i=!0,s=new Map;return y.forEach(this.un(n),o=>this.cn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Z(),a=[];return y.forEach(s,(u,c)=>{E("IndexedDbIndexManager",`Using index ${function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map(P=>`${P.fieldPath}:${P.kind}`).join(",")}`}(u)} to execute ${co(n)}`);let l=function(C,P){let j=wC(P);if(j===void 0)return null;for(let H of Ug(C,j.fieldPath))switch(H.op){case"array-contains-any":return H.value.arrayValue.values||[];case"array-contains":return[H.value]}return null}(c,u),d=function(C,P){let j=new Map;for(let H of Js(P))for(let ve of Ug(C,H.fieldPath))switch(ve.op){case"==":case"in":j.set(H.fieldPath.canonicalString(),ve.value);break;case"not-in":case"!=":return j.set(H.fieldPath.canonicalString(),ve.value),Array.from(j.values())}return null}(c,u),h=function(C,P){let j=[],H=!0;for(let ve of Js(P)){let lt=ve.kind===0?iO(C,ve.fieldPath,C.startAt):sO(C,ve.fieldPath,C.startAt);j.push(lt.value),H&&(H=lt.inclusive)}return new Er(j,H)}(c,u),f=function(C,P){let j=[],H=!0;for(let ve of Js(P)){let lt=ve.kind===0?sO(C,ve.fieldPath,C.endAt):iO(C,ve.fieldPath,C.endAt);j.push(lt.value),H&&(H=lt.inclusive)}return new Er(j,H)}(c,u),p=this.ln(u,c,h),g=this.ln(u,c,f),m=this.hn(u,c,d),I=this.Pn(u.indexId,l,p,h.inclusive,g,f.inclusive,m);return y.forEach(I,R=>r.G(R,n.limit).next(C=>{C.forEach(P=>{let j=b.fromSegments(P.documentKey);o.has(j)||(o=o.add(j),a.push(j))})}))}).next(()=>a)}return y.resolve(null)})}un(e){let n=this.an.get(e);return n||(e.filters.length===0?n=[e]:n=l3(Ee.create(e.filters,"and")).map(r=>LC(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,i,s,o,a){let u=(n!=null?n.length:1)*Math.max(r.length,s.length),c=u/(n!=null?n.length:1),l=[];for(let d=0;d<u;++d){let h=n?this.In(n[d/c]):vg,f=this.Tn(e,h,r[d%c],i),p=this.En(e,h,s[d%c],o),g=a.map(m=>this.Tn(e,h,m,!0));l.push(...this.createRange(f,p,g))}return l}Tn(e,n,r,i){let s=new ro(e,b.empty(),n,r);return i?s:s.Ht()}En(e,n,r,i){let s=new ro(e,b.empty(),n,r);return i?s.Ht():s}cn(e,n){let r=new Wg(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.un(n);return y.forEach(i,s=>this.cn(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new be(Ye.comparator),l=!1;for(let d of u.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:c=c.add(h.field));for(let d of u.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}dn(e,n){let r=new no;for(let i of Js(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.jt(i.kind);Gr.St.ht(s,o)}return r.Ut()}In(e){let n=new no;return Gr.St.ht(e,n.jt(0)),n.Ut()}An(e,n){let r=new no;return Gr.St.ht(ao(this.databaseId,n),r.jt(function(s){let o=Js(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(r===null)return[];let i=[];i.push(new no);let s=0;for(let o of Js(e)){let a=r[s++];for(let u of i)if(this.Rn(n,o.fieldPath)&&dd(a))i=this.Vn(i,o,a);else{let c=u.jt(o.kind);Gr.St.ht(a,c)}}return this.mn(i)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let u=new no;u.seed(a.Ut()),Gr.St.ht(o,u.jt(n.kind)),s.push(u)}return s}Rn(e,n){return!!e.filters.find(r=>r instanceof ae&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=Yl(e),i=Wa(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{let o=[];return y.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(l,d){let h=d?new od(d.sequenceNumber,new Nn(fo(d.readTime),new b(gr(d.documentKey)),d.largestBatchId)):od.empty(),f=l.fields.map(([p,g])=>new tu(Ye.fromServerFormat(p),g));return new su(l.indexId,l.collectionGroup,f,h)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Y(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=Yl(e),s=Wa(e);return this.fn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>y.forEach(a,u=>s.put(vO(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return y.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?y.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),y.forEach(a,u=>this.gn(e,i,u).next(c=>{let l=this.pn(s,u);return c.isEqual(l)?y.resolve():this.yn(e,s,u,c,l)}))))})}wn(e,n,r,i){return za(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,i){return za(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){let i=za(e),s=new be(ki);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(o,a)=>{s=s.add(new ro(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,n){let r=new be(ki),i=this.dn(n,e);if(i==null)return r;let s=wC(n);if(s!=null){let o=e.data.field(s.fieldPath);if(dd(o))for(let a of o.arrayValue.values||[])r=r.add(new ro(n.indexId,e.key,this.In(a),i))}else r=r.add(new ro(n.indexId,e.key,vg,i));return r}yn(e,n,r,i,s){E("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(u,c,l,d,h){let f=u.getIterator(),p=c.getIterator(),g=Ga(f),m=Ga(p);for(;g||m;){let I=!1,R=!1;if(g&&m){let C=l(g,m);C<0?R=!0:C>0&&(I=!0)}else g!=null?R=!0:I=!0;I?(d(m),m=Ga(p)):R?(h(g),g=Ga(f)):(g=Ga(f),m=Ga(p))}}(i,s,ki,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.Sn(e,n,r,a))}),y.waitFor(o)}fn(e){let n=1;return Wa(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ki(o,a)).filter((o,a,u)=>!a||ki(o,u[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=ki(o,e),u=ki(o,n);if(a===0)i[0]=e.Ht();else if(a>0&&u<0)i.push(o),i.push(o.Ht());else if(u>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,vg,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,vg,[]];s.push(IDBKeyRange.bound(a,u))}return s}bn(e,n){return ki(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(bO)}getMinOffset(e,n){return y.mapArray(this.un(n),r=>this.cn(e,r).next(i=>i||x())).next(bO)}};function TO(t){return vt(t,"collectionParents")}function za(t){return vt(t,"indexEntries")}function Yl(t){return vt(t,"indexConfiguration")}function Wa(t){return vt(t,"indexState")}function bO(t){O(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;fT(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Nn(e.readTime,e.documentKey,n)}var SO={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function W1(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,u=r.J({range:o},(l,d,h)=>(a++,h.delete()));s.push(u.next(()=>{O(a===1)}));let c=[];for(let l of n.mutations){let d=JO(e,l.key.path,n.batchId);s.push(i.delete(d)),c.push(l.key)}return y.waitFor(s).next(()=>c)}function Qg(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw x();e=t.noDocument}return JSON.stringify(e).length}xn.DEFAULT_COLLECTION_PERCENTILE=10,xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xn.DEFAULT=new xn(41943040,xn.DEFAULT_COLLECTION_PERCENTILE,xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xn.DISABLED=new xn(-1,0,0);var Yg=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,n,r,i){O(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Oi(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=Ja(e),o=Oi(e);return o.add({}).next(a=>{O(typeof a=="number");let u=new fd(a,n,r,i),c=function(f,p,g){let m=g.baseMutations.map(R=>_d(f.ut,R)),I=g.mutations.map(R=>_d(f.ut,R));return{userId:p,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:m,mutations:I}}(this.serializer,this.userId,u),l=[],d=new be((h,f)=>Y(h.canonicalString(),f.canonicalString()));for(let h of i){let f=JO(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(c)),l.push(s.put(f,y9))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Dn[a]=u.keys()}),y.waitFor(l).next(()=>u)})}lookupMutationBatch(e,n){return Oi(e).get(n).next(r=>r?(O(r.userId===this.userId),to(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?y.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Dn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Oi(e).J({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(O(a.batchId>=r),s=to(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Oi(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Oi(e).U("userMutationsIndex",n).next(r=>r.map(i=>to(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=Cg(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ja(e).J({range:i},(o,a,u)=>{let[c,l,d]=o,h=gr(l);if(c===this.userId&&n.path.isEqual(h))return Oi(e).get(d).next(f=>{if(!f)throw x();O(f.userId===this.userId),s.push(to(this.serializer,f))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new be(Y),i=[];return n.forEach(s=>{let o=Cg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=Ja(e).J({range:a},(c,l,d)=>{let[h,f,p]=c,g=gr(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(u)}),y.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=Cg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new be(Y);return Ja(e).J({range:o},(u,c,l)=>{let[d,h,f]=u,p=gr(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.vn(e,a))}vn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(Oi(e).get(s).next(o=>{if(o===null)throw x();O(o.userId===this.userId),r.push(to(this.serializer,o))}))}),y.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return W1(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),y.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return y.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ja(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let u=gr(s[1]);i.push(u)}else a.done()}).next(()=>{O(i.length===0)})})}containsKey(e,n){return K1(e,this.userId,n)}Mn(e){return Q1(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function K1(t,e,n){let r=Cg(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Ja(t).J({range:s,H:!0},(a,u,c)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function Oi(t){return vt(t,"mutations")}function Ja(t){return vt(t,"documentMutations")}function Q1(t){return vt(t,"mutationQueues")}var hu=class t{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new t(0)}static Nn(){return new t(-1)}};var iD=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{let r=new hu(n.highestTargetId);return n.highestTargetId=r.next(),this.Bn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>L.fromTimestamp(new je(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Bn(e,i)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Bn(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ka(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>(O(r.targetCount>0),r.targetCount-=1,this.Bn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return Ka(e).J((o,a)=>{let u=ed(a);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>y.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Ka(e).J((r,i)=>{let s=ed(i);n(s)})}Ln(e){return AO(e).get("targetGlobalKey").next(n=>(O(n!==null),n))}Bn(e,n){return AO(e).put("targetGlobalKey",n)}kn(e,n){return Ka(e).put(q1(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){let r=co(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Ka(e).J({range:i,index:"queryTargetsIndex"},(o,a,u)=>{let c=ed(a);Rd(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Fi(e);return n.forEach(o=>{let a=zt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),y.waitFor(i)}removeMatchingKeys(e,n,r){let i=Fi(e);return y.forEach(n,s=>{let o=zt(s.path);return y.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Fi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Fi(e),s=Z();return i.J({range:r,H:!0},(o,a,u)=>{let c=gr(o[1]),l=new b(c);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=zt(n.path),i=IDBKeyRange.bound([r],[WO(r)],!1,!0),s=0;return Fi(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],u,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}ot(e,n){return Ka(e).get(n).next(r=>r?ed(r):null)}};function Ka(t){return vt(t,"targets")}function AO(t){return vt(t,"targetGlobal")}function Fi(t){return vt(t,"targetDocuments")}function RO([t,e],[n,r]){let i=Y(t,n);return i===0?Y(e,r):i}var sD=class{constructor(e){this.Qn=e,this.buffer=new be(RO),this.Kn=0}$n(){return++this.Kn}Un(e){let n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();RO(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},oD=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){E("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>_(this,null,function*(){this.Wn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Zi(n)?E("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Yi(n)}yield this.Gn(3e5)}))}},aD=class{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return y.resolve(dn.oe);let r=new sD(n);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(E("LruGarbageCollector","Garbage collection skipped; disabled"),y.resolve(SO)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(E("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),SO):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,i,s,o,a,u,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(E("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),Qa()<=pn.DEBUG&&E("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${d} documents in `+(c-u)+`ms
Total Duration: ${c-l}ms`),y.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function d3(t,e){return new aD(t,e)}var uD=class{constructor(e,n){this.db=e,this.garbageCollector=d3(this,n)}jn(e){let n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,i)=>n(i))}addReference(e,n,r){return wg(e,r)}removeReference(e,n,r){return wg(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return wg(e,n)}Xn(e,n){return function(i,s){let o=!1;return Q1(i).Y(a=>K1(i,a,s).next(u=>(u&&(o=!0),y.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Zn(e,(o,a)=>{if(a<=n){let u=this.Xn(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,L.min()),Fi(e).delete(function(d){return[0,zt(d.path)]}(o))))});i.push(u)}}).next(()=>y.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return wg(e,n)}Zn(e,n){let r=Fi(e),i,s=dn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(s!==dn.oe&&n(new b(gr(i)),s),s=c,i=u):s=dn.oe}).next(()=>{s!==dn.oe&&n(new b(gr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function wg(t,e){return Fi(t).put(function(r,i){return{targetId:0,path:zt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var Zg=class{constructor(){this.changes=new Ir(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,rt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?y.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var cD=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Xs(e).put(r)}removeEntry(e,n,r){return Xs(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Gg(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=rt.newInvalidDocument(n);return Xs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Zl(n))},(i,s)=>{r=this.tr(n,s)}).next(()=>r)}nr(e,n){let r={size:0,document:rt.newInvalidDocument(n)};return Xs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Zl(n))},(i,s)=>{r={document:this.tr(n,s),size:Qg(s)}}).next(()=>r)}getEntries(e,n){let r=en();return this.rr(e,n,(i,s)=>{let o=this.tr(i,s);r=r.insert(i,o)}).next(()=>r)}ir(e,n){let r=en(),i=new Me(b.comparator);return this.rr(e,n,(s,o)=>{let a=this.tr(s,o);r=r.insert(s,a),i=i.insert(s,Qg(o))}).next(()=>({documents:r,sr:i}))}rr(e,n,r){if(n.isEmpty())return y.resolve();let i=new be(NO);n.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound(Zl(i.first()),Zl(i.last())),o=i.getIterator(),a=o.getNext();return Xs(e).J({index:"documentKeyIndex",range:s},(u,c,l)=>{let d=b.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&NO(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?l.$(Zl(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Gg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Xs(e).U(IDBKeyRange.bound(a,u,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let l=en();for(let d of c){let h=this.tr(b.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(Md(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=en(),o=MO(n,r),a=MO(n,Nn.max());return Xs(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,l)=>{let d=this.tr(b.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new lD(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return xO(e).get("remoteDocumentGlobalKey").next(n=>(O(!!n),n))}er(e,n){return xO(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){let r=u3(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(L.min())))return r}return rt.newInvalidDocument(e)}};function Y1(t){return new cD(t)}var lD=class extends Zg{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new Ir(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new be((s,o)=>Y(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ar.get(s);if(n.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){let u=yO(this._r.serializer,o);i=i.add(s.path.popLast());let c=Qg(u);r+=c-a.size,n.push(this._r.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){let u=yO(this._r.serializer,o.convertToNoDocument(L.min()));n.push(this._r.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),n.push(this._r.updateMetadata(e,r)),y.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:i})=>(i.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function xO(t){return vt(t,"remoteDocumentGlobal")}function Xs(t){return vt(t,"remoteDocumentsV14")}function Zl(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function MO(t,e){let n=e.documentKey.path.toArray();return[t,Gg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function NO(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Y(n[s],r[s]),i)return i;return i=Y(n.length,r.length),i||(i=Y(n[n.length-2],r[r.length-2]),i||Y(n[n.length-1],r[r.length-1]))}var dD=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Xg=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&rd(r.mutation,i,hn.empty(),je.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Z()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Z()){let i=mr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Jl();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=mr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Z()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=en(),o=nd(),a=function(){return nd()}();return n.forEach((u,c)=>{let l=r.get(c.key);i.has(c.key)&&(l===void 0||l.mutation instanceof zn)?s=s.insert(c.key,c):l!==void 0?(o.set(c.key,l.mutation.getFieldMask()),rd(l.mutation,c,l.mutation.getFieldMask(),je.now())):o.set(c.key,hn.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,l)=>o.set(c,l)),n.forEach((c,l)=>{var d;return a.set(c,new dD(l,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=nd(),i=new Me((o,a)=>o-a),s=Z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(u=>{let c=n.get(u);if(c===null)return;let l=r.get(u)||hn.empty();l=a.applyToLocalView(c,l),r.set(u,l);let d=(i.get(a.batchId)||Z()).add(u);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),c=u.key,l=u.value,d=v1();l.forEach(h=>{if(!s.has(h)){let f=S1(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return y.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return b.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):yT(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):y.resolve(mr()),a=-1,u=s;return o.next(c=>y.forEach(c,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?y.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{u=u.insert(l,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,Z())).next(l=>({batchId:a,changes:_1(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new b(n)).next(r=>{let i=Jl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=Jl();return this.indexManager.getCollectionParents(e,s).next(a=>y.forEach(a,u=>{let c=function(d,h){return new Gn(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{let l=c.getKey();o.get(l)===null&&(o=o.insert(l,rt.newInvalidDocument(l)))});let a=Jl();return o.forEach((u,c)=>{let l=s.get(u);l!==void 0&&rd(l.mutation,c,hn.empty(),je.now()),Md(n,c)&&(a=a.insert(u,c))}),a})}};var hD=class{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return y.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ze(i.createTime)}}(n)),y.resolve()}getNamedQuery(e,n){return y.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(i){return{name:i.name,query:wT(i.bundledQuery),readTime:Ze(i.readTime)}}(n)),y.resolve()}};var fD=class{constructor(){this.overlays=new Me(b.comparator),this.lr=new Map}getOverlay(e,n){return y.resolve(this.overlays.get(n))}getOverlays(e,n){let r=mr();return y.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),y.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),y.resolve()}getOverlaysForCollection(e,n,r){let i=mr(),s=n.length+1,o=new b(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return y.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Me((c,l)=>c-l),o=this.overlays.getIterator();for(;o.hasNext();){let c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let l=s.get(c.largestBatchId);l===null&&(l=mr(),s=s.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}let a=mr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(c,l)),!(a.size()>=i)););return y.resolve(a)}lt(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new pd(n,r));let s=this.lr.get(n);s===void 0&&(s=Z(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}};var wd=class{constructor(){this.hr=new be(et.Pr),this.Ir=new be(et.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){let r=new et(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new et(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){let n=new b(new le([])),r=new et(n,e),i=new et(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){let n=new b(new le([])),r=new et(n,e),i=new et(n,e+1),s=Z();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new et(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},et=class{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return b.comparator(e.key,n.key)||Y(e.gr,n.gr)}static Tr(e,n){return Y(e.gr,n.gr)||b.comparator(e.key,n.key)}};var pD=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new be(et.Pr)}checkEmpty(e){return y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new fd(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.yr=this.yr.add(new et(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return y.resolve(o)}lookupMutationBatch(e,n){return y.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.Sr(r),s=i<0?0:i;return y.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return y.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new et(n,0),i=new et(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{let a=this.wr(o.gr);s.push(a)}),y.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new be(Y);return n.forEach(i=>{let s=new et(i,0),o=new et(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),y.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;b.isDocumentKey(s)||(s=s.child(""));let o=new et(new b(s),0),a=new be(Y);return this.yr.forEachWhile(u=>{let c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.gr)),!0)},o),y.resolve(this.br(a))}br(e){let n=[];return e.forEach(r=>{let i=this.wr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){O(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return y.forEach(n.mutations,i=>{let s=new et(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){let r=new et(n,0),i=this.yr.firstAfterOrEqual(r);return y.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,y.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){let n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var gD=class{constructor(e){this.Cr=e,this.docs=function(){return new Me(b.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return y.resolve(r?r.document.mutableCopy():rt.newInvalidDocument(n))}getEntries(e,n){let r=en();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():rt.newInvalidDocument(i))}),y.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=en(),o=n.path,a=new b(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:c,value:{document:l}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||fT(QO(l),r)<=0||(i.has(l.key)||Md(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return y.resolve(s)}getAllFromCollectionGroup(e,n,r,i){x()}vr(e,n){return y.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new mD(this)}getSize(e){return y.resolve(this.size)}},mD=class extends Zg{constructor(e){super(),this._r=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),y.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}};var yD=class{constructor(e){this.persistence=e,this.Fr=new Ir(n=>co(n),Rd),this.lastRemoteSnapshotVersion=L.min(),this.highestTargetId=0,this.Mr=0,this.Or=new wd,this.targetCount=0,this.Nr=hu.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),y.resolve()}getLastRemoteSnapshotVersion(e){return y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return y.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),y.resolve()}kn(e){this.Fr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Nr=new hu(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,y.resolve()}updateTargetData(e,n){return this.kn(n),y.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,y.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),y.waitFor(s).next(()=>i)}getTargetCount(e){return y.resolve(this.targetCount)}getTargetData(e,n){let r=this.Fr.get(n)||null;return y.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),y.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),y.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),y.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Or.mr(n);return y.resolve(r)}containsKey(e,n){return y.resolve(this.Or.containsKey(n))}};var Jg=class{constructor(e,n){this.Lr={},this.overlays={},this.Br=new dn(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new yD(this),this.indexManager=new nD,this.remoteDocumentCache=function(i){return new gD(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new qg(n),this.Kr=new hD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new fD,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new pD(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){E("MemoryPersistence","Starting transaction:",e);let i=new _D(this.Br.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return y.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}},_D=class extends Ng{constructor(e){super(),this.currentSequenceNumber=e}},em=class t{constructor(e){this.persistence=e,this.Gr=new wd,this.zr=null}static jr(e){return new t(e)}get Hr(){if(this.zr)return this.zr;throw x()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),y.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),y.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),y.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return y.forEach(this.Hr,r=>{let i=b.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,L.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return y.or([()=>y.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}};var vD=class{constructor(e){this.serializer=e}O(e,n,r,i){let s=new Pg("createOrUpgrade",n);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Qk,{unique:!0}),u.createObjectStore("documentMutations")}(e),PO(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=y.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),PO(e)),o=o.next(()=>function(u){let c=u.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:L.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").U().next(l=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Qk,{unique:!0});let d=c.store("mutations"),h=l.map(f=>d.put(f));return y.waitFor(h)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Zr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(o=o.next(()=>this.ei(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ni(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){let c=u.createObjectStore("documentOverlays",{keyPath:R9});c.createIndex("collectionPathOverlayIndex",x9,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",M9,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){let c=u.createObjectStore("remoteDocumentsV14",{keyPath:_9});c.createIndex("documentKeyIndex",v9),c.createIndex("collectionGroupIndex",w9)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ii(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:T9}).createIndex("sequenceNumberIndex",b9,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:S9}).createIndex("documentKeyIndex",A9,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),o}Xr(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=Qg(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>y.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>y.forEach(a,u=>{O(u.userId===s.userId);let c=to(this.serializer,u);return W1(e,s.userId,c).next(()=>{})}))}))}ei(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let u=new le(o),c=function(d){return[0,zt(d)]}(u);s.push(n.get(c).next(l=>l?y.resolve():(d=>n.put({targetId:0,path:zt(d),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>y.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:D9});let r=n.store("collectionParents"),i=new vd,s=o=>{if(i.add(o)){let a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:zt(u)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{let u=new le(o);return s(u.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,u],c)=>{let l=gr(a);return s(l.popLast())}))}ni(e){let n=e.store("targets");return n.J((r,i)=>{let s=ed(i),o=q1(this.serializer,s);return n.put(o)})}ri(e,n){let r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=n.store("remoteDocumentsV14"),u=function(d){return d.document?new b(le.fromString(d.document.name).popFirst(5)):d.noDocument?b.fromSegments(d.noDocument.path):d.unknownDocument?b.fromSegments(d.unknownDocument.path):x()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>y.waitFor(i))}ii(e,n){let r=n.store("mutations"),i=Y1(this.serializer),s=new Jg(em.jr,this.serializer.ut);return r.U().next(o=>{let a=new Map;return o.forEach(u=>{var c;let l=(c=a.get(u.userId))!==null&&c!==void 0?c:Z();to(this.serializer,u).keys().forEach(d=>l=l.add(d)),a.set(u.userId,l)}),y.forEach(a,(u,c)=>{let l=new tt(c),d=zg.ct(this.serializer,l),h=s.getIndexManager(l),f=Yg.ct(l,this.serializer,h,s.referenceDelegate);return new Xg(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new ud(n,dn.oe),u).next()})})}};function PO(t){t.createObjectStore("targetDocuments",{keyPath:I9}).createIndex("documentTargetsIndex",C9,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",E9,{unique:!0}),t.createObjectStore("targetGlobal")}var lC="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",wD=class t{constructor(e,n,r,i,s,o,a,u,c,l,d=16){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=s,this.window=o,this.document=a,this.oi=c,this._i=l,this.ai=d,this.Br=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=h=>Promise.resolve(),!t.D())throw new w(v.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new uD(this,i),this.Ii=n+"main",this.serializer=new qg(u),this.Ti=new Bi(this.Ii,this.ai,new vD(this.serializer)),this.qr=new iD(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Y1(this.serializer),this.Kr=new QC,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,l===!1&&Qe("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new w(v.FAILED_PRECONDITION,lC);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Br=new dn(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=n=>_(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(n=>_(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(()=>_(this,null,function*(){this.started&&(yield this.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Eg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(Zi(e))return E("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return E("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return Xl(e).get("owner").next(n=>y.resolve(this.wi(n)))}Si(e){return Eg(e).delete(this.clientId)}bi(){return _(this,null,function*(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=vt(n,"clientMetadata");return r.U().next(i=>{let s=this.Ci(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return y.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ei)for(let n of e)this.Ei.removeItem(this.vi(n.clientId))}})}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?y.resolve(!0):Xl(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new w(v.FAILED_PRECONDITION,lC);return!1}}return!(!this.networkEnabled||!this.inForeground)||Eg(e).U().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&E("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return _(this,null,function*(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),yield this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new ud(e,dn.oe);return this.pi(n).next(()=>this.Si(n))}),this.Ti.close(),this.Ni()})}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>Eg(e).U().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return Yg.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new rD(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return zg.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){E("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(u){return u===16?P9:u===15?r1:u===14?n1:u===13?t1:u===12?N9:u===11?e1:void x()}(this.ai),o;return this.Ti.runTransaction(e,i,s,a=>(o=new ud(a,this.Br?this.Br.next():dn.oe),n==="readwrite-primary"?this.fi(o).next(u=>!!u||this.gi(o)).next(u=>{if(!u)throw Qe(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new w(v.FAILED_PRECONDITION,YO);return r(o)}).next(u=>this.yi(o).next(()=>u)):this.Bi(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Bi(e){return Xl(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new w(v.FAILED_PRECONDITION,lC)})}yi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Xl(e).put("owner",n)}static D(){return Bi.D()}pi(e){let n=Xl(e);return n.get("owner").next(r=>this.wi(r)?(E("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):y.resolve())}Di(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(Qe(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();let n=/(?:Version|Mobile)\/1[456]/;Zm()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{let r=((n=this.Ei)===null||n===void 0?void 0:n.getItem(this.vi(e)))!==null;return E("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Qe("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){Qe("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Xl(t){return vt(t,"owner")}function Eg(t){return vt(t,"clientMetadata")}function IT(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var ED=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=Z(),i=Z();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var ID=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var tm=class{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=function(){return Zm()?8:ZO(ku())>0?6:4}()}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new ID;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(Qa()<=pn.DEBUG&&E("QueryEngine","SDK will not create cache indexes for query:",Ya(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),y.resolve()):(Qa()<=pn.DEBUG&&E("QueryEngine","Query:",Ya(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(Qa()<=pn.DEBUG&&E("QueryEngine","The SDK decides to create cache indexes for query:",Ya(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wt(n))):y.resolve())}zi(e,n){if(oO(n))return y.resolve(null);let r=Wt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=jg(n,null,"F"),r=Wt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=Z(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let c=this.Yi(n,a);return this.Zi(n,c,o,u.readTime)?this.zi(e,jg(n,null,"F")):this.Xi(e,c,n,u)}))})))}ji(e,n,r,i){return oO(n)||i.isEqual(L.min())?y.resolve(null):this.Gi.getDocuments(e,r).next(s=>{let o=this.Yi(n,s);return this.Zi(n,o,r,i)?y.resolve(null):(Qa()<=pn.DEBUG&&E("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ya(n)),this.Xi(e,o,n,KO(i,-1)).next(a=>a))})}Yi(e,n){let r=new be(m1(e));return n.forEach((i,s)=>{Md(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return Qa()<=pn.DEBUG&&E("QueryEngine","Using full collection scan to execute query:",Ya(n)),this.Gi.getDocumentsMatchingQuery(e,n,Nn.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var CD=class{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new Me(Y),this.ns=new Ir(s=>co(s),Rd),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Xg(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}};function Z1(t,e,n,r){return new CD(t,e,n,r)}function X1(t,e){return _(this,null,function*(){let n=S(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=Z();for(let c of i){o.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}for(let c of s){a.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}return n.localDocuments.getDocuments(r,u).next(c=>({_s:c,removedBatchIds:o,addedBatchIds:a}))})})})}function h3(t,e){let n=S(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,u,c,l){let d=c.batch,h=d.keys(),f=y.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(u,p)).next(g=>{let m=c.docVersions.get(p);O(m!==null),g.version.compareTo(m)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),l.addEntry(g)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(u,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=Z();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function J1(t){let e=S(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function f3(t,e){let n=S(t),r=e.snapshotVersion,i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(_t.EMPTY_BYTE_STRING,L.min()).withLastLimboFreeSnapshotVersion(L.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(g,m,I){return g.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(h,f,l)&&a.push(n.qr.updateTargetData(s,f))});let u=en(),c=Z();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(eF(s,o,e.documentUpdates).next(l=>{u=l.us,c=l.cs})),!r.isEqual(L.min())){let l=n.qr.getLastRemoteSnapshotVersion(s).next(d=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return y.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.ts=i,s))}function eF(t,e,n){let r=Z(),i=Z();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=en();return n.forEach((a,u)=>{let c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(L.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):E("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{us:o,cs:i}})}function p3(t,e){let n=S(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function fu(t,e){let n=S(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,y.resolve(i)):n.qr.allocateTargetId(r).next(o=>(i=new du(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}function pu(t,e,n){return _(this,null,function*(){let r=S(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Zi(o))throw o;E("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)})}function nm(t,e,n){let r=S(t),i=L.min(),s=Z();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,l){let d=S(u),h=d.ns.get(l);return h!==void 0?y.resolve(d.ts.get(h)):d.qr.getTargetData(c,l)}(r,o,Wt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?i:L.min(),n?s:Z())).next(a=>(rF(r,g1(e),a),{documents:a,ls:s})))}function tF(t,e){let n=S(t),r=S(n.qr),i=n.ts.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function nF(t,e){let n=S(t),r=n.rs.get(e)||L.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ss.getAllFromCollectionGroup(i,e,KO(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(rF(n,e,i),i))}function rF(t,e,n){let r=t.rs.get(e)||L.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}function g3(t,e,n,r){return _(this,null,function*(){let i=S(t),s=Z(),o=en();for(let c of n){let l=e.hs(c.metadata.name);c.document&&(s=s.add(l));let d=e.Ps(c);d.setReadTime(e.Is(c.metadata.readTime)),o=o.insert(l,d)}let a=i.ss.newChangeBuffer({trackRemovals:!0}),u=yield fu(i,function(l){return Wt(Iu(le.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>eF(c,a,o).next(l=>(a.apply(c),l)).next(l=>i.qr.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.qr.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,l.us,l.cs)).next(()=>l.us)))})}function m3(r,i){return _(this,arguments,function*(t,e,n=Z()){let s=yield fu(t,Wt(wT(e.bundledQuery))),o=S(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let u=Ze(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.Kr.saveNamedQuery(a,e);let c=s.withResumeToken(_t.EMPTY_BYTE_STRING,u);return o.ts=o.ts.insert(c.targetId,c),o.qr.updateTargetData(a,c).next(()=>o.qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.Kr.saveNamedQuery(a,e))})})}function kO(t,e){return`firestore_clients_${t}_${e}`}function OO(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function dC(t,e){return`firestore_targets_${t}_${e}`}var rm=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ts(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new w(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(Qe("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},id=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new w(r.error.code,r.error.message))),s?new t(e,r.state,i):(Qe("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},im=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=_T();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=XO(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(Qe("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},DD=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(Qe("SharedClientState",`Failed to parse online state: ${e}`),null)}},Ed=class{constructor(){this.activeTargetIds=_T()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},sd=class{constructor(e,n,r,i,s){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Me(Y),this.started=!1,this.ps=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=kO(this.persistenceKey,this.Rs),this.ws=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new Ed),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.vs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){return _(this,null,function*(){let e=yield this.syncEngine.Li();for(let r of e){if(r===this.Rs)continue;let i=this.getItem(kO(this.persistenceKey,r));if(i){let s=im.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();let n=this.storage.getItem(this.Cs);if(n){let r=this.Ms(n);r&&this.xs(r)}for(let r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Ls(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(dC(this.persistenceKey,e));if(r){let i=id.Ts(e,r);i&&(n=i.state)}}return this.Bs.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Bs.As(e),this.Fs()}isLocalQueryTarget(e){return this.Bs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(dC(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Ls(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return E("SharedClientState","READ",e,n),n}setItem(e,n){E("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){E("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){let n=e;if(n.storageArea===this.storage){if(E("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ys)return void Qe("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(()=>_(this,null,function*(){if(this.started){if(n.key!==null){if(this.Ss.test(n.key)){if(n.newValue==null){let r=this.Ks(n.key);return this.$s(r,null)}{let r=this.Us(n.key,n.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(n.key)){if(n.newValue!==null){let r=this.Ws(n.key,n.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.zs(n.key,n.newValue);if(r)return this.js(r)}}else if(n.key===this.Cs){if(n.newValue!==null){let r=this.Ms(n.newValue);if(r)return this.xs(r)}}else if(n.key===this.ws){let r=function(s){let o=dn.oe;if(s!=null)try{let a=JSON.parse(s);O(typeof a=="number"),o=a}catch(a){Qe("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==dn.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.vs){let r=this.Hs(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(n)}))}}get Bs(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Bs.Es())}Ns(e,n,r){let i=new rm(this.currentUser,e,n,r),s=OO(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Ls(e){let n=OO(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){let n={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(n))}ks(e,n,r){let i=dC(this.persistenceKey,e),s=new id(e,n,r);this.setItem(i,s.Es())}Qs(e){let n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){let n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){let r=this.Ks(e);return im.Ts(r,n)}Ws(e,n){let r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return rm.Ts(new tt(s),i,n)}zs(e,n){let r=this.Ds.exec(e),i=Number(r[1]);return id.Ts(i,n)}Ms(e){return DD.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){return _(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);E("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){let r=n?this.gs.insert(e,n):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=_T();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},sm=class{constructor(){this.eo=new Ed,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new Ed,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var TD=class{ro(e){}shutdown(){}};var om=class{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){E("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ao)e(0)}_o(){E("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ig=null;function hC(){return Ig===null?Ig=function(){return 268435456+Math.round(2147483648*Math.random())}():Ig++,"0x"+Ig.toString(16)}var y3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var bD=class{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}Eo(e){this.Ao=e}onMessage(e){this.Ro=e}close(){this.lo()}send(e){this.co(e)}Vo(){this.Po()}mo(){this.To()}fo(e){this.Ao(e)}po(e){this.Ro(e)}};var Ot="WebChannelConnection",SD=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.yo=r+"://"+n.host,this.wo=`projects/${i}/databases/${s}`,this.So=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get bo(){return!1}Do(n,r,i,s,o){let a=hC(),u=this.Co(n,r.toUriEncodedString());E("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);let c={"google-cloud-resource-prefix":this.wo,"x-goog-request-params":this.So};return this.vo(c,s,o),this.Fo(n,u,c,i).then(l=>(E("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Mn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",u,"request:",i),l})}Mo(n,r,i,s,o,a){return this.Do(n,r,i,s,o)}vo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Eu}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}Co(n,r){let i=y3[n];return`${this.yo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Fo(e,n,r,i){let s=hC();return new Promise((o,a)=>{let u=new qk;u.setWithCredentials(!0),u.listenOnce(Bk.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case _g.NO_ERROR:let l=u.getResponseJson();E(Ot,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case _g.TIMEOUT:E(Ot,`RPC '${e}' ${s} timed out`),a(new w(v.DEADLINE_EXCEEDED,"Request time out"));break;case _g.HTTP_ERROR:let d=u.getStatus();if(E(Ot,`RPC '${e}' ${s} failed with status:`,d,"response text:",u.getResponseText()),d>0){let h=u.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(m){let I=m.toLowerCase().replace(/_/g,"-");return Object.values(v).indexOf(I)>=0?I:v.UNKNOWN}(f.status);a(new w(p,f.message))}else a(new w(v.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new w(v.UNAVAILABLE,"Connection failed."));break;default:x()}}finally{E(Ot,`RPC '${e}' ${s} completed.`)}});let c=JSON.stringify(i);E(Ot,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}xo(e,n,r){let i=hC(),s=[this.yo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Uk(),a=jk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.xmlHttpFactory=new Hk({})),this.vo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;let l=s.join("");E(Ot,`Creating RPC '${e}' stream ${i}: ${l}`,u);let d=o.createWebChannel(l,u),h=!1,f=!1,p=new bD({co:m=>{f?E(Ot,`Not sending because RPC '${e}' stream ${i} is closed:`,m):(h||(E(Ot,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),E(Ot,`RPC '${e}' stream ${i} sending:`,m),d.send(m))},lo:()=>d.close()}),g=(m,I,R)=>{m.listen(I,C=>{try{R(C)}catch(P){setTimeout(()=>{throw P},0)}})};return g(d,Kl.EventType.OPEN,()=>{f||(E(Ot,`RPC '${e}' stream ${i} transport opened.`),p.Vo())}),g(d,Kl.EventType.CLOSE,()=>{f||(f=!0,E(Ot,`RPC '${e}' stream ${i} transport closed`),p.fo())}),g(d,Kl.EventType.ERROR,m=>{f||(f=!0,Mn(Ot,`RPC '${e}' stream ${i} transport errored:`,m),p.fo(new w(v.UNAVAILABLE,"The operation could not be completed")))}),g(d,Kl.EventType.MESSAGE,m=>{var I;if(!f){let R=m.data[0];O(!!R);let C=R,P=C.error||((I=C[0])===null||I===void 0?void 0:I.error);if(P){E(Ot,`RPC '${e}' stream ${i} received error:`,P);let j=P.status,H=function(Km){let Vd=Je[Km];if(Vd!==void 0)return x1(Vd)}(j),ve=P.message;H===void 0&&(H=v.INTERNAL,ve="Unknown error status: "+j+" with message "+P.message),f=!0,p.fo(new w(H,ve)),d.close()}else E(Ot,`RPC '${e}' stream ${i} received:`,R),p.po(R)}}),g(a,$k.STAT_EVENT,m=>{m.stat===uC.PROXY?E(Ot,`RPC '${e}' stream ${i} detected buffering proxy`):m.stat===uC.NOPROXY&&E(Ot,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.mo()},0),p}};function iF(){return typeof window<"u"?window:null}function Sg(){return typeof document<"u"?document:null}function Nd(t){return new qC(t,!0)}var Id=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Oo=r,this.No=i,this.Lo=s,this.Bo=0,this.ko=null,this.qo=Date.now(),this.reset()}reset(){this.Bo=0}Qo(){this.Bo=this.Lo}Ko(e){this.cancel();let n=Math.floor(this.Bo+this.$o()),r=Math.max(0,Date.now()-this.qo),i=Math.max(0,n-r);i>0&&E("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Bo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.ko=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.qo=Date.now(),e())),this.Bo*=this.No,this.Bo<this.Oo&&(this.Bo=this.Oo),this.Bo>this.Lo&&(this.Bo=this.Lo)}Uo(){this.ko!==null&&(this.ko.skipDelay(),this.ko=null)}cancel(){this.ko!==null&&(this.ko.cancel(),this.ko=null)}$o(){return(Math.random()-.5)*this.Bo}};var am=class{constructor(e,n,r,i,s,o,a,u){this.si=e,this.Wo=r,this.Go=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.zo=0,this.jo=null,this.Ho=null,this.stream=null,this.Jo=new Id(e,n)}Yo(){return this.state===1||this.state===5||this.Zo()}Zo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Xo()}stop(){return _(this,null,function*(){this.Yo()&&(yield this.close(0))})}e_(){this.state=0,this.Jo.reset()}t_(){this.Zo()&&this.jo===null&&(this.jo=this.si.enqueueAfterDelay(this.Wo,6e4,()=>this.n_()))}r_(e){this.i_(),this.stream.send(e)}n_(){return _(this,null,function*(){if(this.Zo())return this.close(0)})}i_(){this.jo&&(this.jo.cancel(),this.jo=null)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}close(e,n){return _(this,null,function*(){this.i_(),this.s_(),this.Jo.cancel(),this.zo++,e!==4?this.Jo.reset():n&&n.code===v.RESOURCE_EXHAUSTED?(Qe(n.toString()),Qe("Using maximum backoff delay to prevent overloading the backend."),this.Jo.Qo()):n&&n.code===v.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.o_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Eo(n)})}o_(){}auth(){this.state=1;let e=this.__(this.zo),n=this.zo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.zo===n&&this.a_(r,i)},r=>{e(()=>{let i=new w(v.UNKNOWN,"Fetching auth token failed: "+r.message);return this.u_(i)})})}a_(e,n){let r=this.__(this.zo);this.stream=this.c_(e,n),this.stream.ho(()=>{r(()=>this.listener.ho())}),this.stream.Io(()=>{r(()=>(this.state=2,this.Ho=this.si.enqueueAfterDelay(this.Go,1e4,()=>(this.Zo()&&(this.state=3),Promise.resolve())),this.listener.Io()))}),this.stream.Eo(i=>{r(()=>this.u_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Xo(){this.state=5,this.Jo.Ko(()=>_(this,null,function*(){this.state=0,this.start()}))}u_(e){return E("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}__(e){return n=>{this.si.enqueueAndForget(()=>this.zo===e?n():(E("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},AD=class extends am{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}c_(e,n){return this.connection.xo("Listen",e,n)}onMessage(e){this.Jo.reset();let n=t3(this.serializer,e),r=function(s){if(!("targetChange"in s))return L.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?L.min():o.readTime?Ze(o.readTime):L.min()}(e);return this.listener.l_(n,r)}h_(e){let n={};n.database=WC(this.serializer),n.addTarget=function(s,o){let a,u=o.target;if(a=Vg(u)?{documents:V1(s,u)}:{query:U1(s,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=N1(s,o.resumeToken);let c=GC(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(L.min())>0){a.readTime=lu(s,o.snapshotVersion.toTimestamp());let c=GC(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=r3(this.serializer,e);r&&(n.labels=r),this.r_(n)}P_(e){let n={};n.database=WC(this.serializer),n.removeTarget=e,this.r_(n)}},RD=class extends am{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.I_=!1}get T_(){return this.I_}start(){this.I_=!1,this.lastStreamToken=void 0,super.start()}o_(){this.I_&&this.E_([])}c_(e,n){return this.connection.xo("Write",e,n)}onMessage(e){if(O(!!e.streamToken),this.lastStreamToken=e.streamToken,this.I_){this.Jo.reset();let n=n3(e.writeResults,e.commitTime),r=Ze(e.commitTime);return this.listener.d_(r,n)}return O(!e.writeResults||e.writeResults.length===0),this.I_=!0,this.listener.A_()}R_(){let e={};e.database=WC(this.serializer),this.r_(e)}E_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>_d(this.serializer,r))};this.r_(n)}};var xD=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.V_=!1}m_(){if(this.V_)throw new w(v.FAILED_PRECONDITION,"The client has already been terminated.")}Do(e,n,r,i){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Do(e,zC(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===v.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new w(v.UNKNOWN,s.toString())})}Mo(e,n,r,i,s){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,zC(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===v.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new w(v.UNKNOWN,o.toString())})}terminate(){this.V_=!0,this.connection.terminate()}};var MD=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(Qe(n),this.y_=!1):E("OnlineStateTracker",n)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var ND=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.ro(o=>{r.enqueueAndForget(()=>_(this,null,function*(){Xi(this)&&(E("RemoteStore","Restarting streams for network reachability change."),yield function(u){return _(this,null,function*(){let c=S(u);c.M_.add(4),yield Cu(c),c.N_.set("Unknown"),c.M_.delete(4),yield Pd(c)})}(this))}))}),this.N_=new MD(r,i)}};function Pd(t){return _(this,null,function*(){if(Xi(t))for(let e of t.x_)yield e(!0)})}function Cu(t){return _(this,null,function*(){for(let e of t.x_)yield e(!1)})}function bm(t,e){let n=S(t);n.F_.has(e.targetId)||(n.F_.set(e.targetId,e),TT(n)?DT(n):Tu(n).Zo()&&CT(n,e))}function gu(t,e){let n=S(t),r=Tu(n);n.F_.delete(e),r.Zo()&&sF(n,e),n.F_.size===0&&(r.Zo()?r.t_():Xi(n)&&n.N_.set("Unknown"))}function CT(t,e){if(t.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(L.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Tu(t).h_(e)}function sF(t,e){t.L_.xe(e),Tu(t).P_(e)}function DT(t){t.L_=new HC({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.F_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Tu(t).start(),t.N_.w_()}function TT(t){return Xi(t)&&!Tu(t).Yo()&&t.F_.size>0}function Xi(t){return S(t).M_.size===0}function oF(t){t.L_=void 0}function _3(t){return _(this,null,function*(){t.N_.set("Online")})}function v3(t){return _(this,null,function*(){t.F_.forEach((e,n)=>{CT(t,e)})})}function w3(t,e){return _(this,null,function*(){oF(t),TT(t)?(t.N_.D_(e),DT(t)):t.N_.set("Unknown")})}function E3(t,e,n){return _(this,null,function*(){if(t.N_.set("Online"),e instanceof $g&&e.state===2&&e.cause)try{yield function(i,s){return _(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(t,e)}catch(r){E("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield um(t,r)}else if(e instanceof ru?t.L_.Ke(e):e instanceof Bg?t.L_.He(e):t.L_.We(e),!n.isEqual(L.min()))try{let r=yield J1(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){let l=s.F_.get(c);l&&s.F_.set(c,l.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{let l=s.F_.get(u);if(!l)return;s.F_.set(u,l.withResumeToken(_t.EMPTY_BYTE_STRING,l.snapshotVersion)),sF(s,u);let d=new du(l.target,u,c,l.sequenceNumber);CT(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){E("RemoteStore","Failed to raise snapshot:",r),yield um(t,r)}})}function um(t,e,n){return _(this,null,function*(){if(!Zi(e))throw e;t.M_.add(1),yield Cu(t),t.N_.set("Offline"),n||(n=()=>J1(t.localStore)),t.asyncQueue.enqueueRetryable(()=>_(this,null,function*(){E("RemoteStore","Retrying IndexedDB access"),yield n(),t.M_.delete(1),yield Pd(t)}))})}function aF(t,e){return e().catch(n=>um(t,n,e))}function Du(t){return _(this,null,function*(){let e=S(t),n=Qi(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;I3(e);)try{let i=yield p3(e.localStore,r);if(i===null){e.v_.length===0&&n.t_();break}r=i.batchId,C3(e,i)}catch(i){yield um(e,i)}uF(e)&&cF(e)})}function I3(t){return Xi(t)&&t.v_.length<10}function C3(t,e){t.v_.push(e);let n=Qi(t);n.Zo()&&n.T_&&n.E_(e.mutations)}function uF(t){return Xi(t)&&!Qi(t).Yo()&&t.v_.length>0}function cF(t){Qi(t).start()}function D3(t){return _(this,null,function*(){Qi(t).R_()})}function T3(t){return _(this,null,function*(){let e=Qi(t);for(let n of t.v_)e.E_(n.mutations)})}function b3(t,e,n){return _(this,null,function*(){let r=t.v_.shift(),i=jC.from(r,e,n);yield aF(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Du(t)})}function S3(t,e){return _(this,null,function*(){e&&Qi(t).T_&&(yield function(r,i){return _(this,null,function*(){if(function(o){return R1(o)&&o!==v.ABORTED}(i.code)){let s=r.v_.shift();Qi(r).e_(),yield aF(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Du(r)}})}(t,e)),uF(t)&&cF(t)})}function FO(t,e){return _(this,null,function*(){let n=S(t);n.asyncQueue.verifyOperationInProgress(),E("RemoteStore","RemoteStore received new credentials");let r=Xi(n);n.M_.add(3),yield Cu(n),r&&n.N_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.M_.delete(3),yield Pd(n)})}function PD(t,e){return _(this,null,function*(){let n=S(t);e?(n.M_.delete(2),yield Pd(n)):e||(n.M_.add(2),yield Cu(n),n.N_.set("Unknown"))})}function Tu(t){return t.B_||(t.B_=function(n,r,i){let s=S(n);return s.m_(),new AD(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:_3.bind(null,t),Io:v3.bind(null,t),Eo:w3.bind(null,t),l_:E3.bind(null,t)}),t.x_.push(e=>_(this,null,function*(){e?(t.B_.e_(),TT(t)?DT(t):t.N_.set("Unknown")):(yield t.B_.stop(),oF(t))}))),t.B_}function Qi(t){return t.k_||(t.k_=function(n,r,i){let s=S(n);return s.m_(),new RD(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:()=>Promise.resolve(),Io:D3.bind(null,t),Eo:S3.bind(null,t),A_:T3.bind(null,t),d_:b3.bind(null,t)}),t.x_.push(e=>_(this,null,function*(){e?(t.k_.e_(),yield Du(t)):(yield t.k_.stop(),t.v_.length>0&&(E("RemoteStore",`Stopping write stream with ${t.v_.length} pending writes`),t.v_=[]))}))),t.k_}var kD=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new nt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new w(v.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function bu(t,e){if(Qe("AsyncQueue",`${e}: ${t}`),Zi(t))return new w(v.UNAVAILABLE,`${e}: ${t}`);throw t}var cm=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||b.comparator(n.key,r.key):(n,r)=>b.comparator(n.key,r.key),this.keyedMap=Jl(),this.sortedSet=new Me(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var lm=class{constructor(){this.q_=new Me(b.comparator)}track(e){let n=e.doc.key,r=this.q_.get(n);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(n,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(n):e.type===1&&r.type===2?this.q_=this.q_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):x():this.q_=this.q_.insert(n,e)}Q_(){let e=[];return this.q_.inorderTraversal((n,r)=>{e.push(r)}),e}},mu=class t{constructor(e,n,r,i,s,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,cm.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var OD=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},FD=class{constructor(){this.queries=new Ir(e=>p1(e),xd),this.onlineState="Unknown",this.z_=new Set}};function bT(t,e){return _(this,null,function*(){let n=S(t),r=3,i=e.query,s=n.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new OD,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield n.onListen(i,!0);break;case 1:s.K_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=bu(o,`Initialization of query '${Ya(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.U_.push(e),e.j_(n.onlineState),s.K_&&e.H_(s.K_)&&AT(n)})}function ST(t,e){return _(this,null,function*(){let n=S(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function A3(t,e){let n=S(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&AT(n)}function R3(t,e,n){let r=S(t),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(n);r.queries.delete(e)}function AT(t){t.z_.forEach(e=>{e.next()})}var LD,LO;(LO=LD||(LD={})).J_="default",LO.Cache="cache";var Cd=class{constructor(e,n,r){this.query=e,this.Y_=n,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new mu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),n=!0):this.ta(e,this.onlineState)&&(this.na(e),n=!0),this.X_=e,n}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let n=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),n=!0),n}ta(e,n){if(!e.fromCache||!this.G_())return!0;let r=n!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let n=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}na(e){e=mu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==LD.Cache}};var VD=class{constructor(e,n){this.ia=e,this.byteLength=n}sa(){return"metadata"in this.ia}};var dm=class{constructor(e){this.serializer=e}hs(e){return _r(this.serializer,e)}Ps(e){return e.metadata.exists?L1(this.serializer,e.document,!1):rt.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return Ze(e)}},UD=class{constructor(e,n,r){this.oa=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=lF(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++n;let r=le.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}aa(e){let n=new Map,r=new dm(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.hs(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||Z()).add(s);n.set(o,a)}}return n}complete(){return _(this,null,function*(){let e=yield g3(this.localStore,new dm(this.serializer),this.documents,this.oa.id),n=this.aa(this.documents);for(let r of this.queries)yield m3(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function lF(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var hm=class{constructor(e){this.key=e}},fm=class{constructor(e){this.key=e}},pm=class{constructor(e,n){this.query=e,this.la=n,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=Z(),this.mutatedKeys=Z(),this.Ia=m1(e),this.Ta=new cm(this.Ia)}get Ea(){return this.la}da(e,n){let r=n?n.Aa:new lm,i=n?n.Ta:this.Ta,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=Md(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),m=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),m=!0):this.Ra(h,f)||(r.track({type:2,doc:f}),m=!0,(u&&this.Ia(f,u)>0||c&&this.Ia(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),m=!0):h&&!f&&(r.track({type:1,doc:h}),m=!0,(u||c)&&(a=!0)),m&&(f?(o=o.add(f),s=g?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{Ta:o,Aa:r,Zi:a,mutatedKeys:s}}Ra(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((l,d)=>function(f,p){let g=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return x()}};return g(f)-g(p)}(l.type,d.type)||this.Ia(l.doc,d.doc)),this.Va(r),i=i!=null&&i;let a=n&&!i?this.ma():[],u=this.Pa.size===0&&this.current&&!i?1:0,c=u!==this.ha;return this.ha=u,o.length!==0||c?{snapshot:new mu(this.query,e.Ta,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new lm,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(n=>this.la=this.la.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.la=this.la.delete(n)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=Z(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let n=[];return e.forEach(r=>{this.Pa.has(r)||n.push(new fm(r))}),this.Pa.forEach(r=>{e.has(r)||n.push(new hm(r))}),n}pa(e){this.la=e.ls,this.Pa=Z();let n=this.da(e.documents);return this.applyChanges(n,!0)}ya(){return mu.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},jD=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},BD=class{constructor(e){this.key=e,this.wa=!1}},$D=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new Ir(a=>p1(a),xd),this.Da=new Map,this.Ca=new Set,this.va=new Me(b.comparator),this.Fa=new Map,this.Ma=new wd,this.xa={},this.Oa=new Map,this.Na=hu.Nn(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function x3(t,e,n=!0){return _(this,null,function*(){let r=Sm(t),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield dF(r,e,n,!0),i})}function M3(t,e){return _(this,null,function*(){let n=Sm(t);yield dF(n,e,!0,!1)})}function dF(t,e,n,r){return _(this,null,function*(){let i=yield fu(t.localStore,Wt(e)),s=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield RT(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&bm(t.remoteStore,i),a})}function RT(t,e,n,r,i){return _(this,null,function*(){t.Ba=(d,h,f)=>function(g,m,I,R){return _(this,null,function*(){let C=m.view.da(I);C.Zi&&(C=yield nm(g.localStore,m.query,!1).then(({documents:ve})=>m.view.da(ve,C)));let P=R&&R.targetChanges.get(m.targetId),j=R&&R.targetMismatches.get(m.targetId)!=null,H=m.view.applyChanges(C,g.isPrimaryClient,P,j);return HD(g,m.targetId,H.fa),H.snapshot})}(t,d,h,f);let s=yield nm(t.localStore,e,!0),o=new pm(e,s.ls),a=o.da(s.documents),u=md.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,u);HD(t,n,c.fa);let l=new jD(e,n,o);return t.ba.set(e,l),t.Da.has(n)?t.Da.get(n).push(e):t.Da.set(n,[e]),c.snapshot})}function N3(t,e,n){return _(this,null,function*(){let r=S(t),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!xd(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield pu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&gu(r.remoteStore,i.targetId),yu(r,i.targetId)}).catch(Yi))):(yu(r,i.targetId),yield pu(r.localStore,i.targetId,!0))})}function P3(t,e){return _(this,null,function*(){let n=S(t),r=n.ba.get(e),i=n.Da.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),gu(n.remoteStore,r.targetId))})}function k3(t,e,n){return _(this,null,function*(){let r=PT(t);try{let i=yield function(o,a){let u=S(o),c=je.now(),l=a.reduce((f,p)=>f.add(p.key),Z()),d,h;return u.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=en(),g=Z();return u.ss.getEntries(f,l).next(m=>{p=m,p.forEach((I,R)=>{R.isValidDocument()||(g=g.add(I))})}).next(()=>u.localDocuments.getOverlayedDocuments(f,p)).next(m=>{d=m;let I=[];for(let R of a){let C=K9(R,d.get(R.key).overlayedDocument);C!=null&&I.push(new zn(R.key,C,a1(C.value.mapValue),ze.exists(!0)))}return u.mutationQueue.addMutationBatch(f,c,I,a)}).next(m=>{h=m;let I=m.applyToLocalDocumentSet(d,g);return u.documentOverlayCache.saveOverlays(f,m.batchId,I)})}).then(()=>({batchId:h.batchId,changes:_1(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.xa[o.currentUser.toKey()];c||(c=new Me(Y)),c=c.insert(a,u),o.xa[o.currentUser.toKey()]=c}(r,i.batchId,n),yield Xr(r,i.changes),yield Du(r.remoteStore)}catch(i){let s=bu(i,"Failed to persist write");n.reject(s)}})}function hF(t,e){return _(this,null,function*(){let n=S(t);try{let r=yield f3(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Fa.get(s);o&&(O(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?O(o.wa):i.removedDocuments.size>0&&(O(o.wa),o.wa=!1))}),yield Xr(n,r,e)}catch(r){yield Yi(r)}})}function VO(t,e,n){let r=S(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=S(o);u.onlineState=a;let c=!1;u.queries.forEach((l,d)=>{for(let h of d.U_)h.j_(a)&&(c=!0)}),c&&AT(u)}(r.eventManager,e),i.length&&r.Sa.l_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function O3(t,e,n){return _(this,null,function*(){let r=S(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new Me(b.comparator);o=o.insert(s,rt.newNoDocument(s,L.min()));let a=Z().add(s),u=new gd(L.min(),new Map,new Me(Y),o,a);yield hF(r,u),r.va=r.va.remove(s),r.Fa.delete(e),NT(r)}else yield pu(r.localStore,e,!1).then(()=>yu(r,e,n)).catch(Yi)})}function F3(t,e){return _(this,null,function*(){let n=S(t),r=e.batch.batchId;try{let i=yield h3(n.localStore,e);MT(n,r,null),xT(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Xr(n,i)}catch(i){yield Yi(i)}})}function L3(t,e,n){return _(this,null,function*(){let r=S(t);try{let i=yield function(o,a){let u=S(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return u.mutationQueue.lookupMutationBatch(c,a).next(d=>(O(d!==null),l=d.keys(),u.mutationQueue.removeMutationBatch(c,d))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,l,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>u.localDocuments.getDocuments(c,l))})}(r.localStore,e);MT(r,e,n),xT(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield Xr(r,i)}catch(i){yield Yi(i)}})}function V3(t,e){return _(this,null,function*(){let n=S(t);Xi(n.remoteStore)||E("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=S(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Oa.get(r)||[];i.push(e),n.Oa.set(r,i)}catch(r){let i=bu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function xT(t,e){(t.Oa.get(e)||[]).forEach(n=>{n.resolve()}),t.Oa.delete(e)}function MT(t,e,n){let r=S(t),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function yu(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Da.get(e))t.ba.delete(r),n&&t.Sa.ka(r,n);t.Da.delete(e),t.isPrimaryClient&&t.Ma.Rr(e).forEach(r=>{t.Ma.containsKey(r)||fF(t,r)})}function fF(t,e){t.Ca.delete(e.path.canonicalString());let n=t.va.get(e);n!==null&&(gu(t.remoteStore,n),t.va=t.va.remove(e),t.Fa.delete(n),NT(t))}function HD(t,e,n){for(let r of n)r instanceof hm?(t.Ma.addReference(r.key,e),U3(t,r)):r instanceof fm?(E("SyncEngine","Document no longer in limbo: "+r.key),t.Ma.removeReference(r.key,e),t.Ma.containsKey(r.key)||fF(t,r.key)):x()}function U3(t,e){let n=e.key,r=n.path.canonicalString();t.va.get(n)||t.Ca.has(r)||(E("SyncEngine","New document in limbo: "+n),t.Ca.add(r),NT(t))}function NT(t){for(;t.Ca.size>0&&t.va.size<t.maxConcurrentLimboResolutions;){let e=t.Ca.values().next().value;t.Ca.delete(e);let n=new b(le.fromString(e)),r=t.Na.next();t.Fa.set(r,new BD(n)),t.va=t.va.insert(n,r),bm(t.remoteStore,new du(Wt(Iu(n.path)),r,"TargetPurposeLimboResolution",dn.oe))}}function Xr(t,e,n){return _(this,null,function*(){let r=S(t),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,u)=>{o.push(r.Ba(u,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c?.fromCache?"not-current":"current"),c){i.push(c);let l=ED.Qi(u.targetId,c);s.push(l)}}))}),yield Promise.all(o),r.Sa.l_(i),yield function(u,c){return _(this,null,function*(){let l=S(u);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>y.forEach(c,h=>y.forEach(h.ki,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>y.forEach(h.qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Zi(d))throw d;E("LocalStore","Failed to update sequence numbers: "+d)}for(let d of c){let h=d.targetId;if(!d.fromCache){let f=l.ts.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);l.ts=l.ts.insert(h,g)}}})}(r.localStore,s))})}function j3(t,e){return _(this,null,function*(){let n=S(t);if(!n.currentUser.isEqual(e)){E("SyncEngine","User change. New user:",e.toKey());let r=yield X1(n.localStore,e);n.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(u=>{u.reject(new w(v.CANCELLED,o))})}),s.Oa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Xr(n,r._s)}})}function B3(t,e){let n=S(t),r=n.Fa.get(e);if(r&&r.wa)return Z().add(r.key);{let i=Z(),s=n.Da.get(e);if(!s)return i;for(let o of s){let a=n.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function $3(t,e){return _(this,null,function*(){let n=S(t),r=yield nm(n.localStore,e.query,!0),i=e.view.pa(r);return n.isPrimaryClient&&HD(n,e.targetId,i.fa),i})}function H3(t,e){return _(this,null,function*(){let n=S(t);return nF(n.localStore,e).then(r=>Xr(n,r))})}function q3(t,e,n,r){return _(this,null,function*(){let i=S(t),s=yield function(a,u){let c=S(a),l=S(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.Cn(d,u).next(h=>h?c.localDocuments.getDocuments(d,h):y.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield Du(i.remoteStore):n==="acknowledged"||n==="rejected"?(MT(i,e,r||null),xT(i,e),function(a,u){S(S(a).mutationQueue).Fn(u)}(i.localStore,e)):x(),yield Xr(i,s)):E("SyncEngine","Cannot apply mutation batch with id: "+e)})}function G3(t,e){return _(this,null,function*(){let n=S(t);if(Sm(n),PT(n),e===!0&&n.La!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield UO(n,r.toArray());n.La=!0,yield PD(n.remoteStore,!0);for(let s of i)bm(n.remoteStore,s)}else if(e===!1&&n.La!==!1){let r=[],i=Promise.resolve();n.Da.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(yu(n,o),pu(n.localStore,o,!0))),gu(n.remoteStore,o)}),yield i,yield UO(n,r),function(o){let a=S(o);a.Fa.forEach((u,c)=>{gu(a.remoteStore,c)}),a.Ma.Vr(),a.Fa=new Map,a.va=new Me(b.comparator)}(n),n.La=!1,yield PD(n.remoteStore,!1)}})}function UO(t,e,n){return _(this,null,function*(){let r=S(t),i=[],s=[];for(let o of e){let a,u=r.Da.get(o);if(u&&u.length!==0){a=yield fu(r.localStore,Wt(u[0]));for(let c of u){let l=r.ba.get(c),d=yield $3(r,l);d.snapshot&&s.push(d.snapshot)}}else{let c=yield tF(r.localStore,o);a=yield fu(r.localStore,c),yield RT(r,pF(c),o,!1,a.resumeToken)}i.push(a)}return r.Sa.l_(s),i})}function pF(t){return f1(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function z3(t){return function(n){return S(S(n).persistence).Li()}(S(t).localStore)}function W3(t,e,n,r){return _(this,null,function*(){let i=S(t);if(i.La)return void E("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield nF(i.localStore,g1(s[0])),a=gd.createSynthesizedRemoteEventForCurrentChange(e,n==="current",_t.EMPTY_BYTE_STRING);yield Xr(i,o,a);break}case"rejected":yield pu(i.localStore,e,!0),yu(i,e,r);break;default:x()}})}function K3(t,e,n){return _(this,null,function*(){let r=Sm(t);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){E("SyncEngine","Adding an already active target "+i);continue}let s=yield tF(r.localStore,i),o=yield fu(r.localStore,s);yield RT(r,pF(s),o.targetId,!1,o.resumeToken),bm(r.remoteStore,o)}for(let i of n)r.Da.has(i)&&(yield pu(r.localStore,i,!1).then(()=>{gu(r.remoteStore,i),yu(r,i)}).catch(Yi))}})}function Sm(t){let e=S(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=hF.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=B3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=O3.bind(null,e),e.Sa.l_=A3.bind(null,e.eventManager),e.Sa.ka=R3.bind(null,e.eventManager),e}function PT(t){let e=S(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=F3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=L3.bind(null,e),e}function Q3(t,e,n){let r=S(t);(function(s,o,a){return _(this,null,function*(){try{let u=yield o.getMetadata();if(yield function(f,p){let g=S(f),m=Ze(p.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",I=>g.Kr.getBundleMetadata(I,p.id)).then(I=>!!I&&I.createTime.compareTo(m)>=0)}(s.localStore,u))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(lF(u));let c=new UD(u,s.localStore,o.serializer),l=yield o.qa();for(;l;){let h=yield c._a(l);h&&a._updateProgress(h),l=yield o.qa()}let d=yield c.complete();return yield Xr(s,d.ca,void 0),yield function(f,p){let g=S(f);return g.persistence.runTransaction("Save bundle","readwrite",m=>g.Kr.saveBundleMetadata(m,p))}(s.localStore,u),a._completeWith(d.progress),Promise.resolve(d.ua)}catch(u){return Mn("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Dd=class{constructor(){this.synchronizeTabs=!1}initialize(e){return _(this,null,function*(){this.serializer=Nd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return Z1(this.persistence,new tm,e.initialUser,this.serializer)}createPersistence(e){return new Jg(em.jr,this.serializer)}createSharedClientState(e){return new sm}terminate(){return _(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var gm=class t extends Dd{constructor(e,n,r){super(),this.Qa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return _(this,null,function*(){yield Qm(t.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield PT(this.Qa.syncEngine),yield Du(this.Qa.remoteStore),yield this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return Z1(this.persistence,new tm,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new oD(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new DC(n,this.persistence);return new CC(e.asyncQueue,r)}createPersistence(e){let n=IT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?xn.withCacheSize(this.cacheSizeBytes):xn.DEFAULT;return new wD(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,iF(),Sg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new sm}},qD=class t extends gm{constructor(e,n){super(e,n,!1),this.Qa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return _(this,null,function*(){yield Qm(t.prototype,this,"initialize").call(this,e);let n=this.Qa.syncEngine;this.sharedClientState instanceof sd&&(this.sharedClientState.syncEngine={Ys:q3.bind(null,n),Zs:W3.bind(null,n),Xs:K3.bind(null,n),Li:z3.bind(null,n),Js:H3.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.mi(r=>_(this,null,function*(){yield G3(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=iF();if(!sd.D(n))throw new w(v.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=IT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new sd(n,e.asyncQueue,r,e.clientId,e.initialUser)}},Td=class{initialize(e,n){return _(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>VO(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=j3.bind(null,this.syncEngine),yield PD(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new FD}()}createDatastore(e){let n=Nd(e.databaseInfo.databaseId),r=function(s){return new SD(s)}(e.databaseInfo);return function(s,o,a,u){return new xD(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new ND(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>VO(this.syncEngine,n,0),function(){return om.D()?new om:new TD}())}createSyncEngine(e,n){return function(i,s,o,a,u,c,l){let d=new $D(i,s,o,a,u,c);return l&&(d.La=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return _(this,null,function*(){var e;yield function(r){return _(this,null,function*(){let i=S(r);E("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield Cu(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function jO(t,e=10240){let n=0;return{read(){return _(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return _(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var _u=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):Qe("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var GD=class{constructor(e,n){this.Ua=e,this.serializer=n,this.metadata=new nt,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return _(this,null,function*(){return this.metadata.promise})}qa(){return _(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return _(this,null,function*(){let e=yield this.za();if(e===null)return null;let n=this.Wa.decode(e),r=Number(n);isNaN(r)&&this.ja(`length string (${n}) is not valid number`);let i=yield this.Ha(r);return new VD(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return _(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ha(e){return _(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let n=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return _(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var zD=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return _(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new w(v.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return _(this,null,function*(){let o=S(i),a={documents:s.map(d=>yd(o.serializer,d))},u=yield o.Mo("BatchGetDocuments",o.serializer.databaseId,le.emptyPath(),a,s.length),c=new Map;u.forEach(d=>{let h=e3(o.serializer,d);c.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=c.get(d.toString());O(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ki(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return _(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=b.fromPath(r);this.mutations.push(new hd(i,this.precondition(i)))}),yield function(r,i){return _(this,null,function*(){let s=S(r),o={writes:i.map(a=>_d(s.serializer,a))};yield s.Do("Commit",s.serializer.databaseId,le.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw x();n=L.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new w(v.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(L.min())?ze.exists(!1):ze.updateTime(n):ze.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(L.min()))throw new w(v.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ze.updateTime(n)}return ze.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var WD=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Jo=new Id(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Jo.Ko(()=>_(this,null,function*(){let e=new zD(this.datastore),n=this.tu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let n=this.updateFunction(e);return!Ad(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!R1(n)}return!1}};var KD=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=tt.UNAUTHENTICATED,this.clientId=xg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>_(this,null,function*(){E("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(E("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new w(v.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new nt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=bu(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Ag(t,e){return _(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),E("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>_(this,null,function*(){r.isEqual(i)||(yield X1(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function QD(t,e){return _(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield kT(t);E("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>FO(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>FO(e.remoteStore,i)),t._onlineComponents=e})}function gF(t){return t.name==="FirebaseError"?t.code===v.FAILED_PRECONDITION||t.code===v.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function kT(t){return _(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){E("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Ag(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!gF(n))throw n;Mn("Error using user provided cache. Falling back to memory cache: "+n),yield Ag(t,new Dd)}}else E("FirestoreClient","Using default OfflineComponentProvider"),yield Ag(t,new Dd);return t._offlineComponents})}function Am(t){return _(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(E("FirestoreClient","Using user provided OnlineComponentProvider"),yield QD(t,t._uninitializedComponentsProvider._online)):(E("FirestoreClient","Using default OnlineComponentProvider"),yield QD(t,new Td))),t._onlineComponents})}function mF(t){return kT(t).then(e=>e.persistence)}function OT(t){return kT(t).then(e=>e.localStore)}function yF(t){return Am(t).then(e=>e.remoteStore)}function FT(t){return Am(t).then(e=>e.syncEngine)}function Y3(t){return Am(t).then(e=>e.datastore)}function vu(t){return _(this,null,function*(){let e=yield Am(t),n=e.eventManager;return n.onListen=x3.bind(null,e.syncEngine),n.onUnlisten=N3.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=M3.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=P3.bind(null,e.syncEngine),n})}function Z3(t){return t.asyncQueue.enqueue(()=>_(this,null,function*(){let e=yield mF(t),n=yield yF(t);return e.setNetworkEnabled(!0),function(i){let s=S(i);return s.M_.delete(0),Pd(s)}(n)}))}function X3(t){return t.asyncQueue.enqueue(()=>_(this,null,function*(){let e=yield mF(t),n=yield yF(t);return e.setNetworkEnabled(!1),function(i){return _(this,null,function*(){let s=S(i);s.M_.add(0),yield Cu(s),s.N_.set("Offline")})}(n)}))}function J3(t,e){let n=new nt;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s,o){return _(this,null,function*(){try{let a=yield function(c,l){let d=S(c);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new w(v.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=bu(a,`Failed to get document '${s} from cache`);o.reject(u)}})}(yield OT(t),e,n)})),n.promise}function _F(t,e,n={}){let r=new nt;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(s,o,a,u,c){let l=new _u({next:h=>{o.enqueueAndForget(()=>ST(s,d));let f=h.docs.has(a);!f&&h.fromCache?c.reject(new w(v.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&u&&u.source==="server"?c.reject(new w(v.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new Cd(Iu(a.path),l,{includeMetadataChanges:!0,ra:!0});return bT(s,d)}(yield vu(t),t.asyncQueue,e,n,r)})),r.promise}function e6(t,e){let n=new nt;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s,o){return _(this,null,function*(){try{let a=yield nm(i,s,!0),u=new pm(s,a.ls),c=u.da(a.documents),l=u.applyChanges(c,!1);o.resolve(l.snapshot)}catch(a){let u=bu(a,`Failed to execute query '${s} against cache`);o.reject(u)}})}(yield OT(t),e,n)})),n.promise}function vF(t,e,n={}){let r=new nt;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(s,o,a,u,c){let l=new _u({next:h=>{o.enqueueAndForget(()=>ST(s,d)),h.fromCache&&u.source==="server"?c.reject(new w(v.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new Cd(a,l,{includeMetadataChanges:!0,ra:!0});return bT(s,d)}(yield vu(t),t.asyncQueue,e,n,r)})),r.promise}function t6(t,e){let n=new _u(e);return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s){S(i).z_.add(s),s.next()}(yield vu(t),n)})),()=>{n.$a(),t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s){S(i).z_.delete(s)}(yield vu(t),n)}))}}function n6(t,e,n,r){let i=function(o,a){let u;return u=typeof o=="string"?M1().encode(o):o,function(l,d){return new GD(l,d)}(function(l,d){if(l instanceof Uint8Array)return jO(l,d);if(l instanceof ArrayBuffer)return jO(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(n,Nd(e));t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){Q3(yield FT(t),i,r)}))}function r6(t,e){return t.asyncQueue.enqueue(()=>_(this,null,function*(){return function(r,i){let s=S(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,i))}(yield OT(t),e)}))}function wF(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var BO=new Map;function LT(t,e,n){if(!n)throw new w(v.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function VT(t,e,n,r){if(e===!0&&r===!0)throw new w(v.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function $O(t){if(!b.isDocumentKey(t))throw new w(v.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function HO(t){if(b.isDocumentKey(t))throw new w(v.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Rm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":x()}function de(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new w(v.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Rm(t);throw new w(v.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function EF(t,e){if(e<=0)throw new w(v.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var mm=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new w(v.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new w(v.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wF((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new w(v.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new w(v.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new w(v.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},po=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mm({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new w(v.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new w(v.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new fC;switch(r.type){case"firstParty":return new yC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new w(v.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=BO.get(n);r&&(E("ComponentProvider","Removing Datastore"),BO.delete(n),r.terminate())}(this),Promise.resolve()}};function xm(t,e,n,r={}){var i;let s=(t=de(t,po))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Mn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=tt.MOCK_USER;else{a=So(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new w(v.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new tt(c)}t._authCredentials=new pC(new Rg(a,u))}}var Tt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Re=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},vr=class t extends Tt{constructor(e,n,r){super(e,n,Iu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Re(this.firestore,null,new b(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function Mm(t,e,...n){if(t=ee(t),LT("collection","path",e),t instanceof po){let r=le.fromString(e,...n);return HO(r),new vr(t,null,r)}{if(!(t instanceof Re||t instanceof vr))throw new w(v.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(le.fromString(e,...n));return HO(r),new vr(t.firestore,null,r)}}function UT(t,e){if(t=de(t,po),LT("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new w(v.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Tt(t,null,function(r){return new Gn(le.emptyPath(),r)}(e))}function Su(t,e,...n){if(t=ee(t),arguments.length===1&&(e=xg.newId()),LT("doc","path",e),t instanceof po){let r=le.fromString(e,...n);return $O(r),new Re(t,null,new b(r))}{if(!(t instanceof Re||t instanceof vr))throw new w(v.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(le.fromString(e,...n));return $O(r),new Re(t.firestore,t instanceof vr?t.converter:null,new b(r))}}function Nm(t,e){return t=ee(t),e=ee(e),(t instanceof Re||t instanceof vr)&&(e instanceof Re||e instanceof vr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Pm(t,e){return t=ee(t),e=ee(e),t instanceof Tt&&e instanceof Tt&&t.firestore===e.firestore&&xd(t._query,e._query)&&t.converter===e.converter}var YD=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Jo=new Id(this,"async_queue_retry"),this.hu=()=>{let n=Sg();n&&E("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Jo.Uo()};let e=Sg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let n=Sg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let n=new nt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return _(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Jo.reset()}catch(e){if(!Zi(e))throw e;E("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Jo.Ko(()=>this.Tu())}})}Iu(e){let n=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Qe("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=n,n}enqueueAfterDelay(e,n,r){this.Pu(),this.lu.indexOf(e)>-1&&(n=0);let i=kD.createAndSchedule(this,e,n,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&x()}verifyOperationInProgress(){}du(){return _(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let n of this._u)if(n.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this._u)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let n=this._u.indexOf(e);this._u.splice(n,1)}};function ZD(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var XD=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new nt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var IF=-1,ke=class extends po{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new YD}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||DF(this),this._firestoreClient.terminate()}};function CF(t,e){let n=typeof t=="object"?t:ri(),r=typeof t=="string"?t:e||"(default)",i=Ao(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Pu("firestore");s&&xm(i,...s)}return i}function ct(t){return t._firestoreClient||DF(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function DF(t){var e,n,r;let i=t._freezeSettings(),s=function(a,u,c,l){return new TC(a,u,c,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,wF(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new KD(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function jT(t,e){bF(t=de(t,ke));let n=ct(t);if(n._uninitializedComponentsProvider)throw new w(v.FAILED_PRECONDITION,"SDK cache is already specified.");Mn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new Td;return TF(n,i,new gm(i,r.cacheSizeBytes,e?.forceOwnership))}function BT(t){bF(t=de(t,ke));let e=ct(t);if(e._uninitializedComponentsProvider)throw new w(v.FAILED_PRECONDITION,"SDK cache is already specified.");Mn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new Td;return TF(e,r,new qD(r,n.cacheSizeBytes))}function TF(t,e,n){let r=new nt;return t.asyncQueue.enqueue(()=>_(this,null,function*(){try{yield Ag(t,n),yield QD(t,e),r.resolve()}catch(i){let s=i;if(!gF(s))throw s;Mn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function $T(t){if(t._initialized&&!t._terminated)throw new w(v.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new nt;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{yield function(r){return _(this,null,function*(){if(!Bi.D())return Promise.resolve();let i=r+"main";yield Bi.delete(i)})}(IT(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function HT(t){return function(n){let r=new nt;return n.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return V3(yield FT(n),r)})),r.promise}(ct(t=de(t,ke)))}function qT(t){return Z3(ct(t=de(t,ke)))}function GT(t){return X3(ct(t=de(t,ke)))}function zT(t,e){let n=ct(t=de(t,ke)),r=new XD;return n6(n,t._databaseId,e,r),r}function WT(t,e){return r6(ct(t=de(t,ke)),e).then(n=>n?new Tt(t,null,n.query):null)}function bF(t){if(t._initialized||t._terminated)throw new w(v.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Cr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(_t.fromBase64String(e))}catch(n){throw new w(v.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(_t.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Wn=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new w(v.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ye(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Yr=class{constructor(e){this._methodName=e}};var go=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new w(v.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new w(v.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}};var i6=/^__.*__$/,JD=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new zn(e,this.data,this.fieldMask,n,this.fieldTransforms):new Wi(e,this.data,n,this.fieldTransforms)}},ym=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new zn(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function SF(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw x()}}var _m=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return vm(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(SF(this.fu)&&i6.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},eT=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Nd(e)}Fu(e,n,r,i=!1){return new _m({fu:e,methodName:n,vu:r,path:Ye.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function vo(t){let e=t._freezeSettings(),n=Nd(t._databaseId);return new eT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function km(t,e,n,r,i,s={}){let o=t.Fu(s.merge||s.mergeFields?2:0,e,n,i);YT("Data must be an object, but it was:",o,r);let a=xF(r,o),u,c;if(s.merge)u=new hn(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=sT(e,d,n);if(!o.contains(h))throw new w(v.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);NF(l,h)||l.push(h)}u=new hn(l),c=o.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,c=o.fieldTransforms;return new JD(new Ft(a),u,c)}var bd=class t extends Yr{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function AF(t,e,n){return new _m({fu:3,vu:e.settings.vu,methodName:t._methodName,yu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var tT=class t extends Yr{_toFieldTransform(e){return new lo(e.path,new Gi)}isEqual(e){return e instanceof t}},nT=class t extends Yr{constructor(e,n){super(e),this.Mu=n}_toFieldTransform(e){let n=AF(this,e,!0),r=this.Mu.map(s=>wo(s,n)),i=new Kr(r);return new lo(e.path,i)}isEqual(e){return e instanceof t&&Xm(this.Mu,e.Mu)}},rT=class t extends Yr{constructor(e,n){super(e),this.Mu=n}_toFieldTransform(e){let n=AF(this,e,!0),r=this.Mu.map(s=>wo(s,n)),i=new Qr(r);return new lo(e.path,i)}isEqual(e){return e instanceof t&&Xm(this.Mu,e.Mu)}},iT=class t extends Yr{constructor(e,n){super(e),this.xu=n}_toFieldTransform(e){let n=new zi(e.serializer,I1(e.serializer,this.xu));return new lo(e.path,n)}isEqual(e){return e instanceof t&&this.xu===e.xu}};function KT(t,e,n,r){let i=t.Fu(1,e,n);YT("Data must be an object, but it was:",i,r);let s=[],o=Ft.empty();_o(r,(u,c)=>{let l=ZT(e,u,n);c=ee(c);let d=i.Su(l);if(c instanceof bd)s.push(l);else{let h=wo(c,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new hn(s);return new ym(o,a,i.fieldTransforms)}function QT(t,e,n,r,i,s){let o=t.Fu(1,e,n),a=[sT(e,r,n)],u=[i];if(s.length%2!=0)throw new w(v.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(sT(e,s[h])),u.push(s[h+1]);let c=[],l=Ft.empty();for(let h=a.length-1;h>=0;--h)if(!NF(c,a[h])){let f=a[h],p=u[h];p=ee(p);let g=o.Su(f);if(p instanceof bd)c.push(f);else{let m=wo(p,g);m!=null&&(c.push(f),l.set(f,m))}}let d=new hn(c);return new ym(l,d,o.fieldTransforms)}function RF(t,e,n,r=!1){return wo(n,t.Fu(r?4:3,e))}function wo(t,e){if(MF(t=ee(t)))return YT("Unsupported field value:",e,t),xF(t,e);if(t instanceof Yr)return function(r,i){if(!SF(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=wo(a,i.bu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ee(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return I1(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=je.fromDate(r);return{timestampValue:lu(i.serializer,s)}}if(r instanceof je){let s=new je(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:lu(i.serializer,s)}}if(r instanceof go)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Cr)return{bytesValue:N1(i.serializer,r._byteString)};if(r instanceof Re){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:vT(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${Rm(r)}`)}(t,e)}function xF(t,e){let n={};return i1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):_o(t,(r,i)=>{let s=wo(i,e.pu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function MF(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof je||t instanceof go||t instanceof Cr||t instanceof Re||t instanceof Yr)}function YT(t,e,n){if(!MF(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=Rm(n);throw r==="an object"?e.Du(t+" a custom object"):e.Du(t+" "+r)}}function sT(t,e,n){if((e=ee(e))instanceof Wn)return e._internalPath;if(typeof e=="string")return ZT(t,e);throw vm("Field path arguments must be of type string or ",t,!1,void 0,n)}var s6=new RegExp("[~\\*/\\[\\]]");function ZT(t,e,n){if(e.search(s6)>=0)throw vm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Wn(...e.split("."))._internalPath}catch{throw vm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function vm(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new w(v.INVALID_ARGUMENT,a+t+u)}function NF(t,e){return t.some(n=>n.isEqual(e))}var mo=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Re(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new oT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(Om("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},oT=class extends mo{data(){return super.data()}};function Om(t,e){return typeof e=="string"?ZT(t,e):e instanceof Wn?e._internalPath:e._delegate._internalPath}function PF(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new w(v.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Sd=class{},yo=class extends Sd{};function Dr(t,e,...n){let r=[];e instanceof Sd&&r.push(e),r=r.concat(n),function(s){let o=s.filter(u=>u instanceof aT).length,a=s.filter(u=>u instanceof wm).length;if(o>1||o>0&&a>0)throw new w(v.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var wm=class t extends yo{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return OF(e._query,n),new Tt(e.firestore,e.converter,VC(e._query,n))}_parse(e){let n=vo(e.firestore);return function(s,o,a,u,c,l,d){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new w(v.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){GO(d,l);let f=[];for(let p of d)f.push(qO(u,s,p));h={arrayValue:{values:f}}}else h=qO(u,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||GO(d,l),h=RF(a,o,d,l==="in"||l==="not-in");return ae.create(c,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function XT(t,e,n){let r=e,i=Om("where",t);return wm._create(i,r,n)}var aT=class t extends Sd{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ee.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let u of a)OF(o,u),o=VC(o,u)}(e._query,n),new Tt(e.firestore,e.converter,VC(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var uT=class t extends yo{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new w(v.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new w(v.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new uo(s,o)}(e._query,this._field,this._direction);return new Tt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Gn(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function JT(t,e="asc"){let n=e,r=Om("orderBy",t);return uT._create(r,n)}var Em=class t extends yo{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new Tt(e.firestore,e.converter,jg(e._query,this._limit,this._limitType))}};function eb(t){return EF("limit",t),Em._create("limit",t,"F")}function tb(t){return EF("limitToLast",t),Em._create("limitToLast",t,"L")}var Im=class t extends yo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=kF(e,this.type,this._docOrFields,this._inclusive);return new Tt(e.firestore,e.converter,function(i,s){return new Gn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function nb(...t){return Im._create("startAt",t,!0)}function rb(...t){return Im._create("startAfter",t,!1)}var Cm=class t extends yo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=kF(e,this.type,this._docOrFields,this._inclusive);return new Tt(e.firestore,e.converter,function(i,s){return new Gn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function ib(...t){return Cm._create("endBefore",t,!1)}function sb(...t){return Cm._create("endAt",t,!0)}function kF(t,e,n,r){if(n[0]=ee(n[0]),n[0]instanceof mo)return function(s,o,a,u,c){if(!u)throw new w(v.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of nu(s))if(d.field.isKeyField())l.push(ao(o,u.key));else{let h=u.data.field(d.field);if(Tm(h))throw new w(v.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new w(v.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new Er(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=vo(t.firestore);return function(o,a,u,c,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new w(v.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let g=l[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new w(v.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!yT(o)&&g.indexOf("/")!==-1)throw new w(v.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);let m=o.path.child(le.fromString(g));if(!b.isDocumentKey(m))throw new w(v.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${m}' is not because it contains an odd number of segments.`);let I=new b(m);f.push(ao(a,I))}else{let m=RF(u,c,g);f.push(m)}}return new Er(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function qO(t,e,n){if(typeof(n=ee(n))=="string"){if(n==="")throw new w(v.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yT(e)&&n.indexOf("/")!==-1)throw new w(v.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(le.fromString(n));if(!b.isDocumentKey(r))throw new w(v.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ao(t,new b(r))}if(n instanceof Re)return ao(t,n._key);throw new w(v.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Rm(n)}.`)}function GO(t,e){if(!Array.isArray(t)||t.length===0)throw new w(v.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function OF(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new w(v.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new w(v.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var wu=class{convertValue(e,n="none"){switch(oo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes($i(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw x()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return _o(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new go(Ge(e.latitude),Ge(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=gT(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(cd(e));default:return null}}convertTimestamp(e){let n=Wr(e);return new je(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=le.fromString(e);O(H1(r));let i=new Hi(r.get(1),r.get(3)),s=new b(r.popFirst(5));return i.isEqual(n)||Qe(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function Fm(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var cT=class extends wu{constructor(e){super(),this.firestore=e}convertBytes(e){return new Cr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Re(this.firestore,null,n)}};var zr=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Pn=class extends mo{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Ui(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(Om("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Ui=class extends Pn{data(e={}){return super.data(e)}},Kn=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new zr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ui(this._firestore,this._userDataWriter,r.key,r,new zr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new w(v.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let u=new Ui(i._firestore,i._userDataWriter,a.doc.key,a.doc,new zr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let u=new Ui(i._firestore,i._userDataWriter,a.doc.key,a.doc,new zr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,l=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:o6(a.type),doc:u,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function o6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return x()}}function Lm(t,e){return t instanceof Pn&&e instanceof Pn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Kn&&e instanceof Kn&&t._firestore===e._firestore&&Pm(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function ob(t){t=de(t,Re);let e=de(t.firestore,ke);return _F(ct(e),t._key).then(n=>gb(e,t,n))}var Zr=class extends wu{constructor(e){super(),this.firestore=e}convertBytes(e){return new Cr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Re(this.firestore,null,n)}};function ab(t){t=de(t,Re);let e=de(t.firestore,ke),n=ct(e),r=new Zr(e);return J3(n,t._key).then(i=>new Pn(e,r,t._key,i,new zr(i!==null&&i.hasLocalMutations,!0),t.converter))}function ub(t){t=de(t,Re);let e=de(t.firestore,ke);return _F(ct(e),t._key,{source:"server"}).then(n=>gb(e,t,n))}function cb(t){t=de(t,Tt);let e=de(t.firestore,ke),n=ct(e),r=new Zr(e);return PF(t._query),vF(n,t._query).then(i=>new Kn(e,r,t,i))}function lb(t){t=de(t,Tt);let e=de(t.firestore,ke),n=ct(e),r=new Zr(e);return e6(n,t._query).then(i=>new Kn(e,r,t,i))}function db(t){t=de(t,Tt);let e=de(t.firestore,ke),n=ct(e),r=new Zr(e);return vF(n,t._query,{source:"server"}).then(i=>new Kn(e,r,t,i))}function Vm(t,e,n){t=de(t,Re);let r=de(t.firestore,ke),i=Fm(t.converter,e,n);return Au(r,[km(vo(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,ze.none())])}function Um(t,e,n,...r){t=de(t,Re);let i=de(t.firestore,ke),s=vo(i),o;return o=typeof(e=ee(e))=="string"||e instanceof Wn?QT(s,"updateDoc",t._key,e,n,r):KT(s,"updateDoc",t._key,e),Au(i,[o.toMutation(t._key,ze.exists(!0))])}function hb(t){return Au(de(t.firestore,ke),[new Ki(t._key,ze.none())])}function fb(t,e){let n=de(t.firestore,ke),r=Su(t),i=Fm(t.converter,e);return Au(n,[km(vo(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,ze.exists(!1))]).then(()=>r)}function jm(t,...e){var n,r,i;t=ee(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||ZD(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ZD(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let u,c,l;if(t instanceof Re)c=de(t.firestore,ke),l=Iu(t._key.path),u={next:d=>{e[o]&&e[o](gb(c,t,d))},error:e[o+1],complete:e[o+2]};else{let d=de(t,Tt);c=de(d.firestore,ke),l=d._query;let h=new Zr(c);u={next:f=>{e[o]&&e[o](new Kn(c,h,d,f))},error:e[o+1],complete:e[o+2]},PF(t._query)}return function(h,f,p,g){let m=new _u(g),I=new Cd(f,m,p);return h.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return bT(yield vu(h),I)})),()=>{m.$a(),h.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return ST(yield vu(h),I)}))}}(ct(c),l,a,u)}function pb(t,e){return t6(ct(t=de(t,ke)),ZD(e)?e:{next:e})}function Au(t,e){return function(r,i){let s=new nt;return r.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return k3(yield FT(r),i,s)})),s.promise}(ct(t),e)}function gb(t,e,n){let r=n.docs.get(e._key),i=new Zr(t);return new Pn(t,i,e._key,r,new zr(n.hasPendingWrites,n.fromCache),e.converter)}var a6={maxAttempts:5};var Dm=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=vo(e)}set(e,n,r){this._verifyNotCommitted();let i=Li(e,this._firestore),s=Fm(i.converter,n,r),o=km(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,ze.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=Li(e,this._firestore),o;return o=typeof(n=ee(n))=="string"||n instanceof Wn?QT(this._dataReader,"WriteBatch.update",s._key,n,r,i):KT(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,ze.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=Li(e,this._firestore);return this._mutations=this._mutations.concat(new Ki(n._key,ze.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new w(v.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Li(t,e){if((t=ee(t)).firestore!==e)throw new w(v.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var lT=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=vo(n)}get(n){let r=Li(n,this._firestore),i=new cT(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return x();let o=s[0];if(o.isFoundDocument())return new mo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new mo(this._firestore,i,r._key,null,r.converter);throw x()})}set(n,r,i){let s=Li(n,this._firestore),o=Fm(s.converter,r,i),a=km(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=Li(n,this._firestore),a;return a=typeof(r=ee(r))=="string"||r instanceof Wn?QT(this._dataReader,"Transaction.update",o._key,r,i,s):KT(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=Li(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=Li(e,this._firestore),r=new Zr(this._firestore);return super.get(e).then(i=>new Pn(this._firestore,r,n._key,i._document,new zr(!1,!1),n.converter))}};function mb(t,e,n){t=de(t,ke);let r=Object.assign(Object.assign({},a6),n);return function(s){if(s.maxAttempts<1)throw new w(v.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let u=new nt;return s.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){let c=yield Y3(s);new WD(s.asyncQueue,c,a,o,u).Xa()})),u.promise}(ct(t),i=>e(new lT(t,i)),r)}function yb(){return new bd("deleteField")}function _b(){return new tT("serverTimestamp")}function vb(...t){return new nT("arrayUnion",t)}function wb(...t){return new rT("arrayRemove",t)}function Eb(t){return new iT("increment",t)}(function(e,n=!0){(function(i){Eu=i})(Ro),Sr(new Lt("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new ke(new gC(r.getProvider("auth-internal")),new vC(r.getProvider("app-check-internal")),function(c,l){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new w(v.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hi(c.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Ne(zk,"4.6.1",e),Ne(zk,"4.6.1","esm2017")})();var u6="@firebase/firestore-compat",c6="0.3.30";function Sb(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new w("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function FF(){if(typeof Uint8Array>"u")throw new w("unimplemented","Uint8Arrays are not available in this environment.")}function LF(){if(!s1())throw new w("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Bm=class t{constructor(e){this._delegate=e}static fromBase64String(e){return LF(),new t(Cr.fromBase64String(e))}static fromUint8Array(e){return FF(),new t(Cr.fromUint8Array(e))}toBase64(){return LF(),this._delegate.toBase64()}toUint8Array(){return FF(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Ib(t){return l6(t,["next","error","complete"])}function l6(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var Cb=class{enableIndexedDbPersistence(e,n){return jT(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return BT(e._delegate)}clearIndexedDbPersistence(e){return $T(e._delegate)}},$m=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Hi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Mn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){xm(this._delegate,e,n,r)}enableNetwork(){return qT(this._delegate)}disableNetwork(){return GT(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,VT("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return HT(this._delegate)}onSnapshotsInSync(e){return pb(this._delegate,e)}get app(){if(!this._appCompat)throw new w("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Mu(this,Mm(this._delegate,e))}catch(n){throw Kt(n,"collection()","Firestore.collection()")}}doc(e){try{return new Tr(this,Su(this._delegate,e))}catch(n){throw Kt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Do(this,UT(this._delegate,e))}catch(n){throw Kt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return mb(this._delegate,n=>e(new Hm(this,n)))}batch(){return ct(this._delegate),new qm(new Dm(this._delegate,e=>Au(this._delegate,e)))}loadBundle(e){return zT(this._delegate,e)}namedQuery(e){return WT(this._delegate,e).then(n=>n?new Do(this,n):null)}},Ru=class extends wu{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bm(new Cr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return Tr.forKey(n,this.firestore,null)}};function d6(t){dT(t)}var Hm=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Ru(e)}get(e){let n=Eo(e);return this._delegate.get(n).then(r=>new Io(this._firestore,new Pn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=Eo(e);return r?(Sb("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Eo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Eo(e);return this._delegate.delete(n),this}},qm=class{constructor(e){this._delegate=e}set(e,n,r){let i=Eo(e);return r?(Sb("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Eo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Eo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},xu=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Ui(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Co(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new Ru(e),n),i.set(n,s)),s}};xu.INSTANCES=new WeakMap;var Tr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Ru(e)}static forPath(e,n,r){if(e.length%2!==0)throw new w("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new Re(n._delegate,r,new b(e)))}static forKey(e,n,r){return new t(n,new Re(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Mu(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Mu(this.firestore,Mm(this._delegate,e))}catch(n){throw Kt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ee(e),e instanceof Re?Nm(this._delegate,e):!1}set(e,n){n=Sb("DocumentReference.set",n);try{return n?Vm(this._delegate,e,n):Vm(this._delegate,e)}catch(r){throw Kt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?Um(this._delegate,e):Um(this._delegate,e,n,...r)}catch(i){throw Kt(i,"updateDoc()","DocumentReference.update()")}}delete(){return hb(this._delegate)}onSnapshot(...e){let n=VF(e),r=UF(e,i=>new Io(this.firestore,new Pn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return jm(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=ab(this._delegate):e?.source==="server"?n=ub(this._delegate):n=ob(this._delegate),n.then(r=>new Io(this.firestore,new Pn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(xu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Kt(t,e,n){return t.message=t.message.replace(e,n),t}function VF(t){for(let e of t)if(typeof e=="object"&&!Ib(e))return e;return{}}function UF(t,e){var n,r;let i;return Ib(t[0])?i=t[0]:Ib(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Io=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Tr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Lm(this._delegate,e._delegate)}},Co=class extends Io{data(e){let n=this._delegate.data(e);return this._delegate._converter||zO(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},Do=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Ru(e)}where(e,n,r){try{return new t(this.firestore,Dr(this._delegate,XT(e,n,r)))}catch(i){throw Kt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,Dr(this._delegate,JT(e,n)))}catch(r){throw Kt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,Dr(this._delegate,eb(e)))}catch(n){throw Kt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,Dr(this._delegate,tb(e)))}catch(n){throw Kt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,Dr(this._delegate,nb(...e)))}catch(n){throw Kt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,Dr(this._delegate,rb(...e)))}catch(n){throw Kt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,Dr(this._delegate,ib(...e)))}catch(n){throw Kt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,Dr(this._delegate,sb(...e)))}catch(n){throw Kt(n,"endAt()","Query.endAt()")}}isEqual(e){return Pm(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=lb(this._delegate):e?.source==="server"?n=db(this._delegate):n=cb(this._delegate),n.then(r=>new kd(this.firestore,new Kn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=VF(e),r=UF(e,i=>new kd(this.firestore,new Kn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return jm(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(xu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Db=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Co(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},kd=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new Do(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Co(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new Db(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Co(this._firestore,r))})}isEqual(e){return Lm(this._delegate,e._delegate)}},Mu=class t extends Do{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Tr(this.firestore,e):null}doc(e){try{return e===void 0?new Tr(this.firestore,Su(this._delegate)):new Tr(this.firestore,Su(this._delegate,e))}catch(n){throw Kt(n,"doc()","CollectionReference.doc()")}}add(e){return fb(this._delegate,e).then(n=>new Tr(this.firestore,n))}isEqual(e){return Nm(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(xu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Eo(t){return de(t,Re)}var Tb=class t{constructor(...e){this._delegate=new Wn(...e)}static documentId(){return new t(Ye.keyField().canonicalString())}isEqual(e){return e=ee(e),e instanceof Wn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var bb=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=_b();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=yb();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=vb(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=wb(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=Eb(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var h6={Firestore:$m,GeoPoint:go,Timestamp:je,Blob:Bm,Transaction:Hm,WriteBatch:qm,DocumentReference:Tr,DocumentSnapshot:Io,Query:Do,QueryDocumentSnapshot:Co,QuerySnapshot:kd,CollectionReference:Mu,FieldPath:Tb,FieldValue:bb,setLogLevel:d6,CACHE_SIZE_UNLIMITED:IF};function f6(t,e){t.INTERNAL.registerComponent(new Lt("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},h6)))}function p6(t){f6(t,(e,n)=>new $m(e,n,new Cb)),t.registerVersion(u6,c6)}p6(st);function g6(t,e=rs){return new X(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function jF(t,e){return g6(t,e)}function m6(t,e){return jF(t,e).pipe(is(void 0),$u(),F(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function xb(t,e){return jF(t,e).pipe(F(n=>({payload:n,type:"query"})))}var Gm=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=GF(r,n);return new Wm(i,s,this.afs)}snapshotChanges(){return m6(this.ref,this.afs.schedulers.outsideAngular).pipe(He)}valueChanges(e={}){return this.snapshotChanges().pipe(F(({payload:n})=>e.idField?ge(M({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return ye(this.ref.get(e)).pipe(He)}};function zm(t,e){return xb(t,e).pipe(is(void 0),$u(),F(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let c=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function BF(t,e,n){return zm(t,n).pipe(Zn((r,i)=>y6(r,i.map(s=>s.payload),e),[]),ju(),F(r=>r.map(i=>({type:i.type,payload:i}))))}function y6(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=_6(t,r))}),t}function Ab(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function _6(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return Ab(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return Ab(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Ab(t,e.oldIndex,1);break}return t}function $F(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var Wm=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=zm(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(F(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(is(void 0),$u(),bt(([r,i])=>i.length>0||!r),F(([,r])=>r),He)}auditTrail(e){return this.stateChanges(e).pipe(Zn((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=$F(e);return BF(this.query,n,this.afs.schedulers.outsideAngular).pipe(He)}valueChanges(e={}){return xb(this.query,this.afs.schedulers.outsideAngular).pipe(F(n=>n.payload.docs.map(r=>e.idField?ge(M({},r.data()),{[e.idField]:r.id}):r.data())),He)}get(e){return ye(this.query.get(e)).pipe(He)}add(e){return this.ref.add(e)}doc(e){return new Gm(this.ref.doc(e),this.afs)}},Rb=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?zm(this.query,this.afs.schedulers.outsideAngular).pipe(He):zm(this.query,this.afs.schedulers.outsideAngular).pipe(F(n=>n.filter(r=>e.indexOf(r.type)>-1)),bt(n=>n.length>0),He)}auditTrail(e){return this.stateChanges(e).pipe(Zn((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=$F(e);return BF(this.query,n,this.afs.schedulers.outsideAngular).pipe(He)}valueChanges(e={}){return xb(this.query,this.afs.schedulers.outsideAngular).pipe(F(r=>r.payload.docs.map(i=>e.idField?M({[e.idField]:i.id},i.data()):i.data())),He)}get(e){return ye(this.query.get(e)).pipe(He)}},HF=new N("angularfire2.enableFirestorePersistence"),qF=new N("angularfire2.firestore.persistenceSettings"),v6=new N("angularfire2.firestore.settings"),w6=new N("angularfire2.firestore.use-emulator");function GF(t,e=n=>n){return{query:e(t),ref:t}}var E6=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,m,I,R){this.schedulers=u;let C=Fs(n,a,r),P=l;d&&zc(C,a,h,p,g,m,f,I),[this.firestore,this.persistenceEnabled$]=Ea(`${C.name}.firestore`,"AngularFirestore",C.name,()=>{let j=a.runOutsideAngular(()=>C.firestore());if(s&&j.settings(s),P&&j.useEmulator(...P),i&&!Ss(o)){let H=()=>{try{return ye(j.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(ve){return typeof console<"u"&&console.warn(ve),V(!1)}};return[j,a.runOutsideAngular(H)]}else return[j,V(!1)]},[s,P,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=GF(i,r),a=this.schedulers.ngZone.run(()=>s);return new Wm(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new Rb(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new Gm(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(T(or),T(Ei,8),T(HF,8),T(v6,8),T(Mt),T(se),T(Jt),T(qF,8),T(w6,8),T(Ls,8),T(jc,8),T(Bc,8),T($c,8),T(Hc,8),T(qc,8),T(Gc,8),T(Bt,8))};static \u0275prov=U({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),zF=(()=>{class t{constructor(){st.registerVersion("angularfire",ft.full,"fst-compat")}static enablePersistence(n){return{ngModule:t,providers:[{provide:HF,useValue:!0},{provide:qF,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ve({type:t});static \u0275inj=Le({providers:[E6]})}return t})();var WF="auth",Od=class{constructor(e){return e}},To=class{constructor(){return ks(WF)}};var Mb=new N("angularfire2.auth-instances");function E5(t,e){let n=wa(WF,t,e);return n&&new Od(n)}function I5(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Od(r)}}var C5={provide:To,deps:[[new Ke,Mb]]},D5={provide:Od,useFactory:E5,deps:[[new Ke,Mb],Un]},T5=(()=>{class t{constructor(){Ne("angularfire",ft.full,"auth")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ve({type:t});static \u0275inj=Le({providers:[D5,C5]})}return t})();function KF(t,...e){return{ngModule:T5,providers:[{provide:Mb,useFactory:I5(t),multi:!0,deps:[se,Xt,Jt,jr,[new Ke,Bt],...e]}]}}var QF=Os(ny,!0);var Fd=class{constructor(e){return e}},YF="firestore",Nb=class{constructor(){return ks(YF)}};var Pb=new N("angularfire2.firestore-instances");function b5(t,e){let n=wa(YF,t,e);return n&&new Fd(n)}function S5(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Fd(r)}}var A5={provide:Nb,deps:[[new Ke,Pb]]},R5={provide:Fd,useFactory:b5,deps:[[new Ke,Pb],Un]},x5=(()=>{class t{constructor(){Ne("angularfire",ft.full,"fst")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ve({type:t});static \u0275inj=Le({providers:[R5,A5]})}return t})();function ZF(t,...e){return{ngModule:x5,providers:[{provide:Pb,useFactory:S5(t),multi:!0,deps:[se,Xt,Jt,jr,[new Ke,To],[new Ke,Bt],...e]}]}}var XF=Os(CF,!0);var iL="firebasestorage.googleapis.com",M5="storageBucket",N5=2*60*1e3,P5=10*60*1e3;var br=class t extends $d{constructor(e,n,r=0){super(kb(e),`Firebase Storage: ${n} (${kb(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return kb(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},ei=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(ei||{});function kb(t){return"storage/"+t}function k5(){let t="An unknown error occurred, please check the error payload for server response.";return new br(ei.UNKNOWN,t)}function O5(){return new br(ei.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function F5(){return new br(ei.CANCELED,"User canceled the upload/download.")}function L5(t){return new br(ei.INVALID_URL,"Invalid URL '"+t+"'.")}function V5(t){return new br(ei.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function JF(t){return new br(ei.INVALID_ARGUMENT,t)}function sL(){return new br(ei.APP_DELETED,"The Firebase app was deleted.")}function U5(t){return new br(ei.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var Jr=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(r.path==="")return r;throw V5(e)}static makeFromUrl(e,n){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),u={bucket:1,path:3};function c(P){P.path_=decodeURIComponent(P.path)}let l="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",f=new RegExp(`^https?://${d}/${l}/b/${i}/o${h}`,"i"),p={bucket:1,path:3},g=n===iL?"(?:storage.googleapis.com|storage.cloud.google.com)":n,m="([^?#]*)",I=new RegExp(`^https?://${g}/${i}/${m}`,"i"),C=[{regex:a,indices:u,postModify:s},{regex:f,indices:p,postModify:c},{regex:I,indices:{bucket:1,path:2},postModify:c}];for(let P=0;P<C.length;P++){let j=C[P],H=j.regex.exec(e);if(H){let ve=H[j.indices.bucket],lt=H[j.indices.path];lt||(lt=""),r=new t(ve,lt),j.postModify(r);break}}if(r==null)throw L5(e);return r}},Ob=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function j5(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function u(){return a===2}let c=!1;function l(...m){c||(c=!0,e.apply(null,m))}function d(m){i=setTimeout(()=>{i=null,t(f,u())},m)}function h(){s&&clearTimeout(s)}function f(m,...I){if(c){h();return}if(m){h(),l.call(null,m,...I);return}if(u()||o){h(),l.call(null,m,...I);return}r<64&&(r*=2);let C;a===1?(a=2,C=0):C=(r+Math.random())*1e3,d(C)}let p=!1;function g(m){p||(p=!0,h(),!c&&(i!==null?(m||(a=2),clearTimeout(i),d(0)):m||(a=1)))}return d(0),s=setTimeout(()=>{o=!0,g(!0)},n),g}function B5(t){t(!1)}function $5(t){return t!==void 0}function eL(t,e,n,r){if(r<e)throw JF(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw JF(`Invalid value for '${t}'. Expected ${n} or less.`)}function H5(t){let e=encodeURIComponent,n="?";for(let r in t)if(t.hasOwnProperty(r)){let i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Fb=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(Fb||{});function q5(t,e){let n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}var Lb=class{constructor(e,n,r,i,s,o,a,u,c,l,d,h=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=d,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,p)=>{this.resolve_=f,this.reject_=p,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Nu(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let u=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Fb.NO_ERROR,u=s.getStatus();if(!a||q5(u,this.additionalRetryCodes_)&&this.retry){let l=s.getErrorCode()===Fb.ABORT;r(!1,new Nu(!1,null,l));return}let c=this.successCodes_.indexOf(u)!==-1;r(!0,new Nu(c,s))})},n=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let u=this.callback_(a,a.getResponse());$5(u)?s(u):s()}catch(u){o(u)}else if(a!==null){let u=k5();u.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,u)):o(u)}else if(i.canceled){let u=this.appDelete_?sL():F5();o(u)}else{let u=O5();o(u)}};this.canceled_?n(!1,new Nu(!1,null,!0)):this.backoffId_=j5(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&B5(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Nu=class{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}};function G5(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function z5(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function W5(t,e){e&&(t["X-Firebase-GMPID"]=e)}function K5(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function Q5(t,e,n,r,i,s,o=!0){let a=H5(t.urlParams),u=t.url+a,c=Object.assign({},t.headers);return W5(c,e),G5(c,n),z5(c,s),K5(c,r),new Lb(u,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}function Y5(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Z5(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}var Ese=256*1024;var Vb=class t{constructor(e,n){this._service=e,n instanceof Jr?this._location=n:this._location=Jr.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new Jr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Z5(this._location.path)}get storage(){return this._service}get parent(){let e=Y5(this._location.path);if(e===null)return null;let n=new Jr(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw U5(e)}};function tL(t,e){let n=e?.[M5];return n==null?null:Jr.makeFromBucketSpec(n,t)}function X5(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";let{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:So(i,t.app.options.projectId))}var Ub=class{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=iL,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=N5,this._maxUploadRetryTime=P5,this._requests=new Set,i!=null?this._bucket=Jr.makeFromBucketSpec(i,this._host):this._bucket=tL(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Jr.makeFromBucketSpec(this._url,e):this._bucket=tL(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){eL("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){eL("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return _(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=yield e.getToken();if(n!==null)return n.accessToken}return null})}_getAppCheckToken(){return _(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Vb(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new Ob(sL());{let o=Q5(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){return _(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()})}},nL="@firebase/storage",rL="0.12.4";var oL="storage";function aL(t=ri(),e){t=ee(t);let r=Ao(t,oL).getImmediate({identifier:e}),i=Pu("storage");return i&&uL(r,...i),r}function uL(t,e,n,r={}){X5(t,e,n,r)}function J5(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Ub(n,r,i,e,Ro)}function e8(){Sr(new Lt(oL,J5,"PUBLIC").setMultipleInstances(!0)),Ne(nL,rL,""),Ne(nL,rL,"esm2017")}e8();var Ld=class{constructor(e){return e}},cL="storage",jb=class{constructor(){return ks(cL)}};var Bb=new N("angularfire2.storage-instances");function t8(t,e){let n=wa(cL,t,e);return n&&new Ld(n)}function n8(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Ld(r)}}var r8={provide:jb,deps:[[new Ke,Bb]]},i8={provide:Ld,useFactory:t8,deps:[[new Ke,Bb],Un]},s8=(()=>{class t{constructor(){Ne("angularfire",ft.full,"gcs")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ve({type:t});static \u0275inj=Le({providers:[i8,r8]})}return t})();function lL(t,...e){return{ngModule:s8,providers:[{provide:Bb,useFactory:n8(t),multi:!0,deps:[se,Xt,Jt,jr,[new Ke,To],[new Ke,Bt],...e]}]}}var dL=Os(aL,!0);var hL={providers:[lx(eM),ys(Qx.initializeApp(Zf.firebase),Yx,CP,zF),ys(Ox(()=>ty({projectId:"dattilodamian-saladejuegos-sp2",appId:"1:988028569182:web:3a7a599b5bd4c4a78dd6cf",storageBucket:"dattilodamian-saladejuegos-sp2.appspot.com",apiKey:"AIzaSyBodhRrppGG8S8bRC5rA4ae1-t-4w9CLeo",authDomain:"dattilodamian-saladejuegos-sp2.firebaseapp.com",messagingSenderId:"988028569182"}))),ys(KF(()=>QF())),ys(ZF(()=>XF())),ys(lL(()=>dL()))]};function o8(t,e){t&1&&(De(0,"div")(1,"button",4),$e(2,"Home"),Se()())}var fL=(()=>{let e=class e{constructor(r){this.authS=r,this.title="tp-sala-juegos"}logueado(){return console.log(this.authS.userCredentials),this.authS.userCredentials!=null}};e.\u0275fac=function(i){return new(i||e)(te(Ii))},e.\u0275cmp=En({type:e,selectors:[["app-root"]],standalone:!0,features:[Is([{provide:or,useValue:Zf.firebase}]),Cn],decls:10,vars:1,consts:[["routerLink","register",1,"route-button","btn","btn-dark","m-1"],["routerLink","login",1,"route-button","btn","btn-dark","m-1"],["routerLink","quien-soy",1,"route-button","btn","btn-dark","m-1"],[4,"ngIf"],["routerLink","home",1,"route-button","btn","btn-dark","m-1"]],template:function(i,s){i&1&&(De(0,"h1"),$e(1,"Sala de juegos Dattilo Damian"),Se(),De(2,"button",0),$e(3,"Registro"),Se(),De(4,"button",1),$e(5,"Login"),Se(),De(6,"button",2),$e(7,"Quien soy"),Se(),av(8,o8,3,0,"div",3),Vr(9,"router-outlet")),i&2&&(pi(8),uv("ngIf",s.logueado()))},dependencies:[tw,cx,bs,_R,_a],styles:[".route-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:5px solid #00ff2a;margin:5px;padding:8px 16px;border-radius:4px;cursor:pointer}.route-button[_ngcontent-%COMP%]:hover{background-color:#0056b3;border-color:#b30000}"]});let t=e;return t})();AR(fL,hL).catch(t=>console.error(t));
