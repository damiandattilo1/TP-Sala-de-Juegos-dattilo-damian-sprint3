import{A as NT,B as rn,C as qr,D as md,E as uu,F as gm,G as PT,H as kT,I as B,J as Ut,K as Je,L as mm,M as OT,N as cu,O as ie,P as Gt,Q as yd,R as ym,S as sn,T as Gr,U as Hi,V as _d,W as FT,X as En,Y as Xe,a as M,b as ge,c as hm,d as _,e as CT,f as dd,g as DT,h as TT,i as D,j as no,k as hd,l as bT,m as ST,n as rt,o as fd,p as au,q as fm,r as AT,s as jn,t as pm,u as pd,v as xT,w as MT,x as gd,y as Ge,z as RT}from"./chunk-K3XG54ZU.js";var VT=null;var _m=1,vm=Symbol("SIGNAL");function me(t){let e=VT;return VT=t,e}var LT={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function g1(t){if(!(Im(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===_m)){if(!t.producerMustRecompute(t)&&!wm(t)){t.dirty=!1,t.lastCleanEpoch=_m;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=_m}}function jT(t){return t&&(t.nextProducerIndex=0),me(t)}function UT(t,e){if(me(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(Im(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Em(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function wm(t){vd(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(g1(n),r!==n.version))return!0}return!1}function BT(t){if(vd(t),Im(t))for(let e=0;e<t.producerNode.length;e++)Em(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Em(t,e){if(m1(t),vd(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)Em(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];vd(i),i.producerIndexOfThis[r]=e}}function Im(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function vd(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function m1(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function y1(){throw new Error}var _1=y1;function $T(t){_1=t}function q(t){return typeof t=="function"}function ro(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var wd=ro(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function qi(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Ue=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(q(r))try{r()}catch(s){e=s instanceof wd?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{HT(s)}catch(o){e=e??[],o instanceof wd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new wd(e)}}add(e){var n;if(e&&e!==this)if(this.closed)HT(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&qi(n,e)}remove(e){let{_finalizers:n}=this;n&&qi(n,e),e instanceof t&&e._removeParent(this)}};Ue.EMPTY=(()=>{let t=new Ue;return t.closed=!0,t})();var Cm=Ue.EMPTY;function Ed(t){return t instanceof Ue||t&&"closed"in t&&q(t.remove)&&q(t.add)&&q(t.unsubscribe)}function HT(t){q(t)?t():t.unsubscribe()}var In={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var io={setTimeout(t,e,...n){let{delegate:r}=io;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=io;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Id(t){io.setTimeout(()=>{let{onUnhandledError:e}=In;if(e)e(t);else throw t})}function Gi(){}var qT=Dm("C",void 0,void 0);function GT(t){return Dm("E",void 0,t)}function zT(t){return Dm("N",t,void 0)}function Dm(t,e,n){return{kind:t,value:e,error:n}}var zi=null;function so(t){if(In.useDeprecatedSynchronousErrorHandling){let e=!zi;if(e&&(zi={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=zi;if(zi=null,n)throw r}}else t()}function WT(t){In.useDeprecatedSynchronousErrorHandling&&zi&&(zi.errorThrown=!0,zi.error=t)}var Wi=class extends Ue{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Ed(e)&&e.add(this)):this.destination=E1}static create(e,n,r){return new yr(e,n,r)}next(e){this.isStopped?bm(zT(e),this):this._next(e)}error(e){this.isStopped?bm(GT(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?bm(qT,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},v1=Function.prototype.bind;function Tm(t,e){return v1.call(t,e)}var Sm=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Cd(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Cd(r)}else Cd(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Cd(n)}}},yr=class extends Wi{constructor(e,n,r){super();let i;if(q(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&In.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Tm(e.next,s),error:e.error&&Tm(e.error,s),complete:e.complete&&Tm(e.complete,s)}):i=e}this.destination=new Sm(i)}};function Cd(t){In.useDeprecatedSynchronousErrorHandling?WT(t):Id(t)}function w1(t){throw t}function bm(t,e){let{onStoppedNotification:n}=In;n&&io.setTimeout(()=>n(t,e))}var E1={closed:!0,next:Gi,error:w1,complete:Gi};var oo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function dt(t){return t}function Am(...t){return xm(t)}function xm(t){return t.length===0?dt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var X=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=C1(n)?n:new yr(n,r,i);return so(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=KT(r),new r((i,s)=>{let o=new yr({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[oo](){return this}pipe(...n){return xm(n)(this)}toPromise(n){return n=KT(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function KT(t){var e;return(e=t??In.Promise)!==null&&e!==void 0?e:Promise}function I1(t){return t&&q(t.next)&&q(t.error)&&q(t.complete)}function C1(t){return t&&t instanceof Wi||I1(t)&&Ed(t)}function Mm(t){return q(t?.lift)}function K(t){return e=>{if(Mm(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function G(t,e,n,r,i){return new Rm(t,e,n,r,i)}var Rm=class extends Wi{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function ao(){return K((t,e)=>{let n=null;t._refCount++;let r=G(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var uo=class extends X{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Mm(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ue;let n=this.getSubject();e.add(this.source.subscribe(G(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ue.EMPTY)}return e}refCount(){return ao()(this)}};var QT=ro(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Fe=(()=>{class t extends X{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Dd(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new QT}next(n){so(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){so(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){so(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Cm:(this.currentObservers=null,s.push(n),new Ue(()=>{this.currentObservers=null,qi(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new X;return n.source=this,n}}return t.create=(e,n)=>new Dd(e,n),t})(),Dd=class extends Fe{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Cm}};var ht=class extends Fe{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var lu={now(){return(lu.delegate||Date).now()},delegate:void 0};var Td=class extends Fe{constructor(e=1/0,n=1/0,r=lu){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}};var bd=class extends Ue{constructor(e,n){super()}schedule(e,n=0){return this}};var du={setInterval(t,e,...n){let{delegate:r}=du;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=du;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var co=class extends bd{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return du.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&du.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,qi(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var lo=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};lo.now=lu.now;var ho=class extends lo{constructor(e,n=lo.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var Ki=new ho(co);var Sd=class extends co{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var Ad=class extends ho{};var Nm=new Ad(Sd);var xt=new X(t=>t.complete());function YT(t){return t&&q(t.schedule)}function Pm(t){return t[t.length-1]}function fo(t){return q(Pm(t))?t.pop():void 0}function Un(t){return YT(Pm(t))?t.pop():void 0}function ZT(t,e){return typeof Pm(t)=="number"?t.pop():e}var xd=t=>t&&typeof t.length=="number"&&typeof t!="function";function Md(t){return q(t?.then)}function Rd(t){return q(t[oo])}function Nd(t){return Symbol.asyncIterator&&q(t?.[Symbol.asyncIterator])}function Pd(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function D1(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var kd=D1();function Od(t){return q(t?.[kd])}function Fd(t){return DT(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield dd(n.read());if(i)return yield dd(void 0);yield yield dd(r)}}finally{n.releaseLock()}})}function Vd(t){return q(t?.getReader)}function Ie(t){if(t instanceof X)return t;if(t!=null){if(Rd(t))return T1(t);if(xd(t))return b1(t);if(Md(t))return S1(t);if(Nd(t))return JT(t);if(Od(t))return A1(t);if(Vd(t))return x1(t)}throw Pd(t)}function T1(t){return new X(e=>{let n=t[oo]();if(q(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function b1(t){return new X(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function S1(t){return new X(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Id)})}function A1(t){return new X(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function JT(t){return new X(e=>{M1(t,e).catch(n=>e.error(n))})}function x1(t){return JT(Fd(t))}function M1(t,e){var n,r,i,s;return CT(this,void 0,void 0,function*(){try{for(n=TT(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function Bt(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function on(t,e=0){return K((n,r)=>{n.subscribe(G(r,i=>Bt(r,t,()=>r.next(i),e),()=>Bt(r,t,()=>r.complete(),e),i=>Bt(r,t,()=>r.error(i),e)))})}function Cn(t,e=0){return K((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function XT(t,e){return Ie(t).pipe(Cn(e),on(e))}function eb(t,e){return Ie(t).pipe(Cn(e),on(e))}function tb(t,e){return new X(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function nb(t,e){return new X(n=>{let r;return Bt(n,e,()=>{r=t[kd](),Bt(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>q(r?.return)&&r.return()})}function Ld(t,e){if(!t)throw new Error("Iterable cannot be null");return new X(n=>{Bt(n,e,()=>{let r=t[Symbol.asyncIterator]();Bt(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function rb(t,e){return Ld(Fd(t),e)}function ib(t,e){if(t!=null){if(Rd(t))return XT(t,e);if(xd(t))return tb(t,e);if(Md(t))return eb(t,e);if(Nd(t))return Ld(t,e);if(Od(t))return nb(t,e);if(Vd(t))return rb(t,e)}throw Pd(t)}function de(t,e){return e?ib(t,e):Ie(t)}function V(...t){let e=Un(t);return de(t,e)}function po(t,e){let n=q(t)?t:()=>t,r=i=>i.error(n());return new X(e?i=>e.schedule(r,0,i):r)}function km(t){return!!t&&(t instanceof X||q(t.lift)&&q(t.subscribe))}var _r=ro(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function k(t,e){return K((n,r)=>{let i=0;n.subscribe(G(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:R1}=Array;function N1(t,e){return R1(e)?t(...e):t(e)}function jd(t){return k(e=>N1(t,e))}var{isArray:P1}=Array,{getPrototypeOf:k1,prototype:O1,keys:F1}=Object;function Ud(t){if(t.length===1){let e=t[0];if(P1(e))return{args:e,keys:null};if(V1(e)){let n=F1(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function V1(t){return t&&typeof t=="object"&&k1(t)===O1}function Bd(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function hu(...t){let e=Un(t),n=fo(t),{args:r,keys:i}=Ud(t);if(r.length===0)return de([],e);let s=new X(L1(r,e,i?o=>Bd(i,o):dt));return n?s.pipe(jd(n)):s}function L1(t,e,n=dt){return r=>{sb(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)sb(e,()=>{let c=de(t[u],e),l=!1;c.subscribe(G(r,d=>{s[u]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function sb(t,e,n){t?Bt(n,t,e):e()}function ob(t,e,n,r,i,s,o,a){let u=[],c=0,l=0,d=!1,h=()=>{d&&!u.length&&!c&&e.complete()},f=g=>c<r?p(g):u.push(g),p=g=>{s&&e.next(g),c++;let v=!1;Ie(n(g,l++)).subscribe(G(e,C=>{i?.(C),s?f(C):e.next(C)},()=>{v=!0},void 0,()=>{if(v)try{for(c--;u.length&&c<r;){let C=u.shift();o?Bt(e,o,()=>p(C)):p(C)}h()}catch(C){e.error(C)}}))};return t.subscribe(G(e,f,()=>{d=!0,h()})),()=>{a?.()}}function ze(t,e,n=1/0){return q(e)?ze((r,i)=>k((s,o)=>e(r,s,i,o))(Ie(t(r,i))),n):(typeof e=="number"&&(n=e),K((r,i)=>ob(r,i,t,n)))}function zr(t=1/0){return ze(dt,t)}function ab(){return zr(1)}function go(...t){return ab()(de(t,Un(t)))}function $d(t){return new X(e=>{Ie(t()).subscribe(e)})}function Om(...t){let e=fo(t),{args:n,keys:r}=Ud(t),i=new X(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),u=o,c=o;for(let l=0;l<o;l++){let d=!1;Ie(n[l]).subscribe(G(s,h=>{d||(d=!0,c--),a[l]=h},()=>u--,void 0,()=>{(!u||!d)&&(c||s.next(r?Bd(r,a):a),s.complete())}))}});return e?i.pipe(jd(e)):i}function mo(...t){let e=Un(t),n=ZT(t,1/0),r=t;return r.length?r.length===1?Ie(r[0]):zr(n)(de(r,e)):xt}function ft(t,e){return K((n,r)=>{let i=0;n.subscribe(G(r,s=>t.call(e,s,i++)&&r.next(s)))})}function Wr(t){return K((e,n)=>{let r=null,i=!1,s;r=e.subscribe(G(n,void 0,void 0,o=>{s=Ie(t(o,Wr(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function ub(t,e,n,r,i){return(s,o)=>{let a=n,u=e,c=0;s.subscribe(G(o,l=>{let d=c++;u=a?t(u,l,d):(a=!0,l),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function Qi(t,e){return q(e)?ze(t,e,1):ze(t,1)}function Kr(t){return K((e,n)=>{let r=!1;e.subscribe(G(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Bn(t){return t<=0?()=>xt:K((e,n)=>{let r=0;e.subscribe(G(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Fm(t){return k(()=>t)}function fu(t,e=dt){return t=t??j1,K((n,r)=>{let i,s=!0;n.subscribe(G(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function j1(t,e){return t===e}function Hd(t=U1){return K((e,n)=>{let r=!1;e.subscribe(G(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function U1(){return new _r}function pu(t){return K((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function an(t,e){let n=arguments.length>=2;return r=>r.pipe(t?ft((i,s)=>t(i,s,r)):dt,Bn(1),n?Kr(e):Hd(()=>new _r))}function yo(t){return t<=0?()=>xt:K((e,n)=>{let r=[];e.subscribe(G(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function Vm(t,e){let n=arguments.length>=2;return r=>r.pipe(t?ft((i,s)=>t(i,s,r)):dt,yo(1),n?Kr(e):Hd(()=>new _r))}function gu(){return K((t,e)=>{let n,r=!1;t.subscribe(G(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function $n(t,e){return K(ub(t,e,arguments.length>=2,!0))}function mu(t={}){let{connector:e=()=>new Fe,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,c=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=u=void 0,l=d=!1},p=()=>{let g=o;f(),g?.unsubscribe()};return K((g,v)=>{c++,!d&&!l&&h();let C=u=u??e();v.add(()=>{c--,c===0&&!d&&!l&&(a=Lm(p,i))}),C.subscribe(v),!o&&c>0&&(o=new yr({next:N=>C.next(N),error:N=>{d=!0,h(),a=Lm(f,n,N),C.error(N)},complete:()=>{l=!0,h(),a=Lm(f,r),C.complete()}}),Ie(g).subscribe(o))})(s)}}function Lm(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new yr({next:()=>{r.unsubscribe(),t()}});return Ie(e(...n)).subscribe(r)}function qd(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,mu({connector:()=>new Td(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function jm(t){return K((e,n)=>{let r=!1,i=0;e.subscribe(G(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function Yi(...t){let e=Un(t);return K((n,r)=>{(e?go(t,n,e):go(t,n)).subscribe(r)})}function Ae(t,e){return K((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(G(r,u=>{i?.unsubscribe();let c=0,l=s++;Ie(t(u,l)).subscribe(i=G(r,d=>r.next(e?e(u,d,l,c++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Gd(t,e){return q(e)?Ae(()=>t,e):Ae(()=>t)}function Um(t){return K((e,n)=>{Ie(t).subscribe(G(n,()=>n.complete(),Gi)),!n.closed&&e.subscribe(n)})}function et(t,e,n){let r=q(t)||e||n?{next:t,error:e,complete:n}:t;return r?K((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(G(s,u=>{var c;(c=r.next)===null||c===void 0||c.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,u),s.error(u)},()=>{var u,c;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):dt}function Bm(...t){let e=fo(t);return K((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let u=0;u<i;u++)Ie(t[u]).subscribe(G(r,c=>{s[u]=c,!a&&!o[u]&&(o[u]=!0,(a=o.every(dt))&&(o=null))},Gi));n.subscribe(G(r,u=>{if(a){let c=[u,...s];r.next(e?e(...c):c)}}))})}var Gb="https://g.co/ng/security#xss",U=class extends Error{constructor(e,n){super(Uy(e,n)),this.code=e}};function Uy(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function Au(t){return{toString:t}.toString()}var zd="__parameters__";function B1(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function zb(t,e,n){return Au(()=>{let r=B1(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,c,l){let d=u.hasOwnProperty(zd)?u[zd]:Object.defineProperty(u,zd,{value:[]})[zd];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var Zi=globalThis;function Ce(t){for(let e in t)if(t[e]===Ce)return e;throw Error("Could not find renamed property on target object.")}function $1(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Rt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Rt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function cb(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var H1=Ce({__forward_ref__:Ce});function as(t){return t.__forward_ref__=as,t.toString=function(){return Rt(this())},t}function Mt(t){return Wb(t)?t():t}function Wb(t){return typeof t=="function"&&t.hasOwnProperty(H1)&&t.__forward_ref__===as}function F(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function wt(t){return{providers:t.providers||[],imports:t.imports||[]}}function Eh(t){return lb(t,Qb)||lb(t,Yb)}function Kb(t){return Eh(t)!==null}function lb(t,e){return t.hasOwnProperty(e)?t[e]:null}function q1(t){let e=t&&(t[Qb]||t[Yb]);return e||null}function db(t){return t&&(t.hasOwnProperty(hb)||t.hasOwnProperty(G1))?t[hb]:null}var Qb=Ce({\u0275prov:Ce}),hb=Ce({\u0275inj:Ce}),Yb=Ce({ngInjectableDef:Ce}),G1=Ce({ngInjectorDef:Ce}),P=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=F({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Zb(t){return t&&!!t.\u0275providers}var z1=Ce({\u0275cmp:Ce}),W1=Ce({\u0275dir:Ce}),K1=Ce({\u0275pipe:Ce}),Q1=Ce({\u0275mod:Ce}),th=Ce({\u0275fac:Ce}),yu=Ce({__NG_ELEMENT_ID__:Ce}),fb=Ce({__NG_ENV_ID__:Ce});function Ih(t){return typeof t=="string"?t:t==null?"":String(t)}function Y1(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Ih(t)}function Z1(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new U(-200,t)}function By(t,e){throw new U(-201,!1)}var ne=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ne||{}),ry;function Jb(){return ry}function un(t){let e=ry;return ry=t,e}function Xb(t,e,n){let r=Eh(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ne.Optional)return null;if(e!==void 0)return e;By(t,"Injector")}var J1={},_u=J1,iy="__NG_DI_FLAG__",nh="ngTempTokenPath",X1="ngTokenPath",eV=/\n/gm,tV="\u0275",pb="__source",Io;function nV(){return Io}function Qr(t){let e=Io;return Io=t,e}function rV(t,e=ne.Default){if(Io===void 0)throw new U(-203,!1);return Io===null?Xb(t,void 0,e):Io.get(t,e&ne.Optional?null:void 0,e)}function I(t,e=ne.Default){return(Jb()||rV)(Mt(t),e)}function x(t,e=ne.Default){return I(t,Ch(e))}function Ch(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function sy(t){let e=[];for(let n=0;n<t.length;n++){let r=Mt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new U(900,!1);let i,s=ne.Default;for(let o=0;o<r.length;o++){let a=r[o],u=iV(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(I(i,s))}else e.push(I(r))}return e}function e0(t,e){return t[iy]=e,t.prototype[iy]=e,t}function iV(t){return t[iy]}function sV(t,e,n,r){let i=t[nh];throw e[pb]&&i.unshift(e[pb]),t.message=oV(`
`+t.message,i,n,r),t[X1]=i,t[nh]=null,t}function oV(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==tV?t.slice(2):t;let i=Rt(e);if(Array.isArray(e))i=e.map(Rt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Rt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(eV,`
  `)}`}var xu=e0(zb("Optional"),8);var t0=e0(zb("SkipSelf"),4);function Do(t,e){let n=t.hasOwnProperty(th);return n?t[th]:null}function $y(t,e){t.forEach(n=>Array.isArray(n)?$y(n,e):e(n))}function n0(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function rh(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function aV(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function uV(t,e,n){let r=Mu(t,e);return r>=0?t[r|1]=n:(r=~r,aV(t,r,e,n)),r}function $m(t,e){let n=Mu(t,e);if(n>=0)return t[n|1]}function Mu(t,e){return cV(t,e,1)}function cV(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var To={},cn=[],bo=new P(""),r0=new P("",-1),i0=new P(""),ih=class{get(e,n=_u){if(n===_u){let r=new Error(`NullInjectorError: No provider for ${Rt(e)}!`);throw r.name="NullInjectorError",r}return n}},s0=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(s0||{}),Gn=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Gn||{}),_t=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(_t||{});function lV(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function oy(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];dV(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function o0(t){return t===3||t===4||t===6}function dV(t){return t.charCodeAt(0)===64}function vu(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?gb(t,n,i,null,e[++r]):gb(t,n,i,null,null))}}return t}function gb(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var a0="ng-template";function hV(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&lV(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(Hy(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function Hy(t){return t.type===4&&t.value!==a0}function fV(t,e,n){let r=t.type===4&&!n?a0:t.value;return e===r}function pV(t,e,n){let r=4,i=t.attrs,s=i!==null?yV(i):0,o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!Dn(r)&&!Dn(u))return!1;if(o&&Dn(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!fV(t,u,n)||u===""&&e.length===1){if(Dn(r))return!1;o=!0}}else if(r&8){if(i===null||!hV(t,i,u,n)){if(Dn(r))return!1;o=!0}}else{let c=e[++a],l=gV(u,i,Hy(t),n);if(l===-1){if(Dn(r))return!1;o=!0;continue}if(c!==""){let d;if(l>s?d="":d=i[l+1].toLowerCase(),r&2&&c!==d){if(Dn(r))return!1;o=!0}}}}return Dn(r)||o}function Dn(t){return(t&1)===0}function gV(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return _V(e,t)}function mV(t,e,n=!1){for(let r=0;r<e.length;r++)if(pV(t,e[r],n))return!0;return!1}function yV(t){for(let e=0;e<t.length;e++){let n=t[e];if(o0(n))return e}return t.length}function _V(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function mb(t,e){return t?":not("+e.trim()+")":e}function vV(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Dn(o)&&(e+=mb(s,i),i=""),r=o,s=s||!Dn(r);n++}return i!==""&&(e+=mb(s,i)),e}function wV(t){return t.map(vV).join(",")}function EV(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Dn(i))break;i=s}r++}return{attrs:e,classes:n}}function u0(t){return Au(()=>{let e=f0(t),n=ge(M({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===s0.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Gn.Emulated,styles:t.styles||cn,_:null,schemas:t.schemas||null,tView:null,id:""});p0(n);let r=t.dependencies;return n.directiveDefs=_b(r,!1),n.pipeDefs=_b(r,!0),n.id=DV(n),n})}function IV(t){return Zr(t)||c0(t)}function CV(t){return t!==null}function Et(t){return Au(()=>({type:t.type,bootstrap:t.bootstrap||cn,declarations:t.declarations||cn,imports:t.imports||cn,exports:t.exports||cn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function yb(t,e){if(t==null)return To;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=_t.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==_t.None?[r,a]:r,e[s]=o):n[s]=r}return n}function It(t){return Au(()=>{let e=f0(t);return p0(e),e})}function Zr(t){return t[z1]||null}function c0(t){return t[W1]||null}function l0(t){return t[K1]||null}function d0(t){let e=Zr(t)||c0(t)||l0(t);return e!==null?e.standalone:!1}function h0(t,e){let n=t[Q1]||null;if(!n&&e===!0)throw new Error(`Type ${Rt(t)} does not have '\u0275mod' property.`);return n}function f0(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||To,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||cn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:yb(t.inputs,e),outputs:yb(t.outputs),debugInfo:null}}function p0(t){t.features?.forEach(e=>e(t))}function _b(t,e){if(!t)return null;let n=e?l0:IV;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(CV)}function DV(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Dh(t){return{\u0275providers:t}}function TV(...t){return{\u0275providers:g0(!0,t),\u0275fromNgModule:!0}}function g0(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return $y(e,o=>{let a=o;ay(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&m0(i,s),n}function m0(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];qy(i,s=>{e(s,r)})}}function ay(t,e,n,r){if(t=Mt(t),!t)return!1;let i=null,s=db(t),o=!s&&Zr(t);if(!s&&!o){let u=t.ngModule;if(s=db(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of u)ay(c,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let c;try{$y(s.imports,l=>{ay(l,e,n,r)&&(c||=[],c.push(l))})}finally{}c!==void 0&&m0(c,e)}if(!a){let c=Do(i)||(()=>new i);e({provide:i,useFactory:c,deps:cn},i),e({provide:i0,useValue:i,multi:!0},i),e({provide:bo,useValue:()=>I(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let c=t;qy(u,l=>{e(l,c)})}}else return!1;return i!==t&&t.providers!==void 0}function qy(t,e){for(let n of t)Zb(n)&&(n=n.\u0275providers),Array.isArray(n)?qy(n,e):e(n)}var bV=Ce({provide:String,useValue:Ce});function y0(t){return t!==null&&typeof t=="object"&&bV in t}function SV(t){return!!(t&&t.useExisting)}function AV(t){return!!(t&&t.useFactory)}function So(t){return typeof t=="function"}function xV(t){return!!t.useClass}var Th=new P(""),Yd={},MV={},Hm;function Gy(){return Hm===void 0&&(Hm=new ih),Hm}var zt=class{},wu=class extends zt{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,cy(e,o=>this.processProvider(o)),this.records.set(r0,_o(void 0,this)),i.has("environment")&&this.records.set(zt,_o(void 0,this));let s=this.records.get(Th);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(i0,cn,ne.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=me(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),me(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=Qr(this),r=un(void 0),i;try{return e()}finally{Qr(n),un(r)}}get(e,n=_u,r=ne.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(fb))return e[fb](this);r=Ch(r);let i,s=Qr(this),o=un(void 0);try{if(!(r&ne.SkipSelf)){let u=this.records.get(e);if(u===void 0){let c=OV(e)&&Eh(e);c&&this.injectableDefInScope(c)?u=_o(uy(e),Yd):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&ne.Self?Gy():this.parent;return n=r&ne.Optional&&n===_u?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[nh]=a[nh]||[]).unshift(Rt(e)),s)throw a;return sV(a,e,"R3InjectorError",this.source)}else throw a}finally{un(o),Qr(s)}}resolveInjectorInitializers(){let e=me(null),n=Qr(this),r=un(void 0),i;try{let s=this.get(bo,cn,ne.Self);for(let o of s)o()}finally{Qr(n),un(r),me(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Rt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new U(205,!1)}processProvider(e){e=Mt(e);let n=So(e)?e:Mt(e&&e.provide),r=NV(e);if(!So(e)&&e.multi===!0){let i=this.records.get(n);i||(i=_o(void 0,Yd,!0),i.factory=()=>sy(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=me(null);try{return n.value===Yd&&(n.value=MV,n.value=n.factory()),typeof n.value=="object"&&n.value&&kV(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{me(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Mt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function uy(t){let e=Eh(t),n=e!==null?e.factory:Do(t);if(n!==null)return n;if(t instanceof P)throw new U(204,!1);if(t instanceof Function)return RV(t);throw new U(204,!1)}function RV(t){if(t.length>0)throw new U(204,!1);let n=q1(t);return n!==null?()=>n.factory(t):()=>new t}function NV(t){if(y0(t))return _o(void 0,t.useValue);{let e=_0(t);return _o(e,Yd)}}function _0(t,e,n){let r;if(So(t)){let i=Mt(t);return Do(i)||uy(i)}else if(y0(t))r=()=>Mt(t.useValue);else if(AV(t))r=()=>t.useFactory(...sy(t.deps||[]));else if(SV(t))r=()=>I(Mt(t.useExisting));else{let i=Mt(t&&(t.useClass||t.provide));if(PV(t))r=()=>new i(...sy(t.deps));else return Do(i)||uy(i)}return r}function _o(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function PV(t){return!!t.deps}function kV(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function OV(t){return typeof t=="function"||typeof t=="object"&&t instanceof P}function cy(t,e){for(let n of t)Array.isArray(n)?cy(n,e):n&&Zb(n)?cy(n.\u0275providers,e):e(n)}function Er(t,e){t instanceof wu&&t.assertNotDestroyed();let n,r=Qr(t),i=un(void 0);try{return e()}finally{Qr(r),un(i)}}function v0(){return Jb()!==void 0||nV()!=null}function FV(t){if(!v0())throw new U(-203,!1)}function VV(t){return typeof t=="function"}var Ir=0,ae=1,$=2,vt=3,Tn=4,An=5,sh=6,Eu=7,bn=8,Ao=9,Sn=10,tt=11,Iu=12,vb=13,Po=14,zn=15,bh=16,vo=17,xo=18,Sh=19,w0=20,Yr=21,qm=22,es=23,Jr=25,E0=1;var ts=7,oh=8,ah=9,ln=10,zy=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(zy||{});function Ji(t){return Array.isArray(t)&&typeof t[E0]=="object"}function Cr(t){return Array.isArray(t)&&t[E0]===!0}function I0(t){return(t.flags&4)!==0}function Ah(t){return t.componentOffset>-1}function Wy(t){return(t.flags&1)===1}function Xr(t){return!!t.template}function LV(t){return(t[$]&512)!==0}var ly=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function C0(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function ti(){return D0}function D0(t){return t.type.prototype.ngOnChanges&&(t.setInput=UV),jV}ti.ngInherit=!0;function jV(){let t=b0(this),e=t?.current;if(e){let n=t.previous;if(n===To)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function UV(t,e,n,r,i){let s=this.declaredInputs[r],o=b0(t)||BV(t,{previous:To,current:null}),a=o.current||(o.current={}),u=o.previous,c=u[s];a[s]=new ly(c&&c.currentValue,n,u===To),C0(t,e,i,n)}var T0="__ngSimpleChanges__";function b0(t){return t[T0]||null}function BV(t,e){return t[T0]=e}var wb=null;var Hn=function(t,e,n){wb?.(t,e,n)},$V="svg",HV="math",qV=!1;function GV(){return qV}function Wn(t){for(;Array.isArray(t);)t=t[Ir];return t}function S0(t,e){return Wn(e[t])}function dn(t,e){return Wn(e[t.index])}function A0(t,e){return t.data[e]}function ni(t,e){let n=e[t];return Ji(n)?n:n[Ir]}function Ky(t){return(t[$]&128)===128}function zV(t){return Cr(t[vt])}function uh(t,e){return e==null?null:t[e]}function x0(t){t[vo]=0}function WV(t){t[$]&1024||(t[$]|=1024,Ky(t)&&Cu(t))}function KV(t,e){for(;t>0;)e=e[Po],t--;return e}function Qy(t){return!!(t[$]&9216||t[es]?.dirty)}function dy(t){t[Sn].changeDetectionScheduler?.notify(1),Qy(t)?Cu(t):t[$]&64&&(GV()?(t[$]|=1024,Cu(t)):t[Sn].changeDetectionScheduler?.notify())}function Cu(t){t[Sn].changeDetectionScheduler?.notify();let e=Du(t);for(;e!==null&&!(e[$]&8192||(e[$]|=8192,!Ky(e)));)e=Du(e)}function M0(t,e){if((t[$]&256)===256)throw new U(911,!1);t[Yr]===null&&(t[Yr]=[]),t[Yr].push(e)}function QV(t,e){if(t[Yr]===null)return;let n=t[Yr].indexOf(e);n!==-1&&t[Yr].splice(n,1)}function Du(t){let e=t[vt];return Cr(e)?e[vt]:e}var se={lFrame:V0(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function YV(){return se.lFrame.elementDepthCount}function ZV(){se.lFrame.elementDepthCount++}function JV(){se.lFrame.elementDepthCount--}function R0(){return se.bindingsEnabled}function XV(){return se.skipHydrationRootTNode!==null}function eL(t){return se.skipHydrationRootTNode===t}function tL(){se.skipHydrationRootTNode=null}function xe(){return se.lFrame.lView}function Wt(){return se.lFrame.tView}function sZ(t){return se.lFrame.contextLView=t,t[bn]}function oZ(t){return se.lFrame.contextLView=null,t}function $t(){let t=N0();for(;t!==null&&t.type===64;)t=t.parent;return t}function N0(){return se.lFrame.currentTNode}function nL(){let t=se.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function Ru(t,e){let n=se.lFrame;n.currentTNode=t,n.isParent=e}function P0(){return se.lFrame.isParent}function rL(){se.lFrame.isParent=!1}function iL(t){return se.lFrame.bindingIndex=t}function xh(){return se.lFrame.bindingIndex++}function sL(t){let e=se.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function oL(){return se.lFrame.inI18n}function aL(t,e){let n=se.lFrame;n.bindingIndex=n.bindingRootIndex=t,hy(e)}function uL(){return se.lFrame.currentDirectiveIndex}function hy(t){se.lFrame.currentDirectiveIndex=t}function cL(t){let e=se.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function k0(t){se.lFrame.currentQueryIndex=t}function lL(t){let e=t[ae];return e.type===2?e.declTNode:e.type===1?t[An]:null}function O0(t,e,n){if(n&ne.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&ne.Host);)if(i=lL(s),i===null||(s=s[Po],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=se.lFrame=F0();return r.currentTNode=e,r.lView=t,!0}function Yy(t){let e=F0(),n=t[ae];se.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function F0(){let t=se.lFrame,e=t===null?null:t.child;return e===null?V0(t):e}function V0(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function L0(){let t=se.lFrame;return se.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var j0=L0;function Zy(){let t=L0();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function dL(t){return(se.lFrame.contextLView=KV(t,se.lFrame.contextLView))[bn]}function ko(){return se.lFrame.selectedIndex}function ns(t){se.lFrame.selectedIndex=t}function Jy(){let t=se.lFrame;return A0(t.tView,t.selectedIndex)}function hL(){return se.lFrame.currentNamespace}var U0=!0;function Xy(){return U0}function e_(t){U0=t}function fL(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=D0(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function t_(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function Zd(t,e,n){B0(t,e,3,n)}function Jd(t,e,n,r){(t[$]&3)===n&&B0(t,e,n,r)}function Gm(t,e){let n=t[$];(n&3)===e&&(n&=16383,n+=1,t[$]=n)}function B0(t,e,n,r){let i=r!==void 0?t[vo]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(t[vo]+=65536),(a<s||s==-1)&&(pL(t,n,e,u),t[vo]=(t[vo]&4294901760)+u+2),u++}function Eb(t,e){Hn(4,t,e);let n=me(null);try{e.call(t)}finally{me(n),Hn(5,t,e)}}function pL(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[$]>>14<t[vo]>>16&&(t[$]&3)===e&&(t[$]+=16384,Eb(a,s)):Eb(a,s)}var Co=-1,rs=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function gL(t){return t instanceof rs}function mL(t){return(t.flags&8)!==0}function yL(t){return(t.flags&16)!==0}function $0(t){return t!==Co}function ch(t){return t&32767}function _L(t){return t>>16}function lh(t,e){let n=_L(t),r=e;for(;n>0;)r=r[Po],n--;return r}var fy=!0;function Ib(t){let e=fy;return fy=t,e}var vL=256,H0=vL-1,q0=5,wL=0,qn={};function EL(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(yu)&&(r=n[yu]),r==null&&(r=n[yu]=wL++);let i=r&H0,s=1<<i;e.data[t+(i>>q0)]|=s}function dh(t,e){let n=G0(t,e);if(n!==-1)return n;let r=e[ae];r.firstCreatePass&&(t.injectorIndex=e.length,zm(r.data,t),zm(e,null),zm(r.blueprint,null));let i=n_(t,e),s=t.injectorIndex;if($0(i)){let o=ch(i),a=lh(i,e),u=a[ae].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|u[o+c]}return e[s+8]=i,s}function zm(t,e){t.push(0,0,0,0,0,0,0,0,e)}function G0(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function n_(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=Y0(i),r===null)return Co;if(n++,i=i[Po],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Co}function py(t,e,n){EL(t,e,n)}function IL(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(o0(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function z0(t,e,n){if(n&ne.Optional||t!==void 0)return t;By(e,"NodeInjector")}function W0(t,e,n,r){if(n&ne.Optional&&r===void 0&&(r=null),!(n&(ne.Self|ne.Host))){let i=t[Ao],s=un(void 0);try{return i?i.get(e,r,n&ne.Optional):Xb(e,r,n&ne.Optional)}finally{un(s)}}return z0(r,e,n)}function K0(t,e,n,r=ne.Default,i){if(t!==null){if(e[$]&2048&&!(r&ne.Self)){let o=SL(t,e,n,r,qn);if(o!==qn)return o}let s=Q0(t,e,n,r,qn);if(s!==qn)return s}return W0(e,n,r,i)}function Q0(t,e,n,r,i){let s=TL(n);if(typeof s=="function"){if(!O0(e,t,r))return r&ne.Host?z0(i,n,r):W0(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&ne.Optional))By(n);else return o}finally{j0()}}else if(typeof s=="number"){let o=null,a=G0(t,e),u=Co,c=r&ne.Host?e[zn][An]:null;for((a===-1||r&ne.SkipSelf)&&(u=a===-1?n_(t,e):e[a+8],u===Co||!Db(r,!1)?a=-1:(o=e[ae],a=ch(u),e=lh(u,e)));a!==-1;){let l=e[ae];if(Cb(s,a,l.data)){let d=CL(a,e,n,o,r,c);if(d!==qn)return d}u=e[a+8],u!==Co&&Db(r,e[ae].data[a+8]===c)&&Cb(s,a,e)?(o=l,a=ch(u),e=lh(u,e)):a=-1}}return i}function CL(t,e,n,r,i,s){let o=e[ae],a=o.data[t+8],u=r==null?Ah(a)&&fy:r!=o&&(a.type&3)!==0,c=i&ne.Host&&s===a,l=DL(a,o,n,u,c);return l!==null?Mo(e,o,l,a):qn}function DL(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,u=t.directiveStart,c=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:c;for(let f=d;f<h;f++){let p=o[f];if(f<u&&n===p||f>=u&&p.type===n)return f}if(i){let f=o[u];if(f&&Xr(f)&&f.type===n)return u}return null}function Mo(t,e,n,r){let i=t[n],s=e.data;if(gL(i)){let o=i;o.resolving&&Z1(Y1(s[n]));let a=Ib(o.canSeeViewProviders);o.resolving=!0;let u,c=o.injectImpl?un(o.injectImpl):null,l=O0(t,r,ne.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&fL(n,s[n],e)}finally{c!==null&&un(c),Ib(a),o.resolving=!1,j0()}}return i}function TL(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(yu)?t[yu]:void 0;return typeof e=="number"?e>=0?e&H0:bL:e}function Cb(t,e,n){let r=1<<t;return!!(n[e+(t>>q0)]&r)}function Db(t,e){return!(t&ne.Self)&&!(t&ne.Host&&e)}var Xi=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return K0(this._tNode,this._lView,e,Ch(r),n)}};function bL(){return new Xi($t(),xe())}function Oo(t){return Au(()=>{let e=t.prototype.constructor,n=e[th]||gy(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[th]||gy(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function gy(t){return Wb(t)?()=>{let e=gy(Mt(t));return e&&e()}:Do(t)}function SL(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[$]&2048&&!(o[$]&512);){let a=Q0(s,o,n,r|ne.Self,qn);if(a!==qn)return a;let u=s.parent;if(!u){let c=o[w0];if(c){let l=c.get(n,qn,r);if(l!==qn)return l}u=Y0(o),o=o[Po]}s=u}return i}function Y0(t){let e=t[ae],n=e.type;return n===2?e.declTNode:n===1?t[An]:null}function r_(t){return IL($t(),t)}function Tb(t,e=null,n=null,r){let i=Z0(t,e,n,r);return i.resolveInjectorInitializers(),i}function Z0(t,e=null,n=null,r,i=new Set){let s=[n||cn,TV(t)];return r=r||(typeof t=="object"?void 0:Rt(t)),new wu(s,e||Gy(),r||null,i)}var Dr=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return Tb({name:""},i,r,"");{let s=r.name??"";return Tb({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=_u,e.NULL=new ih,e.\u0275prov=F({token:e,providedIn:"any",factory:()=>I(r0)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var AL="ngOriginalError";function Wm(t){return t[AL]}var Kn=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Wm(e);for(;n&&Wm(n);)n=Wm(n);return n||null}},J0=new P("",{providedIn:"root",factory:()=>x(Kn).handleError.bind(void 0)}),i_=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=xL,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),my=class extends i_{constructor(e){super(),this._lView=e}onDestroy(e){return M0(this._lView,e),()=>QV(this._lView,e)}};function xL(){return new my(xe())}function ML(){return Mh($t(),xe())}function Mh(t,e){return new ri(dn(t,e))}var ri=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=ML;let t=e;return t})();var yy=class extends Fe{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,v0()&&(this.destroyRef=x(i_,{optional:!0})??void 0)}emit(e){let n=me(null);try{super.next(e)}finally{me(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=Km(s),i&&(i=Km(i)),o&&(o=Km(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Ue&&e.add(a),a}};function Km(t){return e=>{setTimeout(t,void 0,e)}}var yt=yy;function X0(t){return(t.flags&128)===128}var eS=new Map,RL=0;function NL(){return RL++}function PL(t){eS.set(t[Sh],t)}function kL(t){eS.delete(t[Sh])}var bb="__ngContext__";function is(t,e){Ji(e)?(t[bb]=e[Sh],PL(e)):t[bb]=e}function tS(t){return rS(t[Iu])}function nS(t){return rS(t[Tn])}function rS(t){for(;t!==null&&!Cr(t);)t=t[Tn];return t}var _y;function iS(t){_y=t}function OL(){if(_y!==void 0)return _y;if(typeof document<"u")return document;throw new U(210,!1)}var s_=new P("",{providedIn:"root",factory:()=>FL}),FL="ng",o_=new P(""),Ct=new P("",{providedIn:"platform",factory:()=>"unknown"});var a_=new P("",{providedIn:"root",factory:()=>OL().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var VL="h",LL="b";var jL=()=>null;function u_(t,e,n=!1){return jL(t,e,n)}var sS=!1,UL=new P("",{providedIn:"root",factory:()=>sS});var Wd;function BL(){if(Wd===void 0&&(Wd=null,Zi.trustedTypes))try{Wd=Zi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Wd}function Sb(t){return BL()?.createScriptURL(t)||t}var hh=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Gb})`}};function Nu(t){return t instanceof hh?t.changingThisBreaksApplicationSecurity:t}function c_(t,e){let n=$L(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${Gb})`)}return n===e}function $L(t){return t instanceof hh&&t.getTypeName()||null}var HL=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function oS(t){return t=String(t),t.match(HL)?t:"unsafe:"+t}var Rh=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Rh||{});function qL(t){let e=uS();return e?e.sanitize(Rh.URL,t)||"":c_(t,"URL")?Nu(t):oS(Ih(t))}function GL(t){let e=uS();if(e)return Sb(e.sanitize(Rh.RESOURCE_URL,t)||"");if(c_(t,"ResourceURL"))return Sb(Nu(t));throw new U(904,!1)}function zL(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?GL:qL}function aS(t,e,n){return zL(e,n)(t)}function uS(){let t=xe();return t&&t[Sn].sanitizer}function cS(t){return t instanceof Function?t():t}function WL(t){return(t??x(Dr)).get(Ct)==="browser"}var vr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(vr||{}),KL;function l_(t,e){return KL(t,e)}function wo(t,e,n,r,i){if(r!=null){let s,o=!1;Cr(r)?s=r:Ji(r)&&(o=!0,r=r[Ir]);let a=Wn(r);t===0&&n!==null?i==null?pS(e,n,a):fh(e,n,a,i||null,!0):t===1&&n!==null?fh(e,n,a,i||null,!0):t===2?dj(e,a,o):t===3&&e.destroyNode(a),s!=null&&fj(e,t,s,n,i)}}function QL(t,e){return t.createText(e)}function YL(t,e,n){t.setValue(e,n)}function lS(t,e,n){return t.createElement(e,n)}function ZL(t,e){dS(t,e),e[Ir]=null,e[An]=null}function JL(t,e,n,r,i,s){r[Ir]=i,r[An]=e,Nh(t,r,n,1,i,s)}function dS(t,e){e[Sn].changeDetectionScheduler?.notify(1),Nh(t,e,e[tt],2,null,null)}function XL(t){let e=t[Iu];if(!e)return Qm(t[ae],t);for(;e;){let n=null;if(Ji(e))n=e[Iu];else{let r=e[ln];r&&(n=r)}if(!n){for(;e&&!e[Tn]&&e!==t;)Ji(e)&&Qm(e[ae],e),e=e[vt];e===null&&(e=t),Ji(e)&&Qm(e[ae],e),n=e&&e[Tn]}e=n}}function ej(t,e,n,r){let i=ln+r,s=n.length;r>0&&(n[i-1][Tn]=e),r<s-ln?(e[Tn]=n[i],n0(n,ln+r,e)):(n.push(e),e[Tn]=null),e[vt]=n;let o=e[bh];o!==null&&n!==o&&tj(o,e);let a=e[xo];a!==null&&a.insertView(t),dy(e),e[$]|=128}function tj(t,e){let n=t[ah],i=e[vt][vt][zn];e[zn]!==i&&(t[$]|=zy.HasTransplantedViews),n===null?t[ah]=[e]:n.push(e)}function hS(t,e){let n=t[ah],r=n.indexOf(e);n.splice(r,1)}function vy(t,e){if(t.length<=ln)return;let n=ln+e,r=t[n];if(r){let i=r[bh];i!==null&&i!==t&&hS(i,r),e>0&&(t[n-1][Tn]=r[Tn]);let s=rh(t,ln+e);ZL(r[ae],r);let o=s[xo];o!==null&&o.detachView(s[ae]),r[vt]=null,r[Tn]=null,r[$]&=-129}return r}function fS(t,e){if(!(e[$]&256)){let n=e[tt];n.destroyNode&&Nh(t,e,n,3,null,null),XL(e)}}function Qm(t,e){if(e[$]&256)return;let n=me(null);try{e[$]&=-129,e[$]|=256,e[es]&&BT(e[es]),rj(t,e),nj(t,e),e[ae].type===1&&e[tt].destroy();let r=e[bh];if(r!==null&&Cr(e[vt])){r!==e[vt]&&hS(r,e);let i=e[xo];i!==null&&i.detachView(t)}kL(e)}finally{me(n)}}function nj(t,e){let n=t.cleanup,r=e[Eu];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Eu]=null);let i=e[Yr];if(i!==null){e[Yr]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function rj(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof rs)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];Hn(4,a,u);try{u.call(a)}finally{Hn(5,a,u)}}else{Hn(4,i,s);try{s.call(i)}finally{Hn(5,i,s)}}}}}function ij(t,e,n){return sj(t,e.parent,n)}function sj(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[Ir];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===Gn.None||s===Gn.Emulated)return null}return dn(r,n)}}function fh(t,e,n,r,i){t.insertBefore(e,n,r,i)}function pS(t,e,n){t.appendChild(e,n)}function Ab(t,e,n,r,i){r!==null?fh(t,e,n,r,i):pS(t,e,n)}function oj(t,e,n,r){t.removeChild(e,n,r)}function d_(t,e){return t.parentNode(e)}function aj(t,e){return t.nextSibling(e)}function uj(t,e,n){return lj(t,e,n)}function cj(t,e,n){return t.type&40?dn(t,n):null}var lj=cj,xb;function h_(t,e,n,r){let i=ij(t,r,e),s=e[tt],o=r.parent||e[An],a=uj(o,r,e);if(i!=null)if(Array.isArray(n))for(let u=0;u<n.length;u++)Ab(s,i,n[u],a,!1);else Ab(s,i,n,a,!1);xb!==void 0&&xb(s,r,e,n,i)}function Xd(t,e){if(e!==null){let n=e.type;if(n&3)return dn(e,t);if(n&4)return wy(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return Xd(t,r);{let i=t[e.index];return Cr(i)?wy(-1,i):Wn(i)}}else{if(n&32)return l_(e,t)()||Wn(t[e.index]);{let r=gS(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Du(t[zn]);return Xd(i,r)}else return Xd(t,e.next)}}}return null}function gS(t,e){if(e!==null){let r=t[zn][An],i=e.projection;return r.projection[i]}return null}function wy(t,e){let n=ln+t+1;if(n<e.length){let r=e[n],i=r[ae].firstChild;if(i!==null)return Xd(r,i)}return e[ts]}function dj(t,e,n){let r=d_(t,e);r&&oj(t,r,e,n)}function f_(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],u=n.type;if(o&&e===0&&(a&&is(Wn(a),r),n.flags|=2),(n.flags&32)!==32)if(u&8)f_(t,e,n.child,r,i,s,!1),wo(e,t,i,a,s);else if(u&32){let c=l_(n,r),l;for(;l=c();)wo(e,t,i,l,s);wo(e,t,i,a,s)}else u&16?hj(t,e,r,n,i,s):wo(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Nh(t,e,n,r,i,s){f_(n,r,t.firstChild,e,i,s,!1)}function hj(t,e,n,r,i,s){let o=n[zn],u=o[An].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++){let l=u[c];wo(e,t,i,l,s)}else{let c=u,l=o[vt];X0(r)&&(c.flags|=128),f_(t,e,c,l,i,s,!0)}}function fj(t,e,n,r,i){let s=n[ts],o=Wn(n);s!==o&&wo(e,t,r,s,i);for(let a=ln;a<n.length;a++){let u=n[a];Nh(u[ae],u,t,e,r,s)}}function pj(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:vr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=vr.Important),t.setStyle(n,r,i,s))}}function gj(t,e,n){t.setAttribute(e,"style",n)}function mS(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function yS(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&oy(t,e,r),i!==null&&mS(t,e,i),s!==null&&gj(t,e,s)}var Fo={};function aZ(t=1){_S(Wt(),xe(),ko()+t,!1)}function _S(t,e,n,r){if(!r)if((e[$]&3)===3){let s=t.preOrderCheckHooks;s!==null&&Zd(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Jd(e,s,0,n)}ns(n)}function _e(t,e=ne.Default){let n=xe();if(n===null)return I(t,e);let r=$t();return K0(r,n,Mt(t),e)}function vS(){let t="invalid";throw new Error(t)}function wS(t,e,n,r,i,s){let o=me(null);try{let a=null;i&_t.SignalBased&&(a=e[r][vm]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&_t.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):C0(e,a,r,s)}finally{me(o)}}function mj(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)ns(~i);else{let s=i,o=n[++r],a=n[++r];aL(o,s);let u=e[s];a(2,u)}}}finally{ns(-1)}}function Ph(t,e,n,r,i,s,o,a,u,c,l){let d=e.blueprint.slice();return d[Ir]=i,d[$]=r|4|128|8|64,(c!==null||t&&t[$]&2048)&&(d[$]|=2048),x0(d),d[vt]=d[Po]=t,d[bn]=n,d[Sn]=o||t&&t[Sn],d[tt]=a||t&&t[tt],d[Ao]=u||t&&t[Ao]||null,d[An]=s,d[Sh]=NL(),d[sh]=l,d[w0]=c,d[zn]=e.type==2?t[zn]:d,d}function kh(t,e,n,r,i){let s=t.data[e];if(s===null)s=yj(t,e,n,r,i),oL()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=nL();s.injectorIndex=o===null?-1:o.injectorIndex}return Ru(s,!0),s}function yj(t,e,n,r,i){let s=N0(),o=P0(),a=o?s:s&&s.parent,u=t.data[e]=Ij(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function ES(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function IS(t,e,n,r,i){let s=ko(),o=r&2;try{ns(-1),o&&e.length>Jr&&_S(t,e,Jr,!1),Hn(o?2:0,i),n(r,i)}finally{ns(s),Hn(o?3:1,i)}}function CS(t,e,n){if(I0(e)){let r=me(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let u=n[o];a.contentQueries(1,u,o)}}}finally{me(r)}}}function DS(t,e,n){R0()&&(Aj(t,e,n,dn(n,e)),(n.flags&64)===64&&MS(t,e,n))}function TS(t,e,n=dn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function bS(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=p_(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function p_(t,e,n,r,i,s,o,a,u,c,l){let d=Jr+r,h=d+i,f=_j(d,h),p=typeof c=="function"?c():c;return f[ae]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:p,incompleteFirstPass:!1,ssrId:l}}function _j(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:Fo);return n}function vj(t,e,n,r){let s=r.get(UL,sS)||n===Gn.ShadowDom,o=t.selectRootElement(e,s);return wj(o),o}function wj(t){Ej(t)}var Ej=()=>null;function Ij(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return XV()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Mb(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,u=_t.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let c=s;if(i!==null){if(!i.hasOwnProperty(s))continue;c=i[s]}t===0?Rb(r,n,c,a,u):Rb(r,n,c,a)}return r}function Rb(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function Cj(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],u=null,c=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;u=Mb(0,d.inputs,l,u,f),c=Mb(1,d.outputs,l,c,p);let g=u!==null&&o!==null&&!Hy(e)?jj(u,l,o):null;a.push(g)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=c}function Dj(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function SS(t,e,n,r,i,s,o,a){let u=dn(e,n),c=e.inputs,l;!a&&c!=null&&(l=c[r])?(g_(t,n,l,r,i),Ah(e)&&Tj(n,e.index)):e.type&3?(r=Dj(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(u,r,i)):e.type&12}function Tj(t,e){let n=ni(e,t);n[$]&16||(n[$]|=64)}function AS(t,e,n,r){if(R0()){let i=r===null?null:{"":-1},s=Mj(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&xS(t,e,n,o,i,a),i&&Rj(n,r,i)}n.mergedAttrs=vu(n.mergedAttrs,n.attrs)}function xS(t,e,n,r,i,s){for(let c=0;c<r.length;c++)py(dh(n,e),t,r[c].type);Pj(n,t.data.length,r.length);for(let c=0;c<r.length;c++){let l=r[c];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,u=ES(t,e,r.length,null);for(let c=0;c<r.length;c++){let l=r[c];n.mergedAttrs=vu(n.mergedAttrs,l.hostAttrs),kj(t,n,e,u,l),Nj(u,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}Cj(t,n,s)}function bj(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;Sj(o)!=a&&o.push(a),o.push(n,r,s)}}function Sj(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function Aj(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;Ah(n)&&Oj(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||dh(n,e),is(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let u=t.data[a],c=Mo(e,t,a,n);if(is(c,e),o!==null&&Lj(e,a-i,c,u,n,o),Xr(u)){let l=ni(n.index,e);l[bn]=Mo(e,t,a,n)}}}function MS(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=uL();try{ns(s);for(let a=r;a<i;a++){let u=t.data[a],c=e[a];hy(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&xj(u,c)}}finally{ns(-1),hy(o)}}function xj(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function Mj(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(mV(e,o.selectors,!1))if(r||(r=[]),Xr(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;Ey(t,e,u)}else r.unshift(o),Ey(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function Ey(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function Rj(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new U(-301,!1);r.push(e[i],s)}}}function Nj(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Xr(e)&&(n[""]=t)}}function Pj(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function kj(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Do(i.type,!0)),o=new rs(s,Xr(i),_e);t.blueprint[r]=o,n[r]=o,bj(t,e,r,ES(t,n,i.hostVars,Fo),i)}function Oj(t,e,n){let r=dn(e,t),i=bS(n),s=t[Sn].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=Oh(t,Ph(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function Fj(t,e,n,r,i,s){let o=dn(t,e);Vj(e[tt],o,s,t.value,n,r,i)}function Vj(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?Ih(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function Lj(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],c=o[a++],l=o[a++],d=o[a++];wS(r,n,u,c,l,d)}}function jj(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function RS(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function NS(t,e){let n=t.contentQueries;if(n!==null){let r=me(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];k0(s),a.contentQueries(2,e[o],o)}}}finally{me(r)}}}function Oh(t,e){return t[Iu]?t[vb][Tn]=e:t[Iu]=e,t[vb]=e,e}function Iy(t,e,n){k0(0);let r=me(null);try{e(t,n)}finally{me(r)}}function Uj(t){return t[Eu]||(t[Eu]=[])}function Bj(t){return t.cleanup||(t.cleanup=[])}function PS(t,e){let n=t[Ao],r=n?n.get(Kn,null):null;r&&r.handleError(e)}function g_(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],u=n[s++],c=e[o],l=t.data[o];wS(l,c,r,a,u,i)}}function $j(t,e,n){let r=S0(e,t);YL(t[tt],r,n)}function Hj(t,e){let n=ni(e,t),r=n[ae];qj(r,n);let i=n[Ir];i!==null&&n[sh]===null&&(n[sh]=u_(i,n[Ao])),m_(r,n,n[bn])}function qj(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function m_(t,e,n){Yy(e);try{let r=t.viewQuery;r!==null&&Iy(1,r,n);let i=t.template;i!==null&&IS(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[xo]?.finishViewCreation(t),t.staticContentQueries&&NS(t,e),t.staticViewQueries&&Iy(2,t.viewQuery,n);let s=t.components;s!==null&&Gj(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[$]&=-5,Zy()}}function Gj(t,e){for(let n=0;n<e.length;n++)Hj(t,e[n])}function zj(t,e,n,r){let i=me(null);try{let s=e.tView,a=t[$]&4096?4096:16,u=Ph(t,s,n,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),c=t[e.index];u[bh]=c;let l=t[xo];return l!==null&&(u[xo]=l.createEmbeddedView(s)),m_(s,u,n),u}finally{me(i)}}function Nb(t,e){return!e||e.firstChild===null||X0(t)}function Wj(t,e,n,r=!0){let i=e[ae];if(ej(i,e,t,n),r){let o=wy(n,t),a=e[tt],u=d_(a,t[ts]);u!==null&&JL(i,t[An],a,e,u,o)}let s=e[sh];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function ph(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(Wn(s)),Cr(s)&&Kj(s,r);let o=n.type;if(o&8)ph(t,e,n.child,r);else if(o&32){let a=l_(n,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=gS(e,n);if(Array.isArray(a))r.push(...a);else{let u=Du(e[zn]);ph(u[ae],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function Kj(t,e){for(let n=ln;n<t.length;n++){let r=t[n],i=r[ae].firstChild;i!==null&&ph(r[ae],r,i,e)}t[ts]!==t[Ir]&&e.push(t[ts])}var kS=[];function Qj(t){return t[es]??Yj(t)}function Yj(t){let e=kS.pop()??Object.create(Jj);return e.lView=t,e}function Zj(t){t.lView[es]!==t&&(t.lView=null,kS.push(t))}var Jj=ge(M({},LT),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Cu(t.lView)},consumerOnSignalRead(){this.lView[es]=this}}),OS=100;function FS(t,e=!0,n=0){let r=t[Sn],i=r.rendererFactory,s=!1;s||i.begin?.();try{Xj(t,n)}catch(o){throw e&&PS(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function Xj(t,e){Cy(t,e);let n=0;for(;Qy(t);){if(n===OS)throw new U(103,!1);n++,Cy(t,1)}}function e2(t,e,n,r){let i=e[$];if((i&256)===256)return;let s=!1;!s&&e[Sn].inlineEffectRunner?.flush(),Yy(e);let o=null,a=null;!s&&t2(t)&&(a=Qj(e),o=jT(a));try{x0(e),iL(t.bindingStartIndex),n!==null&&IS(t,e,n,2,r);let u=(i&3)===3;if(!s)if(u){let d=t.preOrderCheckHooks;d!==null&&Zd(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Jd(e,d,0,null),Gm(e,0)}if(n2(e),VS(e,0),t.contentQueries!==null&&NS(t,e),!s)if(u){let d=t.contentCheckHooks;d!==null&&Zd(e,d)}else{let d=t.contentHooks;d!==null&&Jd(e,d,1),Gm(e,1)}mj(t,e);let c=t.components;c!==null&&jS(e,c,0);let l=t.viewQuery;if(l!==null&&Iy(2,l,r),!s)if(u){let d=t.viewCheckHooks;d!==null&&Zd(e,d)}else{let d=t.viewHooks;d!==null&&Jd(e,d,2),Gm(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[qm]){for(let d of e[qm])d();e[qm]=null}s||(e[$]&=-73)}catch(u){throw Cu(e),u}finally{a!==null&&(UT(a,o),Zj(a)),Zy()}}function t2(t){return t.type!==2}function VS(t,e){for(let n=tS(t);n!==null;n=nS(n))for(let r=ln;r<n.length;r++){let i=n[r];LS(i,e)}}function n2(t){for(let e=tS(t);e!==null;e=nS(e)){if(!(e[$]&zy.HasTransplantedViews))continue;let n=e[ah];for(let r=0;r<n.length;r++){let i=n[r],s=i[vt];WV(i)}}}function r2(t,e,n){let r=ni(e,t);LS(r,n)}function LS(t,e){Ky(t)&&Cy(t,e)}function Cy(t,e){let r=t[ae],i=t[$],s=t[es],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&wm(s)),s&&(s.dirty=!1),t[$]&=-9217,o)e2(r,t,r.template,t[bn]);else if(i&8192){VS(t,1);let a=r.components;a!==null&&jS(t,a,1)}}function jS(t,e,n){for(let r=0;r<e.length;r++)r2(t,e[r],n)}function y_(t){for(t[Sn].changeDetectionScheduler?.notify();t;){t[$]|=64;let e=Du(t);if(LV(t)&&!e)return t;t=e}return null}var ss=class{get rootNodes(){let e=this._lView,n=e[ae];return ph(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[bn]}set context(e){this._lView[bn]=e}get destroyed(){return(this._lView[$]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[vt];if(Cr(e)){let n=e[oh],r=n?n.indexOf(this):-1;r>-1&&(vy(e,r),rh(n,r))}this._attachedToViewContainer=!1}fS(this._lView[ae],this._lView)}onDestroy(e){M0(this._lView,e)}markForCheck(){y_(this._cdRefInjectingView||this._lView)}detach(){this._lView[$]&=-129}reattach(){dy(this._lView),this._lView[$]|=128}detectChanges(){this._lView[$]|=1024,FS(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new U(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,dS(this._lView[ae],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new U(902,!1);this._appRef=e,dy(this._lView)}},__=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=o2;let t=e;return t})(),i2=__,s2=class extends i2{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=zj(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:n,dehydratedView:r});return new ss(i)}};function o2(){return a2($t(),xe())}function a2(t,e){return t.type&4?new s2(e,t,Mh(t,e)):null}var cZ=new RegExp(`^(\\d+)*(${LL}|${VL})*(.*)`);var u2=()=>null;function Pb(t,e){return u2(t,e)}var gh=class{},Dy=class{},mh=class{};function c2(t){let e=Error(`No component factory found for ${Rt(t)}.`);return e[l2]=t,e}var l2="ngComponent";var Ty=class{resolveComponentFactory(e){throw c2(e)}},Fh=(()=>{let e=class e{};e.NULL=new Ty;let t=e;return t})(),Tu=class{},us=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>d2();let t=e;return t})();function d2(){let t=xe(),e=$t(),n=ni(e.index,t);return(Ji(n)?n:t)[tt]}var h2=(()=>{let e=class e{};e.\u0275prov=F({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),Ym={};var kb=new Set;function v_(t){kb.has(t)||(kb.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function Ob(...t){}function f2(){let t=typeof Zi.requestAnimationFrame=="function",e=Zi[t?"requestAnimationFrame":"setTimeout"],n=Zi[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var he=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new yt(!1),this.onMicrotaskEmpty=new yt(!1),this.onStable=new yt(!1),this.onError=new yt(!1),typeof Zone>"u")throw new U(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=f2().nativeRequestAnimationFrame,m2(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new U(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new U(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,p2,Ob,Ob);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},p2={};function w_(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function g2(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Zi,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,by(t),t.isCheckStableRunning=!0,w_(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),by(t))}function m2(t){let e=()=>{g2(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(y2(a))return n.invokeTask(i,s,o,a);try{return Fb(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),Vb(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return Fb(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),Vb(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,by(t),w_(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function by(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function Fb(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Vb(t){t._nesting--,w_(t)}function y2(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}var Eo=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Eo||{}),_2={destroy(){}};function E_(t,e){!e&&FV(E_);let n=e?.injector??x(Dr);if(!WL(n))return _2;v_("NgAfterNextRender");let r=n.get(I_),i=r.handler??=new Ay,s=e?.phase??Eo.MixedReadWrite,o=()=>{i.unregister(u),a()},a=n.get(i_).onDestroy(o),u=Er(n,()=>new Sy(s,()=>{o(),t()}));return i.register(u),{destroy:o}}var Sy=class{constructor(e,n){this.phase=e,this.callbackFn=n,this.zone=x(he),this.errorHandler=x(Kn,{optional:!0}),x(gh,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},Ay=class{constructor(){this.executingCallbacks=!1,this.buckets={[Eo.EarlyRead]:new Set,[Eo.Write]:new Set,[Eo.MixedReadWrite]:new Set,[Eo.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},I_=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=F({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function xy(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=cb(i,a);else if(s==2){let u=a,c=e[++o];r=cb(r,u+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var yh=class extends Fh{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=Zr(e);return new Ro(n,this.ngModule)}};function Lb(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function v2(t){let e=t.toLowerCase();return e==="svg"?$V:e==="math"?HV:null}var My=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Ch(r);let i=this.injector.get(e,Ym,r);return i!==Ym||n===Ym?i:this.parentInjector.get(e,n,r)}},Ro=class extends mh{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=Lb(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return Lb(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=wV(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=me(null);try{i=i||this.ngModule;let o=i instanceof zt?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new My(e,o):e,u=a.get(Tu,null);if(u===null)throw new U(407,!1);let c=a.get(h2,null),l=a.get(I_,null),d=a.get(gh,null),h={rendererFactory:u,sanitizer:c,inlineEffectRunner:null,afterRenderEventManager:l,changeDetectionScheduler:d},f=u.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",g=r?vj(f,r,this.componentDef.encapsulation,a):lS(f,p,v2(p)),v=512;this.componentDef.signals?v|=4096:this.componentDef.onPush||(v|=16);let C=null;g!==null&&(C=u_(g,a,!0));let N=p_(0,null,null,1,0,null,null,null,null,null,null),T=Ph(null,N,null,v,null,null,h,f,a,null,C);Yy(T);let j,H;try{let W=this.componentDef,Ee,jt=null;W.findHostDirectiveDefs?(Ee=[],jt=new Map,W.findHostDirectiveDefs(W,Ee,jt),Ee.push(W)):Ee=[W];let dm=w2(T,g),ld=E2(dm,g,W,Ee,T,h,f);H=A0(N,Jr),g&&D2(f,W,g,r),n!==void 0&&T2(H,this.ngContentSelectors,n),j=C2(ld,W,Ee,jt,T,[b2]),m_(N,T,null)}finally{Zy()}return new Ry(this.componentType,j,Mh(H,T),T,H)}finally{me(s)}}},Ry=class extends Dy{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new ss(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;g_(s[ae],s,i,e,n),this.previousInputValues.set(e,n);let o=ni(this._tNode.index,s);y_(o)}}get injector(){return new Xi(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function w2(t,e){let n=t[ae],r=Jr;return t[r]=e,kh(n,r,2,"#host",null)}function E2(t,e,n,r,i,s,o){let a=i[ae];I2(r,t,e,o);let u=null;e!==null&&(u=u_(e,i[Ao]));let c=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=Ph(i,bS(n),null,l,i[t.index],t,s,c,null,null,u);return a.firstCreatePass&&Ey(a,t,r.length-1),Oh(i,d),i[t.index]=d}function I2(t,e,n,r){for(let i of t)e.mergedAttrs=vu(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(xy(e,e.mergedAttrs,!0),n!==null&&yS(r,n,e))}function C2(t,e,n,r,i,s){let o=$t(),a=i[ae],u=dn(o,i);xS(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=Mo(i,a,d,o);is(h,i)}MS(a,i,o),u&&is(u,i);let c=Mo(i,a,o.directiveStart+o.componentOffset,o);if(t[bn]=i[bn]=c,s!==null)for(let l of s)l(c,e);return CS(a,o,i),c}function D2(t,e,n,r){if(r)oy(t,n,["ng-version","17.3.5"]);else{let{attrs:i,classes:s}=EV(e.selectors[0]);i&&oy(t,n,i),s&&s.length>0&&mS(t,n,s.join(" "))}}function T2(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function b2(){let t=$t();t_(xe()[ae],t)}var Pu=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=S2;let t=e;return t})();function S2(){let t=$t();return x2(t,xe())}var A2=Pu,US=class extends A2{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Mh(this._hostTNode,this._hostLView)}get injector(){return new Xi(this._hostTNode,this._hostLView)}get parentInjector(){let e=n_(this._hostTNode,this._hostLView);if($0(e)){let n=lh(e,this._hostLView),r=ch(e),i=n[ae].data[r+8];return new Xi(i,n)}else return new Xi(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=jb(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-ln}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Pb(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,Nb(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!VV(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let u=o?e:new Ro(Zr(e)),c=r||this.parentInjector;if(!s&&u.ngModule==null){let g=(o?c:this.parentInjector).get(zt,null);g&&(s=g)}let l=Zr(u.componentType??{}),d=Pb(this._lContainer,l?.id??null),h=d?.firstChild??null,f=u.create(c,i,h,s);return this.insertImpl(f.hostView,a,Nb(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(zV(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[vt],c=new US(u,u[An],u[vt]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return Wj(o,i,s,r),e.attachToViewContainerRef(),n0(Zm(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=jb(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=vy(this._lContainer,n);r&&(rh(Zm(this._lContainer),n),fS(r[ae],r))}detach(e){let n=this._adjustIndex(e,-1),r=vy(this._lContainer,n);return r&&rh(Zm(this._lContainer),n)!=null?new ss(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function jb(t){return t[oh]}function Zm(t){return t[oh]||(t[oh]=[])}function x2(t,e){let n,r=e[t.index];return Cr(r)?n=r:(n=RS(r,e,null,t),e[t.index]=n,Oh(e,n)),R2(n,e,t,r),new US(n,t,e)}function M2(t,e){let n=t[tt],r=n.createComment(""),i=dn(e,t),s=d_(n,i);return fh(n,s,r,aj(n,i),!1),r}var R2=k2,N2=()=>!1;function P2(t,e,n){return N2(t,e,n)}function k2(t,e,n,r){if(t[ts])return;let i;n.type&8?i=Wn(r):i=M2(e,n),t[ts]=i}function O2(t){return typeof t=="function"&&t[vm]!==void 0}function BS(t){return O2(t)&&typeof t.set=="function"}function F2(t){return Object.getPrototypeOf(t.prototype).constructor}function Tr(t){let e=F2(t.type),n=!0,r=[t];for(;e;){let i;if(Xr(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new U(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Kd(t.inputs),o.inputTransforms=Kd(t.inputTransforms),o.declaredInputs=Kd(t.declaredInputs),o.outputs=Kd(t.outputs);let a=i.hostBindings;a&&B2(t,a);let u=i.viewQuery,c=i.contentQueries;if(u&&j2(t,u),c&&U2(t,c),V2(t,i),$1(t.outputs,i.outputs),Xr(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===Tr&&(n=!1)}}e=Object.getPrototypeOf(e)}L2(r)}function V2(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function L2(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=vu(i.hostAttrs,n=vu(n,i.hostAttrs))}}function Kd(t){return t===To?{}:t===cn?[]:t}function j2(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function U2(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function B2(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function C_(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var ei=class{},bu=class{};var Ny=class extends ei{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new yh(this);let i=h0(e);this._bootstrapComponents=cS(i.bootstrap),this._r3Injector=Z0(e,n,[{provide:ei,useValue:this},{provide:Fh,useValue:this.componentFactoryResolver},...r],Rt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Py=class extends bu{constructor(e){super(),this.moduleType=e}create(e){return new Ny(this.moduleType,e,[])}};var _h=class extends ei{constructor(e){super(),this.componentFactoryResolver=new yh(this),this.instance=null;let n=new wu([...e.providers,{provide:ei,useValue:this},{provide:Fh,useValue:this.componentFactoryResolver}],e.parent||Gy(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Vh(t,e,n=null){return new _h({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var Lh=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new ht(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ku(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function $2(t){return(t.flags&32)===32}function H2(t,e,n,r,i,s,o,a,u){let c=e.consts,l=kh(e,t,4,o||null,uh(c,a));AS(e,n,l,uh(c,u)),t_(e,l);let d=l.tView=p_(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function q2(t,e,n,r,i,s,o,a){let u=xe(),c=Wt(),l=t+Jr,d=c.firstCreatePass?H2(l,c,u,e,n,r,i,s,o):c.data[l];Ru(d,!1);let h=G2(c,u,d,t);Xy()&&h_(c,u,h,d),is(h,u);let f=RS(h,u,h,d);return u[l]=f,Oh(u,f),P2(f,d,u),Wy(d)&&DS(c,u,d),o!=null&&TS(u,d,a),q2}var G2=z2;function z2(t,e,n,r){return e_(!0),e[tt].createComment("")}function Ou(t,e,n,r){let i=xe(),s=xh();if(ku(i,s,e)){let o=Wt(),a=Jy();Fj(a,i,t,e,n,r)}return Ou}function W2(t,e,n,r){return ku(t,xh(),n)?e+Ih(n)+r:Fo}function Qd(t,e){return t<<17|e<<2}function os(t){return t>>17&32767}function K2(t){return(t&2)==2}function Q2(t,e){return t&131071|e<<17}function ky(t){return t|2}function No(t){return(t&131068)>>2}function Jm(t,e){return t&-131069|e<<2}function Y2(t){return(t&1)===1}function Oy(t){return t|1}function Z2(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=os(o),u=No(o);t[r]=n;let c=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||Mu(d,l)>0)&&(c=!0)}else l=n;if(i)if(u!==0){let h=os(t[a+1]);t[r+1]=Qd(h,a),h!==0&&(t[h+1]=Jm(t[h+1],r)),t[a+1]=Q2(t[a+1],r)}else t[r+1]=Qd(a,0),a!==0&&(t[a+1]=Jm(t[a+1],r)),a=r;else t[r+1]=Qd(u,0),a===0?a=r:t[u+1]=Jm(t[u+1],r),u=r;c&&(t[r+1]=ky(t[r+1])),Ub(t,l,r,!0),Ub(t,l,r,!1),J2(e,l,t,r,s),o=Qd(a,u),s?e.classBindings=o:e.styleBindings=o}function J2(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&Mu(s,e)>=0&&(n[r+1]=Oy(n[r+1]))}function Ub(t,e,n,r){let i=t[n+1],s=e===null,o=r?os(i):No(i),a=!1;for(;o!==0&&(a===!1||s);){let u=t[o],c=t[o+1];X2(u,e)&&(a=!0,t[o+1]=r?Oy(c):ky(c)),o=r?os(c):No(c)}a&&(t[n+1]=r?ky(i):Oy(i))}function X2(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?Mu(t,e)>=0:!1}function eU(t,e,n){let r=xe(),i=xh();if(ku(r,i,e)){let s=Wt(),o=Jy();SS(s,o,r,t,e,r[tt],n,!1)}return eU}function Bb(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";g_(t,n,s[o],o,r)}function jh(t,e){return tU(t,e,null,!0),jh}function tU(t,e,n,r){let i=xe(),s=Wt(),o=sL(2);if(s.firstUpdatePass&&rU(s,t,o,r),e!==Fo&&ku(i,o,e)){let a=s.data[ko()];uU(s,a,i,i[tt],t,i[o+1]=cU(e,n),r,o)}}function nU(t,e){return e>=t.expandoStartIndex}function rU(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[ko()],o=nU(t,n);lU(s,r)&&e===null&&!o&&(e=!1),e=iU(i,s,e,r),Z2(i,s,e,n,o,r)}}function iU(t,e,n,r){let i=cL(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=Xm(null,t,e,n,r),n=Su(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=Xm(i,t,e,n,r),s===null){let u=sU(t,e,r);u!==void 0&&Array.isArray(u)&&(u=Xm(null,t,e,u[1],r),u=Su(u,e.attrs,r),oU(t,e,r,u))}else s=aU(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function sU(t,e,n){let r=n?e.classBindings:e.styleBindings;if(No(r)!==0)return t[os(r)]}function oU(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[os(i)]=r}function aU(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=Su(r,o,n)}return Su(r,e.attrs,n)}function Xm(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=Su(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Su(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),uV(t,o,n?!0:e[++s]))}return t===void 0?null:t}function uU(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let u=t.data,c=u[a+1],l=Y2(c)?$b(u,e,n,i,No(c),o):void 0;if(!vh(l)){vh(s)||K2(c)&&(s=$b(u,null,n,i,a,o));let d=S0(ko(),n);pj(r,o,d,i,s)}}function $b(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let u=t[i],c=Array.isArray(u),l=c?u[1]:u,d=l===null,h=n[i+1];h===Fo&&(h=d?cn:void 0);let f=d?$m(h,r):l===r?h:void 0;if(c&&!vh(f)&&(f=$m(u,r)),vh(f)&&(a=f,o))return a;let p=t[i+1];i=o?os(p):No(p)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(a=$m(u,r))}return a}function vh(t){return t!==void 0}function cU(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Rt(Nu(t)))),t}function lU(t,e){return(t.flags&(e?8:16))!==0}function dU(t,e,n,r,i,s){let o=e.consts,a=uh(o,i),u=kh(e,t,2,r,a);return AS(e,n,u,uh(o,s)),u.attrs!==null&&xy(u,u.attrs,!1),u.mergedAttrs!==null&&xy(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function $S(t,e,n,r){let i=xe(),s=Wt(),o=Jr+t,a=i[tt],u=s.firstCreatePass?dU(o,s,i,e,n,r):s.data[o],c=hU(s,i,u,a,e,t);i[o]=c;let l=Wy(u);return Ru(u,!0),yS(a,c,u),!$2(u)&&Xy()&&h_(s,i,c,u),YV()===0&&is(c,i),ZV(),l&&(DS(s,i,u),CS(s,u,i)),r!==null&&TS(i,u),$S}function HS(){let t=$t();P0()?rL():(t=t.parent,Ru(t,!1));let e=t;eL(e)&&tL(),JV();let n=Wt();return n.firstCreatePass&&(t_(n,t),I0(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&mL(e)&&Bb(n,e,xe(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&yL(e)&&Bb(n,e,xe(),e.stylesWithoutHost,!1),HS}function D_(t,e,n,r){return $S(t,e,n,r),HS(),D_}var hU=(t,e,n,r,i,s)=>(e_(!0),lS(r,i,hL()));function dZ(){return xe()}var wh="en-US";var fU=wh;function pU(t){typeof t=="string"&&(fU=t.toLowerCase().replace(/_/g,"-"))}function Vo(t,e,n,r){let i=xe(),s=Wt(),o=$t();return qS(s,i,i[tt],o,t,e,r),Vo}function gU(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Eu],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function qS(t,e,n,r,i,s,o){let a=Wy(r),c=t.firstCreatePass&&Bj(t),l=e[bn],d=Uj(e),h=!0;if(r.type&3||o){let g=dn(r,e),v=o?o(g):g,C=d.length,N=o?j=>o(Wn(j[r.index])):r.index,T=null;if(!o&&a&&(T=gU(t,e,i,r.index)),T!==null){let j=T.__ngLastListenerFn__||T;j.__ngNextListenerFn__=s,T.__ngLastListenerFn__=s,h=!1}else{s=qb(r,e,l,s,!1);let j=n.listen(v,i,s);d.push(s,j),c&&c.push(i,N,C,C+1)}}else s=qb(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let v=0;v<g;v+=2){let C=p[v],N=p[v+1],H=e[C][N].subscribe(s),W=d.length;d.push(s,H),c&&c.push(i,r.index,W,-(W+1))}}}function Hb(t,e,n,r){let i=me(null);try{return Hn(6,e,n),n(r)!==!1}catch(s){return PS(t,s),!1}finally{Hn(7,e,n),me(i)}}function qb(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?ni(t.index,e):e;y_(a);let u=Hb(e,n,r,o),c=s.__ngNextListenerFn__;for(;c;)u=Hb(e,n,c,o)&&u,c=c.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}function hZ(t=1){return dL(t)}function fZ(t,e=""){let n=xe(),r=Wt(),i=t+Jr,s=r.firstCreatePass?kh(r,i,1,e,null):r.data[i],o=mU(r,n,s,e,t);n[i]=o,Xy()&&h_(r,n,o,s),Ru(s,!1)}var mU=(t,e,n,r,i)=>(e_(!0),QL(e[tt],r));function yU(t){return GS("",t,""),yU}function GS(t,e,n){let r=xe(),i=W2(r,t,e,n);return i!==Fo&&$j(r,ko(),i),GS}function _U(t,e,n){BS(e)&&(e=e());let r=xe(),i=xh();if(ku(r,i,e)){let s=Wt(),o=Jy();SS(s,o,r,t,e,r[tt],n,!1)}return _U}function pZ(t,e){let n=BS(t);return n&&t.set(e),n}function vU(t,e){let n=xe(),r=Wt(),i=$t();return qS(r,n,n[tt],i,t,e),vU}function wU(t,e,n){let r=Wt();if(r.firstCreatePass){let i=Xr(t);Fy(n,r.data,r.blueprint,i,!0),Fy(e,r.data,r.blueprint,i,!1)}}function Fy(t,e,n,r,i){if(t=Mt(t),Array.isArray(t))for(let s=0;s<t.length;s++)Fy(t[s],e,n,r,i);else{let s=Wt(),o=xe(),a=$t(),u=So(t)?t:Mt(t.provide),c=_0(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(So(t)||!t.multi){let f=new rs(c,i,_e),p=ty(u,e,i?l:l+h,d);p===-1?(py(dh(a,o),s,u),ey(s,t,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=ty(u,e,l+h,d),p=ty(u,e,l,l+h),g=f>=0&&n[f],v=p>=0&&n[p];if(i&&!v||!i&&!g){py(dh(a,o),s,u);let C=CU(i?IU:EU,n.length,i,r,c);!i&&v&&(n[p].providerFactory=C),ey(s,t,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(C),o.push(C)}else{let C=zS(n[i?p:f],c,!i&&r);ey(s,t,f>-1?f:p,C)}!i&&r&&v&&n[p].componentProviders++}}}function ey(t,e,n,r){let i=So(e),s=xV(e);if(i||s){let u=(s?Mt(e.useClass):e).prototype.ngOnDestroy;if(u){let c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=c.indexOf(n);l===-1?c.push(n,[r,u]):c[l+1].push(r,u)}else c.push(n,u)}}}function zS(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function ty(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function EU(t,e,n,r){return Vy(this.multi,[])}function IU(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Mo(n,n[ae],this.providerFactory.index,r);s=a.slice(0,o),Vy(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],Vy(i,s);return s}function Vy(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function CU(t,e,n,r,i){let s=new rs(t,n,_e);return s.multi=[],s.index=e,s.componentProviders=0,zS(s,i,r&&!n),s}function Fu(t,e=[]){return n=>{n.providersResolver=(r,i)=>wU(r,i?i(t):t,e)}}var DU=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=g0(!1,r.type),s=i.length>0?Vh([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=F({token:e,providedIn:"environment",factory:()=>new e(I(zt))});let t=e;return t})();function WS(t){v_("NgStandalone"),t.getStandaloneInjector=e=>e.get(DU).getOrCreateStandaloneInjector(t)}var wr=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},KS=new wr("17.3.5"),Uh=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var QS=new P("");function cs(t){return!!t&&typeof t.then=="function"}function YS(t){return!!t&&typeof t.subscribe=="function"}var Bh=new P(""),ZS=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=x(Bh,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(cs(o))r.push(o);else if(YS(o)){let a=new Promise((u,c)=>{o.subscribe({complete:u,error:c})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),$h=new P("");function TU(){$T(()=>{throw new U(600,!1)})}function bU(t){return t.isBoundToModule}function SU(t,e,n){try{let r=n();return cs(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}var Vu=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=x(J0),this.afterRenderEffectManager=x(I_),this.externalTestViews=new Set,this.beforeRender=new Fe,this.afterTick=new Fe,this.componentTypes=[],this.components=[],this.isStable=x(Lh).hasPendingTasks.pipe(k(r=>!r)),this._injector=x(zt)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof mh;if(!this._injector.get(ZS).done){let f=!s&&d0(r),p=!1;throw new U(405,p)}let a;s?a=r:a=this._injector.get(Fh).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let u=bU(a)?void 0:this._injector.get(ei),c=i||a.selector,l=a.create(Dr.NULL,[],c,u),d=l.location.nativeElement,h=l.injector.get(QS,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),ny(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new U(101,!1);let i=me(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,me(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===OS)throw new U(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:u}of this._views)AU(a,o,u)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Ly(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Ly(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;ny(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get($h,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>ny(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new U(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ny(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function AU(t,e,n){!e&&!Ly(t)||xU(t,n,e)}function Ly(t){return Qy(t)}function xU(t,e,n){let r;n?(r=0,t[$]|=1024):t[$]&64?r=0:r=1,FS(t,e,r)}var jy=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Hh=(()=>{let e=class e{compileModuleSync(r){return new Py(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=h0(r),o=cS(s.declarations).reduce((a,u)=>{let c=Zr(u);return c&&a.push(new Ro(c)),a},[]);return new jy(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var MU=(()=>{let e=class e{constructor(){this.zone=x(he),this.applicationRef=x(Vu)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function RU(t){return[{provide:he,useFactory:t},{provide:bo,multi:!0,useFactory:()=>{let e=x(MU,{optional:!0});return()=>e.initialize()}},{provide:bo,multi:!0,useFactory:()=>{let e=x(OU);return()=>{e.initialize()}}},{provide:J0,useFactory:NU}]}function NU(){let t=x(he),e=x(Kn);return n=>t.runOutsideAngular(()=>e.handleError(n))}function PU(t){let e=RU(()=>new he(kU(t)));return Dh([[],e])}function kU(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var OU=(()=>{let e=class e{constructor(){this.subscription=new Ue,this.initialized=!1,this.zone=x(he),this.pendingTasks=x(Lh)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{he.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{he.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function FU(){return typeof $localize<"u"&&$localize.locale||wh}var T_=new P("",{providedIn:"root",factory:()=>x(T_,ne.Optional|ne.SkipSelf)||FU()});var JS=new P("");var eh=null;function VU(t=[],e){return Dr.create({name:e,providers:[{provide:Th,useValue:"platform"},{provide:JS,useValue:new Set([()=>eh=null])},...t]})}function LU(t=[]){if(eh)return eh;let e=VU(t);return eh=e,TU(),jU(e),e}function jU(t){t.get(o_,null)?.forEach(n=>n())}function b_(){return!1}var ls=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=UU;let t=e;return t})();function UU(t){return BU($t(),xe(),(t&16)===16)}function BU(t,e,n){if(Ah(t)&&!n){let r=ni(t.index,e);return new ss(r,r)}else if(t.type&47){let r=e[zn];return new ss(r,e)}return null}function XS(t){try{let{rootComponent:e,appProviders:n,platformProviders:r}=t,i=LU(r),s=[PU(),...n||[]],a=new _h({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,u=a.get(he);return u.run(()=>{a.resolveInjectorInitializers();let c=a.get(Kn,null),l;u.runOutsideAngular(()=>{l=u.onError.subscribe({next:f=>{c.handleError(f)}})});let d=()=>a.destroy(),h=i.get(JS);return h.add(d),a.onDestroy(()=>{l.unsubscribe(),h.delete(d)}),SU(c,u,()=>{let f=a.get(ZS);return f.runInitializers(),f.donePromise.then(()=>{let p=a.get(T_,wh);pU(p||wh);let g=a.get(Vu);return e!==void 0&&g.bootstrap(e),g})})})}catch(e){return Promise.reject(e)}}function ii(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function eA(t){let e=Zr(t);if(!e)return null;let n=new Ro(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var iA=null;function Sr(){return iA}function sA(t){iA??=t}var qh=class{};var Ht=new P(""),M_=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>x($U),providedIn:"platform"});let t=e;return t})(),oA=new P(""),$U=(()=>{let e=class e extends M_{constructor(){super(),this._doc=x(Ht),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Sr().getBaseHref(this._doc)}onPopState(r){let i=Sr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=Sr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function R_(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function tA(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function br(t){return t&&t[0]!=="?"?"?"+t:t}var Ar=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>x(N_),providedIn:"root"});let t=e;return t})(),aA=new P(""),N_=(()=>{let e=class e extends Ar{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??x(Ht).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return R_(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+br(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+br(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+br(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(I(M_),I(aA,8))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),uA=(()=>{let e=class e extends Ar{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=R_(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+br(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+br(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(I(M_),I(aA,8))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),Lo=(()=>{let e=class e{constructor(r){this._subject=new yt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=GU(tA(nA(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+br(i))}normalize(r){return e.stripTrailingSlash(qU(this._basePath,nA(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+br(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+br(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=br,e.joinWithSlash=R_,e.stripTrailingSlash=tA,e.\u0275fac=function(i){return new(i||e)(I(Ar))},e.\u0275prov=F({token:e,factory:()=>HU(),providedIn:"root"});let t=e;return t})();function HU(){return new Lo(I(Ar))}function qU(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function nA(t){return t.replace(/\/index.html$/,"")}function GU(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function cA(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var BZ=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new S_,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){rA("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){rA("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(_e(Pu),_e(__))},e.\u0275dir=It({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),S_=class{constructor(){this.$implicit=null,this.ngIf=null}};function rA(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${Rt(e)}'.`)}var zU=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Et({type:e}),e.\u0275inj=wt({});let t=e;return t})(),P_="browser",WU="server";function KU(t){return t===P_}function ds(t){return t===WU}var lA=(()=>{let e=class e{};e.\u0275prov=F({token:e,providedIn:"root",factory:()=>KU(x(Ct))?new A_(x(Ht),window):new x_});let t=e;return t})(),A_=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=QU(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function QU(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var x_=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Gh=class{};var F_=class extends qh{constructor(){super(...arguments),this.supportsDOMEvents=!0}},V_=class t extends F_{static makeCurrent(){sA(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=ZU();return n==null?null:JU(n)}resetBaseElement(){Lu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return cA(document.cookie,e)}},Lu=null;function ZU(){return Lu=Lu||document.querySelector("base"),Lu?Lu.getAttribute("href"):null}function JU(t){return new URL(t,document.baseURI).pathname}var XU=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),L_=new P(""),pA=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new U(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(I(L_),I(he))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),zh=class{constructor(e){this._doc=e}},k_="ng-app-id",gA=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=ds(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${k_}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(k_),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(k_,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(I(Ht),I(s_),I(a_,8),I(Ct))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),O_={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},U_=/%COMP%/g,mA="%COMP%",eB=`_nghost-${mA}`,tB=`_ngcontent-${mA}`,nB=!0,rB=new P("",{providedIn:"root",factory:()=>nB});function iB(t){return tB.replace(U_,t)}function sB(t){return eB.replace(U_,t)}function yA(t,e){return e.map(n=>n.replace(U_,t))}var dA=(()=>{let e=class e{constructor(r,i,s,o,a,u,c,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=ds(u),this.defaultRenderer=new ju(r,a,c,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Gn.ShadowDom&&(i=ge(M({},i),{encapsulation:Gn.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Wh?s.applyToHost(r):s instanceof Uu&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,u=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case Gn.Emulated:o=new Wh(c,l,i,this.appId,d,a,u,h);break;case Gn.ShadowDom:return new j_(c,l,r,i,a,u,this.nonce,h);default:o=new Uu(c,l,i,d,a,u,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(I(pA),I(gA),I(s_),I(rB),I(Ht),I(Ct),I(he),I(a_))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),ju=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(O_[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(hA(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(hA(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new U(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=O_[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=O_[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(vr.DashCase|vr.Important)?e.style.setProperty(n,r,i&vr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&vr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=Sr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function hA(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var j_=class extends ju{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=yA(i.id,i.styles);for(let l of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Uu=class extends ju{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?yA(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Wh=class extends Uu{constructor(e,n,r,i,s,o,a,u){let c=i+"-"+r.id;super(e,n,r,s,o,a,u,c),this.contentAttr=iB(c),this.hostAttr=sB(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},oB=(()=>{let e=class e extends zh{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(I(Ht))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),fA=["alt","control","meta","shift"],aB={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},uB={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},cB=(()=>{let e=class e extends zh{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Sr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),a="code."),fA.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=s,c.fullKey=a,c}static matchEventFullKeyCode(r,i){let s=aB[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),fA.forEach(a=>{if(a!==s){let u=uB[a];u(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(I(Ht))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})();function hJ(t,e){return XS(M({rootComponent:t},lB(e)))}function lB(t){return{appProviders:[...gB,...t?.providers??[]],platformProviders:pB}}function dB(){V_.makeCurrent()}function hB(){return new Kn}function fB(){return iS(document),document}var pB=[{provide:Ct,useValue:P_},{provide:o_,useValue:dB,multi:!0},{provide:Ht,useFactory:fB,deps:[]}];var gB=[{provide:Th,useValue:"root"},{provide:Kn,useFactory:hB,deps:[]},{provide:L_,useClass:oB,multi:!0,deps:[Ht,he,Ct]},{provide:L_,useClass:cB,multi:!0,deps:[Ht]},dA,gA,pA,{provide:Tu,useExisting:dA},{provide:Gh,useClass:XU,deps:[]},[]];var _A=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(I(Ht))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var SA=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(_e(us),_e(ri))},e.\u0275dir=It({type:e});let t=e;return t})(),yB=(()=>{let e=class e extends SA{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Oo(e)))(s||e)}})(),e.\u0275dir=It({type:e,features:[Tr]});let t=e;return t})(),AA=new P("");var _B={provide:AA,useExisting:as(()=>xA),multi:!0};function vB(){let t=Sr()?Sr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var wB=new P(""),xA=(()=>{let e=class e extends SA{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!vB())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(_e(us),_e(ri),_e(wB,8))},e.\u0275dir=It({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&Vo("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[Fu([_B]),Tr]});let t=e;return t})();function EB(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}var $_=new P(""),MA=new P("");function IB(t){return EB(t.value)?{required:!0}:null}function vA(t){return null}function RA(t){return t!=null}function NA(t){return cs(t)?de(t):t}function PA(t){let e={};return t.forEach(n=>{e=n!=null?M(M({},e),n):e}),Object.keys(e).length===0?null:e}function kA(t,e){return e.map(n=>n(t))}function CB(t){return!t.validate}function OA(t){return t.map(e=>CB(e)?e:n=>e.validate(n))}function DB(t){if(!t)return null;let e=t.filter(RA);return e.length==0?null:function(n){return PA(kA(n,e))}}function H_(t){return t!=null?DB(OA(t)):null}function TB(t){if(!t)return null;let e=t.filter(RA);return e.length==0?null:function(n){let r=kA(n,e).map(NA);return Om(r).pipe(k(PA))}}function q_(t){return t!=null?TB(OA(t)):null}function wA(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function bB(t){return t._rawValidators}function SB(t){return t._rawAsyncValidators}function B_(t){return t?Array.isArray(t)?t:[t]:[]}function Qh(t,e){return Array.isArray(t)?t.includes(e):t===e}function EA(t,e){let n=B_(e);return B_(t).forEach(i=>{Qh(n,i)||n.push(i)}),n}function IA(t,e){return B_(e).filter(n=>!Qh(t,n))}var Yh=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=H_(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=q_(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Uo=class extends Yh{get formDirective(){return null}get path(){return null}},qu=class extends Yh{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Zh=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},AB={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},xJ=ge(M({},AB),{"[class.ng-submitted]":"isSubmitted"}),MJ=(()=>{let e=class e extends Zh{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(_e(qu,2))},e.\u0275dir=It({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&jh("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Tr]});let t=e;return t})(),RJ=(()=>{let e=class e extends Zh{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(_e(Uo,10))},e.\u0275dir=It({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&jh("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Tr]});let t=e;return t})();var Bu="VALID",Kh="INVALID",jo="PENDING",$u="DISABLED";function FA(t){return(ef(t)?t.validators:t)||null}function xB(t){return Array.isArray(t)?H_(t):t||null}function VA(t,e){return(ef(e)?e.asyncValidators:t)||null}function MB(t){return Array.isArray(t)?q_(t):t||null}function ef(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function RB(t,e,n){let r=t.controls;if(!(e?Object.keys(r):r).length)throw new U(1e3,"");if(!r[n])throw new U(1001,"")}function NB(t,e,n){t._forEachChild((r,i)=>{if(n[i]===void 0)throw new U(1002,"")})}var Jh=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Bu}get invalid(){return this.status===Kh}get pending(){return this.status==jo}get disabled(){return this.status===$u}get enabled(){return this.status!==$u}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(EA(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(EA(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(IA(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(IA(e,this._rawAsyncValidators))}hasValidator(e){return Qh(this._rawValidators,e)}hasAsyncValidator(e){return Qh(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=jo,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=$u,this.errors=null,this._forEachChild(r=>{r.disable(ge(M({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ge(M({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Bu,this._forEachChild(r=>{r.enable(ge(M({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ge(M({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Bu||this.status===jo)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?$u:Bu}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=jo,this._hasOwnPendingAsyncValidator=!0;let n=NA(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new yt,this.statusChanges=new yt}_calculateStatus(){return this._allControlsDisabled()?$u:this.errors?Kh:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(jo)?jo:this._anyControlsHaveStatus(Kh)?Kh:Bu}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){ef(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=xB(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=MB(this._rawAsyncValidators)}},Xh=class extends Jh{constructor(e,n,r){super(FA(n),VA(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){NB(this,!0,e),Object.keys(e).forEach(r=>{RB(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>r._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,s)=>{r=n(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var G_=new P("CallSetDisabledState",{providedIn:"root",factory:()=>z_}),z_="always";function PB(t,e){return[...e.path,t]}function LA(t,e,n=z_){jA(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),OB(t,e),VB(t,e),FB(t,e),kB(t,e)}function CA(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function kB(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function jA(t,e){let n=bB(t);e.validator!==null?t.setValidators(wA(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=SB(t);e.asyncValidator!==null?t.setAsyncValidators(wA(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();CA(e._rawValidators,i),CA(e._rawAsyncValidators,i)}function OB(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&UA(t,e)})}function FB(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&UA(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function UA(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function VB(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function LB(t,e){t==null,jA(t,e)}function jB(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function UB(t){return Object.getPrototypeOf(t.constructor)===yB}function BB(t,e){t._syncPendingControls(),e.forEach(n=>{let r=n.control;r.updateOn==="submit"&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function $B(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===xA?n=s:UB(s)?r=s:i=s}),i||r||n||null}var HB={provide:Uo,useExisting:as(()=>qB)},Hu=Promise.resolve(),qB=(()=>{let e=class e extends Uo{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new yt,this.form=new Xh({},H_(r),q_(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){Hu.then(()=>{let i=this._findContainer(r.path);r.control=i.registerControl(r.name,r.control),LA(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){Hu.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){Hu.then(()=>{let i=this._findContainer(r.path),s=new Xh({});LB(s,r),i.registerControl(r.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){Hu.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,i){Hu.then(()=>{this.form.get(r.path).setValue(i)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submitted=!0,BB(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}};e.\u0275fac=function(i){return new(i||e)(_e($_,10),_e(MA,10),_e(G_,8))},e.\u0275dir=It({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){i&1&&Vo("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{options:[_t.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Fu([HB]),Tr]});let t=e;return t})();function DA(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function TA(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var GB=class extends Jh{constructor(e=null,n,r){super(FA(n),VA(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ef(n)&&(n.nonNullable||n.initialValueIsDefault)&&(TA(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){DA(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){DA(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){TA(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var zB={provide:qu,useExisting:as(()=>WB)},bA=Promise.resolve(),WB=(()=>{let e=class e extends qu{constructor(r,i,s,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this.control=new GB,this._registered=!1,this.name="",this.update=new yt,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=$B(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),jB(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){LA(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){bA.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&ii(i);bA.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?PB(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(_e(Uo,9),_e($_,10),_e(MA,10),_e(AA,10),_e(ls,8),_e(G_,8))},e.\u0275dir=It({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[_t.None,"disabled","isDisabled"],model:[_t.None,"ngModel","model"],options:[_t.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Fu([zB]),Tr,ti]});let t=e;return t})(),PJ=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=It({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})();var KB=(()=>{let e=class e{constructor(){this._validator=vA}ngOnChanges(r){if(this.inputName in r){let i=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):vA,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=It({type:e,features:[ti]});let t=e;return t})();var QB={provide:$_,useExisting:as(()=>YB),multi:!0};var YB=(()=>{let e=class e extends KB{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=ii,this.createValidator=r=>IB}enabled(r){return r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Oo(e)))(s||e)}})(),e.\u0275dir=It({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,s){i&2&&Ou("required",s._enabled?"":null)},inputs:{required:"required"},features:[Fu([QB]),Tr]});let t=e;return t})();var ZB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Et({type:e}),e.\u0275inj=wt({});let t=e;return t})();var kJ=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:G_,useValue:r.callSetDisabledState??z_}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Et({type:e}),e.\u0275inj=wt({imports:[ZB]});let t=e;return t})();var J="primary",oc=Symbol("RouteTitle"),Z_=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function Go(t){return new Z_(t)}function JB(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function XB(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Yn(t[n],e[n]))return!1;return!0}function Yn(t,e){let n=t?J_(t):void 0,r=e?J_(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!QA(t[i],e[i]))return!1;return!0}function J_(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function QA(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function YA(t){return t.length>0?t[t.length-1]:null}function ci(t){return km(t)?t:cs(t)?de(Promise.resolve(t)):V(t)}var e$={exact:JA,subset:XA},ZA={exact:t$,subset:n$,ignored:()=>!0};function BA(t,e,n){return e$[n.paths](t.root,e.root,n.matrixParams)&&ZA[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function t$(t,e){return Yn(t,e)}function JA(t,e,n){if(!fs(t.segments,e.segments)||!rf(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!JA(t.children[r],e.children[r],n))return!1;return!0}function n$(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>QA(t[n],e[n]))}function XA(t,e,n){return ex(t,e,e.segments,n)}function ex(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!fs(i,n)||e.hasChildren()||!rf(i,n,r))}else if(t.segments.length===n.length){if(!fs(t.segments,n)||!rf(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!XA(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!fs(t.segments,i)||!rf(t.segments,i,r)||!t.children[J]?!1:ex(t.children[J],e,s,r)}}function rf(t,e,n){return e.every((r,i)=>ZA[n](t[i].parameters,r.parameters))}var si=class{constructor(e=new ye([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Go(this.queryParams),this._queryParamMap}toString(){return s$.serialize(this)}},ye=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return sf(this)}},hs=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=Go(this.parameters),this._parameterMap}toString(){return nx(this)}};function r$(t,e){return fs(t,e)&&t.every((n,r)=>Yn(n.parameters,e[r].parameters))}function fs(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function i$(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===J&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==J&&(n=n.concat(e(i,r)))}),n}var ac=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>new Zu,providedIn:"root"});let t=e;return t})(),Zu=class{parse(e){let n=new ev(e);return new si(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${Gu(e.root,!0)}`,r=u$(e.queryParams),i=typeof e.fragment=="string"?`#${o$(e.fragment)}`:"";return`${n}${r}${i}`}},s$=new Zu;function sf(t){return t.segments.map(e=>nx(e)).join("/")}function Gu(t,e){if(!t.hasChildren())return sf(t);if(e){let n=t.children[J]?Gu(t.children[J],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==J&&r.push(`${i}:${Gu(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=i$(t,(r,i)=>i===J?[Gu(t.children[J],!1)]:[`${i}:${Gu(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[J]!=null?`${sf(t)}/${n[0]}`:`${sf(t)}/(${n.join("//")})`}}function tx(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function tf(t){return tx(t).replace(/%3B/gi,";")}function o$(t){return encodeURI(t)}function X_(t){return tx(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function of(t){return decodeURIComponent(t)}function $A(t){return of(t.replace(/\+/g,"%20"))}function nx(t){return`${X_(t.path)}${a$(t.parameters)}`}function a$(t){return Object.entries(t).map(([e,n])=>`;${X_(e)}=${X_(n)}`).join("")}function u$(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${tf(n)}=${tf(i)}`).join("&"):`${tf(n)}=${tf(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var c$=/^[^\/()?;#]+/;function W_(t){let e=t.match(c$);return e?e[0]:""}var l$=/^[^\/()?;=#]+/;function d$(t){let e=t.match(l$);return e?e[0]:""}var h$=/^[^=?&#]+/;function f$(t){let e=t.match(h$);return e?e[0]:""}var p$=/^[^&#]+/;function g$(t){let e=t.match(p$);return e?e[0]:""}var ev=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ye([],{}):new ye([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[J]=new ye(e,n)),r}parseSegment(){let e=W_(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new U(4009,!1);return this.capture(e),new hs(of(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=d$(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=W_(this.remaining);i&&(r=i,this.capture(r))}e[of(n)]=of(r)}parseQueryParam(e){let n=f$(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=g$(this.remaining);o&&(r=o,this.capture(r))}let i=$A(n),s=$A(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=W_(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new U(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=J);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[J]:new ye([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new U(4011,!1)}};function rx(t){return t.segments.length>0?new ye([],{[J]:t}):t}function ix(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=ix(i);if(r===J&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new ye(t.segments,e);return m$(n)}function m$(t){if(t.numberOfChildren===1&&t.children[J]){let e=t.children[J];return new ye(t.segments.concat(e.segments),e.children)}return t}function zo(t){return t instanceof si}function y$(t,e,n=null,r=null){let i=sx(t);return ox(i,e,n,r)}function sx(t){let e;function n(s){let o={};for(let u of s.children){let c=n(u);o[u.outlet]=c}let a=new ye(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=rx(r);return e??i}function ox(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return K_(i,i,i,n,r);let s=_$(e);if(s.toRoot())return K_(i,i,new ye([],{}),n,r);let o=v$(s,i,t),a=o.processChildren?Ku(o.segmentGroup,o.index,s.commands):ux(o.segmentGroup,o.index,s.commands);return K_(i,o.segmentGroup,a,n,r)}function af(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Ju(t){return typeof t=="object"&&t!=null&&t.outlets}function K_(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([u,c])=>{s[u]=Array.isArray(c)?c.map(l=>`${l}`):`${c}`});let o;t===e?o=n:o=ax(t,e,n);let a=rx(ix(o));return new si(a,s,i)}function ax(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=ax(s,e,n)}),new ye(t.segments,r)}var uf=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&af(r[0]))throw new U(4003,!1);let i=r.find(Ju);if(i&&i!==YA(r))throw new U(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function _$(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new uf(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,c])=>{a[u]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new uf(n,e,r)}var Ho=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function v$(t,e,n){if(t.isAbsolute)return new Ho(e,!0,0);if(!n)return new Ho(e,!1,NaN);if(n.parent===null)return new Ho(n,!0,0);let r=af(t.commands[0])?0:1,i=n.segments.length-1+r;return w$(n,i,t.numberOfDoubleDots)}function w$(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new U(4005,!1);i=r.segments.length}return new Ho(r,!1,i-s)}function E$(t){return Ju(t[0])?t[0].outlets:{[J]:t}}function ux(t,e,n){if(t??=new ye([],{}),t.segments.length===0&&t.hasChildren())return Ku(t,e,n);let r=I$(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new ye(t.segments.slice(0,r.pathIndex),{});return s.children[J]=new ye(t.segments.slice(r.pathIndex),t.children),Ku(s,0,i)}else return r.match&&i.length===0?new ye(t.segments,{}):r.match&&!t.hasChildren()?tv(t,e,n):r.match?Ku(t,0,i):tv(t,e,n)}function Ku(t,e,n){if(n.length===0)return new ye(t.segments,{});{let r=E$(n),i={};if(Object.keys(r).some(s=>s!==J)&&t.children[J]&&t.numberOfChildren===1&&t.children[J].segments.length===0){let s=Ku(t.children[J],e,n);return new ye(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=ux(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new ye(t.segments,i)}}function I$(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(Ju(a))break;let u=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&u===void 0)break;if(u&&c&&typeof c=="object"&&c.outlets===void 0){if(!qA(u,c,o))return s;r+=2}else{if(!qA(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function tv(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(Ju(s)){let u=C$(s.outlets);return new ye(r,u)}if(i===0&&af(n[0])){let u=t.segments[e];r.push(new hs(u.path,HA(n[0]))),i++;continue}let o=Ju(s)?s.outlets[J]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&af(a)?(r.push(new hs(o,HA(a))),i+=2):(r.push(new hs(o,{})),i++)}return new ye(r,{})}function C$(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=tv(new ye([],{}),0,r))}),e}function HA(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function qA(t,e,n){return t==n.path&&Yn(e,n.parameters)}var Qu="imperative",it=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(it||{}),hn=class{constructor(e,n){this.id=e,this.url=n}},Wo=class extends hn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=it.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Zn=class extends hn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=it.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Qt=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(Qt||{}),cf=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(cf||{}),oi=class extends hn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=it.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ai=class extends hn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=it.NavigationSkipped}},Xu=class extends hn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=it.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},lf=class extends hn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=it.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},nv=class extends hn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=it.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},rv=class extends hn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=it.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},iv=class extends hn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=it.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},sv=class extends hn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=it.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ov=class{constructor(e){this.route=e,this.type=it.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},av=class{constructor(e){this.route=e,this.type=it.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},uv=class{constructor(e){this.snapshot=e,this.type=it.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},cv=class{constructor(e){this.snapshot=e,this.type=it.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},lv=class{constructor(e){this.snapshot=e,this.type=it.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},dv=class{constructor(e){this.snapshot=e,this.type=it.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},df=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=it.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},ec=class{},tc=class{constructor(e){this.url=e}};var hv=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new uc,this.attachRef=null}},uc=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new hv,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),hf=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=fv(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=fv(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=pv(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return pv(e,this._root).map(n=>n.value)}};function fv(t,e){if(t===e.value)return e;for(let n of e.children){let r=fv(t,n);if(r)return r}return null}function pv(t,e){if(t===e.value)return[e];for(let n of e.children){let r=pv(t,n);if(r.length)return r.unshift(e),r}return[]}var Kt=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function $o(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var ff=class extends hf{constructor(e,n){super(e),this.snapshot=n,Dv(this,e)}toString(){return this.snapshot.toString()}};function cx(t){let e=D$(t),n=new ht([new hs("",{})]),r=new ht({}),i=new ht({}),s=new ht({}),o=new ht(""),a=new ui(n,r,s,o,i,J,t,e.root);return a.snapshot=e.root,new ff(new Kt(a,[]),e)}function D$(t){let e={},n={},r={},i="",s=new nc([],e,r,i,n,J,t,null,{});return new pf("",new Kt(s,[]))}var ui=class{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(k(c=>c[oc]))??V(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(k(e=>Go(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(k(e=>Go(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Cv(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:M(M({},e.params),t.params),data:M(M({},e.data),t.data),resolve:M(M(M(M({},t.data),e.data),i?.data),t._resolvedData)}:r={params:M({},t.params),data:M({},t.data),resolve:M(M({},t.data),t._resolvedData??{})},i&&dx(i)&&(r.resolve[oc]=i.title),r}var nc=class{get title(){return this.data?.[oc]}constructor(e,n,r,i,s,o,a,u,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Go(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Go(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},pf=class extends hf{constructor(e,n){super(n),this.url=e,Dv(this,n)}toString(){return lx(this._root)}};function Dv(t,e){e.value._routerState=t,e.children.forEach(n=>Dv(t,n))}function lx(t){let e=t.children.length>0?` { ${t.children.map(lx).join(", ")} } `:"";return`${t.value}${e}`}function Q_(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Yn(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),Yn(e.params,n.params)||t.paramsSubject.next(n.params),XB(e.url,n.url)||t.urlSubject.next(n.url),Yn(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function gv(t,e){let n=Yn(t.params,e.params)&&r$(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||gv(t.parent,e.parent))}function dx(t){return typeof t.title=="string"||t.title===null}var T$=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=J,this.activateEvents=new yt,this.deactivateEvents=new yt,this.attachEvents=new yt,this.detachEvents=new yt,this.parentContexts=x(uc),this.location=x(Pu),this.changeDetector=x(ls),this.environmentInjector=x(zt),this.inputBinder=x(_f,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new U(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new U(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new U(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new U(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new mv(r,u,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=It({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ti]});let t=e;return t})(),mv=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r,this.__ngOutletInjector=!0}get(e,n){return e===ui?this.route:e===uc?this.childContexts:this.parent.get(e,n)}},_f=new P(""),GA=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=hu([i.queryParams,i.params,i.data]).pipe(Ae(([o,a,u],c)=>(u=M(M(M({},o),a),u),c===0?V(u):Promise.resolve(u)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=eA(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:u}of a.inputs)r.activatedComponentRef.setInput(u,o[u])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})();function b$(t,e,n){let r=rc(t,e._root,n?n._root:void 0);return new ff(r,e)}function rc(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=S$(t,e,n);return new Kt(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>rc(t,a)),o}}let r=A$(e.value),i=e.children.map(s=>rc(t,s));return new Kt(r,i)}}function S$(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return rc(t,r,i);return rc(t,r)})}function A$(t){return new ui(new ht(t.url),new ht(t.params),new ht(t.queryParams),new ht(t.fragment),new ht(t.data),t.outlet,t.component,t)}var hx="ngNavigationCancelingError";function fx(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=zo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=px(!1,Qt.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function px(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[hx]=!0,n.cancellationCode=e,n}function x$(t){return gx(t)&&zo(t.url)}function gx(t){return!!t&&t[hx]}var M$=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=u0({type:e,selectors:[["ng-component"]],standalone:!0,features:[WS],decls:1,vars:0,template:function(i,s){i&1&&D_(0,"router-outlet")},dependencies:[T$],encapsulation:2});let t=e;return t})();function R$(t,e){return t.providers&&!t._injector&&(t._injector=Vh(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Tv(t){let e=t.children&&t.children.map(Tv),n=e?ge(M({},t),{children:e}):M({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==J&&(n.component=M$),n}function Jn(t){return t.outlet||J}function N$(t,e){let n=t.filter(r=>Jn(r)===e);return n.push(...t.filter(r=>Jn(r)!==e)),n}function cc(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var P$=(t,e,n,r)=>k(i=>(new yv(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),yv=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Q_(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=$o(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=$o(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=$o(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=$o(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new dv(s.value.snapshot))}),e.children.length&&this.forwardEvent(new cv(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(Q_(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Q_(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=cc(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},gf=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},qo=class{constructor(e,n){this.component=e,this.route=n}};function k$(t,e,n){let r=t._root,i=e?e._root:null;return zu(r,i,n,[r.value])}function O$(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function Qo(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!Kb(t)?t:e.get(t):r}function zu(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=$o(e);return t.children.forEach(o=>{F$(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Yu(a,n.getContext(o),i)),i}function F$(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=V$(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new gf(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?zu(t,e,a?a.children:null,r,i):zu(t,e,n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new qo(a.outlet.component,o))}else o&&Yu(e,a,i),i.canActivateChecks.push(new gf(r)),s.component?zu(t,null,a?a.children:null,r,i):zu(t,null,n,r,i);return i}function V$(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!fs(t.url,e.url);case"pathParamsOrQueryParamsChange":return!fs(t.url,e.url)||!Yn(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!gv(t,e)||!Yn(t.queryParams,e.queryParams);case"paramsChange":default:return!gv(t,e)}}function Yu(t,e,n){let r=$o(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Yu(o,e.children.getContext(s),n):Yu(o,null,n):Yu(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new qo(e.outlet.component,i)):n.canDeactivateChecks.push(new qo(null,i)):n.canDeactivateChecks.push(new qo(null,i))}function lc(t){return typeof t=="function"}function L$(t){return typeof t=="boolean"}function j$(t){return t&&lc(t.canLoad)}function U$(t){return t&&lc(t.canActivate)}function B$(t){return t&&lc(t.canActivateChild)}function $$(t){return t&&lc(t.canDeactivate)}function H$(t){return t&&lc(t.canMatch)}function mx(t){return t instanceof _r||t?.name==="EmptyError"}var nf=Symbol("INITIAL_VALUE");function Ko(){return Ae(t=>hu(t.map(e=>e.pipe(Bn(1),Yi(nf)))).pipe(k(e=>{for(let n of e)if(n!==!0){if(n===nf)return nf;if(n===!1||n instanceof si)return n}return!0}),ft(e=>e!==nf),Bn(1)))}function q$(t,e){return ze(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?V(ge(M({},n),{guardsResult:!0})):G$(o,r,i,t).pipe(ze(a=>a&&L$(a)?z$(r,s,t,e):V(a)),k(a=>ge(M({},n),{guardsResult:a})))})}function G$(t,e,n,r){return de(t).pipe(ze(i=>Z$(i.component,i.route,n,e,r)),an(i=>i!==!0,!0))}function z$(t,e,n,r){return de(e).pipe(Qi(i=>go(K$(i.route.parent,r),W$(i.route,r),Y$(t,i.path,n),Q$(t,i.route,n))),an(i=>i!==!0,!0))}function W$(t,e){return t!==null&&e&&e(new lv(t)),V(!0)}function K$(t,e){return t!==null&&e&&e(new uv(t)),V(!0)}function Q$(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return V(!0);let i=r.map(s=>$d(()=>{let o=cc(e)??n,a=Qo(s,o),u=U$(a)?a.canActivate(e,t):Er(o,()=>a(e,t));return ci(u).pipe(an())}));return V(i).pipe(Ko())}function Y$(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>O$(o)).filter(o=>o!==null).map(o=>$d(()=>{let a=o.guards.map(u=>{let c=cc(o.node)??n,l=Qo(u,c),d=B$(l)?l.canActivateChild(r,t):Er(c,()=>l(r,t));return ci(d).pipe(an())});return V(a).pipe(Ko())}));return V(s).pipe(Ko())}function Z$(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return V(!0);let o=s.map(a=>{let u=cc(e)??i,c=Qo(a,u),l=$$(c)?c.canDeactivate(t,e,n,r):Er(u,()=>c(t,e,n,r));return ci(l).pipe(an())});return V(o).pipe(Ko())}function J$(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return V(!0);let s=i.map(o=>{let a=Qo(o,t),u=j$(a)?a.canLoad(e,n):Er(t,()=>a(e,n));return ci(u)});return V(s).pipe(Ko(),yx(r))}function yx(t){return Am(et(e=>{if(zo(e))throw fx(t,e)}),k(e=>e===!0))}function X$(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return V(!0);let s=i.map(o=>{let a=Qo(o,t),u=H$(a)?a.canMatch(e,n):Er(t,()=>a(e,n));return ci(u)});return V(s).pipe(Ko(),yx(r))}var ic=class{constructor(e){this.segmentGroup=e||null}},mf=class extends Error{constructor(e){super(),this.urlTree=e}};function Bo(t){return po(new ic(t))}function eH(t){return po(new U(4e3,!1))}function tH(t){return po(px(!1,Qt.GuardRejected))}var _v=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return V(r);if(i.numberOfChildren>1||!i.children[J])return eH(e.redirectTo);i=i.children[J]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new mf(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new si(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new ye(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new U(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},vv={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function nH(t,e,n,r,i){let s=bv(t,e,n);return s.matched?(r=R$(e,r),X$(r,e,n,i).pipe(k(o=>o===!0?s:M({},vv)))):V(s)}function bv(t,e,n){if(e.path==="**")return rH(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?M({},vv):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||JB)(n,t,e);if(!i)return M({},vv);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?M(M({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function rH(t){return{matched:!0,parameters:t.length>0?YA(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function zA(t,e,n,r){return n.length>0&&oH(t,n,r)?{segmentGroup:new ye(e,sH(r,new ye(n,t.children))),slicedSegments:[]}:n.length===0&&aH(t,n,r)?{segmentGroup:new ye(t.segments,iH(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new ye(t.segments,t.children),slicedSegments:n}}function iH(t,e,n,r){let i={};for(let s of n)if(vf(t,e,s)&&!r[Jn(s)]){let o=new ye([],{});i[Jn(s)]=o}return M(M({},r),i)}function sH(t,e){let n={};n[J]=e;for(let r of t)if(r.path===""&&Jn(r)!==J){let i=new ye([],{});n[Jn(r)]=i}return n}function oH(t,e,n){return n.some(r=>vf(t,e,r)&&Jn(r)!==J)}function aH(t,e,n){return n.some(r=>vf(t,e,r))}function vf(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function uH(t,e,n,r){return Jn(t)!==r&&(r===J||!vf(e,n,t))?!1:bv(e,t,n).matched}function cH(t,e,n){return e.length===0&&!t.children[n]}var wv=class{};function lH(t,e,n,r,i,s,o="emptyOnly"){return new Ev(t,e,n,r,i,o,s).recognize()}var dH=31,Ev=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new _v(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new U(4002,`'${e.segmentGroup}'`)}recognize(){let e=zA(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(k(n=>{let r=new nc([],Object.freeze({}),Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,{},J,this.rootComponentType,null,{}),i=new Kt(r,n),s=new pf("",i),o=y$(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,J).pipe(Wr(r=>{if(r instanceof mf)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ic?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=Cv(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(k(s=>s instanceof Kt?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return de(i).pipe(Qi(s=>{let o=r.children[s],a=N$(n,s);return this.processSegmentGroup(e,a,o,s)}),$n((s,o)=>(s.push(...o),s)),Kr(null),Vm(),ze(s=>{if(s===null)return Bo(r);let o=_x(s);return hH(o),V(o)}))}processSegment(e,n,r,i,s,o){return de(n).pipe(Qi(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(Wr(u=>{if(u instanceof ic)return V(null);throw u}))),an(a=>!!a),Wr(a=>{if(mx(a))return cH(r,i,s)?V(new wv):Bo(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return uH(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):Bo(i):Bo(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:c,remainingSegments:l}=bv(n,i,s);if(!a)return Bo(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>dH&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,c);return this.applyRedirects.lineralizeSegments(i,d).pipe(ze(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=nH(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Ae(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Ae(({routes:u})=>{let c=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new nc(l,h,Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,pH(r),Jn(r),r.component??r._loadedComponent??null,r,gH(r)),{segmentGroup:p,slicedSegments:g}=zA(n,l,d,u);if(g.length===0&&p.hasChildren())return this.processChildren(c,u,p).pipe(k(C=>C===null?null:new Kt(f,C)));if(u.length===0&&g.length===0)return V(new Kt(f,[]));let v=Jn(r)===s;return this.processSegment(c,u,p,g,v?J:s,!0).pipe(k(C=>new Kt(f,C instanceof Kt?[C]:[])))}))):Bo(n)))}getChildConfig(e,n,r){return n.children?V({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?V({routes:n._loadedRoutes,injector:n._loadedInjector}):J$(e,n,r,this.urlSerializer).pipe(ze(i=>i?this.configLoader.loadChildren(e,n).pipe(et(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):tH(n))):V({routes:[],injector:e})}};function hH(t){t.sort((e,n)=>e.value.outlet===J?-1:n.value.outlet===J?1:e.value.outlet.localeCompare(n.value.outlet))}function fH(t){let e=t.value.routeConfig;return e&&e.path===""}function _x(t){let e=[],n=new Set;for(let r of t){if(!fH(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=_x(r.children);e.push(new Kt(r.value,i))}return e.filter(r=>!n.has(r))}function pH(t){return t.data||{}}function gH(t){return t.resolve||{}}function mH(t,e,n,r,i,s){return ze(o=>lH(t,e,n,r,o.extractedUrl,i,s).pipe(k(({state:a,tree:u})=>ge(M({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function yH(t,e){return ze(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return V(n);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let c of vx(u))o.add(c);let a=0;return de(o).pipe(Qi(u=>s.has(u)?_H(u,r,t,e):(u.data=Cv(u,u.parent,t).resolve,V(void 0))),et(()=>a++),yo(1),ze(u=>a===o.size?V(n):xt))})}function vx(t){let e=t.children.map(n=>vx(n)).flat();return[t,...e]}function _H(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!dx(i)&&(s[oc]=i.title),vH(s,t,e,r).pipe(k(o=>(t._resolvedData=o,t.data=Cv(t,t.parent,n).resolve,null)))}function vH(t,e,n,r){let i=J_(t);if(i.length===0)return V({});let s={};return de(i).pipe(ze(o=>wH(t[o],e,n,r).pipe(an(),et(a=>{s[o]=a}))),yo(1),Fm(s),Wr(o=>mx(o)?xt:po(o)))}function wH(t,e,n,r){let i=cc(e)??r,s=Qo(t,i),o=s.resolve?s.resolve(e,n):Er(i,()=>s(e,n));return ci(o)}function Y_(t){return Ae(e=>{let n=t(e);return n?de(n).pipe(k(()=>e)):V(e)})}var wx=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===J);return i}getResolvedTitleForRoute(r){return r.data[oc]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>x(EH),providedIn:"root"});let t=e;return t})(),EH=(()=>{let e=class e extends wx{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(I(_A))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),dc=new P("",{providedIn:"root",factory:()=>({})}),sc=new P(""),Sv=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=x(Hh)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return V(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=ci(r.loadComponent()).pipe(k(Ex),et(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),pu(()=>{this.componentLoaders.delete(r)})),s=new uo(i,()=>new Fe).pipe(ao());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return V({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=IH(i,this.compiler,r,this.onLoadEndListener).pipe(pu(()=>{this.childrenLoaders.delete(i)})),a=new uo(o,()=>new Fe).pipe(ao());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function IH(t,e,n,r){return ci(t.loadChildren()).pipe(k(Ex),ze(i=>i instanceof bu||Array.isArray(i)?V(i):de(e.compileModuleAsync(i))),k(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(sc,[],{optional:!0,self:!0}).flat()),{routes:o.map(Tv),injector:s}}))}function CH(t){return t&&typeof t=="object"&&"default"in t}function Ex(t){return CH(t)?t.default:t}var Av=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>x(DH),providedIn:"root"});let t=e;return t})(),DH=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Ix=new P(""),Cx=new P("");function TH(t,e,n){let r=t.get(Cx),i=t.get(Ht);return t.get(he).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(c=>{s=c}),a=i.startViewTransition(()=>(s(),bH(t))),{onViewTransitionCreated:u}=r;return u&&Er(t,()=>u({transition:a,from:e,to:n})),o})}function bH(t){return new Promise(e=>{E_(e,{injector:t})})}var xv=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Fe,this.transitionAbortSubject=new Fe,this.configLoader=x(Sv),this.environmentInjector=x(zt),this.urlSerializer=x(ac),this.rootContexts=x(uc),this.location=x(Lo),this.inputBindingEnabled=x(_f,{optional:!0})!==null,this.titleStrategy=x(wx),this.options=x(dc,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=x(Av),this.createViewTransition=x(Ix,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>V(void 0),this.rootComponentType=null;let r=s=>this.events.next(new ov(s)),i=s=>this.events.next(new av(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ge(M(M({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new ht({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Qu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ft(o=>o.id!==0),k(o=>ge(M({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ae(o=>{let a=!1,u=!1;return V(o).pipe(Ae(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Qt.SupersededByNewNavigation),xt;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?ge(M({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new ai(c.id,this.urlSerializer.serialize(c.rawUrl),h,cf.IgnoredSameUrlNavigation)),c.resolve(null),xt}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return V(c).pipe(Ae(h=>{let f=this.transitions?.getValue();return this.events.next(new Wo(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?xt:Promise.resolve(h)}),mH(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),et(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ge(M({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new lf(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:v}=c,C=new Wo(h,this.urlSerializer.serialize(f),p,g);this.events.next(C);let N=cx(this.rootComponentType).snapshot;return this.currentTransition=o=ge(M({},c),{targetSnapshot:N,urlAfterRedirects:f,extras:ge(M({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,V(o)}else{let h="";return this.events.next(new ai(c.id,this.urlSerializer.serialize(c.extractedUrl),h,cf.IgnoredByUrlHandlingStrategy)),c.resolve(null),xt}}),et(c=>{let l=new nv(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),k(c=>(this.currentTransition=o=ge(M({},c),{guards:k$(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),q$(this.environmentInjector,c=>this.events.next(c)),et(c=>{if(o.guardsResult=c.guardsResult,zo(c.guardsResult))throw fx(this.urlSerializer,c.guardsResult);let l=new rv(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),ft(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",Qt.GuardRejected),!1)),Y_(c=>{if(c.guards.canActivateChecks.length)return V(c).pipe(et(l=>{let d=new iv(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Ae(l=>{let d=!1;return V(l).pipe(yH(this.paramsInheritanceStrategy,this.environmentInjector),et({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",Qt.NoDataFromResolver)}}))}),et(l=>{let d=new sv(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),Y_(c=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(et(f=>{d.component=f}),k(()=>{})));for(let f of d.children)h.push(...l(f));return h};return hu(l(c.targetSnapshot.root)).pipe(Kr(null),Bn(1))}),Y_(()=>this.afterPreactivation()),Ae(()=>{let{currentSnapshot:c,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?de(d).pipe(k(()=>o)):V(o)}),k(c=>{let l=b$(r.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=ge(M({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),et(()=>{this.events.next(new ec)}),P$(this.rootContexts,r.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Bn(1),et({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Zn(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),Um(this.transitionAbortSubject.pipe(et(c=>{throw c}))),pu(()=>{!a&&!u&&this.cancelNavigationTransition(o,"",Qt.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Wr(c=>{if(u=!0,gx(c))this.events.next(new oi(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),x$(c)?this.events.next(new tc(c.url)):o.resolve(!1);else{this.events.next(new Xu(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return xt}))}))}cancelNavigationTransition(r,i,s){let o=new oi(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function SH(t){return t!==Qu}var AH=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>x(xH),providedIn:"root"});let t=e;return t})(),Iv=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},xH=(()=>{let e=class e extends Iv{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Oo(e)))(s||e)}})(),e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Dx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>x(MH),providedIn:"root"});let t=e;return t})(),MH=(()=>{let e=class e extends Dx{constructor(){super(...arguments),this.location=x(Lo),this.urlSerializer=x(ac),this.options=x(dc,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=x(Av),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new si,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=cx(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Wo)this.stateMemento=this.createStateMemento();else if(r instanceof ai)this.rawUrlTree=i.initialUrl;else if(r instanceof lf){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof ec?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof oi&&(r.code===Qt.GuardRejected||r.code===Qt.NoDataFromResolver)?this.restoreHistory(i):r instanceof Xu?this.restoreHistory(i,!0):r instanceof Zn&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=M(M({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=M(M({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Oo(e)))(s||e)}})(),e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Wu=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Wu||{});function Tx(t,e){t.events.pipe(ft(n=>n instanceof Zn||n instanceof oi||n instanceof Xu||n instanceof ai),k(n=>n instanceof Zn||n instanceof ai?Wu.COMPLETE:(n instanceof oi?n.code===Qt.Redirect||n.code===Qt.SupersededByNewNavigation:!1)?Wu.REDIRECTING:Wu.FAILED),ft(n=>n!==Wu.REDIRECTING),Bn(1)).subscribe(()=>{e()})}function RH(t){throw t}var NH={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},PH={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},xn=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=x(Uh),this.stateManager=x(Dx),this.options=x(dc,{optional:!0})||{},this.pendingTasks=x(Lh),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=x(xv),this.urlSerializer=x(ac),this.location=x(Lo),this.urlHandlingStrategy=x(Av),this._events=new Fe,this.errorHandler=this.options.errorHandler||RH,this.navigated=!1,this.routeReuseStrategy=x(AH),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=x(sc,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!x(_f,{optional:!0}),this.eventsSubscription=new Ue,this.isNgZoneEnabled=x(he)instanceof he&&he.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof oi&&i.code!==Qt.Redirect&&i.code!==Qt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Zn)this.navigated=!0;else if(i instanceof tc){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),u={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||SH(s.source)};this.scheduleNavigation(a,Qu,null,u,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}OH(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Qu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let c=M({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let u=this.parseUrl(r);this.scheduleNavigation(u,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(Tv),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:a,d=null;switch(u){case"merge":d=M(M({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=sx(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return ox(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=zo(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Qu,null,i)}navigate(r,i={skipLocationChange:!1}){return kH(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=M({},NH):i===!1?s=M({},PH):s=i,zo(r))return BA(this.currentUrlTree,r,s);let o=this.parseUrl(r);return BA(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let u,c,l;a?(u=a.resolve,c=a.reject,l=a.promise):l=new Promise((h,f)=>{u=h,c=f});let d=this.pendingTasks.add();return Tx(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:u,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function kH(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new U(4008,!1)}function OH(t){return!(t instanceof ec)&&!(t instanceof tc)}var nX=(()=>{let e=class e{constructor(r,i,s,o,a,u){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=u,this.href=null,this.commands=null,this.onChanges=new Fe,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let c=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=r.events.subscribe(l=>{l instanceof Zn&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let u=this.urlTree;if(u===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(u,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:aS(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(_e(xn),_e(ui),r_("tabindex"),_e(us),_e(ri),_e(Ar))},e.\u0275dir=It({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Vo("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&Ou("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[_t.HasDecoratorInputTransform,"preserveFragment","preserveFragment",ii],skipLocationChange:[_t.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",ii],replaceUrl:[_t.HasDecoratorInputTransform,"replaceUrl","replaceUrl",ii],routerLink:"routerLink"},standalone:!0,features:[C_,ti]});let t=e;return t})();var yf=class{};var FH=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(ft(r=>r instanceof Zn),Qi(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Vh(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,u=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(u,o.children??o._loadedRoutes))}return de(s).pipe(zr())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=V(null);let o=s.pipe(ze(a=>a===null?V(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return de([o,a]).pipe(zr())}else return o})}};e.\u0275fac=function(i){return new(i||e)(I(xn),I(Hh),I(zt),I(yf),I(Sv))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),bx=new P(""),VH=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Wo?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof Zn?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof ai&&r.code===cf.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof df&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new df(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){vS()},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})();function rX(t,...e){return Dh([{provide:sc,multi:!0,useValue:t},[],{provide:ui,useFactory:Sx,deps:[xn]},{provide:$h,multi:!0,useFactory:Ax},e.map(n=>n.\u0275providers)])}function Sx(t){return t.routerState.root}function hc(t,e){return{\u0275kind:t,\u0275providers:e}}function Ax(){let t=x(Dr);return e=>{let n=t.get(Vu);if(e!==n.components[0])return;let r=t.get(xn),i=t.get(xx);t.get(Mv)===1&&r.initialNavigation(),t.get(Mx,null,ne.Optional)?.setUpPreloading(),t.get(bx,null,ne.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var xx=new P("",{factory:()=>new Fe}),Mv=new P("",{providedIn:"root",factory:()=>1});function LH(){return hc(2,[{provide:Mv,useValue:0},{provide:Bh,multi:!0,deps:[Dr],useFactory:e=>{let n=e.get(oA,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(xn),s=e.get(xx);Tx(i,()=>{r(!0)}),e.get(xv).afterPreactivation=()=>(r(!0),s.closed?V(void 0):s),i.initialNavigation()}))}}])}function jH(){return hc(3,[{provide:Bh,multi:!0,useFactory:()=>{let e=x(xn);return()=>{e.setUpLocationChangeListener()}}},{provide:Mv,useValue:2}])}var Mx=new P("");function UH(t){return hc(0,[{provide:Mx,useExisting:FH},{provide:yf,useExisting:t}])}function BH(){return hc(8,[GA,{provide:_f,useExisting:GA}])}function $H(t){let e=[{provide:Ix,useValue:TH},{provide:Cx,useValue:M({skipNextTransition:!!t?.skipInitialTransition},t)}];return hc(9,e)}var WA=new P("ROUTER_FORROOT_GUARD"),HH=[Lo,{provide:ac,useClass:Zu},xn,uc,{provide:ui,useFactory:Sx,deps:[xn]},Sv,[]],iX=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[HH,[],{provide:sc,multi:!0,useValue:r},{provide:WA,useFactory:WH,deps:[[xn,new xu,new t0]]},{provide:dc,useValue:i||{}},i?.useHash?GH():zH(),qH(),i?.preloadingStrategy?UH(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?KH(i):[],i?.bindToComponentInputs?BH().\u0275providers:[],i?.enableViewTransitions?$H().\u0275providers:[],QH()]}}static forChild(r){return{ngModule:e,providers:[{provide:sc,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(I(WA,8))},e.\u0275mod=Et({type:e}),e.\u0275inj=wt({});let t=e;return t})();function qH(){return{provide:bx,useFactory:()=>{let t=x(lA),e=x(he),n=x(dc),r=x(xv),i=x(ac);return n.scrollOffset&&t.setOffset(n.scrollOffset),new VH(i,r,t,e,n)}}}function GH(){return{provide:Ar,useClass:uA}}function zH(){return{provide:Ar,useClass:N_}}function WH(t){return"guarded"}function KH(t){return[t.initialNavigation==="disabled"?jH().\u0275providers:[],t.initialNavigation==="enabledBlocking"?LH().\u0275providers:[]]}var KA=new P("");function QH(){return[{provide:KA,useFactory:Ax},{provide:$h,multi:!0,useExisting:KA}]}var ZH="firebase",JH="10.11.1";En(ZH,JH,"app");var Mr=new wr("ANGULARFIRE2_VERSION");var XH=(t,e)=>{let n=e?[e]:FT(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},xr=class{constructor(){return XH(eq)}},eq="app-check";function Rv(){}var wf=class{zone;delegate;constructor(e,n=Nm){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Nv=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Rv,{},Rv,Rv)),n.pipe(et({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Yo=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new wf(Zone.current)),this.insideAngular=n.run(()=>new wf(Zone.current,Ki)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(I(he))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function tq(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Be(t){return nq(tq())(t)}function nq(t){return function(n){return n=n.lift(new Nv(t.ngZone)),n.pipe(Cn(t.outsideAngular),on(t.insideAngular))}}var rq="firebase",iq="10.11.1";Xe.registerVersion(rq,iq,"app-compat");var sq=["ngOnDestroy"],Nx=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(sq.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let u=a?.[s];return typeof u=="function"?u.bind(a):u?.then?u.then(c=>n.run(()=>c)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,c)=>o.then(l=>{let d=l?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,d),d})})})});var Ef=class{constructor(e){return e}},li=new P("angularfire2.app.options"),di=new P("angularfire2.app.name");function ps(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=Xe.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Xe.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;oq("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Ef(o)}var oq=(t,...e)=>{b_()&&typeof console<"u"&&console[t](...e)},aq={provide:Ef,useFactory:ps,deps:[li,he,[new xu,di]]},IX=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:li,useValue:n},{provide:di,useValue:r}]}}constructor(n){Xe.registerVersion("angularfire",Mr.full,"core"),Xe.registerVersion("angularfire",Mr.full,"app-compat"),Xe.registerVersion("angular",KS.full,n.toString())}static \u0275fac=function(r){return new(r||t)(I(Ct))};static \u0275mod=Et({type:t});static \u0275inj=wt({providers:[aq]})}return t})();function Zo(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return uq(i,o)||(Rx("error",`${e} was already initialized on the ${n} Firebase App with different settings.${cq?" You may need to reload as Firebase is not HMR aware.":""}`),Rx("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function uq(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var cq=typeof module<"u"&&!!module.hot,Rx=(t,...e)=>{b_()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var lq=new Map,dq={activated:!1,tokenObservers:[]},hq={initialized:!1,enabled:!1};function Mn(t){return lq.get(t)||Object.assign({},dq)}function jx(){return hq}var fq="https://content-firebaseappcheck.googleapis.com/v1";var pq="exchangeDebugToken",Px={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},NX=24*60*60*1e3;var Ov=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return _(this,null,function*(){this.stop();try{this.pending=new rt,this.pending.promise.catch(n=>{}),yield gq(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new rt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function gq(t){return new Promise(e=>{setTimeout(e,t)})}var mq={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},hi=new MT("appCheck","AppCheck",mq);function Ux(t){if(!Mn(t).activated)throw hi.create("use-before-activation",{appName:t.name})}function Bx(r,i){return _(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(t,a)}catch(f){throw hi.create("fetch-network-error",{originalErrorMessage:f?.message})}if(u.status!==200)throw hi.create("fetch-status-error",{httpStatus:u.status});let c;try{c=yield u.json()}catch(f){throw hi.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=c.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw hi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function $x(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${fq}/projects/${n}/apps/${r}:${pq}?key=${i}`,body:{debug_token:e}}}var yq="firebase-app-check-database",_q=1,Fv="firebase-app-check-store";var If=null;function vq(){return If||(If=new Promise((t,e)=>{try{let n=indexedDB.open(yq,_q);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(hi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Fv,{keyPath:"compositeKey"})}}}catch(n){e(hi.create("storage-open",{originalErrorMessage:n?.message}))}}),If)}function wq(t,e){return Eq(Iq(t),e)}function Eq(t,e){return _(this,null,function*(){let r=(yield vq()).transaction(Fv,"readwrite"),s=r.objectStore(Fv).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var c;a(hi.create("storage-set",{originalErrorMessage:(c=u.target.error)===null||c===void 0?void 0:c.message}))}})})}function Iq(t){return`${t.options.appId}-${t.name}`}var Vv=new Gr("@firebase/app-check");function kv(t,e){return pd()?wq(t,e).catch(n=>{Vv.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function Hx(){return jx().enabled}function qx(){return _(this,null,function*(){let t=jx();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Cq={error:"UNKNOWN_ERROR"};function Dq(t){return hd.encodeString(JSON.stringify(t),!1)}function Lv(t,e=!1){return _(this,null,function*(){let n=t.app;Ux(n);let r=Mn(n),i=r.token,s;if(i&&!fc(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(fc(u)?i=u:yield kv(n,void 0))}if(!e&&i&&fc(i))return{token:i.token};let o=!1;if(Hx()){r.exchangeTokenPromise||(r.exchangeTokenPromise=Bx($x(n,yield qx()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let u=yield r.exchangeTokenPromise;return yield kv(n,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Mn(n).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?Vv.warn(u.message):Vv.error(u),s=u}let a;return i?s?fc(i)?a={token:i.token,internalError:s}:a=Ox(s):(a={token:i.token},r.token=i,yield kv(n,i)):a=Ox(s),o&&Aq(n,a),a})}function Tq(t){return _(this,null,function*(){let e=t.app;Ux(e);let{provider:n}=Mn(e);if(Hx()){let r=yield qx(),{token:i}=yield Bx($x(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function bq(t,e,n,r){let{app:i}=t,s=Mn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&fc(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),kx(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>kx(t))}function Gx(t,e){let n=Mn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function kx(t){let{app:e}=t,n=Mn(e),r=n.tokenRefresher;r||(r=Sq(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function Sq(t){let{app:e}=t;return new Ov(()=>_(this,null,function*(){let n=Mn(e),r;if(n.token?r=yield Lv(t,!0):r=yield Lv(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=Mn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Px.RETRIAL_MIN_WAIT,Px.RETRIAL_MAX_WAIT)}function Aq(t,e){let n=Mn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function fc(t){return t.expireTimeMillis-Date.now()>0}function Ox(t){return{token:Dq(Cq),error:t}}var jv=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=Mn(this.app);for(let n of e)Gx(this.app,n.next);return Promise.resolve()}};function xq(t,e){return new jv(t,e)}function Mq(t){return{getToken:e=>Lv(t,e),getLimitedUseToken:()=>Tq(t),addTokenListener:e=>bq(t,"INTERNAL",e),removeTokenListener:e=>Gx(t.app,e)}}var Rq="@firebase/app-check",Nq="0.8.3";var Pq="app-check",Fx="app-check-internal";function kq(){Hi(new Gt(Pq,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return xq(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(Fx).initialize()})),Hi(new Gt(Fx,t=>{let e=t.getProvider("app-check").getImmediate();return Mq(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),En(Rq,Nq)}kq();var Oq=["localhost","0.0.0.0","127.0.0.1"],qX=typeof window<"u"&&Oq.includes(window.location.hostname);var pc=new P("angularfire2.auth.use-emulator"),gc=new P("angularfire2.auth.settings"),mc=new P("angularfire2.auth.tenant-id"),yc=new P("angularfire2.auth.langugage-code"),_c=new P("angularfire2.auth.use-device-language"),vc=new P("angularfire.auth.persistence"),wc=(t,e,n,r,i,s,o,a)=>Zo(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(let[c,l]of Object.entries(o))u.settings[c]=l;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]),gs=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,c,l,d,h,f){let p=new Fe,g=V(void 0).pipe(on(o.outsideAngular),Ae(()=>s.runOutsideAngular(()=>import("./chunk-2X4LOZNH.js"))),k(()=>ps(n,s,r)),k(v=>wc(v,s,a,c,l,d,u,h)),qd({bufferSize:1,refCount:!1}));if(ds(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=V(null);else{g.pipe(an()).subscribe();let v=g.pipe(Ae(T=>T.getRedirectResult().then(j=>j,()=>null)),Be,qd({bufferSize:1,refCount:!1})),C=g.pipe(Ae(T=>new X(j=>({unsubscribe:s.runOutsideAngular(()=>T.onAuthStateChanged(H=>j.next(H),H=>j.error(H),()=>j.complete()))})))),N=g.pipe(Ae(T=>new X(j=>({unsubscribe:s.runOutsideAngular(()=>T.onIdTokenChanged(H=>j.next(H),H=>j.error(H),()=>j.complete()))}))));this.authState=v.pipe(Gd(C),Cn(o.outsideAngular),on(o.insideAngular)),this.user=v.pipe(Gd(N),Cn(o.outsideAngular),on(o.insideAngular)),this.idToken=this.user.pipe(Ae(T=>T?de(T.getIdToken()):V(null))),this.idTokenResult=this.user.pipe(Ae(T=>T?de(T.getIdTokenResult()):V(null))),this.credential=mo(v,p,this.authState.pipe(ft(T=>!T))).pipe(k(T=>T?.user?T:null),Cn(o.outsideAngular),on(o.insideAngular))}return Nx(this,g,s,{spy:{apply:(v,C,N)=>{(v.startsWith("signIn")||v.startsWith("createUser"))&&N.then(T=>p.next(T))}}})}static \u0275fac=function(r){return new(r||t)(I(li),I(di,8),I(Ct),I(he),I(Yo),I(pc,8),I(gc,8),I(mc,8),I(yc,8),I(_c,8),I(vc,8),I(xr,8))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),oee=(()=>{class t{constructor(){Xe.registerVersion("angularfire",Mr.full,"auth-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Et({type:t});static \u0275inj=wt({providers:[gs]})}return t})();var Fq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Nn={},A,cw=cw||{},z=Fq||self;function Ff(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function kc(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Vq(t){return Object.prototype.hasOwnProperty.call(t,$v)&&t[$v]||(t[$v]=++Lq)}var $v="closure_uid_"+(1e9*Math.random()>>>0),Lq=0;function jq(t,e,n){return t.call.apply(t.bind,arguments)}function Uq(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Dt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Dt=jq:Dt=Uq,Dt.apply(null,arguments)}function Cf(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function ot(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function fi(){this.s=this.s,this.o=this.o}var Bq=0;fi.prototype.s=!1;fi.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),Bq!=0)&&Vq(this)};fi.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var iM=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function lw(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function zx(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(Ff(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Tt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Tt.prototype.h=function(){this.defaultPrevented=!0};var $q=function(){if(!z.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};z.addEventListener("test",n,e),z.removeEventListener("test",n,e)}catch{}return t}();function bc(t){return/^[\s\xa0]*$/.test(t)}function Vf(){var t=z.navigator;return t&&(t=t.userAgent)?t:""}function Xn(t){return Vf().indexOf(t)!=-1}function dw(t){return dw[" "](t),t}dw[" "]=function(){};function Hq(t,e){var n=RG;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var qq=Xn("Opera"),ta=Xn("Trident")||Xn("MSIE"),sM=Xn("Edge"),Wv=sM||ta,oM=Xn("Gecko")&&!(Vf().toLowerCase().indexOf("webkit")!=-1&&!Xn("Edge"))&&!(Xn("Trident")||Xn("MSIE"))&&!Xn("Edge"),Gq=Vf().toLowerCase().indexOf("webkit")!=-1&&!Xn("Edge");function aM(){var t=z.document;return t?t.documentMode:void 0}var Kv;e:{if(Df="",Tf=function(){var t=Vf();if(oM)return/rv:([^\);]+)(\)|;)/.exec(t);if(sM)return/Edge\/([\d\.]+)/.exec(t);if(ta)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Gq)return/WebKit\/(\S+)/.exec(t);if(qq)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),Tf&&(Df=Tf?Tf[1]:""),ta&&(bf=aM(),bf!=null&&bf>parseFloat(Df))){Kv=String(bf);break e}Kv=Df}var Df,Tf,bf,Qv;z.document&&ta?(Hv=aM(),Qv=Hv||parseInt(Kv,10)||void 0):Qv=void 0;var Hv,zq=Qv;function Sc(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(oM){e:{try{dw(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Wq[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Sc.$.h.call(this)}}ot(Sc,Tt);var Wq={2:"touch",3:"pen",4:"mouse"};Sc.prototype.h=function(){Sc.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Oc="closure_listenable_"+(1e6*Math.random()|0),Kq=0;function Qq(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++Kq,this.fa=this.ia=!1}function Lf(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function hw(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function Yq(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function uM(t){let e={};for(let n in t)e[n]=t[n];return e}var Wx="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function cM(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<Wx.length;s++)n=Wx[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function jf(t){this.src=t,this.g={},this.h=0}jf.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Zv(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new Qq(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Yv(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=iM(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Lf(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Zv(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var fw="closure_lm_"+(1e6*Math.random()|0),qv={};function lM(t,e,n,r,i){if(r&&r.once)return hM(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)lM(t,e[s],n,r,i);return null}return n=mw(n),t&&t[Oc]?t.O(e,n,kc(r)?!!r.capture:!!r,i):dM(t,e,n,!1,r,i)}function dM(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=kc(i)?!!i.capture:!!i,a=gw(t);if(a||(t[fw]=a=new jf(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=Zq(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)$q||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(pM(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Zq(){function t(n){return e.call(t.src,t.listener,n)}let e=Jq;return t}function hM(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)hM(t,e[s],n,r,i);return null}return n=mw(n),t&&t[Oc]?t.P(e,n,kc(r)?!!r.capture:!!r,i):dM(t,e,n,!0,r,i)}function fM(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)fM(t,e[s],n,r,i);else r=kc(r)?!!r.capture:!!r,n=mw(n),t&&t[Oc]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Zv(s,n,r,i),-1<n&&(Lf(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=gw(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Zv(e,n,r,i)),(n=-1<t?e[t]:null)&&pw(n))}function pw(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Oc])Yv(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(pM(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=gw(e))?(Yv(n,t),n.h==0&&(n.src=null,e[fw]=null)):Lf(t)}}}function pM(t){return t in qv?qv[t]:qv[t]="on"+t}function Jq(t,e){if(t.fa)t=!0;else{e=new Sc(e,this);var n=t.listener,r=t.la||t.src;t.ia&&pw(t),t=n.call(r,e)}return t}function gw(t){return t=t[fw],t instanceof jf?t:null}var Gv="__closure_events_fn_"+(1e9*Math.random()>>>0);function mw(t){return typeof t=="function"?t:(t[Gv]||(t[Gv]=function(e){return t.handleEvent(e)}),t[Gv])}function st(){fi.call(this),this.i=new jf(this),this.S=this,this.J=null}ot(st,fi);st.prototype[Oc]=!0;st.prototype.removeEventListener=function(t,e,n,r){fM(this,t,e,n,r)};function gt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Tt(e,t);else if(e instanceof Tt)e.target=e.target||t;else{var i=e;e=new Tt(r,t),cM(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Sf(o,r,!0,e)&&i}if(o=e.g=t,i=Sf(o,r,!0,e)&&i,i=Sf(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Sf(o,r,!1,e)&&i}st.prototype.N=function(){if(st.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Lf(n[r]);delete t.g[e],t.h--}}this.J=null};st.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};st.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Sf(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&Yv(t.i,o),i=a.call(u,r)!==!1&&i}}return i&&!r.defaultPrevented}var yw=z.JSON.stringify,Jv=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function Xq(){var t=_w;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Xv=class{constructor(){this.h=this.g=null}add(e,n){let r=gM.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},gM=new Jv(()=>new ew,t=>t.reset()),ew=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function eG(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function tG(t){z.setTimeout(()=>{throw t},0)}var Ac,xc=!1,_w=new Xv,mM=()=>{let t=z.Promise.resolve(void 0);Ac=()=>{t.then(nG)}},nG=()=>{for(var t;t=Xq();){try{t.h.call(t.g)}catch(n){tG(n)}var e=gM;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}xc=!1};function Uf(t,e){st.call(this),this.h=t||1,this.g=e||z,this.j=Dt(this.qb,this),this.l=Date.now()}ot(Uf,st);A=Uf.prototype;A.ga=!1;A.T=null;A.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),gt(this,"tick"),this.ga&&(vw(this),this.start()))}};A.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function vw(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}A.N=function(){Uf.$.N.call(this),vw(this),delete this.g};function ww(t,e,n){if(typeof t=="function")n&&(t=Dt(t,n));else if(t&&typeof t.handleEvent=="function")t=Dt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:z.setTimeout(t,e||0)}function yM(t){t.g=ww(()=>{t.g=null,t.i&&(t.i=!1,yM(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var tw=class extends fi{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:yM(this)}N(){super.N(),this.g&&(z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Mc(t){fi.call(this),this.h=t,this.g={}}ot(Mc,fi);var Kx=[];function _M(t,e,n,r){Array.isArray(n)||(n&&(Kx[0]=n.toString()),n=Kx);for(var i=0;i<n.length;i++){var s=lM(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function vM(t){hw(t.g,function(e,n){this.g.hasOwnProperty(n)&&pw(e)},t),t.g={}}Mc.prototype.N=function(){Mc.$.N.call(this),vM(this)};Mc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Bf(){this.g=!0}Bf.prototype.Ea=function(){this.g=!1};function rG(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+c+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function iG(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Xo(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+oG(t,n)+(r?" "+r:"")})}function sG(t,e){t.info(function(){return"TIMEOUT: "+e})}Bf.prototype.info=function(){};function oG(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return yw(n)}catch{return e}}var vs={},Qx=null;function $f(){return Qx=Qx||new st}vs.Ta="serverreachability";function wM(t){Tt.call(this,vs.Ta,t)}ot(wM,Tt);function Rc(t){let e=$f();gt(e,new wM(e))}vs.STAT_EVENT="statevent";function EM(t,e){Tt.call(this,vs.STAT_EVENT,t),this.stat=e}ot(EM,Tt);function Nt(t){let e=$f();gt(e,new EM(e,t))}vs.Ua="timingevent";function IM(t,e){Tt.call(this,vs.Ua,t),this.size=e}ot(IM,Tt);function Fc(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return z.setTimeout(function(){t()},e)}var Hf={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},CM={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Ew(){}Ew.prototype.h=null;function Yx(t){return t.h||(t.h=t.i())}function DM(){}var Vc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Iw(){Tt.call(this,"d")}ot(Iw,Tt);function Cw(){Tt.call(this,"c")}ot(Cw,Tt);var nw;function qf(){}ot(qf,Ew);qf.prototype.g=function(){return new XMLHttpRequest};qf.prototype.i=function(){return{}};nw=new qf;function Lc(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Mc(this),this.P=aG,t=Wv?125:void 0,this.V=new Uf(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new TM}function TM(){this.i=null,this.g="",this.h=!1}var aG=45e3,bM={},rw={};A=Lc.prototype;A.setTimeout=function(t){this.P=t};function iw(t,e,n){t.L=1,t.A=zf(Nr(e)),t.u=n,t.S=!0,SM(t,null)}function SM(t,e){t.G=Date.now(),jc(t),t.B=Nr(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),OM(n.i,"t",r),t.o=0,n=t.l.J,t.h=new TM,t.g=nR(t.l,n?e:null,!t.u),0<t.O&&(t.M=new tw(Dt(t.Pa,t,t.g),t.O)),_M(t.U,t.g,"readystatechange",t.nb),e=t.I?uM(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Rc(),rG(t.j,t.v,t.B,t.m,t.W,t.u)}A.nb=function(t){t=t.target;let e=this.M;e&&er(t)==3?e.l():this.Pa(t)};A.Pa=function(t){try{if(t==this.g)e:{let l=er(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||Wv||this.g&&(this.h.h||this.g.ja()||eM(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?Rc(3):Rc(2)),Gf(this);var n=this.g.da();this.ca=n;t:if(AM(this)){var r=eM(this.g);t="";var i=r.length,s=er(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ms(this),Tc(this);var o="";break t}this.h.i=new z.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,iG(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!bc(a)){var c=a;break t}}c=null}if(n=c)Xo(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,sw(this,n);else{this.i=!1,this.s=3,Nt(12),ms(this),Tc(this);break e}}this.S?(xM(this,l,o),Wv&&this.i&&l==3&&(_M(this.U,this.V,"tick",this.mb),this.V.start())):(Xo(this.j,this.m,o,null),sw(this,o)),l==4&&ms(this),this.i&&!this.J&&(l==4?JM(this.l,this):(this.i=!1,jc(this)))}else AG(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,Nt(12)):(this.s=0,Nt(13)),ms(this),Tc(this)}}}catch{}finally{}};function AM(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function xM(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=uG(t,n),i==rw){e==4&&(t.s=4,Nt(14),r=!1),Xo(t.j,t.m,null,"[Incomplete Response]");break}else if(i==bM){t.s=4,Nt(15),Xo(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Xo(t.j,t.m,i,null),sw(t,i);AM(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,Nt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),xw(e),e.M=!0,Nt(11))):(Xo(t.j,t.m,n,"[Invalid Chunked Response]"),ms(t),Tc(t))}A.mb=function(){if(this.g){var t=er(this.g),e=this.g.ja();this.o<e.length&&(Gf(this),xM(this,t,e),this.i&&t!=4&&jc(this))}};function uG(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?rw:(n=Number(e.substring(n,r)),isNaN(n)?bM:(r+=1,r+n>e.length?rw:(e=e.slice(r,r+n),t.o=r+n,e)))}A.cancel=function(){this.J=!0,ms(this)};function jc(t){t.Y=Date.now()+t.P,MM(t,t.P)}function MM(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Fc(Dt(t.lb,t),e)}function Gf(t){t.C&&(z.clearTimeout(t.C),t.C=null)}A.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(sG(this.j,this.B),this.L!=2&&(Rc(),Nt(17)),ms(this),this.s=2,Tc(this)):MM(this,this.Y-t)};function Tc(t){t.l.H==0||t.J||JM(t.l,t)}function ms(t){Gf(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,vw(t.V),vM(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function sw(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||ow(n.i,t))){if(!t.K&&ow(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Nf(n),Qf(n);else break e;Aw(n),Nt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Fc(Dt(n.ib,n),6e3));if(1>=LM(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else ys(n,11)}else if((t.K||n.g==t)&&Nf(n),!bc(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];let l=c[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=c[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Dw(s,s.h),s.h=null))}if(r.F){let g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,Me(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=tR(r,r.J?r.pa:null,r.Y),o.K){jM(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&(Gf(a),jc(a)),r.g=o}else YM(r);0<n.j.length&&Yf(n)}else c[0]!="stop"&&c[0]!="close"||ys(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?ys(n,7):Sw(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}Rc(4)}catch{}}function cG(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Ff(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function lG(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Ff(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function RM(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Ff(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=lG(t),r=cG(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var NM=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function dG(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function _s(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof _s){this.h=t.h,Mf(this,t.j),this.s=t.s,this.g=t.g,Rf(this,t.m),this.l=t.l;var e=t.i,n=new Nc;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Zx(this,n),this.o=t.o}else t&&(e=String(t).match(NM))?(this.h=!1,Mf(this,e[1]||"",!0),this.s=Cc(e[2]||""),this.g=Cc(e[3]||"",!0),Rf(this,e[4]),this.l=Cc(e[5]||"",!0),Zx(this,e[6]||"",!0),this.o=Cc(e[7]||"")):(this.h=!1,this.i=new Nc(null,this.h))}_s.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Dc(e,Jx,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Dc(e,Jx,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Dc(n,n.charAt(0)=="/"?pG:fG,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Dc(n,mG)),t.join("")};function Nr(t){return new _s(t)}function Mf(t,e,n){t.j=n?Cc(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Rf(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Zx(t,e,n){e instanceof Nc?(t.i=e,yG(t.i,t.h)):(n||(e=Dc(e,gG)),t.i=new Nc(e,t.h))}function Me(t,e,n){t.i.set(e,n)}function zf(t){return Me(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Cc(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Dc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,hG),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hG(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Jx=/[#\/\?@]/g,fG=/[#\?:]/g,pG=/[#\?]/g,gG=/[#\?@]/g,mG=/#/g;function Nc(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function pi(t){t.g||(t.g=new Map,t.h=0,t.i&&dG(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}A=Nc.prototype;A.add=function(t,e){pi(this),this.i=null,t=na(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function PM(t,e){pi(t),e=na(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function kM(t,e){return pi(t),e=na(t,e),t.g.has(e)}A.forEach=function(t,e){pi(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};A.ta=function(){pi(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};A.Z=function(t){pi(this);let e=[];if(typeof t=="string")kM(this,t)&&(e=e.concat(this.g.get(na(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};A.set=function(t,e){return pi(this),this.i=null,t=na(this,t),kM(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};A.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function OM(t,e,n){PM(t,e),0<n.length&&(t.i=null,t.g.set(na(t,e),lw(n)),t.h+=n.length)}A.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function na(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function yG(t,e){e&&!t.j&&(pi(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(PM(this,r),OM(this,i,n))},t)),t.j=e}var _G=class{constructor(t,e){this.g=t,this.map=e}};function FM(t){this.l=t||vG,z.PerformanceNavigationTiming?(t=z.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(z.g&&z.g.Ka&&z.g.Ka()&&z.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var vG=10;function VM(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function LM(t){return t.h?1:t.g?t.g.size:0}function ow(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Dw(t,e){t.g?t.g.add(e):t.h=e}function jM(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}FM.prototype.cancel=function(){if(this.i=UM(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function UM(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return lw(t.i)}var wG=class{stringify(t){return z.JSON.stringify(t,void 0)}parse(t){return z.JSON.parse(t,void 0)}};function EG(){this.g=new wG}function IG(t,e,n){let r=n||"";try{RM(t,function(i,s){let o=i;kc(i)&&(o=yw(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function CG(t,e){let n=new Bf;if(z.Image){let r=new Image;r.onload=Cf(Af,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Cf(Af,n,r,"TestLoadImage: error",!1,e),r.onabort=Cf(Af,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Cf(Af,n,r,"TestLoadImage: timeout",!1,e),z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Af(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Uc(t){this.l=t.ec||null,this.j=t.ob||!1}ot(Uc,Ew);Uc.prototype.g=function(){return new Wf(this.l,this.j)};Uc.prototype.i=function(t){return function(){return t}}({});function Wf(t,e){st.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Tw,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ot(Wf,st);var Tw=0;A=Wf.prototype;A.open=function(t,e){if(this.readyState!=Tw)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Pc(this)};A.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||z).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};A.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Bc(this)),this.readyState=Tw};A.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Pc(this)),this.g&&(this.readyState=3,Pc(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof z.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;BM(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function BM(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}A.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Bc(this):Pc(this),this.readyState==3&&BM(this)}};A.Za=function(t){this.g&&(this.response=this.responseText=t,Bc(this))};A.Ya=function(t){this.g&&(this.response=t,Bc(this))};A.ka=function(){this.g&&Bc(this)};function Bc(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Pc(t)}A.setRequestHeader=function(t,e){this.v.append(t,e)};A.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};A.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Pc(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Wf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var DG=z.JSON.parse;function Ve(t){st.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=$M,this.L=this.M=!1}ot(Ve,st);var $M="",TG=/^https?$/i,bG=["POST","PUT"];A=Ve.prototype;A.Oa=function(t){this.M=t};A.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():nw.g(),this.C=this.u?Yx(this.u):Yx(nw),this.g.onreadystatechange=Dt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){Xx(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=z.FormData&&t instanceof z.FormData,!(0<=iM(bG,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{GM(this),0<this.B&&((this.L=SG(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Dt(this.ua,this)):this.A=ww(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){Xx(this,s)}};function SG(t){return ta&&typeof t.timeout=="number"&&t.ontimeout!==void 0}A.ua=function(){typeof cw<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,gt(this,"timeout"),this.abort(8))};function Xx(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,HM(t),Kf(t)}function HM(t){t.F||(t.F=!0,gt(t,"complete"),gt(t,"error"))}A.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,gt(this,"complete"),gt(this,"abort"),Kf(this))};A.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Kf(this,!0)),Ve.$.N.call(this)};A.La=function(){this.s||(this.G||this.v||this.l?qM(this):this.kb())};A.kb=function(){qM(this)};function qM(t){if(t.h&&typeof cw<"u"&&(!t.C[1]||er(t)!=4||t.da()!=2)){if(t.v&&er(t)==4)ww(t.La,0,t);else if(gt(t,"readystatechange"),er(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(NM)[1]||null;!i&&z.self&&z.self.location&&(i=z.self.location.protocol.slice(0,-1)),r=!TG.test(i?i.toLowerCase():"")}n=r}if(n)gt(t,"complete"),gt(t,"success");else{t.m=6;try{var s=2<er(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",HM(t)}}finally{Kf(t)}}}}function Kf(t,e){if(t.g){GM(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||gt(t,"ready");try{n.onreadystatechange=r}catch{}}}function GM(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(z.clearTimeout(t.A),t.A=null)}A.isActive=function(){return!!this.g};function er(t){return t.g?t.g.readyState:0}A.da=function(){try{return 2<er(this)?this.g.status:-1}catch{return-1}};A.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};A.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),DG(e)}};function eM(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case $M:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function AG(t){let e={};t=(t.g&&2<=er(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(bc(t[r]))continue;var n=eG(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}Yq(e,function(r){return r.join(", ")})}A.Ia=function(){return this.m};A.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function zM(t){let e="";return hw(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function bw(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=zM(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Me(t,e,n))}function Ec(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function WM(t){this.Ga=0,this.j=[],this.l=new Bf,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Ec("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Ec("baseRetryDelayMs",5e3,t),this.hb=Ec("retryDelaySeedMs",1e4,t),this.eb=Ec("forwardChannelMaxRetries",2,t),this.xa=Ec("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new FM(t&&t.concurrentRequestLimit),this.Ja=new EG,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}A=WM.prototype;A.ra=8;A.H=1;function Sw(t){if(KM(t),t.H==3){var e=t.W++,n=Nr(t.I);if(Me(n,"SID",t.K),Me(n,"RID",e),Me(n,"TYPE","terminate"),$c(t,n),e=new Lc(t,t.l,e),e.L=2,e.A=zf(Nr(n)),n=!1,z.navigator&&z.navigator.sendBeacon)try{n=z.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&z.Image&&(new Image().src=e.A,n=!0),n||(e.g=nR(e.l,null),e.g.ha(e.A)),e.G=Date.now(),jc(e)}eR(t)}function Qf(t){t.g&&(xw(t),t.g.cancel(),t.g=null)}function KM(t){Qf(t),t.u&&(z.clearTimeout(t.u),t.u=null),Nf(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&z.clearTimeout(t.m),t.m=null)}function Yf(t){if(!VM(t.i)&&!t.m){t.m=!0;var e=t.Na;Ac||mM(),xc||(Ac(),xc=!0),_w.add(e,t),t.C=0}}function xG(t,e){return LM(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Fc(Dt(t.Na,t,e),XM(t,t.C)),t.C++,!0)}A.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Lc(this,this.l,t),s=this.s;if(this.U&&(s?(s=uM(s),cM(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=QM(this,i,e),n=Nr(this.I),Me(n,"RID",t),Me(n,"CVER",22),this.F&&Me(n,"X-HTTP-Session-Id",this.F),$c(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(zM(s)))+"&"+e:this.o&&bw(n,this.o,s)),Dw(this.i,i),this.bb&&Me(n,"TYPE","init"),this.P?(Me(n,"$req",e),Me(n,"SID","null"),i.aa=!0,iw(i,n,null)):iw(i,n,e),this.H=2}}else this.H==3&&(t?tM(this,t):this.j.length==0||VM(this.i)||tM(this))};function tM(t,e){var n;e?n=e.m:n=t.W++;let r=Nr(t.I);Me(r,"SID",t.K),Me(r,"RID",n),Me(r,"AID",t.V),$c(t,r),t.o&&t.s&&bw(r,t.o,t.s),n=new Lc(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=QM(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Dw(t.i,n),iw(n,r,e)}function $c(t,e){t.na&&hw(t.na,function(n,r){Me(e,r,n)}),t.h&&RM({},function(n,r){Me(e,r,n)})}function QM(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Dt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let c=i[u].g,l=i[u].map;if(c-=s,0>c)s=Math.max(0,i[u].g-100),a=!1;else try{IG(l,o,"req"+c+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function YM(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Ac||mM(),xc||(Ac(),xc=!0),_w.add(e,t),t.A=0}}function Aw(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Fc(Dt(t.Ma,t),XM(t,t.A)),t.A++,!0)}A.Ma=function(){if(this.u=null,ZM(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Fc(Dt(this.jb,this),t)}};A.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Nt(10),Qf(this),ZM(this))};function xw(t){t.B!=null&&(z.clearTimeout(t.B),t.B=null)}function ZM(t){t.g=new Lc(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Nr(t.wa);Me(e,"RID","rpc"),Me(e,"SID",t.K),Me(e,"AID",t.V),Me(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Me(e,"TO",t.qa),Me(e,"TYPE","xmlhttp"),$c(t,e),t.o&&t.s&&bw(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=zf(Nr(e)),n.u=null,n.S=!0,SM(n,t)}A.ib=function(){this.v!=null&&(this.v=null,Qf(this),Aw(this),Nt(19))};function Nf(t){t.v!=null&&(z.clearTimeout(t.v),t.v=null)}function JM(t,e){var n=null;if(t.g==e){Nf(t),xw(t),t.g=null;var r=2}else if(ow(t.i,e))n=e.F,jM(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=$f(),gt(r,new IM(r,n)),Yf(t)}else YM(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&xG(t,e)||r==2&&Aw(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:ys(t,5);break;case 4:ys(t,10);break;case 3:ys(t,6);break;default:ys(t,2)}}}function XM(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function ys(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Dt(t.pb,t);n||(n=new _s("//www.google.com/images/cleardot.gif"),z.location&&z.location.protocol=="http"||Mf(n,"https"),zf(n)),CG(n.toString(),r)}else Nt(2);t.H=0,t.h&&t.h.za(e),eR(t),KM(t)}A.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Nt(2)):(this.l.info("Failed to ping google.com"),Nt(1))};function eR(t){if(t.H=0,t.ma=[],t.h){let e=UM(t.i);(e.length!=0||t.j.length!=0)&&(zx(t.ma,e),zx(t.ma,t.j),t.i.i.length=0,lw(t.j),t.j.length=0),t.h.ya()}}function tR(t,e,n){var r=n instanceof _s?Nr(n):new _s(n);if(r.g!="")e&&(r.g=e+"."+r.g),Rf(r,r.m);else{var i=z.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new _s(null);r&&Mf(s,r),e&&(s.g=e),i&&Rf(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Me(r,n,e),Me(r,"VER",t.ra),$c(t,r),r}function nR(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new Ve(new Uc({ob:n})):new Ve(t.va),e.Oa(t.J),e}A.isActive=function(){return!!this.h&&this.h.isActive(this)};function rR(){}A=rR.prototype;A.Ba=function(){};A.Aa=function(){};A.za=function(){};A.ya=function(){};A.isActive=function(){return!0};A.Va=function(){};function Pf(){if(ta&&!(10<=Number(zq)))throw Error("Environmental error: no available transport.")}Pf.prototype.g=function(t,e){return new Yt(t,e)};function Yt(t,e){st.call(this),this.g=new WM(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!bc(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!bc(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new ra(this)}ot(Yt,st);Yt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Nt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=tR(t,null,t.Y),Yf(t)};Yt.prototype.close=function(){Sw(this.g)};Yt.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=yw(t),t=n);e.j.push(new _G(e.fb++,t)),e.H==3&&Yf(e)};Yt.prototype.N=function(){this.g.h=null,delete this.j,Sw(this.g),delete this.g,Yt.$.N.call(this)};function iR(t){Iw.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}ot(iR,Iw);function sR(){Cw.call(this),this.status=1}ot(sR,Cw);function ra(t){this.g=t}ot(ra,rR);ra.prototype.Ba=function(){gt(this.g,"a")};ra.prototype.Aa=function(t){gt(this.g,new iR(t))};ra.prototype.za=function(t){gt(this.g,new sR)};ra.prototype.ya=function(){gt(this.g,"b")};function MG(){this.blockSize=-1}function Rn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ot(Rn,MG);Rn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function zv(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Rn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)zv(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){zv(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){zv(this,r),i=0;break}}this.h=i,this.i+=e};Rn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function ve(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var RG={};function Mw(t){return-128<=t&&128>t?Hq(t,function(e){return new ve([e|0],0>e?-1:0)}):new ve([t|0],0>t?-1:0)}function tr(t){if(isNaN(t)||!isFinite(t))return ea;if(0>t)return pt(tr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=aw;return new ve(e,0)}function oR(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return pt(oR(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=tr(Math.pow(e,8)),r=ea,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=tr(Math.pow(e,s)),r=r.R(s).add(tr(o))):(r=r.R(n),r=r.add(tr(o)))}return r}var aw=4294967296,ea=Mw(0),uw=Mw(1),nM=Mw(16777216);A=ve.prototype;A.ea=function(){if(fn(this))return-pt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:aw+r)*e,e*=aw}return t};A.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Rr(this))return"0";if(fn(this))return"-"+pt(this).toString(t);for(var e=tr(Math.pow(t,6)),n=this,r="";;){var i=Of(n,e).g;n=kf(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Rr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};A.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Rr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function fn(t){return t.h==-1}A.X=function(t){return t=kf(this,t),fn(t)?-1:Rr(t)?0:1};function pt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new ve(n,~t.h).add(uw)}A.abs=function(){return fn(this)?pt(this):this};A.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new ve(n,n[n.length-1]&-2147483648?-1:0)};function kf(t,e){return t.add(pt(e))}A.R=function(t){if(Rr(this)||Rr(t))return ea;if(fn(this))return fn(t)?pt(this).R(pt(t)):pt(pt(this).R(t));if(fn(t))return pt(this.R(pt(t)));if(0>this.X(nM)&&0>t.X(nM))return tr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,u=t.D(i)&65535;n[2*r+2*i]+=o*u,xf(n,2*r+2*i),n[2*r+2*i+1]+=s*u,xf(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,xf(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,xf(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new ve(n,0)};function xf(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Ic(t,e){this.g=t,this.h=e}function Of(t,e){if(Rr(e))throw Error("division by zero");if(Rr(t))return new Ic(ea,ea);if(fn(t))return e=Of(pt(t),e),new Ic(pt(e.g),pt(e.h));if(fn(e))return e=Of(t,pt(e)),new Ic(pt(e.g),e.h);if(30<t.g.length){if(fn(t)||fn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=uw,r=e;0>=r.X(t);)n=rM(n),r=rM(r);var i=Jo(n,1),s=Jo(r,1);for(r=Jo(r,2),n=Jo(n,2);!Rr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Jo(r,1),n=Jo(n,1)}return e=kf(t,i.R(e)),new Ic(i,e)}for(i=ea;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=tr(n),o=s.R(e);fn(o)||0<o.X(t);)n-=r,s=tr(n),o=s.R(e);Rr(s)&&(s=uw),i=i.add(s),t=kf(t,o)}return new Ic(i,t)}A.gb=function(t){return Of(this,t).h};A.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new ve(n,this.h&t.h)};A.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new ve(n,this.h|t.h)};A.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new ve(n,this.h^t.h)};function rM(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new ve(n,t.h)}function Jo(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new ve(i,t.h)}Pf.prototype.createWebChannel=Pf.prototype.g;Yt.prototype.send=Yt.prototype.u;Yt.prototype.open=Yt.prototype.m;Yt.prototype.close=Yt.prototype.close;Hf.NO_ERROR=0;Hf.TIMEOUT=8;Hf.HTTP_ERROR=6;CM.COMPLETE="complete";DM.EventType=Vc;Vc.OPEN="a";Vc.CLOSE="b";Vc.ERROR="c";Vc.MESSAGE="d";st.prototype.listen=st.prototype.O;Ve.prototype.listenOnce=Ve.prototype.P;Ve.prototype.getLastError=Ve.prototype.Sa;Ve.prototype.getLastErrorCode=Ve.prototype.Ia;Ve.prototype.getStatus=Ve.prototype.da;Ve.prototype.getResponseJson=Ve.prototype.Wa;Ve.prototype.getResponseText=Ve.prototype.ja;Ve.prototype.send=Ve.prototype.ha;Ve.prototype.setWithCredentials=Ve.prototype.Oa;Rn.prototype.digest=Rn.prototype.l;Rn.prototype.reset=Rn.prototype.reset;Rn.prototype.update=Rn.prototype.j;ve.prototype.add=ve.prototype.add;ve.prototype.multiply=ve.prototype.R;ve.prototype.modulo=ve.prototype.gb;ve.prototype.compare=ve.prototype.X;ve.prototype.toNumber=ve.prototype.ea;ve.prototype.toString=ve.prototype.toString;ve.prototype.getBits=ve.prototype.D;ve.fromNumber=tr;ve.fromString=oR;var aR=Nn.createWebChannelTransport=function(){return new Pf},uR=Nn.getStatEventTarget=function(){return $f()},Zf=Nn.ErrorCode=Hf,cR=Nn.EventType=CM,lR=Nn.Event=vs,Rw=Nn.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},dR=Nn.FetchXmlHttpFactory=Uc,Hc=Nn.WebChannel=DM,hR=Nn.XhrIo=Ve,fR=Nn.Md5=Rn,ws=Nn.Integer=ve;var pR="@firebase/firestore";var Qe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Qe.UNAUTHENTICATED=new Qe(null),Qe.GOOGLE_CREDENTIALS=new Qe("google-credentials-uid"),Qe.FIRST_PARTY=new Qe("first-party-uid"),Qe.MOCK_USER=new Qe("mock-user");var ka="10.11.1";var Ei=new Gr("@firebase/firestore");function ua(){return Ei.logLevel}function pN(t){Ei.setLogLevel(t)}function E(t,...e){if(Ei.logLevel<=sn.DEBUG){let n=e.map(kI);Ei.debug(`Firestore (${ka}): ${t}`,...n)}}function $e(t,...e){if(Ei.logLevel<=sn.ERROR){let n=e.map(kI);Ei.error(`Firestore (${ka}): ${t}`,...n)}}function gn(t,...e){if(Ei.logLevel<=sn.WARN){let n=e.map(kI);Ei.warn(`Firestore (${ka}): ${t}`,...n)}}function kI(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function R(t="Unexpected state"){let e=`FIRESTORE (${ka}) INTERNAL ASSERTION FAILED: `+t;throw $e(e),new Error(e)}function O(t,e){t||R()}function gN(t,e){t||R()}function S(t,e){return t}var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},w=class extends xT{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Ye=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var up=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Fw=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Qe.UNAUTHENTICATED))}shutdown(){}},Vw=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},Lw=class{constructor(e){this.t=e,this.currentUser=Qe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve(),s=new Ye;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ye,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>_(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{E("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(E("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ye)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(E("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(O(typeof r.accessToken=="string"),new up(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return O(e===null||typeof e=="string"),new Qe(e)}},jw=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Qe.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Uw=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new jw(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Qe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Bw=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},$w=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&E("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,E("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{E("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):E("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(O(typeof n.token=="string"),this.R=n.token,new Bw(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function PG(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var cp=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=PG(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function Q(t,e){return t<e?-1:t>e?1:0}function ya(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function mN(t){return t+"\0"}var ke=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new w(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new w(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new w(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new w(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Q(this.nanoseconds,e.nanoseconds):Q(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var L=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new ke(0,0))}static max(){return new t(new ke(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var lp=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&R(),r===void 0?r=e.length-n:r>e.length-n&&R(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},ce=class t extends lp{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new w(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},kG=/^[_a-zA-Z][_a-zA-Z0-9]*$/,He=class t extends lp{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return kG.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new w(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new w(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new w(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new w(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var b=class t{constructor(e){this.path=e}static fromPath(e){return new t(ce.fromString(e))}static fromName(e){return new t(ce.fromString(e).popFirst(5))}static empty(){return new t(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ce.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new ce(e.slice()))}};var _a=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function Hw(t){return t.fields.find(e=>e.kind===2)}function Is(t){return t.fields.filter(e=>e.kind!==2)}_a.UNKNOWN_ID=-1;var pa=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var tl=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,mn.min())}};function yN(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=L.fromTimestamp(r===1e9?new ke(n+1,0):new ke(n,r));return new mn(i,b.empty(),e)}function _N(t){return new mn(t.readTime,t.key,-1)}var mn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(L.min(),b.empty(),-1)}static max(){return new t(L.max(),b.empty(),-1)}};function OI(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=b.comparator(t.documentKey,e.documentKey),n!==0?n:Q(t.largestBatchId,e.largestBatchId))}var vN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",dp=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ri(t){return _(this,null,function*(){if(t.code!==y.FAILED_PRECONDITION||t.message!==vN)throw t;E("LocalStore","Unexpectedly lost primary lease")})}var m=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&R(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let c=u;n(e[c]).next(l=>{o[c]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var hp=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Ye,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new As(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=FI(r.target.error);this.V.reject(new As(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new As(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(E("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new Gw(n)}},Ii=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(au())===12.2&&$e("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return E("SimpleDb","Removing database:",e),Cs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!pd())return!1;if(t.C())return!0;let e=au(),n=t.S(e),r=0<n&&n<10,i=wN(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return _(this,null,function*(){return this.db||(E("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new As(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new w(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new w(y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new As(e,o))},i.onupgradeneeded=s=>{E("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{E("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return _(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=hp.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),m.reject(c))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,c=u.name!=="FirebaseError"&&o<3;if(E("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function wN(t){let e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}var qw=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Cs(this.B.delete())}},As=class extends w{constructor(e,n){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function Ni(t){return t.name==="IndexedDbTransactionError"}var Gw=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(E("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(E("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Cs(r)}add(e){return E("SimpleDb","ADD",this.store.name,e,e),Cs(this.store.add(e))}get(e){return Cs(this.store.get(e)).next(n=>(n===void 0&&(n=null),E("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return E("SimpleDb","DELETE",this.store.name,e),Cs(this.store.delete(e))}count(){return E("SimpleDb","COUNT",this.store.name),Cs(this.store.count())}U(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new m((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,u)=>{o.push(u)}).next(()=>o)}}G(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new m((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){E("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.W(i,n)}Y(e){let n=this.cursor({});return new m((r,i)=>{n.onerror=s=>{let o=FI(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){let r=[];return new m((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let u=new qw(a),c=n(a.primaryKey,a.value,u);if(c instanceof m){let l=c.catch(d=>(u.done(),m.reject(d)));r.push(l)}u.isDone?i():u.K===null?a.continue():a.continue(u.K)}}).next(()=>m.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function Cs(t){return new m((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=FI(r.target.error);n(i)}})}var gR=!1;function FI(t){let e=Ii.S(au());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new w("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return gR||(gR=!0,setTimeout(()=>{throw r},0)),r}}return t}var zw=class{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){E("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>_(this,null,function*(){this.task=null;try{E("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(n){Ni(n)?E("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Ri(n)}yield this.X(6e4)}))}},Ww=class{constructor(e,n){this.localStore=e,this.persistence=n}ee(e=50){return _(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))})}te(e,n){let r=new Set,i=n,s=!0;return m.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return E("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(E("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=_N(s);OI(o,r)>0&&(r=o)}),new mn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var Zt=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.se&&this.se(n),n}}return t.oe=-1,t})();function Cl(t){return t==null}function nl(t){return t===0&&1/t==-1/0}function EN(t){return typeof t=="number"&&Number.isInteger(t)&&!nl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Pt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=mR(e)),e=OG(t.get(n),e);return mR(e)}function OG(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function mR(t){return t+""}function nr(t){let e=t.length;if(O(e>=2),e===2)return O(t.charAt(0)===""&&t.charAt(1)===""),ce.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&R(),t.charAt(o+1)){case"":let a=t.substring(s,o),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:R()}s=o+2}return new ce(r)}var yR=["userId","batchId"];function np(t,e){return[t,Pt(e)]}function IN(t,e,n){return[t,Pt(e),n]}var FG={},VG=["prefixPath","collectionGroup","readTime","documentId"],LG=["prefixPath","collectionGroup","documentId"],jG=["collectionGroup","readTime","prefixPath","documentId"],UG=["canonicalId","targetId"],BG=["targetId","path"],$G=["path","targetId"],HG=["collectionId","parent"],qG=["indexId","uid"],GG=["uid","sequenceNumber"],zG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],WG=["indexId","uid","orderedDocumentKey"],KG=["userId","collectionPath","documentId"],QG=["userId","collectionPath","largestBatchId"],YG=["userId","collectionGroup","largestBatchId"],CN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ZG=[...CN,"documentOverlays"],DN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],TN=DN,bN=[...TN,"indexConfiguration","indexState","indexEntries"],JG=bN;var rl=class extends dp{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}};function ut(t,e){let n=S(t);return Ii.F(n._e,e)}function _R(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Us(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function SN(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Re=class t{constructor(e,n){this.comparator=e,this.root=n||ir.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ir.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ir.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fa(this.root,e,this.comparator,!1)}getReverseIterator(){return new fa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fa(this.root,e,this.comparator,!0)}},fa=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ir=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw R();let e=this.left.check();if(e!==this.right.check())throw R();return e+(this.isRed()?0:1)}};ir.EMPTY=null,ir.RED=!0,ir.BLACK=!1;ir.EMPTY=new class{constructor(){this.size=0}get key(){throw R()}get value(){throw R()}get color(){throw R()}get left(){throw R()}get right(){throw R()}copy(e,n,r,i,s){return this}insert(e,n,r){return new ir(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var De=class t{constructor(e){this.comparator=e,this.data=new Re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new fp(this.data.getIterator())}getIteratorFrom(e){return new fp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},fp=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function ia(t){return t.hasNext()?t.getNext():void 0}var Jt=class t{constructor(e){this.fields=e,e.sort(He.comparator)}static empty(){return new t([])}unionWith(e){let n=new De(He.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ya(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var pp=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function AN(){return typeof atob<"u"}var at=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new pp("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Q(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};at.EMPTY_BYTE_STRING=new at("");var XG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Or(t){if(O(!!t),typeof t=="string"){let e=0,n=XG.exec(t);if(O(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Le(t.seconds),nanos:Le(t.nanos)}}function Le(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ci(t){return typeof t=="string"?at.fromBase64String(t):at.fromUint8Array(t)}function ig(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function VI(t){let e=t.mapValue.fields.__previous_value__;return ig(e)?VI(e):e}function il(t){let e=Or(t.mapValue.fields.__local_write_time__.timestampValue);return new ke(e.seconds,e.nanos)}var Kw=class{constructor(e,n,r,i,s,o,a,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}},Di=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var vi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},rp={nullValue:"NULL_VALUE"};function xs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ig(t)?4:xN(t)?9007199254740991:10:R()}function ar(t,e){if(t===e)return!0;let n=xs(t);if(n!==xs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return il(t).isEqual(il(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Or(i.timestampValue),a=Or(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ci(i.bytesValue).isEqual(Ci(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Le(i.geoPointValue.latitude)===Le(s.geoPointValue.latitude)&&Le(i.geoPointValue.longitude)===Le(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Le(i.integerValue)===Le(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Le(i.doubleValue),a=Le(s.doubleValue);return o===a?nl(o)===nl(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ya(t.arrayValue.values||[],e.arrayValue.values||[],ar);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(_R(o)!==_R(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!ar(o[u],a[u])))return!1;return!0}(t,e);default:return R()}}function sl(t,e){return(t.values||[]).find(n=>ar(n,e))!==void 0}function Ti(t,e){if(t===e)return 0;let n=xs(t),r=xs(e);if(n!==r)return Q(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Q(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Le(s.integerValue||s.doubleValue),u=Le(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return vR(t.timestampValue,e.timestampValue);case 4:return vR(il(t),il(e));case 5:return Q(t.stringValue,e.stringValue);case 6:return function(s,o){let a=Ci(s),u=Ci(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){let l=Q(a[c],u[c]);if(l!==0)return l}return Q(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=Q(Le(s.latitude),Le(o.latitude));return a!==0?a:Q(Le(s.longitude),Le(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],u=o.values||[];for(let c=0;c<a.length&&c<u.length;++c){let l=Ti(a[c],u[c]);if(l)return l}return Q(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===vi.mapValue&&o===vi.mapValue)return 0;if(s===vi.mapValue)return 1;if(o===vi.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),c=o.fields||{},l=Object.keys(c);u.sort(),l.sort();for(let d=0;d<u.length&&d<l.length;++d){let h=Q(u[d],l[d]);if(h!==0)return h;let f=Ti(a[u[d]],c[l[d]]);if(f!==0)return f}return Q(u.length,l.length)}(t.mapValue,e.mapValue);default:throw R()}}function vR(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Q(t,e);let n=Or(t),r=Or(e),i=Q(n.seconds,r.seconds);return i!==0?i:Q(n.nanos,r.nanos)}function va(t){return Qw(t)}function Qw(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Or(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ci(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return b.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=Qw(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Qw(n.fields[o])}`;return i+"}"}(t.mapValue):R()}function Ms(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Yw(t){return!!t&&"integerValue"in t}function ol(t){return!!t&&"arrayValue"in t}function wR(t){return!!t&&"nullValue"in t}function ER(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ip(t){return!!t&&"mapValue"in t}function Yc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return Us(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Yc(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Yc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function xN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function e4(t){return"nullValue"in t?rp:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ms(Di.empty(),b.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:R()}function t4(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ms(Di.empty(),b.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?vi:R()}function IR(t,e){let n=Ti(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function CR(t,e){let n=Ti(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var St=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!ip(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yc(n)}setAll(e){let n=He.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Yc(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());ip(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ar(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];ip(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Us(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(Yc(this.value))}};function MN(t){let e=[];return Us(t.fields,(n,r)=>{let i=new He([n]);if(ip(r)){let s=MN(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Jt(e)}var Ze=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,L.min(),L.min(),L.min(),St.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,L.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,L.min(),L.min(),St.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,L.min(),L.min(),St.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(L.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=St.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=St.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=L.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var ur=class{constructor(e,n){this.position=e,this.inclusive=n}};function DR(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=b.comparator(b.fromName(o.referenceValue),n.key):r=Ti(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function TR(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ar(t.position[n],e.position[n]))return!1;return!0}var Rs=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function n4(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var gp=class{},oe=class t extends gp{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Xw(e,n,r):n==="array-contains"?new nE(e,r):n==="in"?new mp(e,r):n==="not-in"?new rE(e,r):n==="array-contains-any"?new iE(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new eE(e,r):new tE(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ti(n,this.value)):n!==null&&xs(this.value)===xs(n)&&this.matchesComparison(Ti(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return R()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},we=class t extends gp{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new t(e,n)}matches(e){return wa(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function wa(t){return t.op==="and"}function Zw(t){return t.op==="or"}function LI(t){return RN(t)&&wa(t)}function RN(t){for(let e of t.filters)if(e instanceof we)return!1;return!0}function Jw(t){if(t instanceof oe)return t.field.canonicalString()+t.op.toString()+va(t.value);if(LI(t))return t.filters.map(e=>Jw(e)).join(",");{let e=t.filters.map(n=>Jw(n)).join(",");return`${t.op}(${e})`}}function NN(t,e){return t instanceof oe?function(r,i){return i instanceof oe&&r.op===i.op&&r.field.isEqual(i.field)&&ar(r.value,i.value)}(t,e):t instanceof we?function(r,i){return i instanceof we&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&NN(o,i.filters[a]),!0):!1}(t,e):void R()}function PN(t,e){let n=t.filters.concat(e);return we.create(n,t.op)}function kN(t){return t instanceof oe?function(n){return`${n.field.canonicalString()} ${n.op} ${va(n.value)}`}(t):t instanceof we?function(n){return n.op.toString()+" {"+n.getFilters().map(kN).join(" ,")+"}"}(t):"Filter"}var Xw=class extends oe{constructor(e,n,r){super(e,n,r),this.key=b.fromName(r.referenceValue)}matches(e){let n=b.comparator(e.key,this.key);return this.matchesComparison(n)}},eE=class extends oe{constructor(e,n){super(e,"in",n),this.keys=ON("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},tE=class extends oe{constructor(e,n){super(e,"not-in",n),this.keys=ON("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function ON(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>b.fromName(r.referenceValue))}var nE=class extends oe{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return ol(n)&&sl(n.arrayValue,this.value)}},mp=class extends oe{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&sl(this.value.arrayValue,n)}},rE=class extends oe{constructor(e,n){super(e,"not-in",n)}matches(e){if(sl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!sl(this.value.arrayValue,n)}},iE=class extends oe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!ol(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>sl(this.value.arrayValue,r))}};var sE=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function oE(t,e=null,n=[],r=[],i=null,s=null,o=null){return new sE(t,e,n,r,i,s,o)}function Ns(t){let e=S(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Jw(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Cl(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>va(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>va(r)).join(",")),e.ue=n}return e.ue}function Dl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!n4(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!NN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!TR(t.startAt,e.startAt)&&TR(t.endAt,e.endAt)}function yp(t){return b.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function _p(t,e){return t.filters.filter(n=>n instanceof oe&&n.field.isEqual(e))}function bR(t,e,n){let r=rp,i=!0;for(let s of _p(t,e)){let o=rp,a=!0;switch(s.op){case"<":case"<=":o=e4(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=rp}IR({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];IR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function SR(t,e,n){let r=vi,i=!0;for(let s of _p(t,e)){let o=vi,a=!0;switch(s.op){case">=":case">":o=t4(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=vi}CR({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];CR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var Pn=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function FN(t,e,n,r,i,s,o,a){return new Pn(t,e,n,r,i,s,o,a)}function Oa(t){return new Pn(t)}function AR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function jI(t){return t.collectionGroup!==null}function ga(t){let e=S(t);if(e.ce===null){e.ce=[];let n=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new De(He.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Rs(s,r))}),n.has(He.keyField().canonicalString())||e.ce.push(new Rs(He.keyField(),r))}return e.ce}function kt(t){let e=S(t);return e.le||(e.le=r4(e,ga(t))),e.le}function r4(t,e){if(t.limitType==="F")return oE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Rs(i.field,s)});let n=t.endAt?new ur(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ur(t.startAt.position,t.startAt.inclusive):null;return oE(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function aE(t,e){let n=t.filters.concat([e]);return new Pn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function vp(t,e,n){return new Pn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Tl(t,e){return Dl(kt(t),kt(e))&&t.limitType===e.limitType}function VN(t){return`${Ns(kt(t))}|lt:${t.limitType}`}function ca(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>kN(i)).join(", ")}]`),Cl(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>va(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>va(i)).join(",")),`Target(${r})`}(kt(t))}; limitType=${t.limitType})`}function bl(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):b.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of ga(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let c=DR(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,ga(r),i)||r.endAt&&!function(o,a,u){let c=DR(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,ga(r),i))}(t,e)}function LN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function jN(t){return(e,n)=>{let r=!1;for(let i of ga(t)){let s=i4(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function i4(t,e,n){let r=t.field.isKeyField()?b.comparator(e.key,n.key):function(s,o,a){let u=o.data.field(s),c=a.data.field(s);return u!==null&&c!==null?Ti(u,c):R()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return R()}}var cr=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Us(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return SN(this.inner)}size(){return this.innerSize}};var s4=new Re(b.comparator);function qt(){return s4}var UN=new Re(b.comparator);function Kc(...t){let e=UN;for(let n of t)e=e.insert(n.key,n);return e}function BN(t){let e=UN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function rr(){return Zc()}function $N(){return Zc()}function Zc(){return new cr(t=>t.toString(),(t,e)=>t.isEqual(e))}var o4=new Re(b.comparator),a4=new De(b.comparator);function Z(...t){let e=a4;for(let n of t)e=e.add(n);return e}var u4=new De(Q);function UI(){return u4}function HN(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nl(e)?"-0":e}}function qN(t){return{integerValue:""+t}}function GN(t,e){return EN(e)?qN(e):HN(t,e)}var Ea=class{constructor(){this._=void 0}};function c4(t,e,n){return t instanceof bi?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ig(s)&&(s=VI(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Fr?WN(t,e):t instanceof Vr?KN(t,e):function(i,s){let o=zN(i,s),a=xR(o)+xR(i.Pe);return Yw(o)&&Yw(i.Pe)?qN(a):HN(i.serializer,a)}(t,e)}function l4(t,e,n){return t instanceof Fr?WN(t,e):t instanceof Vr?KN(t,e):n}function zN(t,e){return t instanceof Si?function(r){return Yw(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var bi=class extends Ea{},Fr=class extends Ea{constructor(e){super(),this.elements=e}};function WN(t,e){let n=QN(e);for(let r of t.elements)n.some(i=>ar(i,r))||n.push(r);return{arrayValue:{values:n}}}var Vr=class extends Ea{constructor(e){super(),this.elements=e}};function KN(t,e){let n=QN(e);for(let r of t.elements)n=n.filter(i=>!ar(i,r));return{arrayValue:{values:n}}}var Si=class extends Ea{constructor(e,n){super(),this.serializer=e,this.Pe=n}};function xR(t){return Le(t.integerValue||t.doubleValue)}function QN(t){return ol(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ps=class{constructor(e,n){this.field=e,this.transform=n}};function d4(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Fr&&i instanceof Fr||r instanceof Vr&&i instanceof Vr?ya(r.elements,i.elements,ar):r instanceof Si&&i instanceof Si?ar(r.Pe,i.Pe):r instanceof bi&&i instanceof bi}(t.transform,e.transform)}var uE=class{constructor(e,n){this.version=e,this.transformResults=n}},je=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function sp(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Ia=class{};function YN(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new xi(t.key,je.none()):new Ai(t.key,t.data,je.none());{let n=t.data,r=St.empty(),i=new De(He.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new kn(t.key,r,new Jt(i.toArray()),je.none())}}function h4(t,e,n){t instanceof Ai?function(i,s,o){let a=i.value.clone(),u=RR(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof kn?function(i,s,o){if(!sp(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=RR(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(ZN(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Jc(t,e,n,r){return t instanceof Ai?function(s,o,a,u){if(!sp(s.precondition,o))return a;let c=s.value.clone(),l=NR(s.fieldTransforms,u,o);return c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof kn?function(s,o,a,u){if(!sp(s.precondition,o))return a;let c=NR(s.fieldTransforms,u,o),l=o.data;return l.setAll(ZN(s)),l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return sp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function f4(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=zN(r.transform,i||null);s!=null&&(n===null&&(n=St.empty()),n.set(r.field,s))}return n||null}function MR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ya(r,i,(s,o)=>d4(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Ai=class extends Ia{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},kn=class extends Ia{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function ZN(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function RR(t,e,n){let r=new Map;O(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,l4(o,a,n[i]))}return r}function NR(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,c4(s,o,e))}return r}var xi=class extends Ia{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},al=class extends Ia{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var ul=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&h4(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Jc(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Jc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=$N();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let u=YN(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(L.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Z())}isEqual(e){return this.batchId===e.batchId&&ya(this.mutations,e.mutations,(n,r)=>MR(n,r))&&ya(this.baseMutations,e.baseMutations,(n,r)=>MR(n,r))}},cE=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){O(e.mutations.length===r.length);let i=function(){return o4}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var cl=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var lE=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var We,ue;function JN(t){switch(t){default:return R();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function XN(t){if(t===void 0)return $e("GRPC error has no .code"),y.UNKNOWN;switch(t){case We.OK:return y.OK;case We.CANCELLED:return y.CANCELLED;case We.UNKNOWN:return y.UNKNOWN;case We.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case We.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case We.INTERNAL:return y.INTERNAL;case We.UNAVAILABLE:return y.UNAVAILABLE;case We.UNAUTHENTICATED:return y.UNAUTHENTICATED;case We.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case We.NOT_FOUND:return y.NOT_FOUND;case We.ALREADY_EXISTS:return y.ALREADY_EXISTS;case We.PERMISSION_DENIED:return y.PERMISSION_DENIED;case We.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case We.ABORTED:return y.ABORTED;case We.OUT_OF_RANGE:return y.OUT_OF_RANGE;case We.UNIMPLEMENTED:return y.UNIMPLEMENTED;case We.DATA_LOSS:return y.DATA_LOSS;default:return R()}}(ue=We||(We={}))[ue.OK=0]="OK",ue[ue.CANCELLED=1]="CANCELLED",ue[ue.UNKNOWN=2]="UNKNOWN",ue[ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ue[ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ue[ue.NOT_FOUND=5]="NOT_FOUND",ue[ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",ue[ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",ue[ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",ue[ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ue[ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ue[ue.ABORTED=10]="ABORTED",ue[ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",ue[ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",ue[ue.INTERNAL=13]="INTERNAL",ue[ue.UNAVAILABLE=14]="UNAVAILABLE",ue[ue.DATA_LOSS=15]="DATA_LOSS";var PR=null;function eP(){return new TextEncoder}var p4=new ws([4294967295,4294967295],0);function kR(t){let e=eP().encode(t),n=new fR;return n.update(e),new Uint8Array(n.digest())}function OR(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ws([n,r],0),new ws([i,s],0)]}var dE=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ss(`Invalid padding: ${n}`);if(r<0)throw new Ss(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ss(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ss(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=ws.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(ws.fromNumber(r)));return i.compare(p4)===1&&(i=new ws([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let n=kR(e),[r,i]=OR(n);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let n=kR(e),[r,i]=OR(n);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Ss=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ll=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,dl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(L.min(),i,new Re(Q),qt(),Z())}},dl=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,Z(),Z(),Z())}};var ma=class{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}},wp=class{constructor(e,n){this.targetId=e,this.me=n}},Ep=class{constructor(e,n,r=at.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},Ip=class{constructor(){this.fe=0,this.ge=VR(),this.pe=at.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=Z(),n=Z(),r=Z();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:R()}}),new dl(this.pe,this.ye,e,n,r)}ve(){this.we=!1,this.ge=VR()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,O(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},hE=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=qt(),this.qe=FR(),this.Qe=new Re(Q)}Ke(e){for(let n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(let n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{let r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:R()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){let n=e.targetId,r=e.me.count,i=this.Je(n);if(i){let s=i.target;if(yp(s))if(r===0){let o=new b(s.path);this.Ue(n,o,Ze.newNoDocument(o,L.min()))}else O(r===1);else{let o=this.Ye(n);if(o!==r){let a=this.Ze(e),u=a?this.Xe(a,e,o):1;if(u!==0){this.je(n);let c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}PR?.et(function(l,d,h,f,p){var g,v,C,N,T,j;let H={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},W=d.unchangedNames;return W&&(H.bloomFilter={applied:p===0,hashCount:(g=W?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(N=(C=(v=W?.bits)===null||v===void 0?void 0:v.bitmap)===null||C===void 0?void 0:C.length)!==null&&N!==void 0?N:0,padding:(j=(T=W?.bits)===null||T===void 0?void 0:T.padding)!==null&&j!==void 0?j:0,mightContain:Ee=>{var jt;return(jt=f?.mightContain(Ee))!==null&&jt!==void 0&&jt}}),H}(o,e.me,this.Le.tt(),a,u))}}}}Ze(e){let n=e.me.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=Ci(r).toUint8Array()}catch(u){if(u instanceof pp)return gn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new dE(o,i,s)}catch(u){return gn(u instanceof Ss?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){let n=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&yp(a.target)){let u=new b(a.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,Ze.newNoDocument(u,e))}s.be&&(n.set(o,s.Ce()),s.ve())}});let r=Z();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{let c=this.Je(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new ll(e,n,this.Qe,this.ke,r);return this.ke=qt(),this.qe=FR(),this.Qe=new Re(Q),i}$e(e,n){if(!this.ze(e))return;let r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let n=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Ip,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new De(Q),this.qe=this.qe.insert(e,n)),n}ze(e){let n=this.Je(e)!==null;return n||E("WatchChangeAggregator","Detected inactive target",e),n}Je(e){let n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ip),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function FR(){return new Re(b.comparator)}function VR(){return new Re(b.comparator)}var g4={asc:"ASCENDING",desc:"DESCENDING"},m4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},y4={and:"AND",or:"OR"},fE=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function pE(t,e){return t.useProto3Json||Cl(e)?e:{value:e}}function Ca(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function tP(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function _4(t,e){return Ca(t,e.toTimestamp())}function qe(t){return O(!!t),L.fromTimestamp(function(n){let r=Or(n);return new ke(r.seconds,r.nanos)}(t))}function BI(t,e){return gE(t,e).canonicalString()}function gE(t,e){let n=function(i){return new ce(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function nP(t){let e=ce.fromString(t);return O(hP(e)),e}function hl(t,e){return BI(t.databaseId,e.path)}function sr(t,e){let n=nP(e);if(n.get(1)!==t.databaseId.projectId)throw new w(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new w(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new b(sP(n))}function rP(t,e){return BI(t.databaseId,e)}function iP(t){let e=nP(t);return e.length===4?ce.emptyPath():sP(e)}function mE(t){return new ce(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function sP(t){return O(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function LR(t,e,n){return{name:hl(t,e),fields:n.value.mapValue.fields}}function oP(t,e,n){let r=sr(t,e.name),i=qe(e.updateTime),s=e.createTime?qe(e.createTime):L.min(),o=new St({mapValue:{fields:e.fields}}),a=Ze.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function v4(t,e){return"found"in e?function(r,i){O(!!i.found),i.found.name,i.found.updateTime;let s=sr(r,i.found.name),o=qe(i.found.updateTime),a=i.found.createTime?qe(i.found.createTime):L.min(),u=new St({mapValue:{fields:i.found.fields}});return Ze.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){O(!!i.missing),O(!!i.readTime);let s=sr(r,i.missing),o=qe(i.readTime);return Ze.newNoDocument(s,o)}(t,e):R()}function w4(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:R()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(O(l===void 0||typeof l=="string"),at.fromBase64String(l||"")):(O(l===void 0||l instanceof Buffer||l instanceof Uint8Array),at.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let l=c.code===void 0?y.UNKNOWN:XN(c.code);return new w(l,c.message||"")}(o);n=new Ep(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=sr(t,r.document.name),s=qe(r.document.updateTime),o=r.document.createTime?qe(r.document.createTime):L.min(),a=new St({mapValue:{fields:r.document.fields}}),u=Ze.newFoundDocument(i,s,o,a),c=r.targetIds||[],l=r.removedTargetIds||[];n=new ma(c,l,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=sr(t,r.document),s=r.readTime?qe(r.readTime):L.min(),o=Ze.newNoDocument(i,s),a=r.removedTargetIds||[];n=new ma([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=sr(t,r.document),s=r.removedTargetIds||[];n=new ma([],s,i,null)}else{if(!("filter"in e))return R();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new lE(i,s),a=r.targetId;n=new wp(a,o)}}return n}function fl(t,e){let n;if(e instanceof Ai)n={update:LR(t,e.key,e.value)};else if(e instanceof xi)n={delete:hl(t,e.key)};else if(e instanceof kn)n={update:LR(t,e.key,e.data),updateMask:b4(e.fieldMask)};else{if(!(e instanceof al))return R();n={verify:hl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof bi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Fr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Vr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Si)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw R()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:_4(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:R()}(t,e.precondition)),n}function yE(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?je.updateTime(qe(s.updateTime)):s.exists!==void 0?je.exists(s.exists):je.none()}(e.currentDocument):je.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)O(a.setToServerValue==="REQUEST_TIME"),u=new bi;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];u=new Fr(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];u=new Vr(l)}else"increment"in a?u=new Si(o,a.increment):R();let c=He.fromServerFormat(a.fieldPath);return new Ps(c,u)}(t,i)):[];if(e.update){e.update.name;let i=sr(t,e.update.name),s=new St({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(u){let c=u.fieldPaths||[];return new Jt(c.map(l=>He.fromServerFormat(l)))}(e.updateMask);return new kn(i,s,o,n,r)}return new Ai(i,s,n,r)}if(e.delete){let i=sr(t,e.delete);return new xi(i,n)}if(e.verify){let i=sr(t,e.verify);return new al(i,n)}return R()}function E4(t,e){return t&&t.length>0?(O(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?qe(i.updateTime):qe(s);return o.isEqual(L.min())&&(o=qe(s)),new uE(o,i.transformResults||[])}(n,e))):[]}function aP(t,e){return{documents:[rP(t,e.path)]}}function uP(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=rP(t,i);let s=function(c){if(c.length!==0)return dP(we.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(c){if(c.length!==0)return c.map(l=>function(h){return{field:la(h.field),direction:C4(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=pE(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:i}}function cP(t){let e=iP(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){O(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=lP(d);return h instanceof we&&LI(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new Rs(da(p.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Cl(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(d){let h=!!d.before,f=d.values||[];return new ur(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){let h=!d.before,f=d.values||[];return new ur(f,h)}(n.endAt)),FN(e,i,o,s,a,"F",u,c)}function I4(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return R()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function lP(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=da(n.unaryFilter.field);return oe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=da(n.unaryFilter.field);return oe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=da(n.unaryFilter.field);return oe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=da(n.unaryFilter.field);return oe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return R()}}(t):t.fieldFilter!==void 0?function(n){return oe.create(da(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return R()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return we.create(n.compositeFilter.filters.map(r=>lP(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return R()}}(n.compositeFilter.op))}(t):R()}function C4(t){return g4[t]}function D4(t){return m4[t]}function T4(t){return y4[t]}function la(t){return{fieldPath:t.canonicalString()}}function da(t){return He.fromServerFormat(t.fieldPath)}function dP(t){return t instanceof oe?function(n){if(n.op==="=="){if(ER(n.value))return{unaryFilter:{field:la(n.field),op:"IS_NAN"}};if(wR(n.value))return{unaryFilter:{field:la(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ER(n.value))return{unaryFilter:{field:la(n.field),op:"IS_NOT_NAN"}};if(wR(n.value))return{unaryFilter:{field:la(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:la(n.field),op:D4(n.op),value:n.value}}}(t):t instanceof we?function(n){let r=n.getFilters().map(i=>dP(i));return r.length===1?r[0]:{compositeFilter:{op:T4(n.op),filters:r}}}(t):R()}function b4(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function hP(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Da=class t{constructor(e,n,r,i,s=L.min(),o=L.min(),a=at.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Cp=class{constructor(e){this.ut=e}};function S4(t,e){let n;if(e.document)n=oP(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=b.fromSegments(e.noDocument.path),i=Os(e.noDocument.readTime);n=Ze.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return R();{let r=b.fromSegments(e.unknownDocument.path),i=Os(e.unknownDocument.version);n=Ze.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new ke(i[0],i[1]);return L.fromTimestamp(s)}(e.readTime)),n}function jR(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Dp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:hl(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ca(s,o.version.toTimestamp()),createTime:Ca(s,o.createTime.toTimestamp())}}(t.ut,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ks(e.version)};else{if(!e.isUnknownDocument())return R();r.unknownDocument={path:n.path.toArray(),version:ks(e.version)}}return r}function Dp(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ks(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Os(t){let e=new ke(t.seconds,t.nanoseconds);return L.fromTimestamp(e)}function Ds(t,e){let n=(e.baseMutations||[]).map(s=>yE(t.ut,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>yE(t.ut,s)),i=ke.fromMillis(e.localWriteTimeMs);return new ul(e.batchId,i,n,r)}function Qc(t){let e=Os(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Os(t.lastLimboFreeSnapshotVersion):L.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return O(s.documents.length===1),kt(Oa(iP(s.documents[0])))}(t.query):function(s){return kt(cP(s))}(t.query),new Da(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,at.fromBase64String(t.resumeToken))}function fP(t,e){let n=ks(e.snapshotVersion),r=ks(e.lastLimboFreeSnapshotVersion),i;i=yp(e.target)?aP(t.ut,e.target):uP(t.ut,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ns(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function $I(t){let e=cP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?vp(e,e.limit,"L"):e}function Nw(t,e){return new cl(e.largestBatchId,yE(t.ut,e.overlayMutation))}function UR(t,e){let n=e.path.lastSegment();return[t,Pt(e.path.popLast()),n]}function BR(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ks(r.readTime),documentKey:Pt(r.documentKey.path),largestBatchId:r.largestBatchId}}var _E=class{getBundleMetadata(e,n){return $R(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Os(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return $R(e).put(function(i){return{bundleId:i.id,createTime:ks(qe(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return HR(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:$I(s.bundledQuery),readTime:Os(s.readTime)}}(r)})}saveNamedQuery(e,n){return HR(e).put(function(i){return{name:i.name,readTime:ks(qe(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function $R(t){return ut(t,"bundles")}function HR(t){return ut(t,"namedQueries")}var Tp=class t{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return qc(e).get(UR(this.userId,n)).next(r=>r?Nw(this.serializer,r):null)}getOverlays(e,n){let r=rr();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new cl(n,o);i.push(this.lt(e,a))}),m.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(Pt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(qc(e).j("collectionPathOverlayIndex",a))}),m.waitFor(s)}getOverlaysForCollection(e,n,r){let i=rr(),s=Pt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return qc(e).U("collectionPathOverlayIndex",o).next(a=>{for(let u of a){let c=Nw(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=rr(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return qc(e).J({index:"collectionGroupOverlayIndex",range:a},(u,c,l)=>{let d=Nw(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}lt(e,n){return qc(e).put(function(i,s,o){let[a,u,c]=UR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:fl(i.ut,o.mutation)}}(this.serializer,this.userId,n))}};function qc(t){return ut(t,"documentOverlays")}var Pr=class{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(Le(e.integerValue));else if("doubleValue"in e){let r=Le(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),nl(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Tt(n,20),typeof r=="string"&&(r=Or(r)),n.dt(`${r.seconds||""}`),n.Et(r.nanos||0)}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(Ci(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?xN(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):R()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){let r=e.fields||{};this.Tt(n,55);for(let i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){let r=e.values||[];this.Tt(n,50);for(let i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),b.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}};Pr.St=new Pr;function A4(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function qR(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=A4(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var vE=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{let i=n.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){let n=this.Lt(e),r=qR(n);this.Bt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}kt(e){let n=this.Lt(e),r=qR(n);this.Bt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Bt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Lt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Dt(e){let n=255&e;n===0?(this.Qt(0),this.Qt(255)):n===255?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){let n=255&e;n===0?(this.$t(0),this.$t(255)):n===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Bt(1),this.buffer[this.position++]=e}$t(e){this.Bt(1),this.buffer[this.position++]=~e}Bt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},wE=class{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}},EE=class{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}},Ts=class{constructor(){this.Wt=new vE,this.Gt=new wE(this.Wt),this.zt=new EE(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}};var bs=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ht(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function gi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=GR(t.arrayValue,e.arrayValue),n!==0?n:(n=GR(t.directionalValue,e.directionalValue),n!==0?n:b.comparator(t.documentKey,e.documentKey)))}function GR(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var bp=class{constructor(e){this.Jt=new De((n,r)=>He.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(O(e.collectionGroup===this.collectionId),this.Xt)return!1;let n=Hw(e);if(n!==void 0&&!this.tn(n))return!1;let r=Is(e),i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){let a=this.Jt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[s];if(!this.nn(a,u)||!this.rn(this.Yt[o++],u))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Yt.length||!this.rn(this.Yt[o++],a))return!1}return!0}sn(){if(this.Xt)return null;let e=new De(He.comparator),n=[];for(let r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new pa(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new pa(r.field,0))}for(let r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new pa(r.field,r.dir==="asc"?0:1)));return new _a(_a.UNKNOWN_ID,this.collectionId,n,tl.empty())}tn(e){for(let n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function pP(t){var e,n;if(O(t instanceof oe||t instanceof we),t instanceof oe){if(t instanceof mp){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>oe.create(t.field,"==",s)))||[];return we.create(i,"or")}return t}let r=t.filters.map(i=>pP(i));return we.create(r,t.op)}function x4(t){if(t.getFilters().length===0)return[];let e=DE(pP(t));return O(gP(e)),IE(e)||CE(e)?[e]:e.getFilters()}function IE(t){return t instanceof oe}function CE(t){return t instanceof we&&LI(t)}function gP(t){return IE(t)||CE(t)||function(n){if(n instanceof we&&Zw(n)){for(let r of n.getFilters())if(!IE(r)&&!CE(r))return!1;return!0}return!1}(t)}function DE(t){if(O(t instanceof oe||t instanceof we),t instanceof oe)return t;if(t.filters.length===1)return DE(t.filters[0]);let e=t.filters.map(r=>DE(r)),n=we.create(e,t.op);return n=Sp(n),gP(n)?n:(O(n instanceof we),O(wa(n)),O(n.filters.length>1),n.filters.reduce((r,i)=>HI(r,i)))}function HI(t,e){let n;return O(t instanceof oe||t instanceof we),O(e instanceof oe||e instanceof we),n=t instanceof oe?e instanceof oe?function(i,s){return we.create([i,s],"and")}(t,e):zR(t,e):e instanceof oe?zR(e,t):function(i,s){if(O(i.filters.length>0&&s.filters.length>0),wa(i)&&wa(s))return PN(i,s.getFilters());let o=Zw(i)?i:s,a=Zw(i)?s:i,u=o.filters.map(c=>HI(c,a));return we.create(u,"or")}(t,e),Sp(n)}function zR(t,e){if(wa(e))return PN(e,t.getFilters());{let n=e.filters.map(r=>HI(t,r));return we.create(n,"or")}}function Sp(t){if(O(t instanceof oe||t instanceof we),t instanceof oe)return t;let e=t.getFilters();if(e.length===1)return Sp(e[0]);if(RN(t))return t;let n=e.map(i=>Sp(i)),r=[];return n.forEach(i=>{i instanceof oe?r.push(i):i instanceof we&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:we.create(r,t.op)}var TE=class{constructor(){this.on=new pl}addToCollectionParentIndex(e,n){return this.on.add(n),m.resolve()}getCollectionParents(e,n){return m.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return m.resolve()}deleteFieldIndex(e,n){return m.resolve()}deleteAllFieldIndexes(e){return m.resolve()}createTargetIndexes(e,n){return m.resolve()}getDocumentsMatchingTarget(e,n){return m.resolve(null)}getIndexType(e,n){return m.resolve(0)}getFieldIndexes(e,n){return m.resolve([])}getNextCollectionGroupToUpdate(e){return m.resolve(null)}getMinOffset(e,n){return m.resolve(mn.min())}getMinOffsetFromCollectionGroup(e,n){return m.resolve(mn.min())}updateCollectionGroup(e,n,r){return m.resolve()}updateIndexEntries(e,n){return m.resolve()}},pl=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new De(ce.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new De(ce.comparator)).toArray()}};var Jf=new Uint8Array(0),bE=class{constructor(e,n){this.databaseId=n,this._n=new pl,this.an=new cr(r=>Ns(r),(r,i)=>Dl(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});let s={collectionId:r,parent:Pt(i)};return WR(e).put(s)}return m.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[mN(n),""],!1,!0);return WR(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(nr(o.parent))}return r})}addFieldIndex(e,n){let r=Gc(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=oa(e);return s.next(a=>{o.put(BR(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=Gc(e),i=oa(e),s=sa(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=Gc(e),r=sa(e),i=oa(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return m.forEach(this.un(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new bp(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=sa(e),i=!0,s=new Map;return m.forEach(this.un(n),o=>this.cn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Z(),a=[];return m.forEach(s,(u,c)=>{E("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(j=>`${j.fieldPath}:${j.kind}`).join(",")}`}(u)} to execute ${Ns(n)}`);let l=function(T,j){let H=Hw(j);if(H===void 0)return null;for(let W of _p(T,H.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null}(c,u),d=function(T,j){let H=new Map;for(let W of Is(j))for(let Ee of _p(T,W.fieldPath))switch(Ee.op){case"==":case"in":H.set(W.fieldPath.canonicalString(),Ee.value);break;case"not-in":case"!=":return H.set(W.fieldPath.canonicalString(),Ee.value),Array.from(H.values())}return null}(c,u),h=function(T,j){let H=[],W=!0;for(let Ee of Is(j)){let jt=Ee.kind===0?bR(T,Ee.fieldPath,T.startAt):SR(T,Ee.fieldPath,T.startAt);H.push(jt.value),W&&(W=jt.inclusive)}return new ur(H,W)}(c,u),f=function(T,j){let H=[],W=!0;for(let Ee of Is(j)){let jt=Ee.kind===0?SR(T,Ee.fieldPath,T.endAt):bR(T,Ee.fieldPath,T.endAt);H.push(jt.value),W&&(W=jt.inclusive)}return new ur(H,W)}(c,u),p=this.ln(u,c,h),g=this.ln(u,c,f),v=this.hn(u,c,d),C=this.Pn(u.indexId,l,p,h.inclusive,g,f.inclusive,v);return m.forEach(C,N=>r.G(N,n.limit).next(T=>{T.forEach(j=>{let H=b.fromSegments(j.documentKey);o.has(H)||(o=o.add(H),a.push(H))})}))}).next(()=>a)}return m.resolve(null)})}un(e){let n=this.an.get(e);return n||(e.filters.length===0?n=[e]:n=x4(we.create(e.filters,"and")).map(r=>oE(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,i,s,o,a){let u=(n!=null?n.length:1)*Math.max(r.length,s.length),c=u/(n!=null?n.length:1),l=[];for(let d=0;d<u;++d){let h=n?this.In(n[d/c]):Jf,f=this.Tn(e,h,r[d%c],i),p=this.En(e,h,s[d%c],o),g=a.map(v=>this.Tn(e,h,v,!0));l.push(...this.createRange(f,p,g))}return l}Tn(e,n,r,i){let s=new bs(e,b.empty(),n,r);return i?s:s.Ht()}En(e,n,r,i){let s=new bs(e,b.empty(),n,r);return i?s.Ht():s}cn(e,n){let r=new bp(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.un(n);return m.forEach(i,s=>this.cn(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new De(He.comparator),l=!1;for(let d of u.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:c=c.add(h.field));for(let d of u.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}dn(e,n){let r=new Ts;for(let i of Is(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.jt(i.kind);Pr.St.ht(s,o)}return r.Ut()}In(e){let n=new Ts;return Pr.St.ht(e,n.jt(0)),n.Ut()}An(e,n){let r=new Ts;return Pr.St.ht(Ms(this.databaseId,n),r.jt(function(s){let o=Is(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(r===null)return[];let i=[];i.push(new Ts);let s=0;for(let o of Is(e)){let a=r[s++];for(let u of i)if(this.Rn(n,o.fieldPath)&&ol(a))i=this.Vn(i,o,a);else{let c=u.jt(o.kind);Pr.St.ht(a,c)}}return this.mn(i)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let u=new Ts;u.seed(a.Ut()),Pr.St.ht(o,u.jt(n.kind)),s.push(u)}return s}Rn(e,n){return!!e.filters.find(r=>r instanceof oe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=Gc(e),i=oa(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{let o=[];return m.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(l,d){let h=d?new tl(d.sequenceNumber,new mn(Os(d.readTime),new b(nr(d.documentKey)),d.largestBatchId)):tl.empty(),f=l.fields.map(([p,g])=>new pa(He.fromServerFormat(p),g));return new _a(l.indexId,l.collectionGroup,f,h)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Q(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=Gc(e),s=oa(e);return this.fn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>m.forEach(a,u=>s.put(BR(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return m.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?m.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),m.forEach(a,u=>this.gn(e,i,u).next(c=>{let l=this.pn(s,u);return c.isEqual(l)?m.resolve():this.yn(e,s,u,c,l)}))))})}wn(e,n,r,i){return sa(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,i){return sa(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){let i=sa(e),s=new De(gi);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(o,a)=>{s=s.add(new bs(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,n){let r=new De(gi),i=this.dn(n,e);if(i==null)return r;let s=Hw(n);if(s!=null){let o=e.data.field(s.fieldPath);if(ol(o))for(let a of o.arrayValue.values||[])r=r.add(new bs(n.indexId,e.key,this.In(a),i))}else r=r.add(new bs(n.indexId,e.key,Jf,i));return r}yn(e,n,r,i,s){E("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(u,c,l,d,h){let f=u.getIterator(),p=c.getIterator(),g=ia(f),v=ia(p);for(;g||v;){let C=!1,N=!1;if(g&&v){let T=l(g,v);T<0?N=!0:T>0&&(C=!0)}else g!=null?N=!0:C=!0;C?(d(v),v=ia(p)):N?(h(g),g=ia(f)):(g=ia(f),v=ia(p))}}(i,s,gi,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.Sn(e,n,r,a))}),m.waitFor(o)}fn(e){let n=1;return oa(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>gi(o,a)).filter((o,a,u)=>!a||gi(o,u[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=gi(o,e),u=gi(o,n);if(a===0)i[0]=e.Ht();else if(a>0&&u<0)i.push(o),i.push(o.Ht());else if(u>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Jf,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Jf,[]];s.push(IDBKeyRange.bound(a,u))}return s}bn(e,n){return gi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(KR)}getMinOffset(e,n){return m.mapArray(this.un(n),r=>this.cn(e,r).next(i=>i||R())).next(KR)}};function WR(t){return ut(t,"collectionParents")}function sa(t){return ut(t,"indexEntries")}function Gc(t){return ut(t,"indexConfiguration")}function oa(t){return ut(t,"indexState")}function KR(t){O(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;OI(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new mn(e.readTime,e.documentKey,n)}var QR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function mP(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,u=r.J({range:o},(l,d,h)=>(a++,h.delete()));s.push(u.next(()=>{O(a===1)}));let c=[];for(let l of n.mutations){let d=IN(e,l.key.path,n.batchId);s.push(i.delete(d)),c.push(l.key)}return m.waitFor(s).next(()=>c)}function Ap(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw R();e=t.noDocument}return JSON.stringify(e).length}pn.DEFAULT_COLLECTION_PERCENTILE=10,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pn.DEFAULT=new pn(41943040,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pn.DISABLED=new pn(-1,0,0);var xp=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,n,r,i){O(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return mi(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=ha(e),o=mi(e);return o.add({}).next(a=>{O(typeof a=="number");let u=new ul(a,n,r,i),c=function(f,p,g){let v=g.baseMutations.map(N=>fl(f.ut,N)),C=g.mutations.map(N=>fl(f.ut,N));return{userId:p,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:v,mutations:C}}(this.serializer,this.userId,u),l=[],d=new De((h,f)=>Q(h.canonicalString(),f.canonicalString()));for(let h of i){let f=IN(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(c)),l.push(s.put(f,FG))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Dn[a]=u.keys()}),m.waitFor(l).next(()=>u)})}lookupMutationBatch(e,n){return mi(e).get(n).next(r=>r?(O(r.userId===this.userId),Ds(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?m.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Dn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return mi(e).J({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(O(a.batchId>=r),s=Ds(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return mi(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return mi(e).U("userMutationsIndex",n).next(r=>r.map(i=>Ds(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=np(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return ha(e).J({range:i},(o,a,u)=>{let[c,l,d]=o,h=nr(l);if(c===this.userId&&n.path.isEqual(h))return mi(e).get(d).next(f=>{if(!f)throw R();O(f.userId===this.userId),s.push(Ds(this.serializer,f))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new De(Q),i=[];return n.forEach(s=>{let o=np(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=ha(e).J({range:a},(c,l,d)=>{let[h,f,p]=c,g=nr(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(u)}),m.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=np(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new De(Q);return ha(e).J({range:o},(u,c,l)=>{let[d,h,f]=u,p=nr(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.vn(e,a))}vn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(mi(e).get(s).next(o=>{if(o===null)throw R();O(o.userId===this.userId),r.push(Ds(this.serializer,o))}))}),m.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return mP(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),m.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return m.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return ha(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let u=nr(s[1]);i.push(u)}else a.done()}).next(()=>{O(i.length===0)})})}containsKey(e,n){return yP(e,this.userId,n)}Mn(e){return _P(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function yP(t,e,n){let r=np(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return ha(t).J({range:s,H:!0},(a,u,c)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function mi(t){return ut(t,"mutations")}function ha(t){return ut(t,"documentMutations")}function _P(t){return ut(t,"mutationQueues")}var Ta=class t{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new t(0)}static Nn(){return new t(-1)}};var SE=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{let r=new Ta(n.highestTargetId);return n.highestTargetId=r.next(),this.Bn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>L.fromTimestamp(new ke(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Bn(e,i)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Bn(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>aa(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>(O(r.targetCount>0),r.targetCount-=1,this.Bn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return aa(e).J((o,a)=>{let u=Qc(a);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>m.waitFor(s)).next(()=>i)}forEachTarget(e,n){return aa(e).J((r,i)=>{let s=Qc(i);n(s)})}Ln(e){return YR(e).get("targetGlobalKey").next(n=>(O(n!==null),n))}Bn(e,n){return YR(e).put("targetGlobalKey",n)}kn(e,n){return aa(e).put(fP(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){let r=Ns(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return aa(e).J({range:i,index:"queryTargetsIndex"},(o,a,u)=>{let c=Qc(a);Dl(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=yi(e);return n.forEach(o=>{let a=Pt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),m.waitFor(i)}removeMatchingKeys(e,n,r){let i=yi(e);return m.forEach(n,s=>{let o=Pt(s.path);return m.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=yi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=yi(e),s=Z();return i.J({range:r,H:!0},(o,a,u)=>{let c=nr(o[1]),l=new b(c);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=Pt(n.path),i=IDBKeyRange.bound([r],[mN(r)],!1,!0),s=0;return yi(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],u,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}ot(e,n){return aa(e).get(n).next(r=>r?Qc(r):null)}};function aa(t){return ut(t,"targets")}function YR(t){return ut(t,"targetGlobal")}function yi(t){return ut(t,"targetDocuments")}function ZR([t,e],[n,r]){let i=Q(t,n);return i===0?Q(e,r):i}var AE=class{constructor(e){this.Qn=e,this.buffer=new De(ZR),this.Kn=0}$n(){return++this.Kn}Un(e){let n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();ZR(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},xE=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){E("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>_(this,null,function*(){this.Wn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ni(n)?E("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Ri(n)}yield this.Gn(3e5)}))}},ME=class{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return m.resolve(Zt.oe);let r=new AE(n);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(E("LruGarbageCollector","Garbage collection skipped; disabled"),m.resolve(QR)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(E("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),QR):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,i,s,o,a,u,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(E("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),ua()<=sn.DEBUG&&E("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${d} documents in `+(c-u)+`ms
Total Duration: ${c-l}ms`),m.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function M4(t,e){return new ME(t,e)}var RE=class{constructor(e,n){this.db=e,this.garbageCollector=M4(this,n)}jn(e){let n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,i)=>n(i))}addReference(e,n,r){return Xf(e,r)}removeReference(e,n,r){return Xf(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Xf(e,n)}Xn(e,n){return function(i,s){let o=!1;return _P(i).Y(a=>yP(i,a,s).next(u=>(u&&(o=!0),m.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Zn(e,(o,a)=>{if(a<=n){let u=this.Xn(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,L.min()),yi(e).delete(function(d){return[0,Pt(d.path)]}(o))))});i.push(u)}}).next(()=>m.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Xf(e,n)}Zn(e,n){let r=yi(e),i,s=Zt.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(s!==Zt.oe&&n(new b(nr(i)),s),s=c,i=u):s=Zt.oe}).next(()=>{s!==Zt.oe&&n(new b(nr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Xf(t,e){return yi(t).put(function(r,i){return{targetId:0,path:Pt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var Mp=class{constructor(){this.changes=new cr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ze.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?m.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var NE=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Es(e).put(r)}removeEntry(e,n,r){return Es(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Dp(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=Ze.newInvalidDocument(n);return Es(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(zc(n))},(i,s)=>{r=this.tr(n,s)}).next(()=>r)}nr(e,n){let r={size:0,document:Ze.newInvalidDocument(n)};return Es(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(zc(n))},(i,s)=>{r={document:this.tr(n,s),size:Ap(s)}}).next(()=>r)}getEntries(e,n){let r=qt();return this.rr(e,n,(i,s)=>{let o=this.tr(i,s);r=r.insert(i,o)}).next(()=>r)}ir(e,n){let r=qt(),i=new Re(b.comparator);return this.rr(e,n,(s,o)=>{let a=this.tr(s,o);r=r.insert(s,a),i=i.insert(s,Ap(o))}).next(()=>({documents:r,sr:i}))}rr(e,n,r){if(n.isEmpty())return m.resolve();let i=new De(eN);n.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound(zc(i.first()),zc(i.last())),o=i.getIterator(),a=o.getNext();return Es(e).J({index:"documentKeyIndex",range:s},(u,c,l)=>{let d=b.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&eN(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?l.$(zc(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Dp(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Es(e).U(IDBKeyRange.bound(a,u,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let l=qt();for(let d of c){let h=this.tr(b.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(bl(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=qt(),o=XR(n,r),a=XR(n,mn.max());return Es(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,l)=>{let d=this.tr(b.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new PE(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return JR(e).get("remoteDocumentGlobalKey").next(n=>(O(!!n),n))}er(e,n){return JR(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){let r=S4(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(L.min())))return r}return Ze.newInvalidDocument(e)}};function vP(t){return new NE(t)}var PE=class extends Mp{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new cr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new De((s,o)=>Q(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ar.get(s);if(n.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){let u=jR(this._r.serializer,o);i=i.add(s.path.popLast());let c=Ap(u);r+=c-a.size,n.push(this._r.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){let u=jR(this._r.serializer,o.convertToNoDocument(L.min()));n.push(this._r.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),n.push(this._r.updateMetadata(e,r)),m.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:i})=>(i.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function JR(t){return ut(t,"remoteDocumentGlobal")}function Es(t){return ut(t,"remoteDocumentsV14")}function zc(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function XR(t,e){let n=e.documentKey.path.toArray();return[t,Dp(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function eN(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Q(n[s],r[s]),i)return i;return i=Q(n.length,r.length),i||(i=Q(n[n.length-2],r[r.length-2]),i||Q(n[n.length-1],r[r.length-1]))}var kE=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Rp=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Jc(r.mutation,i,Jt.empty(),ke.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Z()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Z()){let i=rr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Kc();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=rr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Z()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=qt(),o=Zc(),a=function(){return Zc()}();return n.forEach((u,c)=>{let l=r.get(c.key);i.has(c.key)&&(l===void 0||l.mutation instanceof kn)?s=s.insert(c.key,c):l!==void 0?(o.set(c.key,l.mutation.getFieldMask()),Jc(l.mutation,c,l.mutation.getFieldMask(),ke.now())):o.set(c.key,Jt.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,l)=>o.set(c,l)),n.forEach((c,l)=>{var d;return a.set(c,new kE(l,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=Zc(),i=new Re((o,a)=>o-a),s=Z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(u=>{let c=n.get(u);if(c===null)return;let l=r.get(u)||Jt.empty();l=a.applyToLocalView(c,l),r.set(u,l);let d=(i.get(a.batchId)||Z()).add(u);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),c=u.key,l=u.value,d=$N();l.forEach(h=>{if(!s.has(h)){let f=YN(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return m.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return b.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):jI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):m.resolve(rr()),a=-1,u=s;return o.next(c=>m.forEach(c,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?m.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{u=u.insert(l,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,Z())).next(l=>({batchId:a,changes:BN(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new b(n)).next(r=>{let i=Kc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=Kc();return this.indexManager.getCollectionParents(e,s).next(a=>m.forEach(a,u=>{let c=function(d,h){return new Pn(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{let l=c.getKey();o.get(l)===null&&(o=o.insert(l,Ze.newInvalidDocument(l)))});let a=Kc();return o.forEach((u,c)=>{let l=s.get(u);l!==void 0&&Jc(l.mutation,c,Jt.empty(),ke.now()),bl(n,c)&&(a=a.insert(u,c))}),a})}};var OE=class{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return m.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(i){return{id:i.id,version:i.version,createTime:qe(i.createTime)}}(n)),m.resolve()}getNamedQuery(e,n){return m.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(i){return{name:i.name,query:$I(i.bundledQuery),readTime:qe(i.readTime)}}(n)),m.resolve()}};var FE=class{constructor(){this.overlays=new Re(b.comparator),this.lr=new Map}getOverlay(e,n){return m.resolve(this.overlays.get(n))}getOverlays(e,n){let r=rr();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),m.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),m.resolve()}getOverlaysForCollection(e,n,r){let i=rr(),s=n.length+1,o=new b(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return m.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Re((c,l)=>c-l),o=this.overlays.getIterator();for(;o.hasNext();){let c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let l=s.get(c.largestBatchId);l===null&&(l=rr(),s=s.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}let a=rr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(c,l)),!(a.size()>=i)););return m.resolve(a)}lt(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new cl(n,r));let s=this.lr.get(n);s===void 0&&(s=Z(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}};var gl=class{constructor(){this.hr=new De(Ke.Pr),this.Ir=new De(Ke.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){let r=new Ke(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new Ke(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){let n=new b(new ce([])),r=new Ke(n,e),i=new Ke(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){let n=new b(new ce([])),r=new Ke(n,e),i=new Ke(n,e+1),s=Z();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new Ke(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},Ke=class{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return b.comparator(e.key,n.key)||Q(e.gr,n.gr)}static Tr(e,n){return Q(e.gr,n.gr)||b.comparator(e.key,n.key)}};var VE=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new De(Ke.Pr)}checkEmpty(e){return m.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new ul(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.yr=this.yr.add(new Ke(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return m.resolve(o)}lookupMutationBatch(e,n){return m.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.Sr(r),s=i<0?0:i;return m.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return m.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return m.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new Ke(n,0),i=new Ke(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{let a=this.wr(o.gr);s.push(a)}),m.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new De(Q);return n.forEach(i=>{let s=new Ke(i,0),o=new Ke(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),m.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;b.isDocumentKey(s)||(s=s.child(""));let o=new Ke(new b(s),0),a=new De(Q);return this.yr.forEachWhile(u=>{let c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.gr)),!0)},o),m.resolve(this.br(a))}br(e){let n=[];return e.forEach(r=>{let i=this.wr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){O(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return m.forEach(n.mutations,i=>{let s=new Ke(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){let r=new Ke(n,0),i=this.yr.firstAfterOrEqual(r);return m.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,m.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){let n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var LE=class{constructor(e){this.Cr=e,this.docs=function(){return new Re(b.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return m.resolve(r?r.document.mutableCopy():Ze.newInvalidDocument(n))}getEntries(e,n){let r=qt();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ze.newInvalidDocument(i))}),m.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=qt(),o=n.path,a=new b(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:c,value:{document:l}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||OI(_N(l),r)<=0||(i.has(l.key)||bl(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return m.resolve(s)}getAllFromCollectionGroup(e,n,r,i){R()}vr(e,n){return m.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new jE(this)}getSize(e){return m.resolve(this.size)}},jE=class extends Mp{constructor(e){super(),this._r=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),m.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}};var UE=class{constructor(e){this.persistence=e,this.Fr=new cr(n=>Ns(n),Dl),this.lastRemoteSnapshotVersion=L.min(),this.highestTargetId=0,this.Mr=0,this.Or=new gl,this.targetCount=0,this.Nr=Ta.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),m.resolve()}getLastRemoteSnapshotVersion(e){return m.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return m.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),m.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),m.resolve()}kn(e){this.Fr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Nr=new Ta(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,m.resolve()}updateTargetData(e,n){return this.kn(n),m.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,m.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),m.waitFor(s).next(()=>i)}getTargetCount(e){return m.resolve(this.targetCount)}getTargetData(e,n){let r=this.Fr.get(n)||null;return m.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),m.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),m.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),m.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Or.mr(n);return m.resolve(r)}containsKey(e,n){return m.resolve(this.Or.containsKey(n))}};var Np=class{constructor(e,n){this.Lr={},this.overlays={},this.Br=new Zt(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new UE(this),this.indexManager=new TE,this.remoteDocumentCache=function(i){return new LE(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new Cp(n),this.Kr=new OE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new FE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new VE(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){E("MemoryPersistence","Starting transaction:",e);let i=new BE(this.Br.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return m.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}},BE=class extends dp{constructor(e){super(),this.currentSequenceNumber=e}},Pp=class t{constructor(e){this.persistence=e,this.Gr=new gl,this.zr=null}static jr(e){return new t(e)}get Hr(){if(this.zr)return this.zr;throw R()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),m.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),m.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),m.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return m.forEach(this.Hr,r=>{let i=b.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,L.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return m.or([()=>m.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}};var $E=class{constructor(e){this.serializer=e}O(e,n,r,i){let s=new hp("createOrUpgrade",n);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",yR,{unique:!0}),u.createObjectStore("documentMutations")}(e),tN(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=m.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),tN(e)),o=o.next(()=>function(u){let c=u.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:L.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").U().next(l=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",yR,{unique:!0});let d=c.store("mutations"),h=l.map(f=>d.put(f));return m.waitFor(h)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Zr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(o=o.next(()=>this.ei(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ni(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){let c=u.createObjectStore("documentOverlays",{keyPath:KG});c.createIndex("collectionPathOverlayIndex",QG,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",YG,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){let c=u.createObjectStore("remoteDocumentsV14",{keyPath:VG});c.createIndex("documentKeyIndex",LG),c.createIndex("collectionGroupIndex",jG)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ii(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:qG}).createIndex("sequenceNumberIndex",GG,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:zG}).createIndex("documentKeyIndex",WG,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),o}Xr(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=Ap(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>m.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>m.forEach(a,u=>{O(u.userId===s.userId);let c=Ds(this.serializer,u);return mP(e,s.userId,c).next(()=>{})}))}))}ei(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let u=new ce(o),c=function(d){return[0,Pt(d)]}(u);s.push(n.get(c).next(l=>l?m.resolve():(d=>n.put({targetId:0,path:Pt(d),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>m.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:HG});let r=n.store("collectionParents"),i=new pl,s=o=>{if(i.add(o)){let a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Pt(u)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{let u=new ce(o);return s(u.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,u],c)=>{let l=nr(a);return s(l.popLast())}))}ni(e){let n=e.store("targets");return n.J((r,i)=>{let s=Qc(i),o=fP(this.serializer,s);return n.put(o)})}ri(e,n){let r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=n.store("remoteDocumentsV14"),u=function(d){return d.document?new b(ce.fromString(d.document.name).popFirst(5)):d.noDocument?b.fromSegments(d.noDocument.path):d.unknownDocument?b.fromSegments(d.unknownDocument.path):R()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>m.waitFor(i))}ii(e,n){let r=n.store("mutations"),i=vP(this.serializer),s=new Np(Pp.jr,this.serializer.ut);return r.U().next(o=>{let a=new Map;return o.forEach(u=>{var c;let l=(c=a.get(u.userId))!==null&&c!==void 0?c:Z();Ds(this.serializer,u).keys().forEach(d=>l=l.add(d)),a.set(u.userId,l)}),m.forEach(a,(u,c)=>{let l=new Qe(c),d=Tp.ct(this.serializer,l),h=s.getIndexManager(l),f=xp.ct(l,this.serializer,h,s.referenceDelegate);return new Rp(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new rl(n,Zt.oe),u).next()})})}};function tN(t){t.createObjectStore("targetDocuments",{keyPath:BG}).createIndex("documentTargetsIndex",$G,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",UG,{unique:!0}),t.createObjectStore("targetGlobal")}var Pw="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",HE=class t{constructor(e,n,r,i,s,o,a,u,c,l,d=16){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=s,this.window=o,this.document=a,this.oi=c,this._i=l,this.ai=d,this.Br=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=h=>Promise.resolve(),!t.D())throw new w(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new RE(this,i),this.Ii=n+"main",this.serializer=new Cp(u),this.Ti=new Ii(this.Ii,this.ai,new $E(this.serializer)),this.qr=new SE(this.referenceDelegate,this.serializer),this.remoteDocumentCache=vP(this.serializer),this.Kr=new _E,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,l===!1&&$e("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new w(y.FAILED_PRECONDITION,Pw);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Br=new Zt(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=n=>_(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(n=>_(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(()=>_(this,null,function*(){this.started&&(yield this.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ep(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(Ni(e))return E("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return E("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return Wc(e).get("owner").next(n=>m.resolve(this.wi(n)))}Si(e){return ep(e).delete(this.clientId)}bi(){return _(this,null,function*(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=ut(n,"clientMetadata");return r.U().next(i=>{let s=this.Ci(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return m.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ei)for(let n of e)this.Ei.removeItem(this.vi(n.clientId))}})}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?m.resolve(!0):Wc(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new w(y.FAILED_PRECONDITION,Pw);return!1}}return!(!this.networkEnabled||!this.inForeground)||ep(e).U().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&E("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return _(this,null,function*(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),yield this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new rl(e,Zt.oe);return this.pi(n).next(()=>this.Si(n))}),this.Ti.close(),this.Ni()})}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>ep(e).U().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return xp.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new bE(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Tp.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){E("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(u){return u===16?JG:u===15?bN:u===14?TN:u===13?DN:u===12?ZG:u===11?CN:void R()}(this.ai),o;return this.Ti.runTransaction(e,i,s,a=>(o=new rl(a,this.Br?this.Br.next():Zt.oe),n==="readwrite-primary"?this.fi(o).next(u=>!!u||this.gi(o)).next(u=>{if(!u)throw $e(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new w(y.FAILED_PRECONDITION,vN);return r(o)}).next(u=>this.yi(o).next(()=>u)):this.Bi(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Bi(e){return Wc(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new w(y.FAILED_PRECONDITION,Pw)})}yi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Wc(e).put("owner",n)}static D(){return Ii.D()}pi(e){let n=Wc(e);return n.get("owner").next(r=>this.wi(r)?(E("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):m.resolve())}Di(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||($e(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();let n=/(?:Version|Mobile)\/1[456]/;pm()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{let r=((n=this.Ei)===null||n===void 0?void 0:n.getItem(this.vi(e)))!==null;return E("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return $e("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){$e("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Wc(t){return ut(t,"owner")}function ep(t){return ut(t,"clientMetadata")}function qI(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var qE=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=Z(),i=Z();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var GE=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var kp=class{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=function(){return pm()?8:wN(au())>0?6:4}()}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new GE;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(ua()<=sn.DEBUG&&E("QueryEngine","SDK will not create cache indexes for query:",ca(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),m.resolve()):(ua()<=sn.DEBUG&&E("QueryEngine","Query:",ca(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(ua()<=sn.DEBUG&&E("QueryEngine","The SDK decides to create cache indexes for query:",ca(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,kt(n))):m.resolve())}zi(e,n){if(AR(n))return m.resolve(null);let r=kt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=vp(n,null,"F"),r=kt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=Z(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let c=this.Yi(n,a);return this.Zi(n,c,o,u.readTime)?this.zi(e,vp(n,null,"F")):this.Xi(e,c,n,u)}))})))}ji(e,n,r,i){return AR(n)||i.isEqual(L.min())?m.resolve(null):this.Gi.getDocuments(e,r).next(s=>{let o=this.Yi(n,s);return this.Zi(n,o,r,i)?m.resolve(null):(ua()<=sn.DEBUG&&E("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ca(n)),this.Xi(e,o,n,yN(i,-1)).next(a=>a))})}Yi(e,n){let r=new De(jN(e));return n.forEach((i,s)=>{bl(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return ua()<=sn.DEBUG&&E("QueryEngine","Using full collection scan to execute query:",ca(n)),this.Gi.getDocumentsMatchingQuery(e,n,mn.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var zE=class{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new Re(Q),this.ns=new cr(s=>Ns(s),Dl),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Rp(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}};function wP(t,e,n,r){return new zE(t,e,n,r)}function EP(t,e){return _(this,null,function*(){let n=S(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=Z();for(let c of i){o.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}for(let c of s){a.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}return n.localDocuments.getDocuments(r,u).next(c=>({_s:c,removedBatchIds:o,addedBatchIds:a}))})})})}function R4(t,e){let n=S(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,u,c,l){let d=c.batch,h=d.keys(),f=m.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(u,p)).next(g=>{let v=c.docVersions.get(p);O(v!==null),g.version.compareTo(v)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),l.addEntry(g)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(u,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=Z();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function IP(t){let e=S(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function N4(t,e){let n=S(t),r=e.snapshotVersion,i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(at.EMPTY_BYTE_STRING,L.min()).withLastLimboFreeSnapshotVersion(L.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(g,v,C){return g.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(h,f,l)&&a.push(n.qr.updateTargetData(s,f))});let u=qt(),c=Z();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(CP(s,o,e.documentUpdates).next(l=>{u=l.us,c=l.cs})),!r.isEqual(L.min())){let l=n.qr.getLastRemoteSnapshotVersion(s).next(d=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return m.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.ts=i,s))}function CP(t,e,n){let r=Z(),i=Z();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=qt();return n.forEach((a,u)=>{let c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(L.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):E("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{us:o,cs:i}})}function P4(t,e){let n=S(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ba(t,e){let n=S(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,m.resolve(i)):n.qr.allocateTargetId(r).next(o=>(i=new Da(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}function Sa(t,e,n){return _(this,null,function*(){let r=S(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Ni(o))throw o;E("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)})}function Op(t,e,n){let r=S(t),i=L.min(),s=Z();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,l){let d=S(u),h=d.ns.get(l);return h!==void 0?m.resolve(d.ts.get(h)):d.qr.getTargetData(c,l)}(r,o,kt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?i:L.min(),n?s:Z())).next(a=>(bP(r,LN(e),a),{documents:a,ls:s})))}function DP(t,e){let n=S(t),r=S(n.qr),i=n.ts.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function TP(t,e){let n=S(t),r=n.rs.get(e)||L.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ss.getAllFromCollectionGroup(i,e,yN(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(bP(n,e,i),i))}function bP(t,e,n){let r=t.rs.get(e)||L.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}function k4(t,e,n,r){return _(this,null,function*(){let i=S(t),s=Z(),o=qt();for(let c of n){let l=e.hs(c.metadata.name);c.document&&(s=s.add(l));let d=e.Ps(c);d.setReadTime(e.Is(c.metadata.readTime)),o=o.insert(l,d)}let a=i.ss.newChangeBuffer({trackRemovals:!0}),u=yield ba(i,function(l){return kt(Oa(ce.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>CP(c,a,o).next(l=>(a.apply(c),l)).next(l=>i.qr.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.qr.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,l.us,l.cs)).next(()=>l.us)))})}function O4(r,i){return _(this,arguments,function*(t,e,n=Z()){let s=yield ba(t,kt($I(e.bundledQuery))),o=S(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let u=qe(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.Kr.saveNamedQuery(a,e);let c=s.withResumeToken(at.EMPTY_BYTE_STRING,u);return o.ts=o.ts.insert(c.targetId,c),o.qr.updateTargetData(a,c).next(()=>o.qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.Kr.saveNamedQuery(a,e))})})}function nN(t,e){return`firestore_clients_${t}_${e}`}function rN(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function kw(t,e){return`firestore_targets_${t}_${e}`}var Fp=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ts(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new w(i.error.code,i.error.message))),o?new t(e,n,i.state,s):($e("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Xc=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new w(r.error.code,r.error.message))),s?new t(e,r.state,i):($e("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Vp=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=UI();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=EN(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):($e("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},WE=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):($e("SharedClientState",`Failed to parse online state: ${e}`),null)}},ml=class{constructor(){this.activeTargetIds=UI()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},el=class{constructor(e,n,r,i,s){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Re(Q),this.started=!1,this.ps=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=nN(this.persistenceKey,this.Rs),this.ws=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new ml),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.vs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){return _(this,null,function*(){let e=yield this.syncEngine.Li();for(let r of e){if(r===this.Rs)continue;let i=this.getItem(nN(this.persistenceKey,r));if(i){let s=Vp.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();let n=this.storage.getItem(this.Cs);if(n){let r=this.Ms(n);r&&this.xs(r)}for(let r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Ls(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(kw(this.persistenceKey,e));if(r){let i=Xc.Ts(e,r);i&&(n=i.state)}}return this.Bs.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Bs.As(e),this.Fs()}isLocalQueryTarget(e){return this.Bs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(kw(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Ls(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return E("SharedClientState","READ",e,n),n}setItem(e,n){E("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){E("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){let n=e;if(n.storageArea===this.storage){if(E("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ys)return void $e("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(()=>_(this,null,function*(){if(this.started){if(n.key!==null){if(this.Ss.test(n.key)){if(n.newValue==null){let r=this.Ks(n.key);return this.$s(r,null)}{let r=this.Us(n.key,n.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(n.key)){if(n.newValue!==null){let r=this.Ws(n.key,n.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.zs(n.key,n.newValue);if(r)return this.js(r)}}else if(n.key===this.Cs){if(n.newValue!==null){let r=this.Ms(n.newValue);if(r)return this.xs(r)}}else if(n.key===this.ws){let r=function(s){let o=Zt.oe;if(s!=null)try{let a=JSON.parse(s);O(typeof a=="number"),o=a}catch(a){$e("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==Zt.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.vs){let r=this.Hs(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(n)}))}}get Bs(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Bs.Es())}Ns(e,n,r){let i=new Fp(this.currentUser,e,n,r),s=rN(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Ls(e){let n=rN(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){let n={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(n))}ks(e,n,r){let i=kw(this.persistenceKey,e),s=new Xc(e,n,r);this.setItem(i,s.Es())}Qs(e){let n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){let n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){let r=this.Ks(e);return Vp.Ts(r,n)}Ws(e,n){let r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Fp.Ts(new Qe(s),i,n)}zs(e,n){let r=this.Ds.exec(e),i=Number(r[1]);return Xc.Ts(i,n)}Ms(e){return WE.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){return _(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);E("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){let r=n?this.gs.insert(e,n):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=UI();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},Lp=class{constructor(){this.eo=new ml,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new ml,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var KE=class{ro(e){}shutdown(){}};var jp=class{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){E("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ao)e(0)}_o(){E("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var tp=null;function Ow(){return tp===null?tp=function(){return 268435456+Math.round(2147483648*Math.random())}():tp++,"0x"+tp.toString(16)}var F4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var QE=class{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}Eo(e){this.Ao=e}onMessage(e){this.Ro=e}close(){this.lo()}send(e){this.co(e)}Vo(){this.Po()}mo(){this.To()}fo(e){this.Ao(e)}po(e){this.Ro(e)}};var bt="WebChannelConnection",YE=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.yo=r+"://"+n.host,this.wo=`projects/${i}/databases/${s}`,this.So=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get bo(){return!1}Do(n,r,i,s,o){let a=Ow(),u=this.Co(n,r.toUriEncodedString());E("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);let c={"google-cloud-resource-prefix":this.wo,"x-goog-request-params":this.So};return this.vo(c,s,o),this.Fo(n,u,c,i).then(l=>(E("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw gn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",u,"request:",i),l})}Mo(n,r,i,s,o,a){return this.Do(n,r,i,s,o)}vo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ka}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}Co(n,r){let i=F4[n];return`${this.yo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Fo(e,n,r,i){let s=Ow();return new Promise((o,a)=>{let u=new hR;u.setWithCredentials(!0),u.listenOnce(cR.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Zf.NO_ERROR:let l=u.getResponseJson();E(bt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case Zf.TIMEOUT:E(bt,`RPC '${e}' ${s} timed out`),a(new w(y.DEADLINE_EXCEEDED,"Request time out"));break;case Zf.HTTP_ERROR:let d=u.getStatus();if(E(bt,`RPC '${e}' ${s} failed with status:`,d,"response text:",u.getResponseText()),d>0){let h=u.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(v){let C=v.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(C)>=0?C:y.UNKNOWN}(f.status);a(new w(p,f.message))}else a(new w(y.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new w(y.UNAVAILABLE,"Connection failed."));break;default:R()}}finally{E(bt,`RPC '${e}' ${s} completed.`)}});let c=JSON.stringify(i);E(bt,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}xo(e,n,r){let i=Ow(),s=[this.yo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=aR(),a=uR(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.xmlHttpFactory=new dR({})),this.vo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;let l=s.join("");E(bt,`Creating RPC '${e}' stream ${i}: ${l}`,u);let d=o.createWebChannel(l,u),h=!1,f=!1,p=new QE({co:v=>{f?E(bt,`Not sending because RPC '${e}' stream ${i} is closed:`,v):(h||(E(bt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),E(bt,`RPC '${e}' stream ${i} sending:`,v),d.send(v))},lo:()=>d.close()}),g=(v,C,N)=>{v.listen(C,T=>{try{N(T)}catch(j){setTimeout(()=>{throw j},0)}})};return g(d,Hc.EventType.OPEN,()=>{f||(E(bt,`RPC '${e}' stream ${i} transport opened.`),p.Vo())}),g(d,Hc.EventType.CLOSE,()=>{f||(f=!0,E(bt,`RPC '${e}' stream ${i} transport closed`),p.fo())}),g(d,Hc.EventType.ERROR,v=>{f||(f=!0,gn(bt,`RPC '${e}' stream ${i} transport errored:`,v),p.fo(new w(y.UNAVAILABLE,"The operation could not be completed")))}),g(d,Hc.EventType.MESSAGE,v=>{var C;if(!f){let N=v.data[0];O(!!N);let T=N,j=T.error||((C=T[0])===null||C===void 0?void 0:C.error);if(j){E(bt,`RPC '${e}' stream ${i} received error:`,j);let H=j.status,W=function(dm){let ld=We[dm];if(ld!==void 0)return XN(ld)}(H),Ee=j.message;W===void 0&&(W=y.INTERNAL,Ee="Unknown error status: "+H+" with message "+j.message),f=!0,p.fo(new w(W,Ee)),d.close()}else E(bt,`RPC '${e}' stream ${i} received:`,N),p.po(N)}}),g(a,lR.STAT_EVENT,v=>{v.stat===Rw.PROXY?E(bt,`RPC '${e}' stream ${i} detected buffering proxy`):v.stat===Rw.NOPROXY&&E(bt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.mo()},0),p}};function SP(){return typeof window<"u"?window:null}function op(){return typeof document<"u"?document:null}function Sl(t){return new fE(t,!0)}var yl=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Oo=r,this.No=i,this.Lo=s,this.Bo=0,this.ko=null,this.qo=Date.now(),this.reset()}reset(){this.Bo=0}Qo(){this.Bo=this.Lo}Ko(e){this.cancel();let n=Math.floor(this.Bo+this.$o()),r=Math.max(0,Date.now()-this.qo),i=Math.max(0,n-r);i>0&&E("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Bo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.ko=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.qo=Date.now(),e())),this.Bo*=this.No,this.Bo<this.Oo&&(this.Bo=this.Oo),this.Bo>this.Lo&&(this.Bo=this.Lo)}Uo(){this.ko!==null&&(this.ko.skipDelay(),this.ko=null)}cancel(){this.ko!==null&&(this.ko.cancel(),this.ko=null)}$o(){return(Math.random()-.5)*this.Bo}};var Up=class{constructor(e,n,r,i,s,o,a,u){this.si=e,this.Wo=r,this.Go=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.zo=0,this.jo=null,this.Ho=null,this.stream=null,this.Jo=new yl(e,n)}Yo(){return this.state===1||this.state===5||this.Zo()}Zo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Xo()}stop(){return _(this,null,function*(){this.Yo()&&(yield this.close(0))})}e_(){this.state=0,this.Jo.reset()}t_(){this.Zo()&&this.jo===null&&(this.jo=this.si.enqueueAfterDelay(this.Wo,6e4,()=>this.n_()))}r_(e){this.i_(),this.stream.send(e)}n_(){return _(this,null,function*(){if(this.Zo())return this.close(0)})}i_(){this.jo&&(this.jo.cancel(),this.jo=null)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}close(e,n){return _(this,null,function*(){this.i_(),this.s_(),this.Jo.cancel(),this.zo++,e!==4?this.Jo.reset():n&&n.code===y.RESOURCE_EXHAUSTED?($e(n.toString()),$e("Using maximum backoff delay to prevent overloading the backend."),this.Jo.Qo()):n&&n.code===y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.o_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Eo(n)})}o_(){}auth(){this.state=1;let e=this.__(this.zo),n=this.zo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.zo===n&&this.a_(r,i)},r=>{e(()=>{let i=new w(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.u_(i)})})}a_(e,n){let r=this.__(this.zo);this.stream=this.c_(e,n),this.stream.ho(()=>{r(()=>this.listener.ho())}),this.stream.Io(()=>{r(()=>(this.state=2,this.Ho=this.si.enqueueAfterDelay(this.Go,1e4,()=>(this.Zo()&&(this.state=3),Promise.resolve())),this.listener.Io()))}),this.stream.Eo(i=>{r(()=>this.u_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Xo(){this.state=5,this.Jo.Ko(()=>_(this,null,function*(){this.state=0,this.start()}))}u_(e){return E("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}__(e){return n=>{this.si.enqueueAndForget(()=>this.zo===e?n():(E("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},ZE=class extends Up{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}c_(e,n){return this.connection.xo("Listen",e,n)}onMessage(e){this.Jo.reset();let n=w4(this.serializer,e),r=function(s){if(!("targetChange"in s))return L.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?L.min():o.readTime?qe(o.readTime):L.min()}(e);return this.listener.l_(n,r)}h_(e){let n={};n.database=mE(this.serializer),n.addTarget=function(s,o){let a,u=o.target;if(a=yp(u)?{documents:aP(s,u)}:{query:uP(s,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=tP(s,o.resumeToken);let c=pE(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(L.min())>0){a.readTime=Ca(s,o.snapshotVersion.toTimestamp());let c=pE(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=I4(this.serializer,e);r&&(n.labels=r),this.r_(n)}P_(e){let n={};n.database=mE(this.serializer),n.removeTarget=e,this.r_(n)}},JE=class extends Up{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.I_=!1}get T_(){return this.I_}start(){this.I_=!1,this.lastStreamToken=void 0,super.start()}o_(){this.I_&&this.E_([])}c_(e,n){return this.connection.xo("Write",e,n)}onMessage(e){if(O(!!e.streamToken),this.lastStreamToken=e.streamToken,this.I_){this.Jo.reset();let n=E4(e.writeResults,e.commitTime),r=qe(e.commitTime);return this.listener.d_(r,n)}return O(!e.writeResults||e.writeResults.length===0),this.I_=!0,this.listener.A_()}R_(){let e={};e.database=mE(this.serializer),this.r_(e)}E_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>fl(this.serializer,r))};this.r_(n)}};var XE=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.V_=!1}m_(){if(this.V_)throw new w(y.FAILED_PRECONDITION,"The client has already been terminated.")}Do(e,n,r,i){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Do(e,gE(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new w(y.UNKNOWN,s.toString())})}Mo(e,n,r,i,s){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,gE(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new w(y.UNKNOWN,o.toString())})}terminate(){this.V_=!0,this.connection.terminate()}};var eI=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?($e(n),this.y_=!1):E("OnlineStateTracker",n)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var tI=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.ro(o=>{r.enqueueAndForget(()=>_(this,null,function*(){Pi(this)&&(E("RemoteStore","Restarting streams for network reachability change."),yield function(u){return _(this,null,function*(){let c=S(u);c.M_.add(4),yield Fa(c),c.N_.set("Unknown"),c.M_.delete(4),yield Al(c)})}(this))}))}),this.N_=new eI(r,i)}};function Al(t){return _(this,null,function*(){if(Pi(t))for(let e of t.x_)yield e(!0)})}function Fa(t){return _(this,null,function*(){for(let e of t.x_)yield e(!1)})}function sg(t,e){let n=S(t);n.F_.has(e.targetId)||(n.F_.set(e.targetId,e),WI(n)?zI(n):La(n).Zo()&&GI(n,e))}function Aa(t,e){let n=S(t),r=La(n);n.F_.delete(e),r.Zo()&&AP(n,e),n.F_.size===0&&(r.Zo()?r.t_():Pi(n)&&n.N_.set("Unknown"))}function GI(t,e){if(t.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(L.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}La(t).h_(e)}function AP(t,e){t.L_.xe(e),La(t).P_(e)}function zI(t){t.L_=new hE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.F_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),La(t).start(),t.N_.w_()}function WI(t){return Pi(t)&&!La(t).Yo()&&t.F_.size>0}function Pi(t){return S(t).M_.size===0}function xP(t){t.L_=void 0}function V4(t){return _(this,null,function*(){t.N_.set("Online")})}function L4(t){return _(this,null,function*(){t.F_.forEach((e,n)=>{GI(t,e)})})}function j4(t,e){return _(this,null,function*(){xP(t),WI(t)?(t.N_.D_(e),zI(t)):t.N_.set("Unknown")})}function U4(t,e,n){return _(this,null,function*(){if(t.N_.set("Online"),e instanceof Ep&&e.state===2&&e.cause)try{yield function(i,s){return _(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(t,e)}catch(r){E("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Bp(t,r)}else if(e instanceof ma?t.L_.Ke(e):e instanceof wp?t.L_.He(e):t.L_.We(e),!n.isEqual(L.min()))try{let r=yield IP(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){let l=s.F_.get(c);l&&s.F_.set(c,l.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{let l=s.F_.get(u);if(!l)return;s.F_.set(u,l.withResumeToken(at.EMPTY_BYTE_STRING,l.snapshotVersion)),AP(s,u);let d=new Da(l.target,u,c,l.sequenceNumber);GI(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){E("RemoteStore","Failed to raise snapshot:",r),yield Bp(t,r)}})}function Bp(t,e,n){return _(this,null,function*(){if(!Ni(e))throw e;t.M_.add(1),yield Fa(t),t.N_.set("Offline"),n||(n=()=>IP(t.localStore)),t.asyncQueue.enqueueRetryable(()=>_(this,null,function*(){E("RemoteStore","Retrying IndexedDB access"),yield n(),t.M_.delete(1),yield Al(t)}))})}function MP(t,e){return e().catch(n=>Bp(t,n,e))}function Va(t){return _(this,null,function*(){let e=S(t),n=Mi(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;B4(e);)try{let i=yield P4(e.localStore,r);if(i===null){e.v_.length===0&&n.t_();break}r=i.batchId,$4(e,i)}catch(i){yield Bp(e,i)}RP(e)&&NP(e)})}function B4(t){return Pi(t)&&t.v_.length<10}function $4(t,e){t.v_.push(e);let n=Mi(t);n.Zo()&&n.T_&&n.E_(e.mutations)}function RP(t){return Pi(t)&&!Mi(t).Yo()&&t.v_.length>0}function NP(t){Mi(t).start()}function H4(t){return _(this,null,function*(){Mi(t).R_()})}function q4(t){return _(this,null,function*(){let e=Mi(t);for(let n of t.v_)e.E_(n.mutations)})}function G4(t,e,n){return _(this,null,function*(){let r=t.v_.shift(),i=cE.from(r,e,n);yield MP(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Va(t)})}function z4(t,e){return _(this,null,function*(){e&&Mi(t).T_&&(yield function(r,i){return _(this,null,function*(){if(function(o){return JN(o)&&o!==y.ABORTED}(i.code)){let s=r.v_.shift();Mi(r).e_(),yield MP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Va(r)}})}(t,e)),RP(t)&&NP(t)})}function iN(t,e){return _(this,null,function*(){let n=S(t);n.asyncQueue.verifyOperationInProgress(),E("RemoteStore","RemoteStore received new credentials");let r=Pi(n);n.M_.add(3),yield Fa(n),r&&n.N_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.M_.delete(3),yield Al(n)})}function nI(t,e){return _(this,null,function*(){let n=S(t);e?(n.M_.delete(2),yield Al(n)):e||(n.M_.add(2),yield Fa(n),n.N_.set("Unknown"))})}function La(t){return t.B_||(t.B_=function(n,r,i){let s=S(n);return s.m_(),new ZE(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:V4.bind(null,t),Io:L4.bind(null,t),Eo:j4.bind(null,t),l_:U4.bind(null,t)}),t.x_.push(e=>_(this,null,function*(){e?(t.B_.e_(),WI(t)?zI(t):t.N_.set("Unknown")):(yield t.B_.stop(),xP(t))}))),t.B_}function Mi(t){return t.k_||(t.k_=function(n,r,i){let s=S(n);return s.m_(),new JE(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:()=>Promise.resolve(),Io:H4.bind(null,t),Eo:z4.bind(null,t),A_:q4.bind(null,t),d_:G4.bind(null,t)}),t.x_.push(e=>_(this,null,function*(){e?(t.k_.e_(),yield Va(t)):(yield t.k_.stop(),t.v_.length>0&&(E("RemoteStore",`Stopping write stream with ${t.v_.length} pending writes`),t.v_=[]))}))),t.k_}var rI=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Ye,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new w(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ja(t,e){if($e("AsyncQueue",`${e}: ${t}`),Ni(t))return new w(y.UNAVAILABLE,`${e}: ${t}`);throw t}var $p=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||b.comparator(n.key,r.key):(n,r)=>b.comparator(n.key,r.key),this.keyedMap=Kc(),this.sortedSet=new Re(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var Hp=class{constructor(){this.q_=new Re(b.comparator)}track(e){let n=e.doc.key,r=this.q_.get(n);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(n,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(n):e.type===1&&r.type===2?this.q_=this.q_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):R():this.q_=this.q_.insert(n,e)}Q_(){let e=[];return this.q_.inorderTraversal((n,r)=>{e.push(r)}),e}},xa=class t{constructor(e,n,r,i,s,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,$p.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Tl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var iI=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},sI=class{constructor(){this.queries=new cr(e=>VN(e),Tl),this.onlineState="Unknown",this.z_=new Set}};function KI(t,e){return _(this,null,function*(){let n=S(t),r=3,i=e.query,s=n.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new iI,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield n.onListen(i,!0);break;case 1:s.K_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=ja(o,`Initialization of query '${ca(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.U_.push(e),e.j_(n.onlineState),s.K_&&e.H_(s.K_)&&YI(n)})}function QI(t,e){return _(this,null,function*(){let n=S(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function W4(t,e){let n=S(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&YI(n)}function K4(t,e,n){let r=S(t),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(n);r.queries.delete(e)}function YI(t){t.z_.forEach(e=>{e.next()})}var oI,sN;(sN=oI||(oI={})).J_="default",sN.Cache="cache";var _l=class{constructor(e,n,r){this.query=e,this.Y_=n,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new xa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),n=!0):this.ta(e,this.onlineState)&&(this.na(e),n=!0),this.X_=e,n}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let n=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),n=!0),n}ta(e,n){if(!e.fromCache||!this.G_())return!0;let r=n!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let n=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}na(e){e=xa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==oI.Cache}};var aI=class{constructor(e,n){this.ia=e,this.byteLength=n}sa(){return"metadata"in this.ia}};var qp=class{constructor(e){this.serializer=e}hs(e){return sr(this.serializer,e)}Ps(e){return e.metadata.exists?oP(this.serializer,e.document,!1):Ze.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return qe(e)}},uI=class{constructor(e,n,r){this.oa=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=PP(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++n;let r=ce.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}aa(e){let n=new Map,r=new qp(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.hs(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||Z()).add(s);n.set(o,a)}}return n}complete(){return _(this,null,function*(){let e=yield k4(this.localStore,new qp(this.serializer),this.documents,this.oa.id),n=this.aa(this.documents);for(let r of this.queries)yield O4(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function PP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Gp=class{constructor(e){this.key=e}},zp=class{constructor(e){this.key=e}},Wp=class{constructor(e,n){this.query=e,this.la=n,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=Z(),this.mutatedKeys=Z(),this.Ia=jN(e),this.Ta=new $p(this.Ia)}get Ea(){return this.la}da(e,n){let r=n?n.Aa:new Hp,i=n?n.Ta:this.Ta,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=bl(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),v=!0):this.Ra(h,f)||(r.track({type:2,doc:f}),v=!0,(u&&this.Ia(f,u)>0||c&&this.Ia(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),v=!0):h&&!f&&(r.track({type:1,doc:h}),v=!0,(u||c)&&(a=!0)),v&&(f?(o=o.add(f),s=g?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{Ta:o,Aa:r,Zi:a,mutatedKeys:s}}Ra(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((l,d)=>function(f,p){let g=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return R()}};return g(f)-g(p)}(l.type,d.type)||this.Ia(l.doc,d.doc)),this.Va(r),i=i!=null&&i;let a=n&&!i?this.ma():[],u=this.Pa.size===0&&this.current&&!i?1:0,c=u!==this.ha;return this.ha=u,o.length!==0||c?{snapshot:new xa(this.query,e.Ta,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new Hp,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(n=>this.la=this.la.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.la=this.la.delete(n)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=Z(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let n=[];return e.forEach(r=>{this.Pa.has(r)||n.push(new zp(r))}),this.Pa.forEach(r=>{e.has(r)||n.push(new Gp(r))}),n}pa(e){this.la=e.ls,this.Pa=Z();let n=this.da(e.documents);return this.applyChanges(n,!0)}ya(){return xa.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},cI=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},lI=class{constructor(e){this.key=e,this.wa=!1}},dI=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new cr(a=>VN(a),Tl),this.Da=new Map,this.Ca=new Set,this.va=new Re(b.comparator),this.Fa=new Map,this.Ma=new gl,this.xa={},this.Oa=new Map,this.Na=Ta.Nn(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function Q4(t,e,n=!0){return _(this,null,function*(){let r=og(t),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield kP(r,e,n,!0),i})}function Y4(t,e){return _(this,null,function*(){let n=og(t);yield kP(n,e,!0,!1)})}function kP(t,e,n,r){return _(this,null,function*(){let i=yield ba(t.localStore,kt(e)),s=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield ZI(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&sg(t.remoteStore,i),a})}function ZI(t,e,n,r,i){return _(this,null,function*(){t.Ba=(d,h,f)=>function(g,v,C,N){return _(this,null,function*(){let T=v.view.da(C);T.Zi&&(T=yield Op(g.localStore,v.query,!1).then(({documents:Ee})=>v.view.da(Ee,T)));let j=N&&N.targetChanges.get(v.targetId),H=N&&N.targetMismatches.get(v.targetId)!=null,W=v.view.applyChanges(T,g.isPrimaryClient,j,H);return hI(g,v.targetId,W.fa),W.snapshot})}(t,d,h,f);let s=yield Op(t.localStore,e,!0),o=new Wp(e,s.ls),a=o.da(s.documents),u=dl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,u);hI(t,n,c.fa);let l=new cI(e,n,o);return t.ba.set(e,l),t.Da.has(n)?t.Da.get(n).push(e):t.Da.set(n,[e]),c.snapshot})}function Z4(t,e,n){return _(this,null,function*(){let r=S(t),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!Tl(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Sa(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Aa(r.remoteStore,i.targetId),Ma(r,i.targetId)}).catch(Ri))):(Ma(r,i.targetId),yield Sa(r.localStore,i.targetId,!0))})}function J4(t,e){return _(this,null,function*(){let n=S(t),r=n.ba.get(e),i=n.Da.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Aa(n.remoteStore,r.targetId))})}function X4(t,e,n){return _(this,null,function*(){let r=tC(t);try{let i=yield function(o,a){let u=S(o),c=ke.now(),l=a.reduce((f,p)=>f.add(p.key),Z()),d,h;return u.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=qt(),g=Z();return u.ss.getEntries(f,l).next(v=>{p=v,p.forEach((C,N)=>{N.isValidDocument()||(g=g.add(C))})}).next(()=>u.localDocuments.getOverlayedDocuments(f,p)).next(v=>{d=v;let C=[];for(let N of a){let T=f4(N,d.get(N.key).overlayedDocument);T!=null&&C.push(new kn(N.key,T,MN(T.value.mapValue),je.exists(!0)))}return u.mutationQueue.addMutationBatch(f,c,C,a)}).next(v=>{h=v;let C=v.applyToLocalDocumentSet(d,g);return u.documentOverlayCache.saveOverlays(f,v.batchId,C)})}).then(()=>({batchId:h.batchId,changes:BN(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.xa[o.currentUser.toKey()];c||(c=new Re(Q)),c=c.insert(a,u),o.xa[o.currentUser.toKey()]=c}(r,i.batchId,n),yield Ur(r,i.changes),yield Va(r.remoteStore)}catch(i){let s=ja(i,"Failed to persist write");n.reject(s)}})}function OP(t,e){return _(this,null,function*(){let n=S(t);try{let r=yield N4(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Fa.get(s);o&&(O(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?O(o.wa):i.removedDocuments.size>0&&(O(o.wa),o.wa=!1))}),yield Ur(n,r,e)}catch(r){yield Ri(r)}})}function oN(t,e,n){let r=S(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=S(o);u.onlineState=a;let c=!1;u.queries.forEach((l,d)=>{for(let h of d.U_)h.j_(a)&&(c=!0)}),c&&YI(u)}(r.eventManager,e),i.length&&r.Sa.l_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function ez(t,e,n){return _(this,null,function*(){let r=S(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new Re(b.comparator);o=o.insert(s,Ze.newNoDocument(s,L.min()));let a=Z().add(s),u=new ll(L.min(),new Map,new Re(Q),o,a);yield OP(r,u),r.va=r.va.remove(s),r.Fa.delete(e),eC(r)}else yield Sa(r.localStore,e,!1).then(()=>Ma(r,e,n)).catch(Ri)})}function tz(t,e){return _(this,null,function*(){let n=S(t),r=e.batch.batchId;try{let i=yield R4(n.localStore,e);XI(n,r,null),JI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Ur(n,i)}catch(i){yield Ri(i)}})}function nz(t,e,n){return _(this,null,function*(){let r=S(t);try{let i=yield function(o,a){let u=S(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return u.mutationQueue.lookupMutationBatch(c,a).next(d=>(O(d!==null),l=d.keys(),u.mutationQueue.removeMutationBatch(c,d))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,l,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>u.localDocuments.getDocuments(c,l))})}(r.localStore,e);XI(r,e,n),JI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield Ur(r,i)}catch(i){yield Ri(i)}})}function rz(t,e){return _(this,null,function*(){let n=S(t);Pi(n.remoteStore)||E("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=S(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Oa.get(r)||[];i.push(e),n.Oa.set(r,i)}catch(r){let i=ja(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function JI(t,e){(t.Oa.get(e)||[]).forEach(n=>{n.resolve()}),t.Oa.delete(e)}function XI(t,e,n){let r=S(t),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function Ma(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Da.get(e))t.ba.delete(r),n&&t.Sa.ka(r,n);t.Da.delete(e),t.isPrimaryClient&&t.Ma.Rr(e).forEach(r=>{t.Ma.containsKey(r)||FP(t,r)})}function FP(t,e){t.Ca.delete(e.path.canonicalString());let n=t.va.get(e);n!==null&&(Aa(t.remoteStore,n),t.va=t.va.remove(e),t.Fa.delete(n),eC(t))}function hI(t,e,n){for(let r of n)r instanceof Gp?(t.Ma.addReference(r.key,e),iz(t,r)):r instanceof zp?(E("SyncEngine","Document no longer in limbo: "+r.key),t.Ma.removeReference(r.key,e),t.Ma.containsKey(r.key)||FP(t,r.key)):R()}function iz(t,e){let n=e.key,r=n.path.canonicalString();t.va.get(n)||t.Ca.has(r)||(E("SyncEngine","New document in limbo: "+n),t.Ca.add(r),eC(t))}function eC(t){for(;t.Ca.size>0&&t.va.size<t.maxConcurrentLimboResolutions;){let e=t.Ca.values().next().value;t.Ca.delete(e);let n=new b(ce.fromString(e)),r=t.Na.next();t.Fa.set(r,new lI(n)),t.va=t.va.insert(n,r),sg(t.remoteStore,new Da(kt(Oa(n.path)),r,"TargetPurposeLimboResolution",Zt.oe))}}function Ur(t,e,n){return _(this,null,function*(){let r=S(t),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,u)=>{o.push(r.Ba(u,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c?.fromCache?"not-current":"current"),c){i.push(c);let l=qE.Qi(u.targetId,c);s.push(l)}}))}),yield Promise.all(o),r.Sa.l_(i),yield function(u,c){return _(this,null,function*(){let l=S(u);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>m.forEach(c,h=>m.forEach(h.ki,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>m.forEach(h.qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Ni(d))throw d;E("LocalStore","Failed to update sequence numbers: "+d)}for(let d of c){let h=d.targetId;if(!d.fromCache){let f=l.ts.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);l.ts=l.ts.insert(h,g)}}})}(r.localStore,s))})}function sz(t,e){return _(this,null,function*(){let n=S(t);if(!n.currentUser.isEqual(e)){E("SyncEngine","User change. New user:",e.toKey());let r=yield EP(n.localStore,e);n.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(u=>{u.reject(new w(y.CANCELLED,o))})}),s.Oa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ur(n,r._s)}})}function oz(t,e){let n=S(t),r=n.Fa.get(e);if(r&&r.wa)return Z().add(r.key);{let i=Z(),s=n.Da.get(e);if(!s)return i;for(let o of s){let a=n.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function az(t,e){return _(this,null,function*(){let n=S(t),r=yield Op(n.localStore,e.query,!0),i=e.view.pa(r);return n.isPrimaryClient&&hI(n,e.targetId,i.fa),i})}function uz(t,e){return _(this,null,function*(){let n=S(t);return TP(n.localStore,e).then(r=>Ur(n,r))})}function cz(t,e,n,r){return _(this,null,function*(){let i=S(t),s=yield function(a,u){let c=S(a),l=S(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.Cn(d,u).next(h=>h?c.localDocuments.getDocuments(d,h):m.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield Va(i.remoteStore):n==="acknowledged"||n==="rejected"?(XI(i,e,r||null),JI(i,e),function(a,u){S(S(a).mutationQueue).Fn(u)}(i.localStore,e)):R(),yield Ur(i,s)):E("SyncEngine","Cannot apply mutation batch with id: "+e)})}function lz(t,e){return _(this,null,function*(){let n=S(t);if(og(n),tC(n),e===!0&&n.La!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield aN(n,r.toArray());n.La=!0,yield nI(n.remoteStore,!0);for(let s of i)sg(n.remoteStore,s)}else if(e===!1&&n.La!==!1){let r=[],i=Promise.resolve();n.Da.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Ma(n,o),Sa(n.localStore,o,!0))),Aa(n.remoteStore,o)}),yield i,yield aN(n,r),function(o){let a=S(o);a.Fa.forEach((u,c)=>{Aa(a.remoteStore,c)}),a.Ma.Vr(),a.Fa=new Map,a.va=new Re(b.comparator)}(n),n.La=!1,yield nI(n.remoteStore,!1)}})}function aN(t,e,n){return _(this,null,function*(){let r=S(t),i=[],s=[];for(let o of e){let a,u=r.Da.get(o);if(u&&u.length!==0){a=yield ba(r.localStore,kt(u[0]));for(let c of u){let l=r.ba.get(c),d=yield az(r,l);d.snapshot&&s.push(d.snapshot)}}else{let c=yield DP(r.localStore,o);a=yield ba(r.localStore,c),yield ZI(r,VP(c),o,!1,a.resumeToken)}i.push(a)}return r.Sa.l_(s),i})}function VP(t){return FN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function dz(t){return function(n){return S(S(n).persistence).Li()}(S(t).localStore)}function hz(t,e,n,r){return _(this,null,function*(){let i=S(t);if(i.La)return void E("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield TP(i.localStore,LN(s[0])),a=ll.createSynthesizedRemoteEventForCurrentChange(e,n==="current",at.EMPTY_BYTE_STRING);yield Ur(i,o,a);break}case"rejected":yield Sa(i.localStore,e,!0),Ma(i,e,r);break;default:R()}})}function fz(t,e,n){return _(this,null,function*(){let r=og(t);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){E("SyncEngine","Adding an already active target "+i);continue}let s=yield DP(r.localStore,i),o=yield ba(r.localStore,s);yield ZI(r,VP(s),o.targetId,!1,o.resumeToken),sg(r.remoteStore,o)}for(let i of n)r.Da.has(i)&&(yield Sa(r.localStore,i,!1).then(()=>{Aa(r.remoteStore,i),Ma(r,i)}).catch(Ri))}})}function og(t){let e=S(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=OP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ez.bind(null,e),e.Sa.l_=W4.bind(null,e.eventManager),e.Sa.ka=K4.bind(null,e.eventManager),e}function tC(t){let e=S(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=tz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=nz.bind(null,e),e}function pz(t,e,n){let r=S(t);(function(s,o,a){return _(this,null,function*(){try{let u=yield o.getMetadata();if(yield function(f,p){let g=S(f),v=qe(p.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",C=>g.Kr.getBundleMetadata(C,p.id)).then(C=>!!C&&C.createTime.compareTo(v)>=0)}(s.localStore,u))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(PP(u));let c=new uI(u,s.localStore,o.serializer),l=yield o.qa();for(;l;){let h=yield c._a(l);h&&a._updateProgress(h),l=yield o.qa()}let d=yield c.complete();return yield Ur(s,d.ca,void 0),yield function(f,p){let g=S(f);return g.persistence.runTransaction("Save bundle","readwrite",v=>g.Kr.saveBundleMetadata(v,p))}(s.localStore,u),a._completeWith(d.progress),Promise.resolve(d.ua)}catch(u){return gn("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var vl=class{constructor(){this.synchronizeTabs=!1}initialize(e){return _(this,null,function*(){this.serializer=Sl(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return wP(this.persistence,new kp,e.initialUser,this.serializer)}createPersistence(e){return new Np(Pp.jr,this.serializer)}createSharedClientState(e){return new Lp}terminate(){return _(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Kp=class t extends vl{constructor(e,n,r){super(),this.Qa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return _(this,null,function*(){yield hm(t.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield tC(this.Qa.syncEngine),yield Va(this.Qa.remoteStore),yield this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return wP(this.persistence,new kp,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new xE(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new Ww(n,this.persistence);return new zw(e.asyncQueue,r)}createPersistence(e){let n=qI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?pn.withCacheSize(this.cacheSizeBytes):pn.DEFAULT;return new HE(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,SP(),op(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Lp}},fI=class t extends Kp{constructor(e,n){super(e,n,!1),this.Qa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return _(this,null,function*(){yield hm(t.prototype,this,"initialize").call(this,e);let n=this.Qa.syncEngine;this.sharedClientState instanceof el&&(this.sharedClientState.syncEngine={Ys:cz.bind(null,n),Zs:hz.bind(null,n),Xs:fz.bind(null,n),Li:dz.bind(null,n),Js:uz.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.mi(r=>_(this,null,function*(){yield lz(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=SP();if(!el.D(n))throw new w(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=qI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new el(n,e.asyncQueue,r,e.clientId,e.initialUser)}},wl=class{initialize(e,n){return _(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>oN(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=sz.bind(null,this.syncEngine),yield nI(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new sI}()}createDatastore(e){let n=Sl(e.databaseInfo.databaseId),r=function(s){return new YE(s)}(e.databaseInfo);return function(s,o,a,u){return new XE(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new tI(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>oN(this.syncEngine,n,0),function(){return jp.D()?new jp:new KE}())}createSyncEngine(e,n){return function(i,s,o,a,u,c,l){let d=new dI(i,s,o,a,u,c);return l&&(d.La=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return _(this,null,function*(){var e;yield function(r){return _(this,null,function*(){let i=S(r);E("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield Fa(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function uN(t,e=10240){let n=0;return{read(){return _(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return _(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Ra=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):$e("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var pI=class{constructor(e,n){this.Ua=e,this.serializer=n,this.metadata=new Ye,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return _(this,null,function*(){return this.metadata.promise})}qa(){return _(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return _(this,null,function*(){let e=yield this.za();if(e===null)return null;let n=this.Wa.decode(e),r=Number(n);isNaN(r)&&this.ja(`length string (${n}) is not valid number`);let i=yield this.Ha(r);return new aI(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return _(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ha(e){return _(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let n=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return _(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var gI=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return _(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new w(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return _(this,null,function*(){let o=S(i),a={documents:s.map(d=>hl(o.serializer,d))},u=yield o.Mo("BatchGetDocuments",o.serializer.databaseId,ce.emptyPath(),a,s.length),c=new Map;u.forEach(d=>{let h=v4(o.serializer,d);c.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=c.get(d.toString());O(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new xi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return _(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=b.fromPath(r);this.mutations.push(new al(i,this.precondition(i)))}),yield function(r,i){return _(this,null,function*(){let s=S(r),o={writes:i.map(a=>fl(s.serializer,a))};yield s.Do("Commit",s.serializer.databaseId,ce.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw R();n=L.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new w(y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(L.min())?je.exists(!1):je.updateTime(n):je.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(L.min()))throw new w(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return je.updateTime(n)}return je.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var mI=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Jo=new yl(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Jo.Ko(()=>_(this,null,function*(){let e=new gI(this.datastore),n=this.tu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let n=this.updateFunction(e);return!Cl(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!JN(n)}return!1}};var yI=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Qe.UNAUTHENTICATED,this.clientId=cp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>_(this,null,function*(){E("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(E("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new w(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Ye;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=ja(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function ap(t,e){return _(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),E("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>_(this,null,function*(){r.isEqual(i)||(yield EP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function _I(t,e){return _(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield nC(t);E("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>iN(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>iN(e.remoteStore,i)),t._onlineComponents=e})}function LP(t){return t.name==="FirebaseError"?t.code===y.FAILED_PRECONDITION||t.code===y.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function nC(t){return _(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){E("FirestoreClient","Using user provided OfflineComponentProvider");try{yield ap(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!LP(n))throw n;gn("Error using user provided cache. Falling back to memory cache: "+n),yield ap(t,new vl)}}else E("FirestoreClient","Using default OfflineComponentProvider"),yield ap(t,new vl);return t._offlineComponents})}function ag(t){return _(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(E("FirestoreClient","Using user provided OnlineComponentProvider"),yield _I(t,t._uninitializedComponentsProvider._online)):(E("FirestoreClient","Using default OnlineComponentProvider"),yield _I(t,new wl))),t._onlineComponents})}function jP(t){return nC(t).then(e=>e.persistence)}function rC(t){return nC(t).then(e=>e.localStore)}function UP(t){return ag(t).then(e=>e.remoteStore)}function iC(t){return ag(t).then(e=>e.syncEngine)}function gz(t){return ag(t).then(e=>e.datastore)}function Na(t){return _(this,null,function*(){let e=yield ag(t),n=e.eventManager;return n.onListen=Q4.bind(null,e.syncEngine),n.onUnlisten=Z4.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Y4.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=J4.bind(null,e.syncEngine),n})}function mz(t){return t.asyncQueue.enqueue(()=>_(this,null,function*(){let e=yield jP(t),n=yield UP(t);return e.setNetworkEnabled(!0),function(i){let s=S(i);return s.M_.delete(0),Al(s)}(n)}))}function yz(t){return t.asyncQueue.enqueue(()=>_(this,null,function*(){let e=yield jP(t),n=yield UP(t);return e.setNetworkEnabled(!1),function(i){return _(this,null,function*(){let s=S(i);s.M_.add(0),yield Fa(s),s.N_.set("Offline")})}(n)}))}function _z(t,e){let n=new Ye;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s,o){return _(this,null,function*(){try{let a=yield function(c,l){let d=S(c);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new w(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=ja(a,`Failed to get document '${s} from cache`);o.reject(u)}})}(yield rC(t),e,n)})),n.promise}function BP(t,e,n={}){let r=new Ye;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(s,o,a,u,c){let l=new Ra({next:h=>{o.enqueueAndForget(()=>QI(s,d));let f=h.docs.has(a);!f&&h.fromCache?c.reject(new w(y.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&u&&u.source==="server"?c.reject(new w(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new _l(Oa(a.path),l,{includeMetadataChanges:!0,ra:!0});return KI(s,d)}(yield Na(t),t.asyncQueue,e,n,r)})),r.promise}function vz(t,e){let n=new Ye;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s,o){return _(this,null,function*(){try{let a=yield Op(i,s,!0),u=new Wp(s,a.ls),c=u.da(a.documents),l=u.applyChanges(c,!1);o.resolve(l.snapshot)}catch(a){let u=ja(a,`Failed to execute query '${s} against cache`);o.reject(u)}})}(yield rC(t),e,n)})),n.promise}function $P(t,e,n={}){let r=new Ye;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(s,o,a,u,c){let l=new Ra({next:h=>{o.enqueueAndForget(()=>QI(s,d)),h.fromCache&&u.source==="server"?c.reject(new w(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new _l(a,l,{includeMetadataChanges:!0,ra:!0});return KI(s,d)}(yield Na(t),t.asyncQueue,e,n,r)})),r.promise}function wz(t,e){let n=new Ra(e);return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s){S(i).z_.add(s),s.next()}(yield Na(t),n)})),()=>{n.$a(),t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s){S(i).z_.delete(s)}(yield Na(t),n)}))}}function Ez(t,e,n,r){let i=function(o,a){let u;return u=typeof o=="string"?eP().encode(o):o,function(l,d){return new pI(l,d)}(function(l,d){if(l instanceof Uint8Array)return uN(l,d);if(l instanceof ArrayBuffer)return uN(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(n,Sl(e));t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){pz(yield iC(t),i,r)}))}function Iz(t,e){return t.asyncQueue.enqueue(()=>_(this,null,function*(){return function(r,i){let s=S(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,i))}(yield rC(t),e)}))}function HP(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var cN=new Map;function sC(t,e,n){if(!n)throw new w(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function oC(t,e,n,r){if(e===!0&&r===!0)throw new w(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function lN(t){if(!b.isDocumentKey(t))throw new w(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function dN(t){if(b.isDocumentKey(t))throw new w(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ug(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":R()}function le(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new w(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=ug(t);throw new w(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function qP(t,e){if(e<=0)throw new w(y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var Qp=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new w(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new w(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}oC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=HP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Fs=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new w(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new w(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qp(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Fw;switch(r.type){case"firstParty":return new Uw(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new w(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=cN.get(n);r&&(E("ComponentProvider","Removing Datastore"),cN.delete(n),r.terminate())}(this),Promise.resolve()}};function GP(t,e,n,r={}){var i;let s=(t=le(t,Fs))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&gn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=Qe.MOCK_USER;else{a=fd(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new w(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Qe(c)}t._authCredentials=new Vw(new up(a,u))}}var mt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},be=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new or(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},or=class t extends mt{constructor(e,n,r){super(e,n,Oa(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new be(this.firestore,null,new b(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function aC(t,e,...n){if(t=ie(t),sC("collection","path",e),t instanceof Fs){let r=ce.fromString(e,...n);return dN(r),new or(t,null,r)}{if(!(t instanceof be||t instanceof or))throw new w(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ce.fromString(e,...n));return dN(r),new or(t.firestore,null,r)}}function zP(t,e){if(t=le(t,Fs),sC("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new w(y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new mt(t,null,function(r){return new Pn(ce.emptyPath(),r)}(e))}function xl(t,e,...n){if(t=ie(t),arguments.length===1&&(e=cp.newId()),sC("doc","path",e),t instanceof Fs){let r=ce.fromString(e,...n);return lN(r),new be(t,null,new b(r))}{if(!(t instanceof be||t instanceof or))throw new w(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ce.fromString(e,...n));return lN(r),new be(t.firestore,t instanceof or?t.converter:null,new b(r))}}function uC(t,e){return t=ie(t),e=ie(e),(t instanceof be||t instanceof or)&&(e instanceof be||e instanceof or)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function cC(t,e){return t=ie(t),e=ie(e),t instanceof mt&&e instanceof mt&&t.firestore===e.firestore&&Tl(t._query,e._query)&&t.converter===e.converter}var vI=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Jo=new yl(this,"async_queue_retry"),this.hu=()=>{let n=op();n&&E("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Jo.Uo()};let e=op();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let n=op();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let n=new Ye;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return _(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Jo.reset()}catch(e){if(!Ni(e))throw e;E("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Jo.Ko(()=>this.Tu())}})}Iu(e){let n=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw $e("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=n,n}enqueueAfterDelay(e,n,r){this.Pu(),this.lu.indexOf(e)>-1&&(n=0);let i=rI.createAndSchedule(this,e,n,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&R()}verifyOperationInProgress(){}du(){return _(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let n of this._u)if(n.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this._u)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let n=this._u.indexOf(e);this._u.splice(n,1)}};function wI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var EI=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Ye,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var WP=-1,Ne=class extends Fs{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new vI}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||KP(this),this._firestoreClient.terminate()}};function nt(t){return t._firestoreClient||KP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function KP(t){var e,n,r;let i=t._freezeSettings(),s=function(a,u,c,l){return new Kw(a,u,c,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,HP(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new yI(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function QP(t,e){ik(t=le(t,Ne));let n=nt(t);if(n._uninitializedComponentsProvider)throw new w(y.FAILED_PRECONDITION,"SDK cache is already specified.");gn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new wl;return ZP(n,i,new Kp(i,r.cacheSizeBytes,e?.forceOwnership))}function YP(t){ik(t=le(t,Ne));let e=nt(t);if(e._uninitializedComponentsProvider)throw new w(y.FAILED_PRECONDITION,"SDK cache is already specified.");gn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new wl;return ZP(e,r,new fI(r,n.cacheSizeBytes))}function ZP(t,e,n){let r=new Ye;return t.asyncQueue.enqueue(()=>_(this,null,function*(){try{yield ap(t,n),yield _I(t,e),r.resolve()}catch(i){let s=i;if(!LP(s))throw s;gn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function JP(t){if(t._initialized&&!t._terminated)throw new w(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Ye;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{yield function(r){return _(this,null,function*(){if(!Ii.D())return Promise.resolve();let i=r+"main";yield Ii.delete(i)})}(qI(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function XP(t){return function(n){let r=new Ye;return n.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return rz(yield iC(n),r)})),r.promise}(nt(t=le(t,Ne)))}function ek(t){return mz(nt(t=le(t,Ne)))}function tk(t){return yz(nt(t=le(t,Ne)))}function nk(t,e){let n=nt(t=le(t,Ne)),r=new EI;return Ez(n,t._databaseId,e,r),r}function rk(t,e){return Iz(nt(t=le(t,Ne)),e).then(n=>n?new mt(t,null,n.query):null)}function ik(t){if(t._initialized||t._terminated)throw new w(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var lr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(at.fromBase64String(e))}catch(n){throw new w(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(at.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var On=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new w(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new He(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Lr=class{constructor(e){this._methodName=e}};var Vs=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new w(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new w(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Q(this._lat,e._lat)||Q(this._long,e._long)}};var Cz=/^__.*__$/,II=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new kn(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ai(e,this.data,n,this.fieldTransforms)}},Yp=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new kn(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function sk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw R()}}var Zp=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return Jp(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(sk(this.fu)&&Cz.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},CI=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Sl(e)}Fu(e,n,r,i=!1){return new Zp({fu:e,methodName:n,vu:r,path:He.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Bs(t){let e=t._freezeSettings(),n=Sl(t._databaseId);return new CI(t._databaseId,!!e.ignoreUndefinedProperties,n)}function cg(t,e,n,r,i,s={}){let o=t.Fu(s.merge||s.mergeFields?2:0,e,n,i);hC("Data must be an object, but it was:",o,r);let a=uk(r,o),u,c;if(s.merge)u=new Jt(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=AI(e,d,n);if(!o.contains(h))throw new w(y.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);lk(l,h)||l.push(h)}u=new Jt(l),c=o.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,c=o.fieldTransforms;return new II(new St(a),u,c)}var El=class t extends Lr{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function ok(t,e,n){return new Zp({fu:3,vu:e.settings.vu,methodName:t._methodName,yu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var DI=class t extends Lr{_toFieldTransform(e){return new Ps(e.path,new bi)}isEqual(e){return e instanceof t}},TI=class t extends Lr{constructor(e,n){super(e),this.Mu=n}_toFieldTransform(e){let n=ok(this,e,!0),r=this.Mu.map(s=>$s(s,n)),i=new Fr(r);return new Ps(e.path,i)}isEqual(e){return e instanceof t&&gm(this.Mu,e.Mu)}},bI=class t extends Lr{constructor(e,n){super(e),this.Mu=n}_toFieldTransform(e){let n=ok(this,e,!0),r=this.Mu.map(s=>$s(s,n)),i=new Vr(r);return new Ps(e.path,i)}isEqual(e){return e instanceof t&&gm(this.Mu,e.Mu)}},SI=class t extends Lr{constructor(e,n){super(e),this.xu=n}_toFieldTransform(e){let n=new Si(e.serializer,GN(e.serializer,this.xu));return new Ps(e.path,n)}isEqual(e){return e instanceof t&&this.xu===e.xu}};function lC(t,e,n,r){let i=t.Fu(1,e,n);hC("Data must be an object, but it was:",i,r);let s=[],o=St.empty();Us(r,(u,c)=>{let l=fC(e,u,n);c=ie(c);let d=i.Su(l);if(c instanceof El)s.push(l);else{let h=$s(c,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new Jt(s);return new Yp(o,a,i.fieldTransforms)}function dC(t,e,n,r,i,s){let o=t.Fu(1,e,n),a=[AI(e,r,n)],u=[i];if(s.length%2!=0)throw new w(y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(AI(e,s[h])),u.push(s[h+1]);let c=[],l=St.empty();for(let h=a.length-1;h>=0;--h)if(!lk(c,a[h])){let f=a[h],p=u[h];p=ie(p);let g=o.Su(f);if(p instanceof El)c.push(f);else{let v=$s(p,g);v!=null&&(c.push(f),l.set(f,v))}}let d=new Jt(c);return new Yp(l,d,o.fieldTransforms)}function ak(t,e,n,r=!1){return $s(n,t.Fu(r?4:3,e))}function $s(t,e){if(ck(t=ie(t)))return hC("Unsupported field value:",e,t),uk(t,e);if(t instanceof Lr)return function(r,i){if(!sk(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=$s(a,i.bu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ie(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return GN(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=ke.fromDate(r);return{timestampValue:Ca(i.serializer,s)}}if(r instanceof ke){let s=new ke(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ca(i.serializer,s)}}if(r instanceof Vs)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof lr)return{bytesValue:tP(i.serializer,r._byteString)};if(r instanceof be){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:BI(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${ug(r)}`)}(t,e)}function uk(t,e){let n={};return SN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Us(t,(r,i)=>{let s=$s(i,e.pu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function ck(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ke||t instanceof Vs||t instanceof lr||t instanceof be||t instanceof Lr)}function hC(t,e,n){if(!ck(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=ug(n);throw r==="an object"?e.Du(t+" a custom object"):e.Du(t+" "+r)}}function AI(t,e,n){if((e=ie(e))instanceof On)return e._internalPath;if(typeof e=="string")return fC(t,e);throw Jp("Field path arguments must be of type string or ",t,!1,void 0,n)}var Dz=new RegExp("[~\\*/\\[\\]]");function fC(t,e,n){if(e.search(Dz)>=0)throw Jp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new On(...e.split("."))._internalPath}catch{throw Jp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Jp(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new w(y.INVALID_ARGUMENT,a+t+u)}function lk(t,e){return t.some(n=>n.isEqual(e))}var Ls=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new be(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new xI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(lg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},xI=class extends Ls{data(){return super.data()}};function lg(t,e){return typeof e=="string"?fC(t,e):e instanceof On?e._internalPath:e._delegate._internalPath}function dk(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new w(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Il=class{},js=class extends Il{};function Br(t,e,...n){let r=[];e instanceof Il&&r.push(e),r=r.concat(n),function(s){let o=s.filter(u=>u instanceof MI).length,a=s.filter(u=>u instanceof Xp).length;if(o>1||o>0&&a>0)throw new w(y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var Xp=class t extends js{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return Ek(e._query,n),new mt(e.firestore,e.converter,aE(e._query,n))}_parse(e){let n=Bs(e.firestore);return function(s,o,a,u,c,l,d){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new w(y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){fN(d,l);let f=[];for(let p of d)f.push(hN(u,s,p));h={arrayValue:{values:f}}}else h=hN(u,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||fN(d,l),h=ak(a,o,d,l==="in"||l==="not-in");return oe.create(c,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function hk(t,e,n){let r=e,i=lg("where",t);return Xp._create(i,r,n)}var MI=class t extends Il{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:we.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let u of a)Ek(o,u),o=aE(o,u)}(e._query,n),new mt(e.firestore,e.converter,aE(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var RI=class t extends js{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new w(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new w(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Rs(s,o)}(e._query,this._field,this._direction);return new mt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Pn(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function fk(t,e="asc"){let n=e,r=lg("orderBy",t);return RI._create(r,n)}var eg=class t extends js{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new mt(e.firestore,e.converter,vp(e._query,this._limit,this._limitType))}};function pk(t){return qP("limit",t),eg._create("limit",t,"F")}function gk(t){return qP("limitToLast",t),eg._create("limitToLast",t,"L")}var tg=class t extends js{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=wk(e,this.type,this._docOrFields,this._inclusive);return new mt(e.firestore,e.converter,function(i,s){return new Pn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function mk(...t){return tg._create("startAt",t,!0)}function yk(...t){return tg._create("startAfter",t,!1)}var ng=class t extends js{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=wk(e,this.type,this._docOrFields,this._inclusive);return new mt(e.firestore,e.converter,function(i,s){return new Pn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function _k(...t){return ng._create("endBefore",t,!1)}function vk(...t){return ng._create("endAt",t,!0)}function wk(t,e,n,r){if(n[0]=ie(n[0]),n[0]instanceof Ls)return function(s,o,a,u,c){if(!u)throw new w(y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of ga(s))if(d.field.isKeyField())l.push(Ms(o,u.key));else{let h=u.data.field(d.field);if(ig(h))throw new w(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new w(y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new ur(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=Bs(t.firestore);return function(o,a,u,c,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new w(y.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let g=l[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new w(y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!jI(o)&&g.indexOf("/")!==-1)throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);let v=o.path.child(ce.fromString(g));if(!b.isDocumentKey(v))throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);let C=new b(v);f.push(Ms(a,C))}else{let v=ak(u,c,g);f.push(v)}}return new ur(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function hN(t,e,n){if(typeof(n=ie(n))=="string"){if(n==="")throw new w(y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!jI(e)&&n.indexOf("/")!==-1)throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(ce.fromString(n));if(!b.isDocumentKey(r))throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ms(t,new b(r))}if(n instanceof be)return Ms(t,n._key);throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ug(n)}.`)}function fN(t,e){if(!Array.isArray(t)||t.length===0)throw new w(y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ek(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new w(y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new w(y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var Pa=class{convertValue(e,n="none"){switch(xs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Le(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ci(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw R()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return Us(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Vs(Le(e.latitude),Le(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=VI(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(il(e));default:return null}}convertTimestamp(e){let n=Or(e);return new ke(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=ce.fromString(e);O(hP(r));let i=new Di(r.get(1),r.get(3)),s=new b(r.popFirst(5));return i.isEqual(n)||$e(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function dg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var NI=class extends Pa{constructor(e){super(),this.firestore=e}convertBytes(e){return new lr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new be(this.firestore,null,n)}};var kr=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},yn=class extends Ls{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new wi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(lg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},wi=class extends yn{data(e={}){return super.data(e)}},Fn=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new kr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new wi(this._firestore,this._userDataWriter,r.key,r,new kr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new w(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let u=new wi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new kr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let u=new wi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new kr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,l=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:Tz(a.type),doc:u,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function Tz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return R()}}function pC(t,e){return t instanceof yn&&e instanceof yn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Fn&&e instanceof Fn&&t._firestore===e._firestore&&cC(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Ik(t){t=le(t,be);let e=le(t.firestore,Ne);return BP(nt(e),t._key).then(n=>_C(e,t,n))}var jr=class extends Pa{constructor(e){super(),this.firestore=e}convertBytes(e){return new lr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new be(this.firestore,null,n)}};function Ck(t){t=le(t,be);let e=le(t.firestore,Ne),n=nt(e),r=new jr(e);return _z(n,t._key).then(i=>new yn(e,r,t._key,i,new kr(i!==null&&i.hasLocalMutations,!0),t.converter))}function Dk(t){t=le(t,be);let e=le(t.firestore,Ne);return BP(nt(e),t._key,{source:"server"}).then(n=>_C(e,t,n))}function Tk(t){t=le(t,mt);let e=le(t.firestore,Ne),n=nt(e),r=new jr(e);return dk(t._query),$P(n,t._query).then(i=>new Fn(e,r,t,i))}function bk(t){t=le(t,mt);let e=le(t.firestore,Ne),n=nt(e),r=new jr(e);return vz(n,t._query).then(i=>new Fn(e,r,t,i))}function Sk(t){t=le(t,mt);let e=le(t.firestore,Ne),n=nt(e),r=new jr(e);return $P(n,t._query,{source:"server"}).then(i=>new Fn(e,r,t,i))}function gC(t,e,n){t=le(t,be);let r=le(t.firestore,Ne),i=dg(t.converter,e,n);return Ua(r,[cg(Bs(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,je.none())])}function mC(t,e,n,...r){t=le(t,be);let i=le(t.firestore,Ne),s=Bs(i),o;return o=typeof(e=ie(e))=="string"||e instanceof On?dC(s,"updateDoc",t._key,e,n,r):lC(s,"updateDoc",t._key,e),Ua(i,[o.toMutation(t._key,je.exists(!0))])}function Ak(t){return Ua(le(t.firestore,Ne),[new xi(t._key,je.none())])}function xk(t,e){let n=le(t.firestore,Ne),r=xl(t),i=dg(t.converter,e);return Ua(n,[cg(Bs(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,je.exists(!1))]).then(()=>r)}function yC(t,...e){var n,r,i;t=ie(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||wI(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(wI(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let u,c,l;if(t instanceof be)c=le(t.firestore,Ne),l=Oa(t._key.path),u={next:d=>{e[o]&&e[o](_C(c,t,d))},error:e[o+1],complete:e[o+2]};else{let d=le(t,mt);c=le(d.firestore,Ne),l=d._query;let h=new jr(c);u={next:f=>{e[o]&&e[o](new Fn(c,h,d,f))},error:e[o+1],complete:e[o+2]},dk(t._query)}return function(h,f,p,g){let v=new Ra(g),C=new _l(f,v,p);return h.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return KI(yield Na(h),C)})),()=>{v.$a(),h.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return QI(yield Na(h),C)}))}}(nt(c),l,a,u)}function Mk(t,e){return wz(nt(t=le(t,Ne)),wI(e)?e:{next:e})}function Ua(t,e){return function(r,i){let s=new Ye;return r.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return X4(yield iC(r),i,s)})),s.promise}(nt(t),e)}function _C(t,e,n){let r=n.docs.get(e._key),i=new jr(t);return new yn(t,i,e._key,r,new kr(n.hasPendingWrites,n.fromCache),e.converter)}var bz={maxAttempts:5};var rg=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Bs(e)}set(e,n,r){this._verifyNotCommitted();let i=_i(e,this._firestore),s=dg(i.converter,n,r),o=cg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,je.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=_i(e,this._firestore),o;return o=typeof(n=ie(n))=="string"||n instanceof On?dC(this._dataReader,"WriteBatch.update",s._key,n,r,i):lC(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,je.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=_i(e,this._firestore);return this._mutations=this._mutations.concat(new xi(n._key,je.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new w(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function _i(t,e){if((t=ie(t)).firestore!==e)throw new w(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var PI=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Bs(n)}get(n){let r=_i(n,this._firestore),i=new NI(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return R();let o=s[0];if(o.isFoundDocument())return new Ls(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Ls(this._firestore,i,r._key,null,r.converter);throw R()})}set(n,r,i){let s=_i(n,this._firestore),o=dg(s.converter,r,i),a=cg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=_i(n,this._firestore),a;return a=typeof(r=ie(r))=="string"||r instanceof On?dC(this._dataReader,"Transaction.update",o._key,r,i,s):lC(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=_i(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=_i(e,this._firestore),r=new jr(this._firestore);return super.get(e).then(i=>new yn(this._firestore,r,n._key,i._document,new kr(!1,!1),n.converter))}};function Rk(t,e,n){t=le(t,Ne);let r=Object.assign(Object.assign({},bz),n);return function(s){if(s.maxAttempts<1)throw new w(y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let u=new Ye;return s.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){let c=yield gz(s);new mI(s.asyncQueue,c,a,o,u).Xa()})),u.promise}(nt(t),i=>e(new PI(t,i)),r)}function Nk(){return new El("deleteField")}function Pk(){return new DI("serverTimestamp")}function kk(...t){return new TI("arrayUnion",t)}function Ok(...t){return new bI("arrayRemove",t)}function Fk(t){return new SI("increment",t)}(function(e,n=!0){(function(i){ka=i})(_d),Hi(new Gt("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ne(new Lw(r.getProvider("auth-internal")),new $w(r.getProvider("app-check-internal")),function(c,l){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new w(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Di(c.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),En(pR,"4.6.1",e),En(pR,"4.6.1","esm2017")})();var Sz="@firebase/firestore-compat",Az="0.3.30";function DC(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new w("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function Vk(){if(typeof Uint8Array>"u")throw new w("unimplemented","Uint8Arrays are not available in this environment.")}function Lk(){if(!AN())throw new w("unimplemented","Blobs are unavailable in Firestore in this environment.")}var hg=class t{constructor(e){this._delegate=e}static fromBase64String(e){return Lk(),new t(lr.fromBase64String(e))}static fromUint8Array(e){return Vk(),new t(lr.fromUint8Array(e))}toBase64(){return Lk(),this._delegate.toBase64()}toUint8Array(){return Vk(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function vC(t){return xz(t,["next","error","complete"])}function xz(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var wC=class{enableIndexedDbPersistence(e,n){return QP(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return YP(e._delegate)}clearIndexedDbPersistence(e){return JP(e._delegate)}},fg=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Di||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&gn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){GP(this._delegate,e,n,r)}enableNetwork(){return ek(this._delegate)}disableNetwork(){return tk(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,oC("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return XP(this._delegate)}onSnapshotsInSync(e){return Mk(this._delegate,e)}get app(){if(!this._appCompat)throw new w("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ha(this,aC(this._delegate,e))}catch(n){throw Ot(n,"collection()","Firestore.collection()")}}doc(e){try{return new dr(this,xl(this._delegate,e))}catch(n){throw Ot(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new zs(this,zP(this._delegate,e))}catch(n){throw Ot(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Rk(this._delegate,n=>e(new pg(this,n)))}batch(){return nt(this._delegate),new gg(new rg(this._delegate,e=>Ua(this._delegate,e)))}loadBundle(e){return nk(this._delegate,e)}namedQuery(e){return rk(this._delegate,e).then(n=>n?new zs(this,n):null)}},Ba=class extends Pa{constructor(e){super(),this.firestore=e}convertBytes(e){return new hg(new lr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return dr.forKey(n,this.firestore,null)}};function Mz(t){pN(t)}var pg=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Ba(e)}get(e){let n=Hs(e);return this._delegate.get(n).then(r=>new qs(this._firestore,new yn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=Hs(e);return r?(DC("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Hs(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Hs(e);return this._delegate.delete(n),this}},gg=class{constructor(e){this._delegate=e}set(e,n,r){let i=Hs(e);return r?(DC("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Hs(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Hs(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},$a=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new wi(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Gs(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new Ba(e),n),i.set(n,s)),s}};$a.INSTANCES=new WeakMap;var dr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Ba(e)}static forPath(e,n,r){if(e.length%2!==0)throw new w("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new be(n._delegate,r,new b(e)))}static forKey(e,n,r){return new t(n,new be(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ha(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ha(this.firestore,aC(this._delegate,e))}catch(n){throw Ot(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ie(e),e instanceof be?uC(this._delegate,e):!1}set(e,n){n=DC("DocumentReference.set",n);try{return n?gC(this._delegate,e,n):gC(this._delegate,e)}catch(r){throw Ot(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?mC(this._delegate,e):mC(this._delegate,e,n,...r)}catch(i){throw Ot(i,"updateDoc()","DocumentReference.update()")}}delete(){return Ak(this._delegate)}onSnapshot(...e){let n=jk(e),r=Uk(e,i=>new qs(this.firestore,new yn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return yC(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=Ck(this._delegate):e?.source==="server"?n=Dk(this._delegate):n=Ik(this._delegate),n.then(r=>new qs(this.firestore,new yn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter($a.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Ot(t,e,n){return t.message=t.message.replace(e,n),t}function jk(t){for(let e of t)if(typeof e=="object"&&!vC(e))return e;return{}}function Uk(t,e){var n,r;let i;return vC(t[0])?i=t[0]:vC(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var qs=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new dr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return pC(this._delegate,e._delegate)}},Gs=class extends qs{data(e){let n=this._delegate.data(e);return this._delegate._converter||gN(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},zs=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Ba(e)}where(e,n,r){try{return new t(this.firestore,Br(this._delegate,hk(e,n,r)))}catch(i){throw Ot(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,Br(this._delegate,fk(e,n)))}catch(r){throw Ot(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,Br(this._delegate,pk(e)))}catch(n){throw Ot(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,Br(this._delegate,gk(e)))}catch(n){throw Ot(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,Br(this._delegate,mk(...e)))}catch(n){throw Ot(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,Br(this._delegate,yk(...e)))}catch(n){throw Ot(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,Br(this._delegate,_k(...e)))}catch(n){throw Ot(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,Br(this._delegate,vk(...e)))}catch(n){throw Ot(n,"endAt()","Query.endAt()")}}isEqual(e){return cC(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=bk(this._delegate):e?.source==="server"?n=Sk(this._delegate):n=Tk(this._delegate),n.then(r=>new Ml(this.firestore,new Fn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=jk(e),r=Uk(e,i=>new Ml(this.firestore,new Fn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return yC(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter($a.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},EC=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Gs(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Ml=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new zs(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Gs(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new EC(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Gs(this._firestore,r))})}isEqual(e){return pC(this._delegate,e._delegate)}},Ha=class t extends zs{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new dr(this.firestore,e):null}doc(e){try{return e===void 0?new dr(this.firestore,xl(this._delegate)):new dr(this.firestore,xl(this._delegate,e))}catch(n){throw Ot(n,"doc()","CollectionReference.doc()")}}add(e){return xk(this._delegate,e).then(n=>new dr(this.firestore,n))}isEqual(e){return uC(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter($a.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Hs(t){return le(t,be)}var IC=class t{constructor(...e){this._delegate=new On(...e)}static documentId(){return new t(He.keyField().canonicalString())}isEqual(e){return e=ie(e),e instanceof On?this._delegate._internalPath.isEqual(e._internalPath):!1}};var CC=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=Pk();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=Nk();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=kk(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=Ok(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=Fk(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var Rz={Firestore:fg,GeoPoint:Vs,Timestamp:ke,Blob:hg,Transaction:pg,WriteBatch:gg,DocumentReference:dr,DocumentSnapshot:qs,Query:zs,QueryDocumentSnapshot:Gs,QuerySnapshot:Ml,CollectionReference:Ha,FieldPath:IC,FieldValue:CC,setLogLevel:Mz,CACHE_SIZE_UNLIMITED:WP};function Nz(t,e){t.INTERNAL.registerComponent(new Gt("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Rz)))}function Pz(t){Nz(t,(e,n)=>new fg(e,n,new wC)),t.registerVersion(Sz,Az)}Pz(Xe);function kz(t,e=Ki){return new X(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function Bk(t,e){return kz(t,e)}function Oz(t,e){return Bk(t,e).pipe(Yi(void 0),gu(),k(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function SC(t,e){return Bk(t,e).pipe(k(n=>({payload:n,type:"query"})))}var mg=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=zk(r,n);return new _g(i,s,this.afs)}snapshotChanges(){return Oz(this.ref,this.afs.schedulers.outsideAngular).pipe(Be)}valueChanges(e={}){return this.snapshotChanges().pipe(k(({payload:n})=>e.idField?ge(M({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return de(this.ref.get(e)).pipe(Be)}};function yg(t,e){return SC(t,e).pipe(Yi(void 0),gu(),k(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let c=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function $k(t,e,n){return yg(t,n).pipe($n((r,i)=>Fz(r,i.map(s=>s.payload),e),[]),fu(),k(r=>r.map(i=>({type:i.type,payload:i}))))}function Fz(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=Vz(t,r))}),t}function TC(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function Vz(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return TC(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return TC(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return TC(t,e.oldIndex,1);break}return t}function Hk(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var _g=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=yg(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(k(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(Yi(void 0),gu(),ft(([r,i])=>i.length>0||!r),k(([,r])=>r),Be)}auditTrail(e){return this.stateChanges(e).pipe($n((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=Hk(e);return $k(this.query,n,this.afs.schedulers.outsideAngular).pipe(Be)}valueChanges(e={}){return SC(this.query,this.afs.schedulers.outsideAngular).pipe(k(n=>n.payload.docs.map(r=>e.idField?ge(M({},r.data()),{[e.idField]:r.id}):r.data())),Be)}get(e){return de(this.query.get(e)).pipe(Be)}add(e){return this.ref.add(e)}doc(e){return new mg(this.ref.doc(e),this.afs)}},bC=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?yg(this.query,this.afs.schedulers.outsideAngular).pipe(Be):yg(this.query,this.afs.schedulers.outsideAngular).pipe(k(n=>n.filter(r=>e.indexOf(r.type)>-1)),ft(n=>n.length>0),Be)}auditTrail(e){return this.stateChanges(e).pipe($n((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=Hk(e);return $k(this.query,n,this.afs.schedulers.outsideAngular).pipe(Be)}valueChanges(e={}){return SC(this.query,this.afs.schedulers.outsideAngular).pipe(k(r=>r.payload.docs.map(i=>e.idField?M({[e.idField]:i.id},i.data()):i.data())),Be)}get(e){return de(this.query.get(e)).pipe(Be)}},qk=new P("angularfire2.enableFirestorePersistence"),Gk=new P("angularfire2.firestore.persistenceSettings"),Lz=new P("angularfire2.firestore.settings"),jz=new P("angularfire2.firestore.use-emulator");function zk(t,e=n=>n){return{query:e(t),ref:t}}var AC=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,v,C,N){this.schedulers=u;let T=ps(n,a,r),j=l;d&&wc(T,a,h,p,g,v,f,C),[this.firestore,this.persistenceEnabled$]=Zo(`${T.name}.firestore`,"AngularFirestore",T.name,()=>{let H=a.runOutsideAngular(()=>T.firestore());if(s&&H.settings(s),j&&H.useEmulator(...j),i&&!ds(o)){let W=()=>{try{return de(H.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(Ee){return typeof console<"u"&&console.warn(Ee),V(!1)}};return[H,a.runOutsideAngular(W)]}else return[H,V(!1)]},[s,j,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=zk(i,r),a=this.schedulers.ngZone.run(()=>s);return new _g(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new bC(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new mg(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(I(li),I(di,8),I(qk,8),I(Lz,8),I(Ct),I(he),I(Yo),I(Gk,8),I(jz,8),I(gs,8),I(pc,8),I(gc,8),I(mc,8),I(yc,8),I(_c,8),I(vc,8),I(xr,8))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),$ee=(()=>{class t{constructor(){Xe.registerVersion("angularfire",Mr.full,"fst-compat")}static enablePersistence(n){return{ngModule:t,providers:[{provide:qk,useValue:!0},{provide:Gk,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Et({type:t});static \u0275inj=wt({providers:[AC]})}return t})();var qee=(()=>{let e=class e{constructor(r,i,s){this.authF=r,this.router=i,this.firestore=s,this.userCredentials=null}register(r,i){return _(this,null,function*(){try{this.userCredentials=this.authF.createUserWithEmailAndPassword(r,i).then(s=>{this.imprimeHoraActual(),console.log("19"),this.userCredentials=s.user,this.guardar(r),this.router.navigate(["/home"])}).catch(s=>{this.imprimeHoraActual(),console.log("29 - hay un error"),s=="FirebaseError: Firebase: The supplied auth credential is incorrect, malformed or has expired. (auth/invalid-credential)."?this.mensajeError="usuario y/o contrase\xF1a incorrectos":s=="FirebaseError: Firebase: The email address is badly formatted. (auth/invalid-email)."?this.mensajeError="mail vacio o con formato incorrecto":this.mensajeError="contrase\xF1a vacia"})}catch(s){this.mensajeError=s.toString()}})}login(r,i){this.authF.signInWithEmailAndPassword(r,i).then(s=>{this.imprimeHoraActual(),console.log("19"),this.userCredentials=s.user,this.guardar(r),this.router.navigate(["/home"])}).catch(s=>{this.imprimeHoraActual(),console.log("23"),console.error(s),s=="FirebaseError: Firebase: The supplied auth credential is incorrect, malformed or has expired. (auth/invalid-credential)."?this.mensajeError="usuario y/o contrase\xF1a incorrectos":s=="FirebaseError: Firebase: The email address is badly formatted. (auth/invalid-email)."?this.mensajeError="mail vacio o con formato incorrecto":this.mensajeError="contrase\xF1a vacia"})}logout(){this.authF.signOut()}imprimeHoraActual(){let i=new Date().toLocaleTimeString();console.log(i)}guardar(r){let i=this.firestore.collection("logs");console.log("col"),i.add({Email:r,fechaYHora:new Date})}};e.\u0275fac=function(i){return new(i||e)(I(gs),I(xn),I(AC))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Wk="@firebase/database",Kk="1.0.4";var UD="";function BD(t){UD=t}var FC=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ge(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:gd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var VC=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return rn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var TO=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new FC(e)}}catch{}return new VC},Ks=TO("localStorage"),LC=TO("sessionStorage");var Wa=new Gr("@firebase/database"),bO=function(){let t=1;return function(){return t++}}(),SO=function(t){let e=OT(t),n=new kT;n.update(e);let r=n.digest();return hd.encodeByteArray(r)},ed=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=ed.apply(null,r):typeof r=="object"?e+=Ge(r):e+=r,e+=" "}return e},Qs=null,Qk=!0,AO=function(t,e){D(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Wa.logLevel=sn.VERBOSE,Qs=Wa.log.bind(Wa),e&&LC.set("logging_enabled",!0)):typeof t=="function"?Qs=t:(Qs=null,LC.remove("logging_enabled"))},ct=function(...t){if(Qk===!0&&(Qk=!1,Qs===null&&LC.get("logging_enabled")===!0&&AO(!0)),Qs){let e=ed.apply(null,t);Qs(e)}},td=function(t){return function(...e){ct(t,...e)}},jC=function(...t){let e="FIREBASE INTERNAL ERROR: "+ed(...t);Wa.error(e)},pr=function(...t){let e=`FIREBASE FATAL ERROR: ${ed(...t)}`;throw Wa.error(e),new Error(e)},At=function(...t){let e="FIREBASE WARNING: "+ed(...t);Wa.warn(e)},Bz=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&At("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},zg=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},$z=function(t){if(jn()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Vi="[MIN_NAME]",$r="[MAX_NAME]",Zs=function(t,e){if(t===e)return 0;if(t===Vi||e===$r)return-1;if(e===Vi||t===$r)return 1;{let n=Yk(t),r=Yk(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},Hz=function(t,e){return t===e?0:t<e?-1:1},Rl=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ge(e))},$D=function(t){if(typeof t!="object"||t===null)return Ge(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Ge(e[r]),n+=":",n+=$D(t[e[r]]);return n+="}",n},xO=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function lt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var MO=function(t){D(!zg(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,u;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let c=[];for(u=n;u;u-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();let l=c.join(""),d="";for(u=0;u<64;u+=8){let h=parseInt(l.substr(u,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},qz=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Gz=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function zz(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var Wz=new RegExp("^-?(0*)\\d{1,10}$"),Kz=-2147483648,Qz=2147483647,Yk=function(t){if(Wz.test(t)){let e=Number(t);if(e>=Kz&&e<=Qz)return e}return null},nu=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw At("Exception was thrown by user callback.",n),e},Math.floor(0))}},Yz=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ol=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var UC=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){At(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var BC=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(ct("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',At(e)}},Fl=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),wg="5",RO="v",NO="s",PO="r",kO="f",OO=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,FO="ls",VO="p",$C="ac",LO="websocket",jO="long_polling";var Eg=class{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ks.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ks.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function Zz(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function UO(t,e,n){D(typeof e=="string","typeof type must == string"),D(typeof n=="object","typeof params must == object");let r;if(e===LO)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===jO)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Zz(t)&&(n.ns=t.namespace);let i=[];return lt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var HC=class{constructor(){this.counters_={}}incrementCounter(e,n=1){rn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return ST(this.counters_)}};var xC={},MC={};function HD(t){let e=t.toString();return xC[e]||(xC[e]=new HC),xC[e]}function Jz(t,e){let n=t.toString();return MC[n]||(MC[n]=e()),MC[n]}var qC=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&nu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var Zk="start",Xz="close",eW="pLPCommand",tW="pRTLPCB",BO="id",$O="pw",HO="ser",nW="cb",rW="seg",iW="ts",sW="d",oW="dframe",qO=1870,GO=30,aW=qO-GO,uW=25e3,cW=3e4,Ul=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=td(e),this.stats_=HD(n),this.urlFn=u=>(this.appCheckToken&&(u[$C]=this.appCheckToken),UO(n,jO,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new qC(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(cW)),$z(()=>{if(this.isClosed_)return;this.scriptTagHolder=new GC((...s)=>{let[o,a,u,c,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Zk)this.id=a,this.password=u;else if(o===Xz)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[Zk]="t",r[HO]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[nW]=this.scriptTagHolder.uniqueCallbackIdentifier),r[RO]=wg,this.transportSessionId&&(r[NO]=this.transportSessionId),this.lastSessionId&&(r[FO]=this.lastSessionId),this.applicationId&&(r[VO]=this.applicationId),this.appCheckToken&&(r[$C]=this.appCheckToken),typeof location<"u"&&location.hostname&&OO.test(location.hostname)&&(r[PO]=kO);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return jn()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!qz()&&!Gz()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=Ge(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=bT(n),i=xO(r,aW);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(jn())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[oW]="t",r[BO]=e,r[$O]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=Ge(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},GC=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,jn())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=bO(),window[eW+this.uniqueCallbackIdentifier]=e,window[tW+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){ct("frame writing exception"),a.stack&&ct(a.stack),ct(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ct("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[BO]=this.myID,e[$O]=this.myPW,e[HO]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+GO+r.length<=qO;){let o=this.pendingSegs.shift();r=r+"&"+rW+i+"="+o.seg+"&"+iW+i+"="+o.ts+"&"+sW+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(uW)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){jn()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{ct("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var lW=16384,dW=45e3,Ig=null;typeof MozWebSocket<"u"?Ig=MozWebSocket:typeof WebSocket<"u"&&(Ig=WebSocket);var Ga=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=td(this.connId),this.stats_=HD(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[RO]=wg,!jn()&&typeof location<"u"&&location.hostname&&OO.test(location.hostname)&&(a[PO]=kO),r&&(a[NO]=r),i&&(a[FO]=i),s&&(a[$C]=s),o&&(a[VO]=o),UO(n,LO,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ks.set("previous_websocket_failure",!0);try{let i;if(jn()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${wg}/${UD}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Ig(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Ig!==null&&!t.forceDisallow_}static previouslyFailed(){return Ks.isInMemoryStorage||Ks.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ks.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=gd(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(D(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=Ge(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=xO(r,lW);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(dW))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),zO=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Ul,Ga]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Ga&&Ga.isAvailable(),i=r&&!Ga.previouslyFailed();if(n.webSocketOnly&&(r||At("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ga];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),hW=6e4,fW=5e3,pW=10*1024,gW=100*1024,RC="t",Jk="d",mW="s",Xk="r",yW="e",eO="o",tO="a",nO="n",rO="p",_W="h",zC=class{constructor(e,n,r,i,s,o,a,u,c,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=td("c:"+this.id+":"),this.transportManager_=new zO(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Ol(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>gW?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>pW?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(RC in e){let n=e[RC];n===tO?this.upgradeIfSecondaryHealthy_():n===Xk?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===eO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Rl("t",e),r=Rl("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:rO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:tO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:nO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Rl("t",e),r=Rl("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Rl(RC,e);if(Jk in e){let r=e[Jk];if(n===_W){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===nO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===mW?this.onConnectionShutdown_(r):n===Xk?this.onReset_(r):n===yW?jC("Server Error: "+r):n===eO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):jC("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),wg!==r&&At("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Ol(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(hW))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ol(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(fW))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:rO,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ks.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Cg=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var Dg=class{constructor(e){this.allowedEvents_=e,this.listeners_={},D(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){D(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Tg=class t extends Dg{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!fm()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return D(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var iO=32,sO=768,pe=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function fe(){return new pe("")}function ee(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Li(t){return t.pieces_.length-t.pieceNum_}function Te(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new pe(t.pieces_,e)}function qD(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function vW(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Bl(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function WO(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new pe(e,0)}function Pe(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof pe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new pe(n,0)}function te(t){return t.pieceNum_>=t.pieces_.length}function Ft(t,e){let n=ee(t),r=ee(e);if(n===null)return e;if(n===r)return Ft(Te(t),Te(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function wW(t,e){let n=Bl(t,0),r=Bl(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=Zs(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function GD(t,e){if(Li(t)!==Li(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function _n(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Li(t)>Li(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var WC=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Bl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=cu(this.parts_[r]);KO(this)}};function EW(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=cu(e),KO(t)}function IW(t){let e=t.parts_.pop();t.byteLength_-=cu(e),t.parts_.length>0&&(t.byteLength_-=1)}function KO(t){if(t.byteLength_>sO)throw new Error(t.errorPrefix_+"has a key path longer than "+sO+" bytes ("+t.byteLength_+").");if(t.parts_.length>iO)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+iO+") or object contains a cycle "+Ws(t))}function Ws(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var KC=class t extends Dg{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return D(e==="visible","Unknown event type: "+e),[this.visible_]}};var Nl=1e3,CW=60*5*1e3,oO=30*1e3,DW=1.3,TW=3e4,bW="server_kill",aO=3,zD=(()=>{class t extends Cg{constructor(n,r,i,s,o,a,u,c){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=td("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Nl,this.maxReconnectDelay_=CW,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!jn())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");KC.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Tg.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(Ge(o)),D(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new rt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let u=a.d;a.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),D(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,u=>{let c=u.d,l=u.s;t.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,c))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&rn(n,"w")){let i=qr(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();At(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||NT(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=oO)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=RT(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Ge(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):jC("Unrecognized action received from server: "+Ge(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){D(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Nl,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Nl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>TW&&(this.reconnectDelay_=Nl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*DW)}this.onConnectStatus_(!1)}establishConnection_(){return _(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,u=null,c=function(){u?u.close():(a=!0,i())},l=function(h){D(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(h)};this.realtime_={close:c,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?ct("getToken() completed but was canceled"):(ct("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,u=new zC(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{At(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(bW)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&At(h),c())}}})}interrupt(n){ct("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){ct("Resuming connection for reason: "+n),delete this.interruptReasons_[n],md(this.interruptReasons_)&&(this.reconnectDelay_=Nl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>$D(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new pe(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){ct("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=aO&&(this.reconnectDelay_=oO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){ct("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=aO&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";jn()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+UD.replace(/\./g,"-")]=1,fm()?n["framework.cordova"]=1:AT()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Tg.getInstance().currentlyOnline();return md(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),re=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Ka=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new re(Vi,e),i=new re(Vi,n);return this.compare(r,i)!==0}minPost(){return re.MIN}};var vg,bg=class extends Ka{static get __EMPTY_NODE(){return vg}static set __EMPTY_NODE(e){vg=e}compare(e,n){return Zs(e.name,n.name)}isDefinedOn(e){throw no("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return re.MIN}maxPost(){return new re($r,vg)}makePost(e,n){return D(typeof e=="string","KeyIndex indexValue must always be a string."),new re(e,vg)}toString(){return".key"}},fr=new bg;var za=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Vn=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??vn.EMPTY_NODE,this.right=o??vn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return vn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return vn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),QC=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new Vn(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},vn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Vn.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Vn.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new za(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new za(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new za(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new za(this.root_,null,this.comparator_,!0,e)}};vn.EMPTY_NODE=new QC;function SW(t,e){return Zs(t.name,e.name)}function WD(t,e){return Zs(t,e)}var YC;function AW(t){YC=t}var QO=function(t){return typeof t=="number"?"number:"+MO(t):"string:"+t},YO=function(t){if(t.isLeafNode()){let e=t.val();D(typeof e=="string"||typeof e=="number"||typeof e=="object"&&rn(e,".sv"),"Priority must be a string or number.")}else D(t===YC||t.isEmpty(),"priority of unexpected type.");D(t===YC||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var uO,Qa=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,D(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),YO(this.priorityNode_)}static set __childrenNodeConstructor(n){uO=n}static get __childrenNodeConstructor(){return uO}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return te(n)?this:ee(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=ee(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(D(i!==".priority"||Li(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Te(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+QO(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=MO(this.value_):n+=this.value_,this.lazyHash_=SO(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(D(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return D(s>=0,"Unknown leaf type: "+r),D(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),ZO,JO;function xW(t){ZO=t}function MW(t){JO=t}var ZC=class extends Ka{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?Zs(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return re.MIN}maxPost(){return new re($r,new Qa("[PRIORITY-POST]",JO))}makePost(e,n){let r=ZO(e);return new re(n,new Qa("[PRIORITY-POST]",r))}toString(){return".priority"}},Se=new ZC;var RW=Math.log(2),JC=class{constructor(e){let n=s=>parseInt(Math.log(s)/RW,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Sg=function(t,e,n,r){t.sort(e);let i=function(u,c){let l=c-u,d,h;if(l===0)return null;if(l===1)return d=t[u],h=n?n(d):d,new Vn(h,d.node,Vn.BLACK,null,null);{let f=parseInt(l/2,10)+u,p=i(u,f),g=i(f+1,c);return d=t[f],h=n?n(d):d,new Vn(h,d.node,Vn.BLACK,p,g)}},s=function(u){let c=null,l=null,d=t.length,h=function(p,g){let v=d-p,C=d;d-=p;let N=i(v+1,C),T=t[v],j=n?n(T):T;f(new Vn(j,T.node,g,null,N))},f=function(p){c?(c.left=p,c=p):(l=p,c=p)};for(let p=0;p<u.count;++p){let g=u.nextBitIsOne(),v=Math.pow(2,u.count-(p+1));g?h(v,Vn.BLACK):(h(v,Vn.BLACK),h(v,Vn.RED))}return l},o=new JC(t.length),a=s(o);return new vn(r||e,a)};var NC,qa={},Ya=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return D(qa&&Se,"ChildrenNode.ts has not been loaded"),NC=NC||new t({".priority":qa},{".priority":Se}),NC}get(e){let n=qr(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof vn?n:null}hasIndex(e){return rn(this.indexSet_,e.toString())}addIndex(e,n){D(e!==fr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(re.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Sg(r,e.getCompare()):a=qa;let u=e.toString(),c=Object.assign({},this.indexSet_);c[u]=e;let l=Object.assign({},this.indexes_);return l[u]=a,new t(l,c)}addToIndexes(e,n){let r=uu(this.indexes_,(i,s)=>{let o=qr(this.indexSet_,s);if(D(o,"Missing index implementation for "+s),i===qa)if(o.isDefinedOn(e.node)){let a=[],u=n.getIterator(re.Wrap),c=u.getNext();for(;c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),Sg(a,o.getCompare())}else return qa;else{let a=n.get(e.name),u=i;return a&&(u=u.remove(new re(e.name,a))),u.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=uu(this.indexes_,i=>{if(i===qa)return i;{let s=n.get(e.name);return s?i.remove(new re(e.name,s)):i}});return new t(r,this.indexSet_)}};var Pl,Y=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&YO(this.priorityNode_),this.children_.isEmpty()&&D(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Pl||(Pl=new t(new vn(WD),null,Ya.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Pl}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Pl:r}}getChild(n){let r=ee(n);return r===null?this:this.getImmediateChild(r).getChild(Te(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(D(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new re(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Pl:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=ee(n);if(i===null)return r;{D(ee(n)!==".priority"||Li(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Te(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Se,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let u in r)a[u]=r[u];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+QO(this.getPriority().val())+":"),this.forEachChild(Se,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":SO(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new re(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new re(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new re(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,re.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,re.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===nd?-1:0}withIndex(n){if(n===fr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===fr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Se),s=r.getIterator(Se),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===fr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),XC=class extends Y{constructor(){super(new vn(WD),Y.EMPTY_NODE,Ya.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Y.EMPTY_NODE}isEmpty(){return!1}},nd=new XC;Object.defineProperties(re,{MIN:{value:new re(Vi,Y.EMPTY_NODE)},MAX:{value:new re($r,nd)}});bg.__EMPTY_NODE=Y.EMPTY_NODE;Qa.__childrenNodeConstructor=Y;AW(nd);MW(nd);var NW=!0;function Oe(t,e=null){if(t===null)return Y.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),D(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Qa(n,Oe(e))}if(!(t instanceof Array)&&NW){let n=[],r=!1;if(lt(t,(o,a)=>{if(o.substring(0,1)!=="."){let u=Oe(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new re(o,u)))}}),n.length===0)return Y.EMPTY_NODE;let s=Sg(n,SW,o=>o.name,WD);if(r){let o=Sg(n,Se.getCompare());return new Y(s,Oe(e),new Ya({".priority":o},{".priority":Se}))}else return new Y(s,Oe(e),Ya.Default)}else{let n=Y.EMPTY_NODE;return lt(t,(r,i)=>{if(rn(t,r)&&r.substring(0,1)!=="."){let s=Oe(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Oe(e))}}xW(Oe);var $l=class extends Ka{constructor(e){super(),this.indexPath_=e,D(!te(e)&&ee(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?Zs(e.name,n.name):s}makePost(e,n){let r=Oe(e),i=Y.EMPTY_NODE.updateChild(this.indexPath_,r);return new re(n,i)}maxPost(){let e=Y.EMPTY_NODE.updateChild(this.indexPath_,nd);return new re($r,e)}toString(){return Bl(this.indexPath_,0).join("/")}};var eD=class extends Ka{compare(e,n){let r=e.node.compareTo(n.node);return r===0?Zs(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return re.MIN}maxPost(){return re.MAX}makePost(e,n){let r=Oe(e);return new re(n,r)}toString(){return".value"}},KD=new eD;function XO(t){return{type:"value",snapshotNode:t}}function Za(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Hl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function ql(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function PW(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Gl=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){D(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Hl(n,a)):D(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Za(n,r)):o.trackChildChange(ql(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Se,(i,s)=>{n.hasChild(i)||r.trackChildChange(Hl(i,s))}),n.isLeafNode()||n.forEachChild(Se,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(ql(i,s,o))}else r.trackChildChange(Za(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?Y.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Ag=class t{constructor(e){this.indexedFilter_=new Gl(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new re(n,r))||(r=Y.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=Y.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(Y.EMPTY_NODE);let s=this;return n.forEachChild(Se,(o,a)=>{s.matches(new re(o,a))||(i=i.updateImmediateChild(o,Y.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var tD=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Ag(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new re(n,r))||(r=Y.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=Y.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=Y.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(Y.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,Y.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;D(a.numChildren()===this.limit_,"");let u=new re(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,u);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(ql(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(Hl(n,d));let g=a.updateImmediateChild(n,Y.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Za(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:l&&o(c,u)>=0?(s!=null&&(s.trackChildChange(Hl(c.name,c.node)),s.trackChildChange(Za(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,Y.EMPTY_NODE)):e}};var zl=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Se}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return D(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return D(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Vi}hasEnd(){return this.endSet_}getIndexEndValue(){return D(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return D(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:$r}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return D(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Se}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function kW(t){return t.loadsAllData()?new Gl(t.getIndex()):t.hasLimit()?new tD(t):new Ag(t)}function OW(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function FW(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function nD(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function VW(t,e,n){let r;return t.index_===fr||n?r=nD(t,e,n):r=nD(t,e,$r),r.startAfterSet_=!0,r}function rD(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function LW(t,e,n){let r;return t.index_===fr||n?r=rD(t,e,n):r=rD(t,e,Vi),r.endBeforeSet_=!0,r}function Wg(t,e){let n=t.copy();return n.index_=e,n}function cO(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Se?n="$priority":t.index_===KD?n="$value":t.index_===fr?n="$key":(D(t.index_ instanceof $l,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Ge(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=Ge(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Ge(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Ge(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Ge(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function lO(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Se&&(e.i=t.index_.toString()),e}var iD=class t extends Cg{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=td("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(D(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let u=cO(e._queryParams);this.restRequest_(s+".json",u,(c,l)=>{let d=l;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,r),qr(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=cO(e._queryParams),r=e._path.toString(),i=new rt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+PT(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=gd(a.responseText)}catch{At("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&At("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var sD=class{constructor(){this.rootNode_=Y.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function xg(){return{value:null,children:new Map}}function ru(t,e,n){if(te(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=ee(e);t.children.has(r)||t.children.set(r,xg());let i=t.children.get(r);e=Te(e),ru(i,e,n)}}function oD(t,e){if(te(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Se,(r,i)=>{ru(t,new pe(r),i)}),oD(t,e)}}else if(t.children.size>0){let n=ee(e);return e=Te(e),t.children.has(n)&&oD(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function aD(t,e,n){t.value!==null?n(e,t.value):jW(t,(r,i)=>{let s=new pe(e.toString()+"/"+r);aD(i,s,n)})}function jW(t,e){t.children.forEach((n,r)=>{e(r,n)})}var uD=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&lt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var dO=10*1e3,UW=30*1e3,BW=5*60*1e3,cD=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new uD(e);let r=dO+(UW-dO)*Math.random();Ol(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;lt(e,(i,s)=>{s>0&&rn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Ol(this.reportStats_.bind(this),Math.floor(Math.random()*2*BW))}};var hr=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(hr||{});function QD(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function YD(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ZD(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var lD=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=hr.ACK_USER_WRITE,this.source=QD()}operationForChild(e){if(te(this.path)){if(this.affectedTree.value!=null)return D(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new pe(e));return new t(fe(),n,this.revert)}}else return D(ee(this.path)===e,"operationForChild called for unrelated child."),new t(Te(this.path),this.affectedTree,this.revert)}};var Mg=class t{constructor(e,n){this.source=e,this.path=n,this.type=hr.LISTEN_COMPLETE}operationForChild(e){return te(this.path)?new t(this.source,fe()):new t(this.source,Te(this.path))}};var Ja=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=hr.OVERWRITE}operationForChild(e){return te(this.path)?new t(this.source,fe(),this.snap.getImmediateChild(e)):new t(this.source,Te(this.path),this.snap)}};var Wl=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=hr.MERGE}operationForChild(e){if(te(this.path)){let n=this.children.subtree(new pe(e));return n.isEmpty()?null:n.value?new Ja(this.source,fe(),n.value):new t(this.source,fe(),n)}else return D(ee(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Te(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var gr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(te(e))return this.isFullyInitialized()&&!this.filtered_;let n=ee(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var dD=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function $W(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(PW(o.childName,o.snapshotNode))}),kl(t,i,"child_removed",e,r,n),kl(t,i,"child_added",e,r,n),kl(t,i,"child_moved",s,r,n),kl(t,i,"child_changed",e,r,n),kl(t,i,"value",e,r,n),i}function kl(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,u)=>qW(t,a,u)),o.forEach(a=>{let u=HW(t,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(u,t.query_))})})}function HW(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function qW(t,e,n){if(e.childName==null||n.childName==null)throw no("Should only compare child_ events.");let r=new re(e.childName,e.snapshotNode),i=new re(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function Kg(t,e){return{eventCache:t,serverCache:e}}function Vl(t,e,n,r){return Kg(new gr(e,n,r),t.serverCache)}function eF(t,e,n,r){return Kg(t.eventCache,new gr(e,n,r))}function Rg(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ys(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var PC,GW=()=>(PC||(PC=new vn(Hz)),PC),Vt=class t{constructor(e,n=GW()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return lt(e,(r,i)=>{n=n.set(new pe(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:fe(),value:this.value};if(te(e))return null;{let r=ee(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Te(e),n);return s!=null?{path:Pe(new pe(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(te(e))return this;{let n=ee(e),r=this.children.get(n);return r!==null?r.subtree(Te(e)):new t(null)}}set(e,n){if(te(e))return new t(n,this.children);{let r=ee(e),s=(this.children.get(r)||new t(null)).set(Te(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(te(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=ee(e),r=this.children.get(n);if(r){let i=r.remove(Te(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(te(e))return this.value;{let n=ee(e),r=this.children.get(n);return r?r.get(Te(e)):null}}setTree(e,n){if(te(e))return n;{let r=ee(e),s=(this.children.get(r)||new t(null)).setTree(Te(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(fe(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Pe(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,fe(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(te(e))return null;{let s=ee(e),o=this.children.get(s);return o?o.findOnPath_(Te(e),Pe(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,fe(),n)}foreachOnPath_(e,n,r){if(te(e))return this;{this.value&&r(n,this.value);let i=ee(e),s=this.children.get(i);return s?s.foreachOnPath_(Te(e),Pe(n,i),r):new t(null)}}foreach(e){this.foreach_(fe(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Pe(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var Ln=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Vt(null))}};function Ll(t,e,n){if(te(e))return new Ln(new Vt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Ft(i,e);return s=s.updateChild(o,n),new Ln(t.writeTree_.set(i,s))}else{let i=new Vt(n),s=t.writeTree_.setTree(e,i);return new Ln(s)}}}function hD(t,e,n){let r=t;return lt(n,(i,s)=>{r=Ll(r,Pe(e,i),s)}),r}function hO(t,e){if(te(e))return Ln.empty();{let n=t.writeTree_.setTree(e,new Vt(null));return new Ln(n)}}function fD(t,e){return Js(t,e)!=null}function Js(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Ft(n.path,e)):null}function fO(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Se,(r,i)=>{e.push(new re(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new re(r,i.value))}),e}function Oi(t,e){if(te(e))return t;{let n=Js(t,e);return n!=null?new Ln(new Vt(n)):new Ln(t.writeTree_.subtree(e))}}function pD(t){return t.writeTree_.isEmpty()}function Xa(t,e){return tF(fe(),t.writeTree_,e)}function tF(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(D(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=tF(Pe(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Pe(t,".priority"),r)),n}}function Qg(t,e){return sF(e,t)}function zW(t,e,n,r,i){D(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Ll(t.visibleWrites,e,n)),t.lastWriteId=r}function WW(t,e,n,r){D(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=hD(t.visibleWrites,e,n),t.lastWriteId=r}function KW(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function QW(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);D(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&YW(a,r.path)?i=!1:_n(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return ZW(t),!0;if(r.snap)t.visibleWrites=hO(t.visibleWrites,r.path);else{let a=r.children;lt(a,u=>{t.visibleWrites=hO(t.visibleWrites,Pe(r.path,u))})}return!0}else return!1}function YW(t,e){if(t.snap)return _n(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&_n(Pe(t.path,n),e))return!0;return!1}function ZW(t){t.visibleWrites=nF(t.allWrites,JW,fe()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function JW(t){return t.visible}function nF(t,e,n){let r=Ln.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)_n(n,o)?(a=Ft(n,o),r=Ll(r,a,s.snap)):_n(o,n)&&(a=Ft(o,n),r=Ll(r,fe(),s.snap.getChild(a)));else if(s.children){if(_n(n,o))a=Ft(n,o),r=hD(r,a,s.children);else if(_n(o,n))if(a=Ft(o,n),te(a))r=hD(r,fe(),s.children);else{let u=qr(s.children,ee(a));if(u){let c=u.getChild(Te(a));r=Ll(r,fe(),c)}}}else throw no("WriteRecord should have .snap or .children")}}return r}function rF(t,e,n,r,i){if(!r&&!i){let s=Js(t.visibleWrites,e);if(s!=null)return s;{let o=Oi(t.visibleWrites,e);if(pD(o))return n;if(n==null&&!fD(o,fe()))return null;{let a=n||Y.EMPTY_NODE;return Xa(o,a)}}}else{let s=Oi(t.visibleWrites,e);if(!i&&pD(s))return n;if(!i&&n==null&&!fD(s,fe()))return null;{let o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(_n(c.path,e)||_n(e,c.path))},a=nF(t.allWrites,o,e),u=n||Y.EMPTY_NODE;return Xa(a,u)}}}function XW(t,e,n){let r=Y.EMPTY_NODE,i=Js(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Se,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=Oi(t.visibleWrites,e);return n.forEachChild(Se,(o,a)=>{let u=Xa(Oi(s,new pe(o)),a);r=r.updateImmediateChild(o,u)}),fO(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Oi(t.visibleWrites,e);return fO(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function e9(t,e,n,r,i){D(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Pe(e,n);if(fD(t.visibleWrites,s))return null;{let o=Oi(t.visibleWrites,s);return pD(o)?i.getChild(n):Xa(o,i.getChild(n))}}function t9(t,e,n,r){let i=Pe(e,n),s=Js(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=Oi(t.visibleWrites,i);return Xa(o,r.getNode().getImmediateChild(n))}else return null}function n9(t,e){return Js(t.visibleWrites,e)}function r9(t,e,n,r,i,s,o){let a,u=Oi(t.visibleWrites,e),c=Js(u,fe());if(c!=null)a=c;else if(n!=null)a=Xa(u,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function i9(){return{visibleWrites:Ln.empty(),allWrites:[],lastWriteId:-1}}function Ng(t,e,n,r){return rF(t.writeTree,t.treePath,e,n,r)}function JD(t,e){return XW(t.writeTree,t.treePath,e)}function pO(t,e,n,r){return e9(t.writeTree,t.treePath,e,n,r)}function Pg(t,e){return n9(t.writeTree,Pe(t.treePath,e))}function s9(t,e,n,r,i,s){return r9(t.writeTree,t.treePath,e,n,r,i,s)}function XD(t,e,n){return t9(t.writeTree,t.treePath,e,n)}function iF(t,e){return sF(Pe(t.treePath,e),t.writeTree)}function sF(t,e){return{treePath:t,writeTree:e}}var gD=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;D(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),D(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,ql(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Hl(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Za(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,ql(r,e.snapshotNode,i.oldSnap));else throw no("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var mD=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},oF=new mD,Kl=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new gr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return XD(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ys(this.viewCache_),s=s9(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function o9(t){return{filter:t}}function a9(t,e){D(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),D(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function u9(t,e,n,r,i){let s=new gD,o,a;if(n.type===hr.OVERWRITE){let c=n;c.source.fromUser?o=yD(t,e,c.path,c.snap,r,i,s):(D(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!te(c.path),o=kg(t,e,c.path,c.snap,r,i,a,s))}else if(n.type===hr.MERGE){let c=n;c.source.fromUser?o=l9(t,e,c.path,c.children,r,i,s):(D(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=_D(t,e,c.path,c.children,r,i,a,s))}else if(n.type===hr.ACK_USER_WRITE){let c=n;c.revert?o=f9(t,e,c.path,r,i,s):o=d9(t,e,c.path,c.affectedTree,r,i,s)}else if(n.type===hr.LISTEN_COMPLETE)o=h9(t,e,n.path,r,s);else throw no("Unknown operation type: "+n.type);let u=s.getChanges();return c9(e,o,u),{viewCache:o,changes:u}}function c9(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Rg(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(XO(Rg(e)))}}function aF(t,e,n,r,i,s){let o=e.eventCache;if(Pg(r,n)!=null)return e;{let a,u;if(te(n))if(D(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=Ys(e),l=c instanceof Y?c:Y.EMPTY_NODE,d=JD(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=Ng(r,Ys(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=ee(n);if(c===".priority"){D(Li(n)===1,"Can't have a priority with additional path components");let l=o.getNode();u=e.serverCache.getNode();let d=pO(r,n,l,u);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=Te(n),d;if(o.isCompleteForChild(c)){u=e.serverCache.getNode();let h=pO(r,n,o.getNode(),u);h!=null?d=o.getNode().getImmediateChild(c).updateChild(l,h):d=o.getNode().getImmediateChild(c)}else d=XD(r,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,l,i,s):a=o.getNode()}}return Vl(e,a,o.isFullyInitialized()||te(n),t.filter.filtersNodes())}}function kg(t,e,n,r,i,s,o,a){let u=e.serverCache,c,l=o?t.filter:t.filter.getIndexedFilter();if(te(n))c=l.updateFullNode(u.getNode(),r,null);else if(l.filtersNodes()&&!u.isFiltered()){let f=u.getNode().updateChild(n,r);c=l.updateFullNode(u.getNode(),f,null)}else{let f=ee(n);if(!u.isCompleteForPath(n)&&Li(n)>1)return e;let p=Te(n),v=u.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?c=l.updatePriority(u.getNode(),v):c=l.updateChild(u.getNode(),f,v,p,oF,null)}let d=eF(e,c,u.isFullyInitialized()||te(n),l.filtersNodes()),h=new Kl(i,d,s);return aF(t,d,n,i,h,a)}function yD(t,e,n,r,i,s,o){let a=e.eventCache,u,c,l=new Kl(i,e,s);if(te(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=Vl(e,c,!0,t.filter.filtersNodes());else{let d=ee(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),u=Vl(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=Te(n),f=a.getNode().getImmediateChild(d),p;if(te(h))p=r;else{let g=l.getCompleteChild(d);g!=null?qD(h)===".priority"&&g.getChild(WO(h)).isEmpty()?p=g:p=g.updateChild(h,r):p=Y.EMPTY_NODE}if(f.equals(p))u=e;else{let g=t.filter.updateChild(a.getNode(),d,p,h,l,o);u=Vl(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function gO(t,e){return t.eventCache.isCompleteForChild(e)}function l9(t,e,n,r,i,s,o){let a=e;return r.foreach((u,c)=>{let l=Pe(n,u);gO(e,ee(l))&&(a=yD(t,a,l,c,i,s,o))}),r.foreach((u,c)=>{let l=Pe(n,u);gO(e,ee(l))||(a=yD(t,a,l,c,i,s,o))}),a}function mO(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function _D(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,c;te(n)?c=r:c=new Vt(null).setTree(n,r);let l=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=mO(t,f,h);u=kg(t,u,new pe(d),p,i,s,o,a)}}),c.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),g=mO(t,p,h);u=kg(t,u,new pe(d),g,i,s,o,a)}}),u}function d9(t,e,n,r,i,s,o){if(Pg(i,n)!=null)return e;let a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(te(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return kg(t,e,n,u.getNode().getChild(n),i,s,a,o);if(te(n)){let c=new Vt(null);return u.getNode().forEachChild(fr,(l,d)=>{c=c.set(new pe(l),d)}),_D(t,e,n,c,i,s,a,o)}else return e}else{let c=new Vt(null);return r.foreach((l,d)=>{let h=Pe(n,l);u.isCompleteForPath(h)&&(c=c.set(l,u.getNode().getChild(h)))}),_D(t,e,n,c,i,s,a,o)}}function h9(t,e,n,r,i){let s=e.serverCache,o=eF(e,s.getNode(),s.isFullyInitialized()||te(n),s.isFiltered());return aF(t,o,n,r,oF,i)}function f9(t,e,n,r,i,s){let o;if(Pg(r,n)!=null)return e;{let a=new Kl(r,e,i),u=e.eventCache.getNode(),c;if(te(n)||ee(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=Ng(r,Ys(e));else{let d=e.serverCache.getNode();D(d instanceof Y,"serverChildren would be complete if leaf node"),l=JD(r,d)}l=l,c=t.filter.updateFullNode(u,l,s)}else{let l=ee(n),d=XD(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=u.getImmediateChild(l)),d!=null?c=t.filter.updateChild(u,l,d,Te(n),a,s):e.eventCache.getNode().hasChild(l)?c=t.filter.updateChild(u,l,Y.EMPTY_NODE,Te(n),a,s):c=u,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Ng(r,Ys(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||Pg(r,fe())!=null,Vl(e,c,o,t.filter.filtersNodes())}}var vD=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Gl(r.getIndex()),s=kW(r);this.processor_=o9(s);let o=n.serverCache,a=n.eventCache,u=i.updateFullNode(Y.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(Y.EMPTY_NODE,a.getNode(),null),l=new gr(u,o.isFullyInitialized(),i.filtersNodes()),d=new gr(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Kg(d,l),this.eventGenerator_=new dD(this.query_)}get query(){return this.query_}};function p9(t){return t.viewCache_.serverCache.getNode()}function g9(t){return Rg(t.viewCache_)}function m9(t,e){let n=Ys(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!te(e)&&!n.getImmediateChild(ee(e)).isEmpty())?n.getChild(e):null}function yO(t){return t.eventRegistrations_.length===0}function y9(t,e){t.eventRegistrations_.push(e)}function _O(t,e,n){let r=[];if(n){D(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function vO(t,e,n,r){e.type===hr.MERGE&&e.source.queryId!==null&&(D(Ys(t.viewCache_),"We should always have a full cache before handling merges"),D(Rg(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=u9(t.processor_,i,e,n,r);return a9(t.processor_,s.viewCache),D(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,uF(t,s.changes,s.viewCache.eventCache.getNode(),null)}function _9(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Se,(s,o)=>{r.push(Za(s,o))}),n.isFullyInitialized()&&r.push(XO(n.getNode())),uF(t,r,n.getNode(),e)}function uF(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return $W(t.eventGenerator_,e,n,i)}var Og,Fg=class{constructor(){this.views=new Map}};function v9(t){D(!Og,"__referenceConstructor has already been defined"),Og=t}function w9(){return D(Og,"Reference.ts has not been loaded"),Og}function E9(t){return t.views.size===0}function eT(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return D(s!=null,"SyncTree gave us an op for an invalid query."),vO(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(vO(o,e,n,r));return s}}function cF(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Ng(n,i?r:null),u=!1;a?u=!0:r instanceof Y?(a=JD(n,r),u=!1):(a=Y.EMPTY_NODE,u=!1);let c=Kg(new gr(a,u,!1),new gr(r,i,!1));return new vD(e,c)}return o}function I9(t,e,n,r,i,s){let o=cF(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),y9(o,n),_9(o,n)}function C9(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=ji(t);if(i==="default")for(let[u,c]of t.views.entries())o=o.concat(_O(c,n,r)),yO(c)&&(t.views.delete(u),c.query._queryParams.loadsAllData()||s.push(c.query));else{let u=t.views.get(i);u&&(o=o.concat(_O(u,n,r)),yO(u)&&(t.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!ji(t)&&s.push(new(w9())(e._repo,e._path)),{removed:s,events:o}}function lF(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Fi(t,e){let n=null;for(let r of t.views.values())n=n||m9(r,e);return n}function dF(t,e){if(e._queryParams.loadsAllData())return Yg(t);{let r=e._queryIdentifier;return t.views.get(r)}}function hF(t,e){return dF(t,e)!=null}function ji(t){return Yg(t)!=null}function Yg(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Vg;function D9(t){D(!Vg,"__referenceConstructor has already been defined"),Vg=t}function T9(){return D(Vg,"Reference.ts has not been loaded"),Vg}var b9=1,Lg=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Vt(null),this.pendingWriteTree_=i9(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function tT(t,e,n,r,i){return zW(t.pendingWriteTree_,e,n,r,i),i?iu(t,new Ja(QD(),e,n)):[]}function S9(t,e,n,r){WW(t.pendingWriteTree_,e,n,r);let i=Vt.fromObject(n);return iu(t,new Wl(QD(),e,i))}function ki(t,e,n=!1){let r=KW(t.pendingWriteTree_,e);if(QW(t.pendingWriteTree_,e)){let s=new Vt(null);return r.snap!=null?s=s.set(fe(),!0):lt(r.children,o=>{s=s.set(new pe(o),!0)}),iu(t,new lD(r.path,s,n))}else return[]}function rd(t,e,n){return iu(t,new Ja(YD(),e,n))}function A9(t,e,n){let r=Vt.fromObject(n);return iu(t,new Wl(YD(),e,r))}function x9(t,e){return iu(t,new Mg(YD(),e))}function M9(t,e,n){let r=nT(t,n);if(r){let i=rT(r),s=i.path,o=i.queryId,a=Ft(s,e),u=new Mg(ZD(o),a);return iT(t,s,u)}else return[]}function jg(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||hF(o,e))){let u=C9(o,e,n,r);E9(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=u.removed;if(a=u.events,!i){let l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>ji(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=P9(h);for(let p=0;p<f.length;++p){let g=f[p],v=g.query,C=mF(t,g);t.listenProvider_.startListening(jl(v),Ql(t,v),C.hashFn,C.onComplete)}}}!d&&c.length>0&&!r&&(l?t.listenProvider_.stopListening(jl(e),null):c.forEach(h=>{let f=t.queryToTagMap.get(Jg(h));t.listenProvider_.stopListening(jl(h),f)}))}k9(t,c)}return a}function fF(t,e,n,r){let i=nT(t,r);if(i!=null){let s=rT(i),o=s.path,a=s.queryId,u=Ft(o,e),c=new Ja(ZD(a),u,n);return iT(t,o,c)}else return[]}function R9(t,e,n,r){let i=nT(t,r);if(i){let s=rT(i),o=s.path,a=s.queryId,u=Ft(o,e),c=Vt.fromObject(n),l=new Wl(ZD(a),u,c);return iT(t,o,l)}else return[]}function wD(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=Ft(h,i);s=s||Fi(f,p),o=o||ji(f)});let a=t.syncPointTree_.get(i);a?(o=o||ji(a),s=s||Fi(a,fe())):(a=new Fg,t.syncPointTree_=t.syncPointTree_.set(i,a));let u;s!=null?u=!0:(u=!1,s=Y.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let g=Fi(p,fe());g&&(s=s.updateImmediateChild(f,g))}));let c=hF(a,e);if(!c&&!e._queryParams.loadsAllData()){let h=Jg(e);D(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=O9();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=Qg(t.pendingWriteTree_,i),d=I9(a,e,n,l,s,u);if(!c&&!o&&!r){let h=dF(a,e);d=d.concat(F9(t,e,h))}return d}function Zg(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let u=Ft(o,e),c=Fi(a,u);if(c)return c});return rF(i,e,s,n,!0)}function N9(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(c,l)=>{let d=Ft(c,n);r=r||Fi(l,d)});let i=t.syncPointTree_.get(n);i?r=r||Fi(i,fe()):(i=new Fg,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new gr(r,!0,!1):null,a=Qg(t.pendingWriteTree_,e._path),u=cF(i,e,a,s?o.getNode():Y.EMPTY_NODE,s);return g9(u)}function iu(t,e){return pF(e,t.syncPointTree_,null,Qg(t.pendingWriteTree_,fe()))}function pF(t,e,n,r){if(te(t.path))return gF(t,e,n,r);{let i=e.get(fe());n==null&&i!=null&&(n=Fi(i,fe()));let s=[],o=ee(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){let c=n?n.getImmediateChild(o):null,l=iF(r,o);s=s.concat(pF(a,u,c,l))}return i&&(s=s.concat(eT(i,t,r,n))),s}}function gF(t,e,n,r){let i=e.get(fe());n==null&&i!=null&&(n=Fi(i,fe()));let s=[];return e.children.inorderTraversal((o,a)=>{let u=n?n.getImmediateChild(o):null,c=iF(r,o),l=t.operationForChild(o);l&&(s=s.concat(gF(l,a,u,c)))}),i&&(s=s.concat(eT(i,t,r,n))),s}function mF(t,e){let n=e.query,r=Ql(t,n);return{hashFn:()=>(p9(e)||Y.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?M9(t,n._path,r):x9(t,n._path);{let s=zz(i,n);return jg(t,n,null,s)}}}}function Ql(t,e){let n=Jg(e);return t.queryToTagMap.get(n)}function Jg(t){return t._path.toString()+"$"+t._queryIdentifier}function nT(t,e){return t.tagToQueryMap.get(e)}function rT(t){let e=t.indexOf("$");return D(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new pe(t.substr(0,e))}}function iT(t,e,n){let r=t.syncPointTree_.get(e);D(r,"Missing sync point for query tag that we're tracking");let i=Qg(t.pendingWriteTree_,e);return eT(r,n,i,null)}function P9(t){return t.fold((e,n,r)=>{if(n&&ji(n))return[Yg(n)];{let i=[];return n&&(i=lF(n)),lt(r,(s,o)=>{i=i.concat(o)}),i}})}function jl(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(T9())(t._repo,t._path):t}function k9(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=Jg(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function O9(){return b9++}function F9(t,e,n){let r=e._path,i=Ql(t,e),s=mF(t,n),o=t.listenProvider_.startListening(jl(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)D(!ji(a.value),"If we're adding a query, it shouldn't be shadowed");else{let u=a.fold((c,l,d)=>{if(!te(c)&&l&&ji(l))return[Yg(l).query];{let h=[];return l&&(h=h.concat(lF(l).map(f=>f.query))),lt(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<u.length;++c){let l=u[c];t.listenProvider_.stopListening(jl(l),Ql(t,l))}}return o}var ED=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},ID=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Pe(this.path_,e);return new t(this.syncTree_,n)}node(){return Zg(this.syncTree_,this.path_)}},V9=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},wO=function(t,e,n){if(!t||typeof t!="object")return t;if(D(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return L9(t[".sv"],e,n);if(typeof t[".sv"]=="object")return j9(t[".sv"],e);D(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},L9=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:D(!1,"Unexpected server value: "+t)}},j9=function(t,e,n){t.hasOwnProperty("increment")||D(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&D(!1,"Unexpected increment value: "+r);let i=e.node();if(D(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},yF=function(t,e,n,r){return oT(e,new ID(n,t),r)},sT=function(t,e,n){return oT(t,new ED(e),n)};function oT(t,e,n){let r=t.getPriority().val(),i=wO(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=wO(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Qa(a,Oe(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Qa(i))),o.forEachChild(Se,(a,u)=>{let c=oT(u,e.getImmediateChild(a),n);c!==u&&(s=s.updateImmediateChild(a,c))}),s}}var Yl=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function Xg(t,e){let n=e instanceof pe?e:new pe(e),r=t,i=ee(n);for(;i!==null;){let s=qr(r.node.children,i)||{children:{},childCount:0};r=new Yl(i,r,s),n=Te(n),i=ee(n)}return r}function Xs(t){return t.node.value}function aT(t,e){t.node.value=e,CD(t)}function _F(t){return t.node.childCount>0}function U9(t){return Xs(t)===void 0&&!_F(t)}function em(t,e){lt(t.node.children,(n,r)=>{e(new Yl(n,t,r))})}function vF(t,e,n,r){n&&!r&&e(t),em(t,i=>{vF(i,e,!0,r)}),n&&r&&e(t)}function B9(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function id(t){return new pe(t.parent===null?t.name:id(t.parent)+"/"+t.name)}function CD(t){t.parent!==null&&$9(t.parent,t.name,t)}function $9(t,e,n){let r=U9(n),i=rn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,CD(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,CD(t))}var H9=/[\[\].#$\/\u0000-\u001F\u007F]/,q9=/[\[\].#$\u0000-\u001F\u007F]/,kC=10*1024*1024,tm=function(t){return typeof t=="string"&&t.length!==0&&!H9.test(t)},wF=function(t){return typeof t=="string"&&t.length!==0&&!q9.test(t)},G9=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),wF(t)},Zl=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!zg(t)||t&&typeof t=="object"&&rn(t,".sv")},mr=function(t,e,n,r){r&&e===void 0||sd(Ut(t,"value"),e,n)},sd=function(t,e,n){let r=n instanceof pe?new WC(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Ws(r));if(typeof e=="function")throw new Error(t+"contains a function "+Ws(r)+" with contents = "+e.toString());if(zg(e))throw new Error(t+"contains "+e.toString()+" "+Ws(r));if(typeof e=="string"&&e.length>kC/3&&cu(e)>kC)throw new Error(t+"contains a string greater than "+kC+" utf8 bytes "+Ws(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(lt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!tm(o)))throw new Error(t+" contains an invalid key ("+o+") "+Ws(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);EW(r,o),sd(t,a,r),IW(r)}),i&&s)throw new Error(t+' contains ".value" child '+Ws(r)+" in addition to actual children.")}},z9=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=Bl(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!tm(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(wW);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&_n(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},EF=function(t,e,n,r){if(r&&e===void 0)return;let i=Ut(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];lt(e,(o,a)=>{let u=new pe(o);if(sd(i,a,Pe(n,u)),qD(u)===".priority"&&!Zl(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),z9(i,s)},uT=function(t,e,n){if(!(n&&e===void 0)){if(zg(e))throw new Error(Ut(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Zl(e))throw new Error(Ut(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},od=function(t,e,n,r){if(!(r&&n===void 0)&&!tm(n))throw new Error(Ut(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},su=function(t,e,n,r){if(!(r&&n===void 0)&&!wF(n))throw new Error(Ut(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},W9=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),su(t,e,n,r)},Xt=function(t,e){if(ee(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},IF=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!tm(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!G9(n))throw new Error(Ut(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var DD=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function nm(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!GD(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function CF(t,e,n){nm(t,n),DF(t,r=>GD(r,e))}function en(t,e,n){nm(t,n),DF(t,r=>_n(r,e)||_n(e,r))}function DF(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(K9(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function K9(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();Qs&&ct("event: "+n.toString()),nu(r)}}}var TF="repo_interrupt",Q9=25,TD=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new DD,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=xg(),this.transactionQueueTree_=new Yl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function Y9(t,e,n){if(t.stats_=HD(t.repoInfo_),t.forceRestClient_||Yz())t.server_=new iD(t.repoInfo_,(r,i,s,o)=>{EO(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>IO(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ge(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new zD(t.repoInfo_,e,(r,i,s,o)=>{EO(t,r,i,s,o)},r=>{IO(t,r)},r=>{Z9(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=Jz(t.repoInfo_,()=>new cD(t.stats_,t.server_)),t.infoData_=new sD,t.infoSyncTree_=new Lg({startListening:(r,i,s,o)=>{let a=[],u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=rd(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),cT(t,"connected",!1),t.serverSyncTree_=new Lg({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{let c=o(a,u);en(t.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function bF(t){let n=t.infoData_.getNode(new pe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function ad(t){return V9({timestamp:bF(t)})}function EO(t,e,n,r,i){t.dataUpdateCount++;let s=new pe(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let u=uu(n,c=>Oe(c));o=R9(t.serverSyncTree_,s,u,i)}else{let u=Oe(n);o=fF(t.serverSyncTree_,s,u,i)}else if(r){let u=uu(n,c=>Oe(c));o=A9(t.serverSyncTree_,s,u)}else{let u=Oe(n);o=rd(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=eu(t,s)),en(t.eventQueue_,a,o)}function IO(t,e){cT(t,"connected",e),e===!1&&e3(t)}function Z9(t,e){lt(e,(n,r)=>{cT(t,n,r)})}function cT(t,e,n){let r=new pe("/.info/"+e),i=Oe(n);t.infoData_.updateSnapshot(r,i);let s=rd(t.infoSyncTree_,r,i);en(t.eventQueue_,r,s)}function rm(t){return t.nextWriteId_++}function J9(t,e,n){let r=N9(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=Oe(i).withIndex(e._queryParams.getIndex());wD(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=rd(t.serverSyncTree_,e._path,s);else{let a=Ql(t.serverSyncTree_,e);o=fF(t.serverSyncTree_,e._path,s,a)}return en(t.eventQueue_,e._path,o),jg(t.serverSyncTree_,e,n,null,!0),s},i=>(ou(t,"get for query "+Ge(e)+" failed: "+i),Promise.reject(new Error(i))))}function lT(t,e,n,r,i){ou(t,"set",{path:e.toString(),value:n,priority:r});let s=ad(t),o=Oe(n,r),a=Zg(t.serverSyncTree_,e),u=sT(o,a,s),c=rm(t),l=tT(t.serverSyncTree_,e,u,c,!0);nm(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||At("set at "+e+" failed: "+h);let g=ki(t.serverSyncTree_,c,!p);en(t.eventQueue_,e,g),Ui(t,i,h,f)});let d=hT(t,e);eu(t,d),en(t.eventQueue_,d,[])}function X9(t,e,n,r){ou(t,"update",{path:e.toString(),value:n});let i=!0,s=ad(t),o={};if(lt(n,(a,u)=>{i=!1,o[a]=yF(Pe(e,a),Oe(u),t.serverSyncTree_,s)}),i)ct("update() called with empty data.  Don't do anything."),Ui(t,r,"ok",void 0);else{let a=rm(t),u=S9(t.serverSyncTree_,e,o,a);nm(t.eventQueue_,u),t.server_.merge(e.toString(),n,(c,l)=>{let d=c==="ok";d||At("update at "+e+" failed: "+c);let h=ki(t.serverSyncTree_,a,!d),f=h.length>0?eu(t,e):e;en(t.eventQueue_,f,h),Ui(t,r,c,l)}),lt(n,c=>{let l=hT(t,Pe(e,c));eu(t,l)}),en(t.eventQueue_,e,[])}}function e3(t){ou(t,"onDisconnectEvents");let e=ad(t),n=xg();aD(t.onDisconnect_,fe(),(i,s)=>{let o=yF(i,s,t.serverSyncTree_,e);ru(n,i,o)});let r=[];aD(n,fe(),(i,s)=>{r=r.concat(rd(t.serverSyncTree_,i,s));let o=hT(t,i);eu(t,o)}),t.onDisconnect_=xg(),en(t.eventQueue_,fe(),r)}function t3(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&oD(t.onDisconnect_,e),Ui(t,n,r,i)})}function CO(t,e,n,r){let i=Oe(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&ru(t.onDisconnect_,e,i),Ui(t,r,s,o)})}function n3(t,e,n,r,i){let s=Oe(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&ru(t.onDisconnect_,e,s),Ui(t,i,o,a)})}function r3(t,e,n,r){if(md(n)){ct("onDisconnect().update() called with empty data.  Don't do anything."),Ui(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&lt(n,(o,a)=>{let u=Oe(a);ru(t.onDisconnect_,Pe(e,o),u)}),Ui(t,r,i,s)})}function i3(t,e,n){let r;ee(e._path)===".info"?r=wD(t.infoSyncTree_,e,n):r=wD(t.serverSyncTree_,e,n),CF(t.eventQueue_,e._path,r)}function bD(t,e,n){let r;ee(e._path)===".info"?r=jg(t.infoSyncTree_,e,n):r=jg(t.serverSyncTree_,e,n),CF(t.eventQueue_,e._path,r)}function SF(t){t.persistentConnection_&&t.persistentConnection_.interrupt(TF)}function s3(t){t.persistentConnection_&&t.persistentConnection_.resume(TF)}function ou(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),ct(n,...e)}function Ui(t,e,n,r){e&&nu(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function o3(t,e,n,r,i,s){ou(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:bO(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=dT(t,e,void 0);o.currentInputSnapshot=a;let u=o.update(a.val());if(u===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{sd("transaction failed: Data returned ",u,o.path),o.status=0;let c=Xg(t.transactionQueueTree_,e),l=Xs(c)||[];l.push(o),aT(c,l);let d;typeof u=="object"&&u!==null&&rn(u,".priority")?(d=qr(u,".priority"),D(Zl(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(Zg(t.serverSyncTree_,e)||Y.EMPTY_NODE).getPriority().val();let h=ad(t),f=Oe(u,d),p=sT(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=rm(t);let g=tT(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);en(t.eventQueue_,e,g),im(t,t.transactionQueueTree_)}}function dT(t,e,n){return Zg(t.serverSyncTree_,e,n)||Y.EMPTY_NODE}function im(t,e=t.transactionQueueTree_){if(e||sm(t,e),Xs(e)){let n=xF(t,e);D(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&a3(t,id(e),n)}else _F(e)&&em(e,n=>{im(t,n)})}function a3(t,e,n){let r=n.map(c=>c.currentWriteId),i=dT(t,e,r),s=i,o=i.hash();for(let c=0;c<n.length;c++){let l=n[c];D(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=Ft(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),u=e;t.server_.put(u.toString(),a,c=>{ou(t,"transaction put response",{path:u.toString(),status:c});let l=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat(ki(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();sm(t,Xg(t.transactionQueueTree_,e)),im(t,t.transactionQueueTree_),en(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)nu(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{At("transaction at "+u.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}eu(t,e)}},o)}function eu(t,e){let n=AF(t,e),r=id(n),i=xF(t,n);return u3(t,i,r),r}function u3(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let u=e[a],c=Ft(n,u.path),l=!1,d;if(D(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)l=!0,d=u.abortReason,i=i.concat(ki(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=Q9)l=!0,d="maxretry",i=i.concat(ki(t.serverSyncTree_,u.currentWriteId,!0));else{let h=dT(t,u.path,o);u.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){sd("transaction failed: Data returned ",f,u.path);let p=Oe(f);typeof f=="object"&&f!=null&&rn(f,".priority")||(p=p.updatePriority(h.getPriority()));let v=u.currentWriteId,C=ad(t),N=sT(p,h,C);u.currentOutputSnapshotRaw=p,u.currentOutputSnapshotResolved=N,u.currentWriteId=rm(t),o.splice(o.indexOf(v),1),i=i.concat(tT(t.serverSyncTree_,u.path,N,u.currentWriteId,u.applyLocally)),i=i.concat(ki(t.serverSyncTree_,v,!0))}else l=!0,d="nodata",i=i.concat(ki(t.serverSyncTree_,u.currentWriteId,!0))}en(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}sm(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)nu(r[a]);im(t,t.transactionQueueTree_)}function AF(t,e){let n,r=t.transactionQueueTree_;for(n=ee(e);n!==null&&Xs(r)===void 0;)r=Xg(r,n),e=Te(e),n=ee(e);return r}function xF(t,e){let n=[];return MF(t,e,n),n.sort((r,i)=>r.order-i.order),n}function MF(t,e,n){let r=Xs(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);em(e,i=>{MF(t,i,n)})}function sm(t,e){let n=Xs(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,aT(e,n.length>0?n:void 0)}em(e,r=>{sm(t,r)})}function hT(t,e){let n=id(AF(t,e)),r=Xg(t.transactionQueueTree_,e);return B9(r,i=>{OC(t,i)}),OC(t,r),vF(r,i=>{OC(t,i)}),n}function OC(t,e){let n=Xs(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(D(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(D(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ki(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?aT(e,void 0):n.length=s+1,en(t.eventQueue_,id(e),i);for(let o=0;o<r.length;o++)nu(r[o])}}function c3(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function l3(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):At(`Invalid query segment '${n}' in query '${t}'`)}return e}var SD=function(t,e){let n=d3(t),r=n.namespace;n.domain==="firebase.com"&&pr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&pr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||Bz();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Eg(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new pe(n.pathString)}},d3=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=c3(t.substring(l,d)));let h=l3(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var DO="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",h3=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=DO.charAt(n%64),n=Math.floor(n/64);D(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=DO.charAt(e[i]);return D(o.length===20,"nextPushId: Length should be 20."),o}}();var Ug=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ge(this.snapshot.exportVal())}},Bg=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Jl=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return D(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var $g=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new rt;return t3(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Xt("OnDisconnect.remove",this._path);let e=new rt;return CO(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Xt("OnDisconnect.set",this._path),mr("OnDisconnect.set",e,this._path,!1);let n=new rt;return CO(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Xt("OnDisconnect.setWithPriority",this._path),mr("OnDisconnect.setWithPriority",e,this._path,!1),uT("OnDisconnect.setWithPriority",n,!1);let r=new rt;return n3(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){Xt("OnDisconnect.update",this._path),EF("OnDisconnect.update",e,this._path,!1);let n=new rt;return r3(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Lt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return te(this._path)?null:qD(this._path)}get ref(){return new tn(this._repo,this._path)}get _queryIdentifier(){let e=lO(this._queryParams),n=$D(e);return n==="{}"?"default":n}get _queryObject(){return lO(this._queryParams)}isEqual(e){if(e=ie(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=GD(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+vW(this._path)}};function om(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function $i(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===fr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Vi)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==$r)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Se){if(e!=null&&!Zl(e)||n!=null&&!Zl(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(D(t.getIndex()instanceof $l||t.getIndex()===KD,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function am(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var tn=class t extends Lt{constructor(e,n){super(e,n,new zl,!1)}get parent(){let e=WO(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},tu=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new pe(e),r=Bi(this.ref,e);return new t(this._node.getChild(n),r,Se)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,Bi(this.ref,r),Se)))}hasChild(e){let n=new pe(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function fT(t,e){return t=ie(t),t._checkNotDeleted("ref"),e!==void 0?Bi(t._root,e):t._root}function pT(t,e){t=ie(t),t._checkNotDeleted("refFromURL");let n=SD(e,t._repo.repoInfo_.nodeAdmin);IF("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&pr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),fT(t,n.path.toString())}function Bi(t,e){return t=ie(t),ee(t._path)===null?W9("child","path",e,!1):su("child","path",e,!1),new tn(t._repo,Pe(t._path,e))}function RF(t,e){t=ie(t),Xt("push",t._path),mr("push",e,t._path,!0);let n=bF(t._repo),r=h3(n),i=Bi(t,r),s=Bi(t,r),o;return e!=null?o=um(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function NF(t){return Xt("remove",t._path),um(t,null)}function um(t,e){t=ie(t),Xt("set",t._path),mr("set",e,t._path,!1);let n=new rt;return lT(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function PF(t,e){t=ie(t),Xt("setPriority",t._path),uT("setPriority",e,!1);let n=new rt;return lT(t._repo,Pe(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function kF(t,e,n){if(Xt("setWithPriority",t._path),mr("setWithPriority",e,t._path,!1),uT("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new rt;return lT(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function OF(t,e){EF("update",e,t._path,!1);let n=new rt;return X9(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function FF(t){t=ie(t);let e=new Jl(()=>{}),n=new Xl(e);return J9(t._repo,t,n).then(r=>new tu(r,new tn(t._repo,t._path),t._queryParams.getIndex()))}var Xl=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new Ug("value",this,new tu(e.snapshotNode,new tn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Bg(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Hg=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Bg(this,e,n):null}createEvent(e,n){D(e.childName!=null,"Child events should have a childName.");let r=Bi(new tn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new Ug(e.type,this,new tu(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function ud(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let u=n,c=(l,d)=>{bD(t._repo,t,a),u(l,d)};c.userCallback=n.userCallback,c.context=n.context,n=c}let o=new Jl(n,s||void 0),a=e==="value"?new Xl(o):new Hg(e,o);return i3(t._repo,t,a),()=>bD(t._repo,t,a)}function cm(t,e,n,r){return ud(t,"value",e,n,r)}function gT(t,e,n,r){return ud(t,"child_added",e,n,r)}function mT(t,e,n,r){return ud(t,"child_changed",e,n,r)}function yT(t,e,n,r){return ud(t,"child_moved",e,n,r)}function _T(t,e,n,r){return ud(t,"child_removed",e,n,r)}function vT(t,e,n){let r=null,i=n?new Jl(n):null;e==="value"?r=new Xl(i):e&&(r=new Hg(e,i)),bD(t._repo,t,r)}var nn=class{},qg=class extends nn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){mr("endAt",this._value,e._path,!0);let n=rD(e._queryParams,this._value,this._key);if(am(n),$i(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Lt(e._repo,e._path,n,e._orderByCalled)}};function VF(t,e){return od("endAt","key",e,!0),new qg(t,e)}var AD=class extends nn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){mr("endBefore",this._value,e._path,!1);let n=LW(e._queryParams,this._value,this._key);if(am(n),$i(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Lt(e._repo,e._path,n,e._orderByCalled)}};function LF(t,e){return od("endBefore","key",e,!0),new AD(t,e)}var Gg=class extends nn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){mr("startAt",this._value,e._path,!0);let n=nD(e._queryParams,this._value,this._key);if(am(n),$i(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Lt(e._repo,e._path,n,e._orderByCalled)}};function jF(t=null,e){return od("startAt","key",e,!0),new Gg(t,e)}var xD=class extends nn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){mr("startAfter",this._value,e._path,!1);let n=VW(e._queryParams,this._value,this._key);if(am(n),$i(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Lt(e._repo,e._path,n,e._orderByCalled)}};function UF(t,e){return od("startAfter","key",e,!0),new xD(t,e)}var MD=class extends nn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Lt(e._repo,e._path,OW(e._queryParams,this._limit),e._orderByCalled)}};function BF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new MD(t)}var RD=class extends nn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Lt(e._repo,e._path,FW(e._queryParams,this._limit),e._orderByCalled)}};function $F(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new RD(t)}var ND=class extends nn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){om(e,"orderByChild");let n=new pe(this._path);if(te(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new $l(n),i=Wg(e._queryParams,r);return $i(i),new Lt(e._repo,e._path,i,!0)}};function HF(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return su("orderByChild","path",t,!1),new ND(t)}var PD=class extends nn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){om(e,"orderByKey");let n=Wg(e._queryParams,fr);return $i(n),new Lt(e._repo,e._path,n,!0)}};function qF(){return new PD}var kD=class extends nn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){om(e,"orderByPriority");let n=Wg(e._queryParams,Se);return $i(n),new Lt(e._repo,e._path,n,!0)}};function GF(){return new kD}var OD=class extends nn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){om(e,"orderByValue");let n=Wg(e._queryParams,KD);return $i(n),new Lt(e._repo,e._path,n,!0)}};function zF(){return new OD}var FD=class extends nn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(mr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new qg(this._value,this._key)._apply(new Gg(this._value,this._key)._apply(e))}};function WF(t,e){return od("equalTo","key",e,!0),new FD(t,e)}function wn(t,...e){let n=ie(t);for(let r of e)n=r._apply(n);return n}v9(tn);D9(tn);var f3="FIREBASE_DATABASE_EMULATOR_HOST",VD={},p3=!1;function g3(t,e,n,r){t.repoInfo_=new Eg(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function wT(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||pr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ct("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=SD(s,i),a=o.repoInfo,u,c;typeof process<"u"&&process.env&&(c=process.env[f3]),c?(u=!0,s=`http://${c}?ns=${a.namespace}`,o=SD(s,i),a=o.repoInfo):u=!o.repoInfo.secure;let l=i&&u?new Fl(Fl.OWNER):new BC(t.name,t.options,e);IF("Invalid Firebase Database URL",o),te(o.path)||pr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=y3(a,t,l,new UC(t.name,n));return new LD(d,t)}function m3(t,e){let n=VD[e];(!n||n[t.key]!==t)&&pr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),SF(t),delete n[t.key]}function y3(t,e,n,r){let i=VD[e.name];i||(i={},VD[e.name]=i);let s=i[t.toURLString()];return s&&pr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new TD(t,p3,n,r),i[t.toURLString()]=s,s}var LD=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Y9(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new tn(this._repo,fe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(m3(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&pr("Cannot call "+e+" on a deleted database.")}};function KF(){zO.IS_TRANSPORT_INITIALIZED&&At("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function QF(){KF(),Ul.forceDisallow()}function YF(){KF(),Ga.forceDisallow(),Ul.forceAllow()}function ZF(t,e,n,r={}){t=ie(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&pr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&pr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Fl(Fl.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:fd(r.mockUserToken,t.app.options.projectId);s=new Fl(o)}g3(i,e,n,s)}function JF(t){t=ie(t),t._checkNotDeleted("goOffline"),SF(t._repo)}function XF(t){t=ie(t),t._checkNotDeleted("goOnline"),s3(t._repo)}function e1(t,e){AO(t,e)}function _3(t){BD(_d),Hi(new Gt("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return wT(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),En(Wk,Kk,t),En(Wk,Kk,"esm2017")}var v3={".sv":"timestamp"};function t1(){return v3}function n1(t){return{".sv":{increment:t}}}var jD=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function r1(t,e,n){var r;if(t=ie(t),Xt("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new rt,o=(u,c,l)=>{let d=null;u?s.reject(u):(d=new tu(l,new tn(t._repo,t._path),Se),s.resolve(new jD(c,d)))},a=cm(t,()=>{});return o3(t._repo,t._path,e,o,a,i),s.promise}zD.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};zD.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};_3();var w3="@firebase/database-compat",E3="1.0.4";var I3=new Gr("@firebase/database-compat"),i1=function(t){let e="FIREBASE WARNING: "+t;I3.warn(e)};var C3=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(Ut(t,e)+"must be a boolean.")},D3=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Ut(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var ET=class{constructor(e){this._delegate=e}cancel(e){B("OnDisconnect.cancel",0,1,arguments.length),Je("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){B("OnDisconnect.remove",0,1,arguments.length),Je("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){B("OnDisconnect.set",1,2,arguments.length),Je("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){B("OnDisconnect.setWithPriority",2,3,arguments.length),Je("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(B("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,i1("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Je("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var IT=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return B("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var eo=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return B("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return B("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return B("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return B("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return B("DataSnapshot.child",0,1,arguments.length),e=String(e),su("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return B("DataSnapshot.hasChild",1,1,arguments.length),su("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return B("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return B("DataSnapshot.forEach",1,1,arguments.length),Je("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return B("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return B("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return B("DataSnapshot.ref",0,0,arguments.length),new Hr(this._database,this._delegate.ref)}get ref(){return this.getRef()}},lm=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;B("Query.on",2,4,arguments.length),Je("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(c,l)=>{n.call(o.context,new eo(this.database,c),l)};a.userCallback=n,a.context=o.context;let u=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return cm(this._delegate,a,u),n;case"child_added":return gT(this._delegate,a,u),n;case"child_removed":return _T(this._delegate,a,u),n;case"child_changed":return mT(this._delegate,a,u),n;case"child_moved":return yT(this._delegate,a,u),n;default:throw new Error(Ut("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(B("Query.off",0,3,arguments.length),D3("Query.off",e,!0),Je("Query.off","callback",n,!0),mm("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,vT(this._delegate,e,i)}else vT(this._delegate,e)}get(){return FF(this._delegate).then(e=>new eo(this.database,e))}once(e,n,r,i){B("Query.once",1,4,arguments.length),Je("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new rt,a=(c,l)=>{let d=new eo(this.database,c);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let u=c=>{s.cancel&&s.cancel.call(s.context,c),o.reject(c)};switch(e){case"value":cm(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":gT(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":_T(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":mT(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":yT(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error(Ut("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return B("Query.limitToFirst",1,1,arguments.length),new t(this.database,wn(this._delegate,BF(e)))}limitToLast(e){return B("Query.limitToLast",1,1,arguments.length),new t(this.database,wn(this._delegate,$F(e)))}orderByChild(e){return B("Query.orderByChild",1,1,arguments.length),new t(this.database,wn(this._delegate,HF(e)))}orderByKey(){return B("Query.orderByKey",0,0,arguments.length),new t(this.database,wn(this._delegate,qF()))}orderByPriority(){return B("Query.orderByPriority",0,0,arguments.length),new t(this.database,wn(this._delegate,GF()))}orderByValue(){return B("Query.orderByValue",0,0,arguments.length),new t(this.database,wn(this._delegate,zF()))}startAt(e=null,n){return B("Query.startAt",0,2,arguments.length),new t(this.database,wn(this._delegate,jF(e,n)))}startAfter(e=null,n){return B("Query.startAfter",0,2,arguments.length),new t(this.database,wn(this._delegate,UF(e,n)))}endAt(e=null,n){return B("Query.endAt",0,2,arguments.length),new t(this.database,wn(this._delegate,VF(e,n)))}endBefore(e=null,n){return B("Query.endBefore",0,2,arguments.length),new t(this.database,wn(this._delegate,LF(e,n)))}equalTo(e,n){return B("Query.equalTo",1,2,arguments.length),new t(this.database,wn(this._delegate,WF(e,n)))}toString(){return B("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return B("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(B("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,Je(e,"cancel",i.cancel,!0),i.context=r,mm(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(Ut(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Hr(this.database,new tn(this._delegate._repo,this._delegate._path))}},Hr=class t extends lm{constructor(e,n){super(e,new Lt(n._repo,n._path,new zl,!1)),this.database=e,this._delegate=n}getKey(){return B("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return B("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,Bi(this._delegate,e))}getParent(){B("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return B("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){B("Reference.set",1,2,arguments.length),Je("Reference.set","onComplete",n,!0);let r=um(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(B("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,i1("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Xt("Reference.update",this._delegate._path),Je("Reference.update","onComplete",n,!0);let r=OF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){B("Reference.setWithPriority",2,3,arguments.length),Je("Reference.setWithPriority","onComplete",r,!0);let i=kF(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){B("Reference.remove",0,1,arguments.length),Je("Reference.remove","onComplete",e,!0);let n=NF(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){B("Reference.transaction",1,3,arguments.length),Je("Reference.transaction","transactionUpdate",e,!1),Je("Reference.transaction","onComplete",n,!0),C3("Reference.transaction","applyLocally",r,!0);let i=r1(this._delegate,e,{applyLocally:r}).then(s=>new IT(s.committed,new eo(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){B("Reference.setPriority",1,2,arguments.length),Je("Reference.setPriority","onComplete",n,!0);let r=PF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){B("Reference.push",0,2,arguments.length),Je("Reference.push","onComplete",n,!0);let r=RF(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Xt("Reference.onDisconnect",this._delegate._path),new ET(new $g(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var to=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:QF,forceLongPolling:YF}}useEmulator(e,n,r={}){ZF(this._delegate,e,n,r)}ref(e){if(B("database.ref",0,1,arguments.length),e instanceof Hr){let n=pT(this._delegate,e.toString());return new Hr(this,n)}else{let n=fT(this._delegate,e);return new Hr(this,n)}}refFromURL(e){B("database.refFromURL",1,1,arguments.length);let r=pT(this._delegate,e);return new Hr(this,r)}goOffline(){return B("database.goOffline",0,0,arguments.length),JF(this._delegate)}goOnline(){return B("database.goOnline",0,0,arguments.length),XF(this._delegate)}};to.ServerValue={TIMESTAMP:t1(),increment:t=>n1(t)};function T3({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){BD(n);let a=new ym("database-standalone"),u=new yd("auth-internal",a);u.setComponent(new Gt("auth-internal",()=>r,"PRIVATE"));let c;return i&&(c=new yd("app-check-internal",a),c.setComponent(new Gt("app-check-internal",()=>i,"PRIVATE"))),{instance:new to(wT(t,u,c,e,o),t),namespace:s}}var b3=Object.freeze({__proto__:null,initStandalone:T3});var S3=to.ServerValue;function A3(t){t.INTERNAL.registerComponent(new Gt("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new to(i,r)},"PUBLIC").setServiceProps({Reference:Hr,Query:lm,Database:to,DataSnapshot:eo,enableLogging:e1,INTERNAL:b3,ServerValue:S3}).setMultipleInstances(!0)),t.registerVersion(w3,E3)}A3(Xe);function cd(t,e,n="on",r=Ki){return new X(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(k(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),mu())}function x3(t){return typeof t=="string"}function M3(t){return typeof t.exportVal=="function"}function c1(t){return t==null}function l1(t){return typeof t.set=="function"}function s1(t,e){return l1(e)?e:t.ref(e)}function d1(t,e){if(x3(t))return e.stringCase();if(l1(t))return e.firebaseCase();if(M3(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function h1(t){return(c1(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function f1(t,e,n){e=h1(e);let r=e.map(i=>cd(t,i,"on",n));return mo(...r)}function R3(t,e,n){let r=f1(t,e).pipe($n((i,s)=>[...i,s],[]));return P3(t,r,n)}function N3(t,e){return cd(t,"value","on",e).pipe(k(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function P3(t,e,n){return N3(t,n).pipe(Bm(e),k(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),jm(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),k(i=>i.actions))}function o1(t,e){return function(r,i){return d1(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function k3(t){return function(n){return n?d1(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function O3(t,e,n){return cd(t,"value","once",n).pipe(Ae(r=>{let i=[V(r)];return e.forEach(s=>i.push(cd(t,s,"on",n))),mo(...i).pipe($n(V3,[]))}),fu())}function p1(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function F3(t,e){if(c1(e))return 0;{let n=p1(t,e);return n===-1?t.length:n+1}}function V3(t,e){let{payload:n,prevKey:r,key:i}=e,s=p1(t,i),o=F3(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{let c={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(u=>u.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function a1(t,e,n){return e=h1(e),O3(t,e,n)}function L3(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:o1(r,"update"),set:o1(r,"set"),push:i=>r.push(i),remove:k3(r),snapshotChanges(i){return a1(t,i,n).pipe(Be)},stateChanges(i){return f1(t,i,n).pipe(Be)},auditTrail(i){return R3(t,i,n).pipe(Be)},valueChanges(i,s){return a1(t,i,n).pipe(k(a=>a.map(u=>s&&s.idField?ge(M({},u.payload.val()),{[s.idField]:u.key}):u.payload.val())),Be)}}}function u1(t,e){return function(){return cd(t,"value","on",e)}}function j3(t,e){return{query:t,snapshotChanges(){return u1(t,e.schedulers.outsideAngular)().pipe(Be)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return u1(t,e.schedulers.outsideAngular)().pipe(Be,k(r=>r.payload.exists()?r.payload.val():null))}}}var U3=new P("angularfire2.realtimeDatabaseURL"),B3=new P("angularfire2.database.use-emulator"),$3=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,v){this.schedulers=a;let C=u,N=ps(n,o,r);c&&wc(N,o,l,h,f,p,d,g),this.database=Zo(`${N.name}.database.${i}`,"AngularFireDatabase",N.name,()=>{let T=o.runOutsideAngular(()=>N.database(i||void 0));return C&&T.useEmulator(...C),T},[C])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>s1(this.database,n)),s=i;return r&&(s=r(i)),L3(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>s1(this.database,n));return j3(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(I(li),I(di,8),I(U3,8),I(Ct),I(he),I(Yo),I(B3,8),I(gs,8),I(pc,8),I(gc,8),I(mc,8),I(yc,8),I(_c,8),I(vc,8),I(xr,8))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),vte=(()=>{class t{constructor(){Xe.registerVersion("angularfire",Mr.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Et({type:t});static \u0275inj=wt({providers:[$3]})}return t})();export{k as a,Bn as b,Ae as c,F as d,wt as e,I as f,x as g,u0 as h,Et as i,TV as j,sZ as k,oZ as l,aZ as m,_e as n,q2 as o,eU as p,$S as q,HS as r,D_ as s,dZ as t,Vo as u,hZ as v,fZ as w,yU as x,GS as y,_U as z,pZ as A,vU as B,Fu as C,WS as D,BZ as E,zU as F,hJ as G,T$ as H,xn as I,nX as J,rX as K,iX as L,xA as M,MJ as N,RJ as O,qB as P,WB as Q,PJ as R,YB as S,kJ as T,li as U,IX as V,oee as W,AC as X,$ee as Y,qee as Z,$3 as _,vte as $};
